<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="http://keystonejs.com/"

    >keystone (v4.0.0-beta.5)</a>
</h1>
<h4>Web Application Framework and Admin GUI / Content Management System built on Express.js and Mongoose</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone">module keystone</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.AzureFileType">
            function <span class="apidocSignatureSpan">keystone.</span>AzureFileType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.BooleanType">
            function <span class="apidocSignatureSpan">keystone.</span>BooleanType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.CloudinaryImageType">
            function <span class="apidocSignatureSpan">keystone.</span>CloudinaryImageType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.CloudinaryImagesType">
            function <span class="apidocSignatureSpan">keystone.</span>CloudinaryImagesType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.CodeType">
            function <span class="apidocSignatureSpan">keystone.</span>CodeType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.ColorType">
            function <span class="apidocSignatureSpan">keystone.</span>ColorType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.DateArrayType">
            function <span class="apidocSignatureSpan">keystone.</span>DateArrayType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.DateType">
            function <span class="apidocSignatureSpan">keystone.</span>DateType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.DatetimeType">
            function <span class="apidocSignatureSpan">keystone.</span>DatetimeType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Email">
            function <span class="apidocSignatureSpan">keystone.</span>Email
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.EmailType">
            function <span class="apidocSignatureSpan">keystone.</span>EmailType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.EmbedlyType">
            function <span class="apidocSignatureSpan">keystone.</span>EmbedlyType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field">
            function <span class="apidocSignatureSpan">keystone.</span>Field
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.FileType">
            function <span class="apidocSignatureSpan">keystone.</span>FileType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.GeoPointType">
            function <span class="apidocSignatureSpan">keystone.</span>GeoPointType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.HtmlType">
            function <span class="apidocSignatureSpan">keystone.</span>HtmlType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.KeyType">
            function <span class="apidocSignatureSpan">keystone.</span>KeyType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone">
            function <span class="apidocSignatureSpan">keystone.</span>Keystone
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List">
            function <span class="apidocSignatureSpan">keystone.</span>List
            <span class="apidocSignatureSpan">(key, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.LocalFileType">
            function <span class="apidocSignatureSpan">keystone.</span>LocalFileType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.LocalFilesType">
            function <span class="apidocSignatureSpan">keystone.</span>LocalFilesType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.LocationType">
            function <span class="apidocSignatureSpan">keystone.</span>LocationType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.MarkdownType">
            function <span class="apidocSignatureSpan">keystone.</span>MarkdownType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.MoneyType">
            function <span class="apidocSignatureSpan">keystone.</span>MoneyType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.NameType">
            function <span class="apidocSignatureSpan">keystone.</span>NameType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.NumberArrayType">
            function <span class="apidocSignatureSpan">keystone.</span>NumberArrayType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.NumberType">
            function <span class="apidocSignatureSpan">keystone.</span>NumberType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.PasswordType">
            function <span class="apidocSignatureSpan">keystone.</span>PasswordType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.RelationshipType">
            function <span class="apidocSignatureSpan">keystone.</span>RelationshipType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.S3FileType">
            function <span class="apidocSignatureSpan">keystone.</span>S3FileType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.SelectType">
            function <span class="apidocSignatureSpan">keystone.</span>SelectType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Storage">
            function <span class="apidocSignatureSpan">keystone.</span>Storage
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.TextArrayType">
            function <span class="apidocSignatureSpan">keystone.</span>TextArrayType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.TextType">
            function <span class="apidocSignatureSpan">keystone.</span>TextType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.TextareaType">
            function <span class="apidocSignatureSpan">keystone.</span>TextareaType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.UrlType">
            function <span class="apidocSignatureSpan">keystone.</span>UrlType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.View">
            function <span class="apidocSignatureSpan">keystone.</span>View
            <span class="apidocSignatureSpan">(req, res)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.addAsyncHooks">
            function <span class="apidocSignatureSpan">keystone.</span>addAsyncHooks
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.addHooks">
            function <span class="apidocSignatureSpan">keystone.</span>addHooks
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.addSyncHooks">
            function <span class="apidocSignatureSpan">keystone.</span>addSyncHooks
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.addThenableHooks">
            function <span class="apidocSignatureSpan">keystone.</span>addThenableHooks
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.allowHooks">
            function <span class="apidocSignatureSpan">keystone.</span>allowHooks
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.callAsyncHook">
            function <span class="apidocSignatureSpan">keystone.</span>callAsyncHook
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.callHook">
            function <span class="apidocSignatureSpan">keystone.</span>callHook
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.callSyncHook">
            function <span class="apidocSignatureSpan">keystone.</span>callSyncHook
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.callThenableHook">
            function <span class="apidocSignatureSpan">keystone.</span>callThenableHook
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express">
            function <span class="apidocSignatureSpan">keystone.</span>express
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route">
            function <span class="apidocSignatureSpan">keystone.</span>express.Route
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router">
            function <span class="apidocSignatureSpan">keystone.</span>express.Router
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.getMiddleware">
            function <span class="apidocSignatureSpan">keystone.</span>getMiddleware
            <span class="apidocSignatureSpan">(qualifiedHook)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.hasMiddleware">
            function <span class="apidocSignatureSpan">keystone.</span>hasMiddleware
            <span class="apidocSignatureSpan">(qualifiedHook)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.hook">
            function <span class="apidocSignatureSpan">keystone.</span>hook
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.hookable">
            function <span class="apidocSignatureSpan">keystone.</span>hookable
            <span class="apidocSignatureSpan">(qualifiedHook)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.html">
            function <span class="apidocSignatureSpan">keystone.</span>html
            <span class="apidocSignatureSpan">(path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.page">
            function <span class="apidocSignatureSpan">keystone.</span>page
            <span class="apidocSignatureSpan">(key, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.post">
            function <span class="apidocSignatureSpan">keystone.</span>post
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.pre">
            function <span class="apidocSignatureSpan">keystone.</span>pre
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.text">
            function <span class="apidocSignatureSpan">keystone.</span>text
            <span class="apidocSignatureSpan">(path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.unhook">
            function <span class="apidocSignatureSpan">keystone.</span>unhook
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.updateHandler">
            function <span class="apidocSignatureSpan">keystone.</span>updateHandler
            <span class="apidocSignatureSpan">(list, item, req, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Admin</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.AzureFile.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Boolean.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.CloudinaryImage.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.CloudinaryImages.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Code.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Color.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Date.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.DateArray.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Datetime.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Email.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Embedly.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.File.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.GeoPoint.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Html.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Key.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.LocalFile.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.LocalFiles.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Location.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Markdown.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Money.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Name.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Number.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.NumberArray.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Password.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Relationship.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.S3File.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Select.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Text.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.TextArray.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Textarea.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.Types.Url.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Field.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Keystone.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Keystone.prototype.console</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>List.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Storage.Adapters</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Storage.Adapters.FS.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>Storage.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>View.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>__grappling</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>_options</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>_redirects</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>cloudinary</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>color</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>content</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>csrf</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>css</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>express.Route.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>express.application</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>express.request</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>express.response</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>fieldTypes</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>lists</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>middleware</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>mongoose</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>options</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>page.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>paths</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>s3</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>schemaPlugins</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>security</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>session</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>updateHandler.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>updates</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.</span>utils</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.</span>version</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.AzureFileType">module keystone.AzureFileType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.AzureFileType.AzureFileType">
            function <span class="apidocSignatureSpan">keystone.</span>AzureFileType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.AzureFileType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.BooleanType">module keystone.BooleanType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.BooleanType.BooleanType">
            function <span class="apidocSignatureSpan">keystone.</span>BooleanType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.BooleanType.super_">
            function <span class="apidocSignatureSpan">keystone.BooleanType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.BooleanType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.CloudinaryImageType">module keystone.CloudinaryImageType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.CloudinaryImageType.CloudinaryImageType">
            function <span class="apidocSignatureSpan">keystone.</span>CloudinaryImageType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.CloudinaryImageType.super_">
            function <span class="apidocSignatureSpan">keystone.CloudinaryImageType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.CloudinaryImageType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.CloudinaryImagesType">module keystone.CloudinaryImagesType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.CloudinaryImagesType.CloudinaryImagesType">
            function <span class="apidocSignatureSpan">keystone.</span>CloudinaryImagesType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.CloudinaryImagesType.super_">
            function <span class="apidocSignatureSpan">keystone.CloudinaryImagesType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.CloudinaryImagesType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.CodeType">module keystone.CodeType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.CodeType.CodeType">
            function <span class="apidocSignatureSpan">keystone.</span>CodeType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.CodeType.super_">
            function <span class="apidocSignatureSpan">keystone.CodeType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.CodeType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.ColorType">module keystone.ColorType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.ColorType.ColorType">
            function <span class="apidocSignatureSpan">keystone.</span>ColorType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.ColorType.super_">
            function <span class="apidocSignatureSpan">keystone.ColorType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.ColorType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.DateArrayType">module keystone.DateArrayType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.DateArrayType.DateArrayType">
            function <span class="apidocSignatureSpan">keystone.</span>DateArrayType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.DateArrayType.super_">
            function <span class="apidocSignatureSpan">keystone.DateArrayType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.DateArrayType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.DateType">module keystone.DateType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.DateType.DateType">
            function <span class="apidocSignatureSpan">keystone.</span>DateType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.DateType.super_">
            function <span class="apidocSignatureSpan">keystone.DateType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.DateType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.DatetimeType">module keystone.DatetimeType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.DatetimeType.DatetimeType">
            function <span class="apidocSignatureSpan">keystone.</span>DatetimeType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.DatetimeType.super_">
            function <span class="apidocSignatureSpan">keystone.DatetimeType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.DatetimeType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.EmailType">module keystone.EmailType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.EmailType.EmailType">
            function <span class="apidocSignatureSpan">keystone.</span>EmailType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.EmailType.super_">
            function <span class="apidocSignatureSpan">keystone.EmailType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.EmailType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.EmbedlyType">module keystone.EmbedlyType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.EmbedlyType.EmbedlyType">
            function <span class="apidocSignatureSpan">keystone.</span>EmbedlyType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.EmbedlyType.super_">
            function <span class="apidocSignatureSpan">keystone.EmbedlyType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.EmbedlyType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field">module keystone.Field</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Field">
            function <span class="apidocSignatureSpan">keystone.</span>Field
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.Field.</span>Types</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types">module keystone.Field.Types</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.AzureFile">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>AzureFile
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Boolean">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Boolean
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImage">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>CloudinaryImage
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImages">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>CloudinaryImages
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Code">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Code
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Color">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Color
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Date">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Date
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.DateArray">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>DateArray
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Datetime">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Datetime
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Email">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Email
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Embedly">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Embedly
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.File">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>File
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.GeoPoint">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>GeoPoint
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Html">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Html
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Key">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Key
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFile">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>LocalFile
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFiles">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>LocalFiles
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Location">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Location
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Markdown">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Markdown
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Money">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Money
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Name">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Name
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Number">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Number
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.NumberArray">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>NumberArray
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Password">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Password
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Relationship">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Relationship
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.S3File">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>S3File
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Select">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Select
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Text">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Text
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.TextArray">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>TextArray
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Textarea">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Textarea
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Url">
            function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Url
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.AzureFile.prototype">module keystone.Field.Types.AzureFile.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.AzureFile.prototype.addToSchema">
            function <span class="apidocSignatureSpan">keystone.Field.Types.AzureFile.prototype.</span>addToSchema
            <span class="apidocSignatureSpan">(schema)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.AzureFile.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.AzureFile.prototype.</span>format
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.AzureFile.prototype.getRequestHandler">
            function <span class="apidocSignatureSpan">keystone.Field.Types.AzureFile.prototype.</span>getRequestHandler
            <span class="apidocSignatureSpan">(item, req, paths, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.AzureFile.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.AzureFile.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.AzureFile.prototype.isModified">
            function <span class="apidocSignatureSpan">keystone.Field.Types.AzureFile.prototype.</span>isModified
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.AzureFile.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.AzureFile.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.AzureFile.prototype.uploadFile">
            function <span class="apidocSignatureSpan">keystone.Field.Types.AzureFile.prototype.</span>uploadFile
            <span class="apidocSignatureSpan">(item, file, update, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Boolean.prototype">module keystone.Field.Types.Boolean.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Boolean.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Boolean.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Boolean.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Boolean.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data, required)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Boolean.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Boolean.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Boolean.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Boolean.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Boolean.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Boolean.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.Field.Types.Boolean.prototype.</span>defaults</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.CloudinaryImage.prototype">module keystone.Field.Types.CloudinaryImage.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.addToSchema">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>addToSchema
            <span class="apidocSignatureSpan">(schema)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.fileExists">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>fileExists
            <span class="apidocSignatureSpan">(filename, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>format
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.getData">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>getData
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.getFilename">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>getFilename
            <span class="apidocSignatureSpan">(file, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.getFolder">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>getFolder
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.getRequestHandler">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>getRequestHandler
            <span class="apidocSignatureSpan">(item, req, paths, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.isModified">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>isModified
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.retryFilename">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>retryFilename
            <span class="apidocSignatureSpan">(attempt, file, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, files, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.CloudinaryImages.prototype">module keystone.Field.Types.CloudinaryImages.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImages.prototype.addToSchema">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImages.prototype.</span>addToSchema
            <span class="apidocSignatureSpan">(schema)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImages.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImages.prototype.</span>format
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImages.prototype.getData">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImages.prototype.</span>getData
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImages.prototype.getFolder">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImages.prototype.</span>getFolder
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImages.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImages.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.CloudinaryImages.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImages.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, files, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Code.prototype">module keystone.Field.Types.Code.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Code.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Code.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Code.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Code.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Code.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Code.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Color.prototype">module keystone.Field.Types.Color.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Color.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Color.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Color.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Color.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Color.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Color.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Date.prototype">module keystone.Field.Types.Date.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Date.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Date.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Date.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Date.prototype.</span>format
            <span class="apidocSignatureSpan">(item, format)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Date.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Date.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data, required, item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Date.prototype.moment">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Date.prototype.</span>moment
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Date.prototype.parse">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Date.prototype.</span>parse
            <span class="apidocSignatureSpan">(value, format, strict)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Date.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Date.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Date.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Date.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Date.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Date.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.DateArray.prototype">module keystone.Field.Types.DateArray.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.DateArray.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.DateArray.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.DateArray.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.DateArray.prototype.</span>format
            <span class="apidocSignatureSpan">(item, format, separator)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.DateArray.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.DateArray.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data, required, item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.DateArray.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.DateArray.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.DateArray.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.DateArray.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.DateArray.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.DateArray.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Datetime.prototype">module keystone.Field.Types.Datetime.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Datetime.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Datetime.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Datetime.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Datetime.prototype.</span>format
            <span class="apidocSignatureSpan">(item, format)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Datetime.prototype.getInputFromData">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Datetime.prototype.</span>getInputFromData
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Datetime.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Datetime.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data, required, item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Datetime.prototype.moment">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Datetime.prototype.</span>moment
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Datetime.prototype.parse">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Datetime.prototype.</span>parse
            <span class="apidocSignatureSpan">(value, format, strict)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Datetime.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Datetime.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Datetime.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Datetime.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Datetime.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Datetime.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Email.prototype">module keystone.Field.Types.Email.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Email.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Email.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Email.prototype.gravatarUrl">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Email.prototype.</span>gravatarUrl
            <span class="apidocSignatureSpan">(item, size, defaultImage, rating)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Email.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Email.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data, required, item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Email.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Email.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Email.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Email.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Email.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Email.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Embedly.prototype">module keystone.Field.Types.Embedly.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Embedly.prototype.addToSchema">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Embedly.prototype.</span>addToSchema
            <span class="apidocSignatureSpan">(schema)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Embedly.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Embedly.prototype.</span>format
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Embedly.prototype.getData">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Embedly.prototype.</span>getData
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Embedly.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Embedly.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Embedly.prototype.isModified">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Embedly.prototype.</span>isModified
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Embedly.prototype.reset">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Embedly.prototype.</span>reset
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Embedly.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Embedly.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.File.prototype">module keystone.Field.Types.File.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.File.prototype.addToSchema">
            function <span class="apidocSignatureSpan">keystone.Field.Types.File.prototype.</span>addToSchema
            <span class="apidocSignatureSpan">(schema)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.File.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.File.prototype.</span>format
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.File.prototype.isModified">
            function <span class="apidocSignatureSpan">keystone.Field.Types.File.prototype.</span>isModified
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.File.prototype.remove">
            function <span class="apidocSignatureSpan">keystone.Field.Types.File.prototype.</span>remove
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.File.prototype.reset">
            function <span class="apidocSignatureSpan">keystone.Field.Types.File.prototype.</span>reset
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.File.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.File.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, files, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.File.prototype.upload">
            function <span class="apidocSignatureSpan">keystone.Field.Types.File.prototype.</span>upload
            <span class="apidocSignatureSpan">(item, file, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.File.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.File.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.File.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.File.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.GeoPoint.prototype">module keystone.Field.Types.GeoPoint.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.GeoPoint.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.GeoPoint.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.GeoPoint.prototype.addToSchema">
            function <span class="apidocSignatureSpan">keystone.Field.Types.GeoPoint.prototype.</span>addToSchema
            <span class="apidocSignatureSpan">(schema)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.GeoPoint.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.GeoPoint.prototype.</span>format
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.GeoPoint.prototype.getData">
            function <span class="apidocSignatureSpan">keystone.Field.Types.GeoPoint.prototype.</span>getData
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.GeoPoint.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.GeoPoint.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data, required, item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.GeoPoint.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.GeoPoint.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.GeoPoint.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.GeoPoint.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.GeoPoint.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.GeoPoint.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Html.prototype">module keystone.Field.Types.Html.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Html.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Html.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Html.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Html.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Html.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Html.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Key.prototype">module keystone.Field.Types.Key.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Key.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Key.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Key.prototype.generateKey">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Key.prototype.</span>generateKey
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Key.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Key.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data, required, item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Key.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Key.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Key.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Key.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Key.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Key.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.LocalFile.prototype">module keystone.Field.Types.LocalFile.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.addToSchema">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>addToSchema
            <span class="apidocSignatureSpan">(schema)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>format
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.getRequestHandler">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>getRequestHandler
            <span class="apidocSignatureSpan">(item, req, paths, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.hasFormatter">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>hasFormatter
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.href">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>href
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.isModified">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>isModified
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.uploadFile">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>uploadFile
            <span class="apidocSignatureSpan">(item, file, update, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.LocalFiles.prototype">module keystone.Field.Types.LocalFiles.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFiles.prototype.addToSchema">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFiles.prototype.</span>addToSchema
            <span class="apidocSignatureSpan">(schema)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFiles.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFiles.prototype.</span>format
            <span class="apidocSignatureSpan">(item, i)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFiles.prototype.getRequestHandler">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFiles.prototype.</span>getRequestHandler
            <span class="apidocSignatureSpan">(item, req, paths, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFiles.prototype.hasFormatter">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFiles.prototype.</span>hasFormatter
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFiles.prototype.href">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFiles.prototype.</span>href
            <span class="apidocSignatureSpan">(file)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFiles.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFiles.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFiles.prototype.isModified">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFiles.prototype.</span>isModified
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFiles.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFiles.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.LocalFiles.prototype.uploadFiles">
            function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFiles.prototype.</span>uploadFiles
            <span class="apidocSignatureSpan">(item, files, update, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Location.prototype">module keystone.Field.Types.Location.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Location.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Location.prototype.addToSchema">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>addToSchema
            <span class="apidocSignatureSpan">(schema)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Location.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>format
            <span class="apidocSignatureSpan">(item, values, delimiter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Location.prototype.getInputFromData">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>getInputFromData
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Location.prototype.googleLookup">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>googleLookup
            <span class="apidocSignatureSpan">(item, region, update, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Location.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data, required, item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Location.prototype.isModified">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>isModified
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Location.prototype.kmFrom">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>kmFrom
            <span class="apidocSignatureSpan">(item, point)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Location.prototype.milesFrom">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>milesFrom
            <span class="apidocSignatureSpan">(item, point)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Location.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Location.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Location.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Markdown.prototype">module keystone.Field.Types.Markdown.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Markdown.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Markdown.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Markdown.prototype.addToSchema">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Markdown.prototype.</span>addToSchema
            <span class="apidocSignatureSpan">(schema)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Markdown.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Markdown.prototype.</span>format
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Markdown.prototype.getData">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Markdown.prototype.</span>getData
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Markdown.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Markdown.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data, required, item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Markdown.prototype.isModified">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Markdown.prototype.</span>isModified
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Markdown.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Markdown.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Markdown.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Markdown.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Markdown.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Markdown.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Money.prototype">module keystone.Field.Types.Money.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Money.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Money.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Money.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Money.prototype.</span>format
            <span class="apidocSignatureSpan">(item, format)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Money.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Money.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data, required, item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Money.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Money.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Money.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Money.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Money.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Money.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Name.prototype">module keystone.Field.Types.Name.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Name.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Name.prototype.addToSchema">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>addToSchema
            <span class="apidocSignatureSpan">(schema)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Name.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>format
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Name.prototype.getInputFromData">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>getInputFromData
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Name.prototype.getSortString">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>getSortString
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Name.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data, required, item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Name.prototype.isModified">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>isModified
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Name.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Name.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Name.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Number.prototype">module keystone.Field.Types.Number.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Number.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Number.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Number.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Number.prototype.</span>format
            <span class="apidocSignatureSpan">(item, format)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Number.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Number.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data, required, item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Number.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Number.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Number.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Number.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Number.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Number.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.NumberArray.prototype">module keystone.Field.Types.NumberArray.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.NumberArray.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.NumberArray.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.NumberArray.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.NumberArray.prototype.</span>format
            <span class="apidocSignatureSpan">(item, format, separator)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.NumberArray.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.NumberArray.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data, required, item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.NumberArray.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.NumberArray.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.NumberArray.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.NumberArray.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.NumberArray.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.NumberArray.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Password.prototype">module keystone.Field.Types.Password.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Password.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Password.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Password.prototype.addToSchema">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Password.prototype.</span>addToSchema
            <span class="apidocSignatureSpan">(schema)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Password.prototype.compare">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Password.prototype.</span>compare
            <span class="apidocSignatureSpan">(item, candidate, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Password.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Password.prototype.</span>format
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Password.prototype.getData">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Password.prototype.</span>getData
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Password.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Password.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data, required, item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Password.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Password.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Password.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Password.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Password.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Password.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Relationship.prototype">module keystone.Field.Types.Relationship.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Relationship.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Relationship.prototype.addToSchema">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>addToSchema
            <span class="apidocSignatureSpan">(schema)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Relationship.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>format
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Relationship.prototype.getData">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>getData
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Relationship.prototype.getExpandedData">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>getExpandedData
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Relationship.prototype.getProperties">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>getProperties
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Relationship.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data, required, item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Relationship.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Relationship.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Relationship.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.S3File.prototype">module keystone.Field.Types.S3File.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.S3File.prototype.addToSchema">
            function <span class="apidocSignatureSpan">keystone.Field.Types.S3File.prototype.</span>addToSchema
            <span class="apidocSignatureSpan">(schema)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.S3File.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.S3File.prototype.</span>format
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.S3File.prototype.generateHeaders">
            function <span class="apidocSignatureSpan">keystone.Field.Types.S3File.prototype.</span>generateHeaders
            <span class="apidocSignatureSpan">(item, file, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.S3File.prototype.getRequestHandler">
            function <span class="apidocSignatureSpan">keystone.Field.Types.S3File.prototype.</span>getRequestHandler
            <span class="apidocSignatureSpan">(item, req, paths, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.S3File.prototype.hasFormatter">
            function <span class="apidocSignatureSpan">keystone.Field.Types.S3File.prototype.</span>hasFormatter
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.S3File.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.S3File.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.S3File.prototype.isModified">
            function <span class="apidocSignatureSpan">keystone.Field.Types.S3File.prototype.</span>isModified
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.S3File.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.S3File.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.S3File.prototype.uploadFile">
            function <span class="apidocSignatureSpan">keystone.Field.Types.S3File.prototype.</span>uploadFile
            <span class="apidocSignatureSpan">(item, file, update, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Select.prototype">module keystone.Field.Types.Select.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Select.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Select.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Select.prototype.addToSchema">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Select.prototype.</span>addToSchema
            <span class="apidocSignatureSpan">(schema)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Select.prototype.cloneMap">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Select.prototype.</span>cloneMap
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Select.prototype.cloneOps">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Select.prototype.</span>cloneOps
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Select.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Select.prototype.</span>format
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Select.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Select.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data, required, item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Select.prototype.pluck">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Select.prototype.</span>pluck
            <span class="apidocSignatureSpan">(item, property, _default)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Select.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Select.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Select.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Select.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Text.prototype">module keystone.Field.Types.Text.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Text.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Text.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Text.prototype.crop">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Text.prototype.</span>crop
            <span class="apidocSignatureSpan">(item, length, append, preserveWords)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Text.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Text.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Text.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Text.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.TextArray.prototype">module keystone.Field.Types.TextArray.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.TextArray.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.TextArray.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.TextArray.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.TextArray.prototype.</span>format
            <span class="apidocSignatureSpan">(item, separator)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.TextArray.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.Types.TextArray.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data, required, item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.TextArray.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.Types.TextArray.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.TextArray.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.TextArray.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.TextArray.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.TextArray.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Textarea.prototype">module keystone.Field.Types.Textarea.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Textarea.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Textarea.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Textarea.prototype.crop">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Textarea.prototype.</span>crop
            <span class="apidocSignatureSpan">(item, length, append, preserveWords)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Textarea.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Textarea.prototype.</span>format
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Textarea.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Textarea.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Textarea.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Textarea.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.Types.Url.prototype">module keystone.Field.Types.Url.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Url.prototype.addFilterToQuery">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Url.prototype.</span>addFilterToQuery
            <span class="apidocSignatureSpan">(filter)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Url.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Url.prototype.</span>format
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Url.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Url.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.Types.Url.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.Types.Url.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Field.prototype">module keystone.Field.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.prototype.addToSchema">
            function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>addToSchema
            <span class="apidocSignatureSpan">(schema)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.prototype.bindUnderscoreMethods">
            function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>bindUnderscoreMethods
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.prototype.format">
            function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>format
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.prototype.getData">
            function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>getData
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.prototype.getDefaultValue">
            function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>getDefaultValue
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.prototype.getOptions">
            function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>getOptions
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.prototype.getPreSaveWatcher">
            function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>getPreSaveWatcher
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.prototype.getSize">
            function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>getSize
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.prototype.getValueFromData">
            function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>getValueFromData
            <span class="apidocSignatureSpan">(data, subpath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.prototype.inputIsValid">
            function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>inputIsValid
            <span class="apidocSignatureSpan">(data, required, item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.prototype.isModified">
            function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>isModified
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.prototype.underscoreMethod">
            function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>underscoreMethod
            <span class="apidocSignatureSpan">(path, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.prototype.validateInput">
            function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>validateInput
            <span class="apidocSignatureSpan">(data, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Field.prototype.validateRequiredInput">
            function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>validateRequiredInput
            <span class="apidocSignatureSpan">(item, data, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.FileType">module keystone.FileType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.FileType.FileType">
            function <span class="apidocSignatureSpan">keystone.</span>FileType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.FileType.super_">
            function <span class="apidocSignatureSpan">keystone.FileType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.FileType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.GeoPointType">module keystone.GeoPointType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.GeoPointType.GeoPointType">
            function <span class="apidocSignatureSpan">keystone.</span>GeoPointType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.GeoPointType.super_">
            function <span class="apidocSignatureSpan">keystone.GeoPointType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.GeoPointType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.HtmlType">module keystone.HtmlType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.HtmlType.HtmlType">
            function <span class="apidocSignatureSpan">keystone.</span>HtmlType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.HtmlType.super_">
            function <span class="apidocSignatureSpan">keystone.HtmlType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.HtmlType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.KeyType">module keystone.KeyType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.KeyType.KeyType">
            function <span class="apidocSignatureSpan">keystone.</span>KeyType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.KeyType.super_">
            function <span class="apidocSignatureSpan">keystone.KeyType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.KeyType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Keystone">module keystone.Keystone</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.Keystone">
            function <span class="apidocSignatureSpan">keystone.</span>Keystone
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Keystone.prototype">module keystone.Keystone.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.applyUpdates">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>applyUpdates
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.closeDatabaseConnection">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>closeDatabaseConnection
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.createItems">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>createItems
            <span class="apidocSignatureSpan">(data, ops, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.createKeystoneHash">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>createKeystoneHash
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.createRouter">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>createRouter
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.expandPath">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>expandPath
            <span class="apidocSignatureSpan">(pathValue)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.get">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>get
            <span class="apidocSignatureSpan">(key, value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.getOrphanedLists">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>getOrphanedLists
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.getPath">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>getPath
            <span class="apidocSignatureSpan">(key, defaultValue)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.import">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>import
            <span class="apidocSignatureSpan">(dirname)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.importer">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>importer
            <span class="apidocSignatureSpan">(rel__dirname)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.init">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>init
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.initDatabaseConfig">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>initDatabaseConfig
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.initExpressApp">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>initExpressApp
            <span class="apidocSignatureSpan">(customApp)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.initExpressSession">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>initExpressSession
            <span class="apidocSignatureSpan">(mongoose)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.initNav">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>initNav
            <span class="apidocSignatureSpan">(sections)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.list">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>list
            <span class="apidocSignatureSpan">(key)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.openDatabaseConnection">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>openDatabaseConnection
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.options">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>options
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.populateRelated">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>populateRelated
            <span class="apidocSignatureSpan">(docs, relationships, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.prefixModel">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>prefixModel
            <span class="apidocSignatureSpan">(key)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.redirect">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>redirect
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.routes">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>routes
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.set">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>set
            <span class="apidocSignatureSpan">(key, value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.start">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>start
            <span class="apidocSignatureSpan">(events)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.wrapHTMLError">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>wrapHTMLError
            <span class="apidocSignatureSpan">(title, err)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>console</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Keystone.prototype.console">module keystone.Keystone.prototype.console</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Keystone.prototype.console.err">
            function <span class="apidocSignatureSpan">keystone.Keystone.prototype.console.</span>err
            <span class="apidocSignatureSpan">(type, msg)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.List">module keystone.List</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.List">
            function <span class="apidocSignatureSpan">keystone.</span>List
            <span class="apidocSignatureSpan">(key, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.List.prototype">module keystone.List.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.add">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>add
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.addFiltersToQuery">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>addFiltersToQuery
            <span class="apidocSignatureSpan">(filters)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.addSearchToQuery">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>addSearchToQuery
            <span class="apidocSignatureSpan">(searchString)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.apiForGet">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>apiForGet
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.automap">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>automap
            <span class="apidocSignatureSpan">(field)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.buildSearchTextIndex">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>buildSearchTextIndex
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.declaresTextIndex">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>declaresTextIndex
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.ensureTextIndex">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>ensureTextIndex
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.expandColumns">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>expandColumns
            <span class="apidocSignatureSpan">(cols)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.expandPaths">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>expandPaths
            <span class="apidocSignatureSpan">(paths)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.expandSort">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>expandSort
            <span class="apidocSignatureSpan">(input)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.field">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>field
            <span class="apidocSignatureSpan">(path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.get">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>get
            <span class="apidocSignatureSpan">(key, value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.getAdminURL">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>getAdminURL
            <span class="apidocSignatureSpan">(item)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.getCSVData">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>getCSVData
            <span class="apidocSignatureSpan">(item, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.getData">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>getData
            <span class="apidocSignatureSpan">(item, fields, expandRelationshipFields)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.getDocumentName">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>getDocumentName
            <span class="apidocSignatureSpan">(doc, escape)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.getOptions">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>getOptions
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.getPages">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>getPages
            <span class="apidocSignatureSpan">(options, maxPages)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.getSearchFilters">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>getSearchFilters
            <span class="apidocSignatureSpan">(search, add)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.getUniqueValue">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>getUniqueValue
            <span class="apidocSignatureSpan">(path, generator, limit, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.isReserved">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>isReserved
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.map">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>map
            <span class="apidocSignatureSpan">(field, path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.paginate">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>paginate
            <span class="apidocSignatureSpan">(options, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.processFilters">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>processFilters
            <span class="apidocSignatureSpan">(q)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.register">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>register
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.relationship">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>relationship
            <span class="apidocSignatureSpan">(def)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.selectColumns">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>selectColumns
            <span class="apidocSignatureSpan">(q, cols)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.set">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>set
            <span class="apidocSignatureSpan">(key, value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.underscoreMethod">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>underscoreMethod
            <span class="apidocSignatureSpan">(path, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.List.prototype.updateItem">
            function <span class="apidocSignatureSpan">keystone.List.prototype.</span>updateItem
            <span class="apidocSignatureSpan">(item, data, options, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.LocalFileType">module keystone.LocalFileType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.LocalFileType.LocalFileType">
            function <span class="apidocSignatureSpan">keystone.</span>LocalFileType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.LocalFileType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.LocalFilesType">module keystone.LocalFilesType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.LocalFilesType.LocalFilesType">
            function <span class="apidocSignatureSpan">keystone.</span>LocalFilesType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.LocalFilesType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.LocationType">module keystone.LocationType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.LocationType.LocationType">
            function <span class="apidocSignatureSpan">keystone.</span>LocationType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.LocationType.super_">
            function <span class="apidocSignatureSpan">keystone.LocationType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.LocationType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.MarkdownType">module keystone.MarkdownType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.MarkdownType.MarkdownType">
            function <span class="apidocSignatureSpan">keystone.</span>MarkdownType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.MarkdownType.super_">
            function <span class="apidocSignatureSpan">keystone.MarkdownType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.MarkdownType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.MoneyType">module keystone.MoneyType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.MoneyType.MoneyType">
            function <span class="apidocSignatureSpan">keystone.</span>MoneyType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.MoneyType.super_">
            function <span class="apidocSignatureSpan">keystone.MoneyType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.MoneyType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.NameType">module keystone.NameType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.NameType.NameType">
            function <span class="apidocSignatureSpan">keystone.</span>NameType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.NameType.super_">
            function <span class="apidocSignatureSpan">keystone.NameType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.NameType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.NumberArrayType">module keystone.NumberArrayType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.NumberArrayType.NumberArrayType">
            function <span class="apidocSignatureSpan">keystone.</span>NumberArrayType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.NumberArrayType.super_">
            function <span class="apidocSignatureSpan">keystone.NumberArrayType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.NumberArrayType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.NumberType">module keystone.NumberType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.NumberType.NumberType">
            function <span class="apidocSignatureSpan">keystone.</span>NumberType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.NumberType.super_">
            function <span class="apidocSignatureSpan">keystone.NumberType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.NumberType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.PasswordType">module keystone.PasswordType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.PasswordType.PasswordType">
            function <span class="apidocSignatureSpan">keystone.</span>PasswordType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.PasswordType.super_">
            function <span class="apidocSignatureSpan">keystone.PasswordType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.PasswordType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.RelationshipType">module keystone.RelationshipType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.RelationshipType.RelationshipType">
            function <span class="apidocSignatureSpan">keystone.</span>RelationshipType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.RelationshipType.super_">
            function <span class="apidocSignatureSpan">keystone.RelationshipType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.RelationshipType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.S3FileType">module keystone.S3FileType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.S3FileType.S3FileType">
            function <span class="apidocSignatureSpan">keystone.</span>S3FileType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.S3FileType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.SelectType">module keystone.SelectType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.SelectType.SelectType">
            function <span class="apidocSignatureSpan">keystone.</span>SelectType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.SelectType.super_">
            function <span class="apidocSignatureSpan">keystone.SelectType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.SelectType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Storage">module keystone.Storage</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Storage.Storage">
            function <span class="apidocSignatureSpan">keystone.</span>Storage
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Storage.contentHashFilename">
            function <span class="apidocSignatureSpan">keystone.Storage.</span>contentHashFilename
            <span class="apidocSignatureSpan">(file, i, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Storage.originalFilename">
            function <span class="apidocSignatureSpan">keystone.Storage.</span>originalFilename
            <span class="apidocSignatureSpan">(file)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Storage.randomFilename">
            function <span class="apidocSignatureSpan">keystone.Storage.</span>randomFilename
            <span class="apidocSignatureSpan">(file, i, callback)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.Storage.</span>Adapters</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Storage.Adapters">module keystone.Storage.Adapters</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Storage.Adapters.FS">
            function <span class="apidocSignatureSpan">keystone.Storage.Adapters.</span>FS
            <span class="apidocSignatureSpan">(options, schema)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Storage.Adapters.FS.prototype">module keystone.Storage.Adapters.FS.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Storage.Adapters.FS.prototype.fileExists">
            function <span class="apidocSignatureSpan">keystone.Storage.Adapters.FS.prototype.</span>fileExists
            <span class="apidocSignatureSpan">(filename, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Storage.Adapters.FS.prototype.getFileURL">
            function <span class="apidocSignatureSpan">keystone.Storage.Adapters.FS.prototype.</span>getFileURL
            <span class="apidocSignatureSpan">(file)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Storage.Adapters.FS.prototype.getFilename">
            function <span class="apidocSignatureSpan">keystone.Storage.Adapters.FS.prototype.</span>getFilename
            <span class="apidocSignatureSpan">(file, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Storage.Adapters.FS.prototype.pathForFile">
            function <span class="apidocSignatureSpan">keystone.Storage.Adapters.FS.prototype.</span>pathForFile
            <span class="apidocSignatureSpan">(filename)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Storage.Adapters.FS.prototype.removeFile">
            function <span class="apidocSignatureSpan">keystone.Storage.Adapters.FS.prototype.</span>removeFile
            <span class="apidocSignatureSpan">(file, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Storage.Adapters.FS.prototype.retryFilename">
            function <span class="apidocSignatureSpan">keystone.Storage.Adapters.FS.prototype.</span>retryFilename
            <span class="apidocSignatureSpan">(attempt, file, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Storage.Adapters.FS.prototype.uploadFile">
            function <span class="apidocSignatureSpan">keystone.Storage.Adapters.FS.prototype.</span>uploadFile
            <span class="apidocSignatureSpan">(file, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.Storage.prototype">module keystone.Storage.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Storage.prototype.removeFile">
            function <span class="apidocSignatureSpan">keystone.Storage.prototype.</span>removeFile
            <span class="apidocSignatureSpan">(value, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.Storage.prototype.uploadFile">
            function <span class="apidocSignatureSpan">keystone.Storage.prototype.</span>uploadFile
            <span class="apidocSignatureSpan">(file, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.TextArrayType">module keystone.TextArrayType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.TextArrayType.TextArrayType">
            function <span class="apidocSignatureSpan">keystone.</span>TextArrayType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.TextArrayType.super_">
            function <span class="apidocSignatureSpan">keystone.TextArrayType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.TextArrayType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.TextType">module keystone.TextType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.TextType.TextType">
            function <span class="apidocSignatureSpan">keystone.</span>TextType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.TextType.super_">
            function <span class="apidocSignatureSpan">keystone.TextType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.TextType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.TextareaType">module keystone.TextareaType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.TextareaType.TextareaType">
            function <span class="apidocSignatureSpan">keystone.</span>TextareaType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.TextareaType.super_">
            function <span class="apidocSignatureSpan">keystone.TextareaType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.TextareaType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.UrlType">module keystone.UrlType</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.UrlType.UrlType">
            function <span class="apidocSignatureSpan">keystone.</span>UrlType
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.UrlType.super_">
            function <span class="apidocSignatureSpan">keystone.UrlType.</span>super_
            <span class="apidocSignatureSpan">(list, path, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.UrlType.</span>properName</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.View">module keystone.View</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.View.View">
            function <span class="apidocSignatureSpan">keystone.</span>View
            <span class="apidocSignatureSpan">(req, res)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.View.prototype">module keystone.View.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.View.prototype.on">
            function <span class="apidocSignatureSpan">keystone.View.prototype.</span>on
            <span class="apidocSignatureSpan">(on)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.View.prototype.query">
            function <span class="apidocSignatureSpan">keystone.View.prototype.</span>query
            <span class="apidocSignatureSpan">(key, query, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.View.prototype.render">
            function <span class="apidocSignatureSpan">keystone.View.prototype.</span>render
            <span class="apidocSignatureSpan">(renderFn, locals, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.cloudinary">module keystone.cloudinary</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.cloudinary.autocomplete">
            function <span class="apidocSignatureSpan">keystone.cloudinary.</span>autocomplete
            <span class="apidocSignatureSpan">(req, res)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.cloudinary.get">
            function <span class="apidocSignatureSpan">keystone.cloudinary.</span>get
            <span class="apidocSignatureSpan">(req, res)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.cloudinary.upload">
            function <span class="apidocSignatureSpan">keystone.cloudinary.</span>upload
            <span class="apidocSignatureSpan">(req, res)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.color">module keystone.color</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.color.blend">
            function <span class="apidocSignatureSpan">keystone.color.</span>blend
            <span class="apidocSignatureSpan">(color1, color2, percent)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.color.darken">
            function <span class="apidocSignatureSpan">keystone.color.</span>darken
            <span class="apidocSignatureSpan">(color, percent)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.color.fade">
            function <span class="apidocSignatureSpan">keystone.color.</span>fade
            <span class="apidocSignatureSpan">(color, opacity = 100)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.color.lighten">
            function <span class="apidocSignatureSpan">keystone.color.</span>lighten
            <span class="apidocSignatureSpan">(color, percent)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.csrf">module keystone.csrf</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.csrf.createSecret">
            function <span class="apidocSignatureSpan">keystone.csrf.</span>createSecret
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.csrf.createToken">
            function <span class="apidocSignatureSpan">keystone.csrf.</span>createToken
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.csrf.getSecret">
            function <span class="apidocSignatureSpan">keystone.csrf.</span>getSecret
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.csrf.getToken">
            function <span class="apidocSignatureSpan">keystone.csrf.</span>getToken
            <span class="apidocSignatureSpan">(req, res)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.csrf.requestToken">
            function <span class="apidocSignatureSpan">keystone.csrf.</span>requestToken
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.csrf.validate">
            function <span class="apidocSignatureSpan">keystone.csrf.</span>validate
            <span class="apidocSignatureSpan">(req, token)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">keystone.csrf.</span>SECRET_LENGTH</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.csrf.</span>middleware</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.csrf.</span>CSRF_HEADER_KEY</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.csrf.</span>LOCAL_KEY</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.csrf.</span>LOCAL_VALUE</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.csrf.</span>SECRET_KEY</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.csrf.</span>TOKEN_KEY</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.csrf.</span>XSRF_COOKIE_KEY</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">keystone.csrf.</span>XSRF_HEADER_KEY</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.css">module keystone.css</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.css.borderBottomRadius">
            function <span class="apidocSignatureSpan">keystone.css.</span>borderBottomRadius
            <span class="apidocSignatureSpan">(radius)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.css.borderLeftRadius">
            function <span class="apidocSignatureSpan">keystone.css.</span>borderLeftRadius
            <span class="apidocSignatureSpan">(radius)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.css.borderRightRadius">
            function <span class="apidocSignatureSpan">keystone.css.</span>borderRightRadius
            <span class="apidocSignatureSpan">(radius)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.css.borderTopRadius">
            function <span class="apidocSignatureSpan">keystone.css.</span>borderTopRadius
            <span class="apidocSignatureSpan">(radius)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.css.gradientHorizontal">
            function <span class="apidocSignatureSpan">keystone.css.</span>gradientHorizontal
            <span class="apidocSignatureSpan">(top, bottom, base)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.css.gradientVertical">
            function <span class="apidocSignatureSpan">keystone.css.</span>gradientVertical
            <span class="apidocSignatureSpan">(top, bottom, base)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.express">module keystone.express</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.express">
            function <span class="apidocSignatureSpan">keystone.</span>express
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route">
            function <span class="apidocSignatureSpan">keystone.express.</span>Route
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router">
            function <span class="apidocSignatureSpan">keystone.express.</span>Router
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.query">
            function <span class="apidocSignatureSpan">keystone.express.</span>query
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.static">
            function <span class="apidocSignatureSpan">keystone.express.</span>static
            <span class="apidocSignatureSpan">(root, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.express.</span>application</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.express.</span>request</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.express.</span>response</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.express.Route">module keystone.express.Route</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.Route">
            function <span class="apidocSignatureSpan">keystone.express.</span>Route
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.express.Route.prototype">module keystone.express.Route.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype._handles_method">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>_handles_method
            <span class="apidocSignatureSpan">(method)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype._options">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>_options
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.acl">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>acl
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.all">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>all
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.bind">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>bind
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.checkout">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>checkout
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.connect">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>connect
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.copy">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>copy
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.delete">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>delete
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.dispatch">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>dispatch
            <span class="apidocSignatureSpan">(req, res, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.get">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>get
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.head">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>head
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.link">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>link
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.lock">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>lock
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.m-search">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>m-search
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.merge">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>merge
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.mkactivity">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>mkactivity
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.mkcalendar">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>mkcalendar
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.mkcol">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>mkcol
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.move">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>move
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.notify">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>notify
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.options">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>options
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.patch">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>patch
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.post">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>post
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.propfind">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>propfind
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.proppatch">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>proppatch
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.purge">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>purge
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.put">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>put
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.rebind">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>rebind
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.report">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>report
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.search">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>search
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.subscribe">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>subscribe
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.trace">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>trace
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.unbind">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>unbind
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.unlink">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>unlink
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.unlock">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>unlock
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Route.prototype.unsubscribe">
            function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>unsubscribe
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.express.Router">module keystone.express.Router</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.Router">
            function <span class="apidocSignatureSpan">keystone.express.</span>Router
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.acl">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>acl
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.all">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>all
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.bind">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>bind
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.checkout">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>checkout
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.connect">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>connect
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.copy">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>copy
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.delete">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>delete
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.get">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>get
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.handle">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>handle
            <span class="apidocSignatureSpan">(req, res, out)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.head">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>head
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.link">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>link
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.lock">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>lock
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.m-search">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>m-search
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.merge">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>merge
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.mkactivity">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>mkactivity
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.mkcalendar">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>mkcalendar
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.mkcol">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>mkcol
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.move">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>move
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.notify">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>notify
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.options">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>options
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.param">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>param
            <span class="apidocSignatureSpan">(name, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.patch">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>patch
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.post">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>post
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.process_params">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>process_params
            <span class="apidocSignatureSpan">(layer, called, req, res, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.propfind">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>propfind
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.proppatch">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>proppatch
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.purge">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>purge
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.put">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>put
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.rebind">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>rebind
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.report">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>report
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.route">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>route
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.search">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>search
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.subscribe">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>subscribe
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.trace">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>trace
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.unbind">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>unbind
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.unlink">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>unlink
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.unlock">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>unlock
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.unsubscribe">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>unsubscribe
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.Router.use">
            function <span class="apidocSignatureSpan">keystone.express.Router.</span>use
            <span class="apidocSignatureSpan">(fn)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.express.application">module keystone.express.application</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.acl">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>acl
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.all">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>all
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.bind">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>bind
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.checkout">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>checkout
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.connect">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>connect
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.copy">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>copy
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.defaultConfiguration">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>defaultConfiguration
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.del">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>del
            <span class="apidocSignatureSpan">(arg0)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.delete">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>delete
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.disable">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>disable
            <span class="apidocSignatureSpan">(setting)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.disabled">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>disabled
            <span class="apidocSignatureSpan">(setting)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.enable">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>enable
            <span class="apidocSignatureSpan">(setting)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.enabled">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>enabled
            <span class="apidocSignatureSpan">(setting)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.engine">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>engine
            <span class="apidocSignatureSpan">(ext, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.get">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>get
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.handle">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>handle
            <span class="apidocSignatureSpan">(req, res, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.head">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>head
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.init">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>init
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.lazyrouter">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>lazyrouter
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.link">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>link
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.listen">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>listen
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.lock">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>lock
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.m-search">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>m-search
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.merge">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>merge
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.mkactivity">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>mkactivity
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.mkcalendar">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>mkcalendar
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.mkcol">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>mkcol
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.move">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>move
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.notify">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>notify
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.options">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>options
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.param">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>param
            <span class="apidocSignatureSpan">(name, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.patch">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>patch
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.path">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>path
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.post">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>post
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.propfind">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>propfind
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.proppatch">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>proppatch
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.purge">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>purge
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.put">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>put
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.rebind">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>rebind
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.render">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>render
            <span class="apidocSignatureSpan">(name, options, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.report">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>report
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.route">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>route
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.search">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>search
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.set">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>set
            <span class="apidocSignatureSpan">(setting, val)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.subscribe">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>subscribe
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.trace">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>trace
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.unbind">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>unbind
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.unlink">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>unlink
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.unlock">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>unlock
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.unsubscribe">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>unsubscribe
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.application.use">
            function <span class="apidocSignatureSpan">keystone.express.application.</span>use
            <span class="apidocSignatureSpan">(fn)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.express.request">module keystone.express.request</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.request.accepts">
            function <span class="apidocSignatureSpan">keystone.express.request.</span>accepts
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.request.acceptsCharset">
            function <span class="apidocSignatureSpan">keystone.express.request.</span>acceptsCharset
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.request.acceptsCharsets">
            function <span class="apidocSignatureSpan">keystone.express.request.</span>acceptsCharsets
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.request.acceptsEncoding">
            function <span class="apidocSignatureSpan">keystone.express.request.</span>acceptsEncoding
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.request.acceptsEncodings">
            function <span class="apidocSignatureSpan">keystone.express.request.</span>acceptsEncodings
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.request.acceptsLanguage">
            function <span class="apidocSignatureSpan">keystone.express.request.</span>acceptsLanguage
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.request.acceptsLanguages">
            function <span class="apidocSignatureSpan">keystone.express.request.</span>acceptsLanguages
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.request.get">
            function <span class="apidocSignatureSpan">keystone.express.request.</span>get
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.request.header">
            function <span class="apidocSignatureSpan">keystone.express.request.</span>header
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.request.is">
            function <span class="apidocSignatureSpan">keystone.express.request.</span>is
            <span class="apidocSignatureSpan">(types)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.request.param">
            function <span class="apidocSignatureSpan">keystone.express.request.</span>param
            <span class="apidocSignatureSpan">(name, defaultValue)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.request.range">
            function <span class="apidocSignatureSpan">keystone.express.request.</span>range
            <span class="apidocSignatureSpan">(size, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.express.response">module keystone.express.response</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.append">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>append
            <span class="apidocSignatureSpan">(field, val)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.attachment">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>attachment
            <span class="apidocSignatureSpan">(filename)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.clearCookie">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>clearCookie
            <span class="apidocSignatureSpan">(name, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.contentType">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>contentType
            <span class="apidocSignatureSpan">(type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.cookie">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>cookie
            <span class="apidocSignatureSpan">(name, value, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.download">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>download
            <span class="apidocSignatureSpan">(path, filename, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.format">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>format
            <span class="apidocSignatureSpan">(obj)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.get">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>get
            <span class="apidocSignatureSpan">(field)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.header">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>header
            <span class="apidocSignatureSpan">(field, val)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.json">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>json
            <span class="apidocSignatureSpan">(obj)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.jsonp">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>jsonp
            <span class="apidocSignatureSpan">(obj)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.links">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>links
            <span class="apidocSignatureSpan">(links)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.location">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>location
            <span class="apidocSignatureSpan">(url)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.redirect">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>redirect
            <span class="apidocSignatureSpan">(url)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.render">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>render
            <span class="apidocSignatureSpan">(view, options, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.send">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>send
            <span class="apidocSignatureSpan">(body)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.sendFile">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>sendFile
            <span class="apidocSignatureSpan">(path, options, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.sendStatus">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>sendStatus
            <span class="apidocSignatureSpan">(statusCode)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.sendfile">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>sendfile
            <span class="apidocSignatureSpan">(arg0, arg1, arg2)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.set">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>set
            <span class="apidocSignatureSpan">(field, val)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.status">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>status
            <span class="apidocSignatureSpan">(code)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.type">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>type
            <span class="apidocSignatureSpan">(type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.express.response.vary">
            function <span class="apidocSignatureSpan">keystone.express.response.</span>vary
            <span class="apidocSignatureSpan">(field)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.html">module keystone.html</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.html.html">
            function <span class="apidocSignatureSpan">keystone.</span>html
            <span class="apidocSignatureSpan">(path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.html.super_">
            function <span class="apidocSignatureSpan">keystone.html.</span>super_
            <span class="apidocSignatureSpan">(path, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.middleware">module keystone.middleware</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.middleware.api">
            function <span class="apidocSignatureSpan">keystone.middleware.</span>api
            <span class="apidocSignatureSpan">(req, res, next)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.middleware.cors">
            function <span class="apidocSignatureSpan">keystone.middleware.</span>cors
            <span class="apidocSignatureSpan">(req, res, next)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.options">module keystone.options</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.options.options">
            function <span class="apidocSignatureSpan">keystone.</span>options
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.options.expandPath">
            function <span class="apidocSignatureSpan">keystone.options.</span>expandPath
            <span class="apidocSignatureSpan">(pathValue)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.options.get">
            function <span class="apidocSignatureSpan">keystone.options.</span>get
            <span class="apidocSignatureSpan">(key, value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.options.getPath">
            function <span class="apidocSignatureSpan">keystone.options.</span>getPath
            <span class="apidocSignatureSpan">(key, defaultValue)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.options.set">
            function <span class="apidocSignatureSpan">keystone.options.</span>set
            <span class="apidocSignatureSpan">(key, value)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.page">module keystone.page</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.page.page">
            function <span class="apidocSignatureSpan">keystone.</span>page
            <span class="apidocSignatureSpan">(key, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.page.prototype">module keystone.page.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.page.prototype.add">
            function <span class="apidocSignatureSpan">keystone.page.prototype.</span>add
            <span class="apidocSignatureSpan">(fields)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.page.prototype.clean">
            function <span class="apidocSignatureSpan">keystone.page.prototype.</span>clean
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.page.prototype.get">
            function <span class="apidocSignatureSpan">keystone.page.prototype.</span>get
            <span class="apidocSignatureSpan">(key)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.page.prototype.populate">
            function <span class="apidocSignatureSpan">keystone.page.prototype.</span>populate
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.page.prototype.register">
            function <span class="apidocSignatureSpan">keystone.page.prototype.</span>register
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.page.prototype.set">
            function <span class="apidocSignatureSpan">keystone.page.prototype.</span>set
            <span class="apidocSignatureSpan">(key, value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.page.prototype.validate">
            function <span class="apidocSignatureSpan">keystone.page.prototype.</span>validate
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.s3">module keystone.s3</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.s3.upload">
            function <span class="apidocSignatureSpan">keystone.s3.</span>upload
            <span class="apidocSignatureSpan">(req, res)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.schemaPlugins">module keystone.schemaPlugins</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.schemaPlugins.autokey">
            function <span class="apidocSignatureSpan">keystone.schemaPlugins.</span>autokey
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.schemaPlugins.history">
            function <span class="apidocSignatureSpan">keystone.schemaPlugins.</span>history
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.schemaPlugins.sortable">
            function <span class="apidocSignatureSpan">keystone.schemaPlugins.</span>sortable
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.schemaPlugins.track">
            function <span class="apidocSignatureSpan">keystone.schemaPlugins.</span>track
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.schemaPlugins.</span>methods</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">keystone.schemaPlugins.</span>options</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.session">module keystone.session</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.session.keystoneAuth">
            function <span class="apidocSignatureSpan">keystone.session.</span>keystoneAuth
            <span class="apidocSignatureSpan">(req, res, next)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.session.persist">
            function <span class="apidocSignatureSpan">keystone.session.</span>persist
            <span class="apidocSignatureSpan">(req, res, next)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.session.signin">
            function <span class="apidocSignatureSpan">keystone.session.</span>signin
            <span class="apidocSignatureSpan">(lookup, req, res, onSuccess, onFail)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.session.signinWithUser">
            function <span class="apidocSignatureSpan">keystone.session.</span>signinWithUser
            <span class="apidocSignatureSpan">(user, req, res, onSuccess)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.session.signout">
            function <span class="apidocSignatureSpan">keystone.session.</span>signout
            <span class="apidocSignatureSpan">(req, res, next)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.text">module keystone.text</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.text.text">
            function <span class="apidocSignatureSpan">keystone.</span>text
            <span class="apidocSignatureSpan">(path, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.text.super_">
            function <span class="apidocSignatureSpan">keystone.text.</span>super_
            <span class="apidocSignatureSpan">(path, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.updateHandler">module keystone.updateHandler</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.updateHandler.updateHandler">
            function <span class="apidocSignatureSpan">keystone.</span>updateHandler
            <span class="apidocSignatureSpan">(list, item, req, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.updateHandler.prototype">module keystone.updateHandler.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.updateHandler.prototype.process">
            function <span class="apidocSignatureSpan">keystone.updateHandler.prototype.</span>process
            <span class="apidocSignatureSpan">(data, options, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.updates">module keystone.updates</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.updates.apply">
            function <span class="apidocSignatureSpan">keystone.updates.</span>apply
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.keystone.utils">module keystone.utils</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.bindMethods">
            function <span class="apidocSignatureSpan">keystone.utils.</span>bindMethods
            <span class="apidocSignatureSpan">(obj, scope)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.calculateDistance">
            function <span class="apidocSignatureSpan">keystone.utils.</span>calculateDistance
            <span class="apidocSignatureSpan">(point1, point2)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.camelcase">
            function <span class="apidocSignatureSpan">keystone.utils.</span>camelcase
            <span class="apidocSignatureSpan">(str, lc)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.cropHTMLString">
            function <span class="apidocSignatureSpan">keystone.utils.</span>cropHTMLString
            <span class="apidocSignatureSpan">(str, length, append, preserveWords)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.cropString">
            function <span class="apidocSignatureSpan">keystone.utils.</span>cropString
            <span class="apidocSignatureSpan">(str, length, append, preserveWords)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.decodeHTMLEntities">
            function <span class="apidocSignatureSpan">keystone.utils.</span>decodeHTMLEntities
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.defer">
            function <span class="apidocSignatureSpan">keystone.utils.</span>defer
            <span class="apidocSignatureSpan">(fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.downcase">
            function <span class="apidocSignatureSpan">keystone.utils.</span>downcase
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.encodeHTMLEntities">
            function <span class="apidocSignatureSpan">keystone.utils.</span>encodeHTMLEntities
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.escapeRegExp">
            function <span class="apidocSignatureSpan">keystone.utils.</span>escapeRegExp
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.escapeString">
            function <span class="apidocSignatureSpan">keystone.utils.</span>escapeString
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.htmlStringify">
            function <span class="apidocSignatureSpan">keystone.utils.</span>htmlStringify
            <span class="apidocSignatureSpan">(obj, fromRecur)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.htmlToText">
            function <span class="apidocSignatureSpan">keystone.utils.</span>htmlToText
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.isArray">
            function <span class="apidocSignatureSpan">keystone.utils.</span>isArray
            <span class="apidocSignatureSpan">(arg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.isDataURL">
            function <span class="apidocSignatureSpan">keystone.utils.</span>isDataURL
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.isDate">
            function <span class="apidocSignatureSpan">keystone.utils.</span>isDate
            <span class="apidocSignatureSpan">(arg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.isEmail">
            function <span class="apidocSignatureSpan">keystone.utils.</span>isEmail
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.isFunction">
            function <span class="apidocSignatureSpan">keystone.utils.</span>isFunction
            <span class="apidocSignatureSpan">(arg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.isNumber">
            function <span class="apidocSignatureSpan">keystone.utils.</span>isNumber
            <span class="apidocSignatureSpan">(arg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.isObject">
            function <span class="apidocSignatureSpan">keystone.utils.</span>isObject
            <span class="apidocSignatureSpan">(arg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.isString">
            function <span class="apidocSignatureSpan">keystone.utils.</span>isString
            <span class="apidocSignatureSpan">(arg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.isValidObjectId">
            function <span class="apidocSignatureSpan">keystone.utils.</span>isValidObjectId
            <span class="apidocSignatureSpan">(arg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.keyToLabel">
            function <span class="apidocSignatureSpan">keystone.utils.</span>keyToLabel
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.keyToPath">
            function <span class="apidocSignatureSpan">keystone.utils.</span>keyToPath
            <span class="apidocSignatureSpan">(str, plural)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.keyToProperty">
            function <span class="apidocSignatureSpan">keystone.utils.</span>keyToProperty
            <span class="apidocSignatureSpan">(str, plural)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.kmBetween">
            function <span class="apidocSignatureSpan">keystone.utils.</span>kmBetween
            <span class="apidocSignatureSpan">(point1, point2)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.milesBetween">
            function <span class="apidocSignatureSpan">keystone.utils.</span>milesBetween
            <span class="apidocSignatureSpan">(point1, point2)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.noop">
            function <span class="apidocSignatureSpan">keystone.utils.</span>noop
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.number">
            function <span class="apidocSignatureSpan">keystone.utils.</span>number
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.options">
            function <span class="apidocSignatureSpan">keystone.utils.</span>options
            <span class="apidocSignatureSpan">(defaults, ops)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.optionsMap">
            function <span class="apidocSignatureSpan">keystone.utils.</span>optionsMap
            <span class="apidocSignatureSpan">(arr, property, clone)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.plural">
            function <span class="apidocSignatureSpan">keystone.utils.</span>plural
            <span class="apidocSignatureSpan">(count, sn, pl)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.randomString">
            function <span class="apidocSignatureSpan">keystone.utils.</span>randomString
            <span class="apidocSignatureSpan">(len, chars)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.singular">
            function <span class="apidocSignatureSpan">keystone.utils.</span>singular
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.slug">
            function <span class="apidocSignatureSpan">keystone.utils.</span>slug
            <span class="apidocSignatureSpan">(str, sep, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.stringify">
            function <span class="apidocSignatureSpan">keystone.utils.</span>stringify
            <span class="apidocSignatureSpan">(obj)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.stripDiacritics">
            function <span class="apidocSignatureSpan">keystone.utils.</span>stripDiacritics
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.textToHTML">
            function <span class="apidocSignatureSpan">keystone.utils.</span>textToHTML
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.titlecase">
            function <span class="apidocSignatureSpan">keystone.utils.</span>titlecase
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.transliterate">
            function <span class="apidocSignatureSpan">keystone.utils.</span>transliterate
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.keystone.utils.upcase">
            function <span class="apidocSignatureSpan">keystone.utils.</span>upcase
            <span class="apidocSignatureSpan">(str)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone" id="apidoc.module.keystone">module keystone</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.AzureFileType" id="apidoc.element.keystone.AzureFileType">
        function <span class="apidocSignatureSpan">keystone.</span>AzureFileType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function azurefile(list, path, options) {

	throw new Error(&#x27;The AzureFile field type has been removed. Please use File instead.&#x27;
		+ &#x27;\n\nSee https://github.com/keystonejs/keystone/wiki/File-Fields-Upgrade-Guide\n&#x27;);

	<span class="apidocCodeCommentSpan">/*

	grappling.mixin(this).allowHooks(&#x27;pre:upload&#x27;);

	this._underscoreMethods = [&#x27;format&#x27;, &#x27;uploadFile&#x27;];
	this._fixedSize = &#x27;full&#x27;;

	// TODO: implement filtering, usage disabled for now
	options.nofilter = true;

	// TODO: implement initial form, usage disabled for now
	if (options.initial) {
		throw new Error(&#x27;Invalid Configuration\n\nAzureFile fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) do not currently support being used
 as initial fields.\n&#x27;);
	}

	var self = this;
	options.filenameFormatter = options.filenameFormatter || function (item, filename) { return filename; };
	options.containerFormatter = options.containerFormatter || function (item, filename) { return self.azurefileconfig.container; };//
eslint-disable-line no-unused-vars

	azurefile.super_.call(this, list, path, options);

	// validate azurefile config (has to happen after super_.call)
	if (!this.azurefileconfig) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;AzureFile fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require the &#x22;azurefile config&#x22; option to be set.\n\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/configuration/#services-azure for more information.\n&#x27;);
	}

	// TODO; this is really bad, we shouldn&#x27;t be overwriting global env!
	process.env.AZURE_STORAGE_ACCOUNT = this.azurefileconfig.account;
	process.env.AZURE_STORAGE_ACCESS_KEY = this.azurefileconfig.key;

	this.azurefileconfig.container = this.azurefileconfig.container || &#x27;keystone&#x27;;

	// Could be more pre- hooks, just upload for now
	if (options.pre &#x26;&#x26; options.pre.upload) {
		this.pre(&#x27;upload&#x27;, options.pre.upload);
	}

	*/
</span>
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.BooleanType" id="apidoc.element.keystone.BooleanType">
        function <span class="apidocSignatureSpan">keystone.</span>BooleanType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function boolean(list, path, options) {
	this._nativeType = Boolean;
	this._properties = [&#x27;indent&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this.indent = (options.indent) ? true : false;
	boolean.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.CloudinaryImageType" id="apidoc.element.keystone.CloudinaryImageType">
        function <span class="apidocSignatureSpan">keystone.</span>CloudinaryImageType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function cloudinaryimage(list, path, options) {
	this._underscoreMethods = [&#x27;format&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this._properties = [&#x27;select&#x27;, &#x27;selectPrefix&#x27;, &#x27;autoCleanup&#x27;];

	if (options.filenameAsPublicID) {
		// Produces the same result as the legacy filenameAsPublicID option
		options.generateFilename = nameFunctions.originalFilename;
		options.whenExists = &#x27;overwrite&#x27;;
	}
	options = assign({}, DEFAULT_OPTIONS, options);
	options.generateFilename = ensureCallback(options.generateFilename);

	cloudinaryimage.super_.call(this, list, path, options);
	// validate cloudinary config
	if (!keystone.get(&#x27;cloudinary config&#x27;)) {
		throw new Error(
			&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;CloudinaryImage fields (&#x27; + list.key + &#x27;.&#x27; + this.path + &#x27;) require the &#x22;cloudinary config&#x22; option to be set.\n\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/configuration/#services-cloudinary for more information.\n&#x27;
		);
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.CloudinaryImagesType" id="apidoc.element.keystone.CloudinaryImagesType">
        function <span class="apidocSignatureSpan">keystone.</span>CloudinaryImagesType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function cloudinaryimages(list, path, options) {
	this._underscoreMethods = [&#x27;format&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this._properties = [&#x27;select&#x27;, &#x27;selectPrefix&#x27;, &#x27;autoCleanup&#x27;, &#x27;publicID&#x27;, &#x27;folder&#x27;, &#x27;filenameAsPublicID&#x27;];

	cloudinaryimages.super_.call(this, list, path, options);

	// validate cloudinary config
	if (!keystone.get(&#x27;cloudinary config&#x27;)) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;CloudinaryImages fields (&#x27; + list.key + &#x27;.&#x27; + this.path + &#x27;) require the &#x22;cloudinary config&#x22; option to be set.\n\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/configuration/#services-cloudinary for more information.\n&#x27;);
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.CodeType" id="apidoc.element.keystone.CodeType">
        function <span class="apidocSignatureSpan">keystone.</span>CodeType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function code(list, path, options) {
	this._nativeType = String;
	this._defaultSize = &#x27;full&#x27;;
	this.height = options.height || 180;
	this.lang = options.lang || options.language;
	this._properties = [&#x27;editor&#x27;, &#x27;height&#x27;, &#x27;lang&#x27;];
	this.codemirror = options.codemirror || {};
	this.editor = assign({ mode: this.lang }, this.codemirror);
	code.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.ColorType" id="apidoc.element.keystone.ColorType">
        function <span class="apidocSignatureSpan">keystone.</span>ColorType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function color(list, path, options) {
	this._nativeType = String;
	color.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.DateArrayType" id="apidoc.element.keystone.DateArrayType">
        function <span class="apidocSignatureSpan">keystone.</span>DateArrayType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function datearray(list, path, options) {
	this._nativeType = [Date];
	this._defaultSize = &#x27;medium&#x27;;
	this._underscoreMethods = [&#x27;format&#x27;];
	this._properties = [&#x27;formatString&#x27;];
	this.parseFormatString = options.parseFormat || &#x27;YYYY-MM-DD&#x27;;
	this.formatString = (options.format === false) ? false : (options.format || &#x27;Do MMM YYYY&#x27;);
	if (this.formatString &#x26;&#x26; typeof this.formatString !== &#x27;string&#x27;) {
		throw new Error(&#x27;FieldType.DateArray: options.format must be a string.&#x27;);
	}
	this.separator = options.separator || &#x27; | &#x27;;
	datearray.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.DateType" id="apidoc.element.keystone.DateType">
        function <span class="apidocSignatureSpan">keystone.</span>DateType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function date(list, path, options) {
	this._nativeType = Date;
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;moment&#x27;, &#x27;parse&#x27;];
	this._fixedSize = &#x27;medium&#x27;;
	this._properties = [&#x27;formatString&#x27;, &#x27;yearRange&#x27;, &#x27;isUTC&#x27;, &#x27;inputFormat&#x27;];
	this.parseFormatString = options.inputFormat || &#x27;YYYY-MM-DD&#x27;;
	this.formatString = (options.format === false) ? false : (options.format || &#x27;Do MMM YYYY&#x27;);

	this.yearRange = options.yearRange;
	this.isUTC = options.utc || false;
	if (this.formatString &#x26;&#x26; typeof this.formatString !== &#x27;string&#x27;) {
		throw new Error(&#x27;FieldType.Date: options.format must be a string.&#x27;);
	}
	date.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.DatetimeType" id="apidoc.element.keystone.DatetimeType">
        function <span class="apidocSignatureSpan">keystone.</span>DatetimeType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function datetime(list, path, options) {
	this._nativeType = Date;
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;moment&#x27;, &#x27;parse&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this._properties = [&#x27;formatString&#x27;, &#x27;isUTC&#x27;];
	this.typeDescription = &#x27;date and time&#x27;;
	this.parseFormatString = options.parseFormat || parseFormats;
	this.formatString = (options.format === false) ? false : (options.format || &#x27;YYYY-MM-DD h:mm:ss a&#x27;);
	this.isUTC = options.utc || false;
	if (this.formatString &#x26;&#x26; typeof this.formatString !== &#x27;string&#x27;) {
		throw new Error(&#x27;FieldType.DateTime: options.format must be a string.&#x27;);
	}
	datetime.super_.call(this, list, path, options);
	this.paths = {
		date: this.path + &#x27;_date&#x27;,
		time: this.path + &#x27;_time&#x27;,
		tzOffset: this.path + &#x27;_tzOffset&#x27;,
	};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Email" id="apidoc.element.keystone.Email">
        function <span class="apidocSignatureSpan">keystone.</span>Email
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Email = function (options) {
	if (typeof options === &#x27;string&#x27;) {
		options = { templateName: options };
	}
	if (!utils.isObject(options)) {
		throw new Error(&#x27;The keystone.Email class requires a templateName or options argument to be provided&#x27;);
	}

	<span class="apidocCodeCommentSpan">/**
	 * Keystone &#x3c; 0.4 Compatibility
	 *
	 * NOTE: Add warnings and enable them in 4.1 or 4.2 release. These patterns
	 * will be deprecated with the 0.5 release!
	 */
</span>	// keystome.set(&#x27;email transport&#x27;, &#x27;sometransport&#x27;) -&#x3e; options.transport
	var emailTransport = keystone.get(&#x27;email transport&#x27;);
	if (!options.transport &#x26;&#x26; emailTransport) {
		options.transport = emailTransport;
	}
	// mandrill used to be the default; provide it if the api key is set
	var mandrillApiKey = keystone.get(&#x27;mandrill api key&#x27;);
	if (!options.transport &#x26;&#x26; mandrillApiKey) {
		options.transport = &#x27;mandrill&#x27;;
		options.apiKey = mandrillApiKey;
	}
	// templateExt -&#x3e; engine
	if (!options.engine) {
		options.engine = options.templateExt;
	}
	// keystone.set(&#x27;view engine&#x27;, &#x27;something&#x27;) -&#x3e; engine
	if (!options.engine) {
		var customEngine = keystone.get(&#x27;custom engine&#x27;);
		var viewEngine = keystone.get(&#x27;view engine&#x27;);
		if (typeof customEngine === &#x27;function&#x27;) {
			// when customEngine is a function, viewEngine is probably the extension
			options.engine = customEngine;
			options.ext = options.ext || options.templateExt || viewEngine;
		} else if (viewEngine) {
			// otherwise, default the email engine to keystone&#x27;s view engine
			options.engine = viewEngine;
		}
	}
	// keystone.set(&#x27;emails&#x27;, &#x27;rootpath&#x27;) -&#x3e; root
	var rootPath = keystone.get(&#x27;emails&#x27;);
	if (rootPath &#x26;&#x26; !options.root) {
		options.root = rootPath;
	}

	// Try to use the keystone-email package and throw if it hasn&#x27;t been installed
	var KeystoneEmail;
	try {
		KeystoneEmail = require(&#x27;keystone-email&#x27;);
	} catch (err) {
		if (err.code === &#x27;MODULE_NOT_FOUND&#x27;) {
			throw new Error(&#x27;The &#x22;keystone-email&#x22; package needs to be installed to send emails&#x27;);
		} else {
			throw err;
		}
	}

	// Create the new email instance with the template name and options
	var templateName = options.templateName;
	delete options.templateName;
	var email = new KeystoneEmail(templateName, options);

	// Make email.send backwards compatible with old argument signature
	var send = email.send;
	email.send = function () {
		var args = [arguments[0]];
		if (typeof arguments[1] === &#x27;function&#x27;) {
			// map .send(options, callback) =&#x3e; .send(locals, options, callback)
			// TOOD: Deprecate this call signature
			args.push(arguments[0]);
			args.push(arguments[1]);
		} else {
			// map .send(locals options, callback) =&#x3e; .send(locals, options, callback)
			args.push(arguments[1]);
			args.push(arguments[2]);
		}
		send.apply(email, args);
	};

	return email;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.EmailType" id="apidoc.element.keystone.EmailType">
        function <span class="apidocSignatureSpan">keystone.</span>EmailType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function email(list, path, options) {
	this._nativeType = String;
	this._underscoreMethods = [&#x27;gravatarUrl&#x27;];
	this.typeDescription = &#x27;email address&#x27;;
	email.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.EmbedlyType" id="apidoc.element.keystone.EmbedlyType">
        function <span class="apidocSignatureSpan">keystone.</span>EmbedlyType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function embedly(list, path, options) {

	this._underscoreMethods = [&#x27;reset&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this.fromPath = options.from;
	this.embedlyOptions = options.options || {};

	// check and api key has been set, or bail.
	if (!keystone.get(&#x27;embedly api key&#x27;)) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;Embedly fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require the &#x22;embedly api key&#x22; option to be set.\n\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/configuration/#services-embedly for more information.\n&#x27;);
	}

	// ensure a fromPath has been defined
	if (!options.from) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;Embedly fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require a fromPath option to be set.\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/database/#fieldtypes-embedly for more information.\n&#x27;);
	}

	// embedly fields cannot be set as initial fields
	if (options.initial) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;Embedly fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) cannot be set as initial fields.\n&#x27;);
	}

	embedly.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field" id="apidoc.element.keystone.Field">
        function <span class="apidocSignatureSpan">keystone.</span>Field
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.FileType" id="apidoc.element.keystone.FileType">
        function <span class="apidocSignatureSpan">keystone.</span>FileType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function file(list, path, options) {
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;upload&#x27;, &#x27;remove&#x27;, &#x27;reset&#x27;];
	this._fixedSize = &#x27;full&#x27;;

	if (!options.storage) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;File fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require storage to be provided.&#x27;);
	}
	this.storage = options.storage;
	file.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.GeoPointType" id="apidoc.element.keystone.GeoPointType">
        function <span class="apidocSignatureSpan">keystone.</span>GeoPointType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function geopoint(list, path, options) {
	this._fixedSize = &#x27;medium&#x27;;
	geopoint.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.HtmlType" id="apidoc.element.keystone.HtmlType">
        function <span class="apidocSignatureSpan">keystone.</span>HtmlType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function html(list, path, options) {
	this._nativeType = String;
	this._defaultSize = &#x27;full&#x27;;
	this.wysiwyg = options.wysiwyg || false;
	this.height = options.height || 180;
	this._properties = [&#x27;wysiwyg&#x27;, &#x27;height&#x27;];
	html.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.KeyType" id="apidoc.element.keystone.KeyType">
        function <span class="apidocSignatureSpan">keystone.</span>KeyType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function key(list, path, options) {
	this._nativeType = String;
	this._defaultSize = &#x27;medium&#x27;;
	this.separator = options.separator || &#x27;-&#x27;;
	key.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone" id="apidoc.element.keystone.Keystone">
        function <span class="apidocSignatureSpan">keystone.</span>Keystone
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Keystone = function () {
	grappling.mixin(this).allowHooks(&#x27;pre:static&#x27;, &#x27;pre:bodyparser&#x27;, &#x27;pre:session&#x27;, &#x27;pre:logger&#x27;, &#x27;pre:admin&#x27;, &#x27;pre:routes&#x27;, &#x27;pre:render
&#x27;, &#x27;updates&#x27;, &#x27;signin&#x27;, &#x27;signout&#x27;);
	this.lists = {};
	this.fieldTypes = {};
	this.paths = {};
	this._options = {
		&#x27;name&#x27;: &#x27;Keystone&#x27;,
		&#x27;brand&#x27;: &#x27;Keystone&#x27;,
		&#x27;admin path&#x27;: &#x27;keystone&#x27;,
		&#x27;compress&#x27;: true,
		&#x27;headless&#x27;: false,
		&#x27;logger&#x27;: &#x27;:method :url :status :response-time ms&#x27;,
		&#x27;auto update&#x27;: false,
		&#x27;model prefix&#x27;: null,
		&#x27;module root&#x27;: moduleRoot,
		&#x27;frame guard&#x27;: &#x27;sameorigin&#x27;,
		&#x27;cache admin bundles&#x27;: true,
	};
	this._redirects = {};

	// expose express
	this.express = express;

	// init environment defaults
	this.set(&#x27;env&#x27;, process.env.NODE_ENV || &#x27;development&#x27;);

	this.set(&#x27;port&#x27;, process.env.PORT || process.env.OPENSHIFT_NODEJS_PORT || &#x27;3000&#x27;);
	this.set(&#x27;host&#x27;, process.env.HOST || process.env.IP || process.env.OPENSHIFT_NODEJS_IP || &#x27;0.0.0.0&#x27;);
	this.set(&#x27;listen&#x27;, process.env.LISTEN);

	this.set(&#x27;ssl&#x27;, process.env.SSL);
	this.set(&#x27;ssl port&#x27;, process.env.SSL_PORT || &#x27;3001&#x27;);
	this.set(&#x27;ssl host&#x27;, process.env.SSL_HOST || process.env.SSL_IP);
	this.set(&#x27;ssl key&#x27;, process.env.SSL_KEY);
	this.set(&#x27;ssl cert&#x27;, process.env.SSL_CERT);

	this.set(&#x27;cookie secret&#x27;, process.env.COOKIE_SECRET);
	this.set(&#x27;cookie signin&#x27;, (this.get(&#x27;env&#x27;) === &#x27;development&#x27;) ? true : false);

	this.set(&#x27;embedly api key&#x27;, process.env.EMBEDLY_API_KEY || process.env.EMBEDLY_APIKEY);
	this.set(&#x27;mandrill api key&#x27;, process.env.MANDRILL_API_KEY || process.env.MANDRILL_APIKEY);
	this.set(&#x27;mandrill username&#x27;, process.env.MANDRILL_USERNAME);
	this.set(&#x27;google api key&#x27;, process.env.GOOGLE_BROWSER_KEY);
	this.set(&#x27;google server api key&#x27;, process.env.GOOGLE_SERVER_KEY);
	this.set(&#x27;ga property&#x27;, process.env.GA_PROPERTY);
	this.set(&#x27;ga domain&#x27;, process.env.GA_DOMAIN);
	this.set(&#x27;chartbeat property&#x27;, process.env.CHARTBEAT_PROPERTY);
	this.set(&#x27;chartbeat domain&#x27;, process.env.CHARTBEAT_DOMAIN);
	this.set(&#x27;allowed ip ranges&#x27;, process.env.ALLOWED_IP_RANGES);

	if (process.env.S3_BUCKET &#x26;&#x26; process.env.S3_KEY &#x26;&#x26; process.env.S3_SECRET) {
		this.set(&#x27;s3 config&#x27;, { bucket: process.env.S3_BUCKET, key: process.env.S3_KEY, secret: process.env.S3_SECRET, region: process
.env.S3_REGION });
	}

	if (process.env.AZURE_STORAGE_ACCOUNT &#x26;&#x26; process.env.AZURE_STORAGE_ACCESS_KEY) {
		this.set(&#x27;azurefile config&#x27;, { account: process.env.AZURE_STORAGE_ACCOUNT, key: process.env.AZURE_STORAGE_ACCESS_KEY });
	}

	if (process.env.CLOUDINARY_URL) {
		// process.env.CLOUDINARY_URL is processed by the cloudinary package when this is set
		this.set(&#x27;cloudinary config&#x27;, true);
	}

	// init mongoose
	this.set(&#x27;mongoose&#x27;, require(&#x27;mongoose&#x27;));
	this.mongoose.Promise = require(&#x27;es6-promise&#x27;).Promise;

	// Attach middleware packages, bound to this instance
	this.middleware = {
		api: require(&#x27;./lib/middleware/api&#x27;)(this),
		cors: require(&#x27;./lib/middleware/cors&#x27;)(this),
	};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List" id="apidoc.element.keystone.List">
        function <span class="apidocSignatureSpan">keystone.</span>List
        <span class="apidocSignatureSpan">(key, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function List(key, options) {
		if (!(this instanceof List)) return new List(key, options);
		this.keystone = keystone;

		var defaultOptions = {
			schema: {
				collection: keystone.prefixModel(key),
			},
			noedit: false,
			nocreate: false,
			nodelete: false,
			autocreate: false,
			sortable: false,
			hidden: false,
			track: false,
			inherits: false,
			perPage: 100,
			searchFields: &#x27;__name__&#x27;,
			searchUsesTextIndex: false,
			defaultSort: &#x27;__default__&#x27;,
			defaultColumns: &#x27;__name__&#x27;,
		};

		// initialFields values are initialised on demand by the getter
		var initialFields;

		// Inherit default options from parent list if it exists
		if (options &#x26;&#x26; options.inherits) {
			if (options.inherits.options &#x26;&#x26; options.inherits.options.inherits) {
				throw new Error(&#x27;Inherited Lists may not contain any inheritance&#x27;);
			}
			defaultOptions = utils.options(defaultOptions, options.inherits.options);
			if (options.inherits.options.track) {
				options.track = false;
			}
		}

		this.options = utils.options(defaultOptions, options);

		// init properties
		this.key = key;
		this.path = this.get(&#x27;path&#x27;) || utils.keyToPath(key, true);
		this.schema = new keystone.mongoose.Schema({}, this.options.schema);
		this.schemaFields = [];
		this.uiElements = [];
		this.underscoreMethods = {};
		this.fields = {};
		this.fieldsArray = [];
		this.fieldTypes = {};
		this.relationshipFields = [];
		this.relationships = {};
		this.mappings = {
			name: null,
			createdBy: null,
			createdOn: null,
			modifiedBy: null,
			modifiedOn: null,
		};

		var self = this;

		// init mappings
		_.forEach(this.options.map, function (val, key) { self.map(key, val); });

		// define property getters
		Object.defineProperty(this, &#x27;label&#x27;, { get: function () {
			return this.get(&#x27;label&#x27;) || this.set(&#x27;label&#x27;, utils.plural(utils.keyToLabel(key)));
		} });
		Object.defineProperty(this, &#x27;singular&#x27;, { get: function () {
			return this.get(&#x27;singular&#x27;) || this.set(&#x27;singular&#x27;, utils.singular(this.label));
		} });
		Object.defineProperty(this, &#x27;plural&#x27;, { get: function () {
			return this.get(&#x27;plural&#x27;) || this.set(&#x27;plural&#x27;, utils.plural(this.singular));
		} });
		Object.defineProperty(this, &#x27;namePath&#x27;, { get: function () {
			return this.mappings.name || &#x27;_id&#x27;;
		} });
		Object.defineProperty(this, &#x27;nameField&#x27;, { get: function () {
			return this.fields[this.mappings.name];
		} });
		Object.defineProperty(this, &#x27;nameIsVirtual&#x27;, { get: function () {
			return this.model.schema.virtuals[this.mappings.name] ? true : false;
		} });
		Object.defineProperty(this, &#x27;nameFieldIsFormHeader&#x27;, { get: function () {
			return (this.fields[this.mappings.name] &#x26;&#x26; this.fields[this.mappings.name].type === &#x27;text&#x27;) ? !this.fields[this.mappings.name
].noedit : false;
		} });
		Object.defineProperty(this, &#x27;nameIsInitial&#x27;, { get: function () {
			return (this.fields[this.mappings.name] &#x26;&#x26; this.fields[this.mappings.name].options.initial === undefined);
		} });
		Object.defineProperty(this, &#x27;initialFields&#x27;, { get: function () {
			return initialFields || (initialFields = _.filter(this.fields, function (i) { return i.initial; }));
		} });
		if (this.get(&#x27;inherits&#x27;)) {
			var parentFields = this.get(&#x27;inherits&#x27;).schemaFields;
			this.add.apply(this, parentFields);
		}
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.LocalFileType" id="apidoc.element.keystone.LocalFileType">
        function <span class="apidocSignatureSpan">keystone.</span>LocalFileType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function localfile(list, path, options) {

	throw new Error(&#x27;The LocalFile field type has been removed. Please use File instead.&#x27;
		+ &#x27;\n\nSee https://github.com/keystonejs/keystone/wiki/File-Fields-Upgrade-Guide\n&#x27;);

	<span class="apidocCodeCommentSpan">/*

	grappling.mixin(this).allowHooks(&#x27;move&#x27;);
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;uploadFile&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this.autoCleanup = options.autoCleanup || false;

	if (options.overwrite !== false) {
		options.overwrite = true;
	}

	localfile.super_.call(this, list, path, options);

	// validate destination dir
	if (!options.dest) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;localfile fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require the &#x22;dest&#x22; option to be set.&#x27;);
	}
	// Allow hook into before and after
	if (options.pre &#x26;&#x26; options.pre.move) {
		this.pre(&#x27;move&#x27;, options.pre.move);
	}

	if (options.post &#x26;&#x26; options.post.move) {
		this.post(&#x27;move&#x27;, options.post.move);
	}

	*/
</span>
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.LocalFilesType" id="apidoc.element.keystone.LocalFilesType">
        function <span class="apidocSignatureSpan">keystone.</span>LocalFilesType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function localfiles(list, path, options) {

	throw new Error(&#x27;The LocalFiles field type has been removed. Please use File instead.&#x27;
		+ &#x27;\n\nSee https://github.com/keystonejs/keystone/wiki/File-Fields-Upgrade-Guide\n&#x27;);

	<span class="apidocCodeCommentSpan">/*
	grappling.mixin(this).allowHooks(&#x27;move&#x27;);
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;uploadFiles&#x27;];
	this._fixedSize = &#x27;full&#x27;;

	// TODO: implement filtering, usage disabled for now
	options.nofilter = true;

	// TODO: implement initial form, usage disabled for now
	if (options.initial) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;localfiles fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) do not currently support being used as initial fields.\n&#x27;);
	}

	if (options.overwrite !== false) {
		options.overwrite = true;
	}

	localfiles.super_.call(this, list, path, options);

	// validate destination dir
	if (!options.dest) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;localfiles fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require the &#x22;dest&#x22; option to be set.&#x27;);
	}

	// Allow hook into before and after
	if (options.pre &#x26;&#x26; options.pre.move) {
		this.pre(&#x27;move&#x27;, options.pre.move);
	}

	if (options.post &#x26;&#x26; options.post.move) {
		this.post(&#x27;move&#x27;, options.post.move);
	}
	*/
</span>}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.LocationType" id="apidoc.element.keystone.LocationType">
        function <span class="apidocSignatureSpan">keystone.</span>LocationType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function location(list, path, options) {

	this._underscoreMethods = [&#x27;format&#x27;, &#x27;googleLookup&#x27;, &#x27;kmFrom&#x27;, &#x27;milesFrom&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this._properties = [&#x27;enableMapsAPI&#x27;];
	this.enableMapsAPI = (options.enableImprove === true || (options.enableImprove !== false &#x26;&#x26; keystone.get(&#x27;google server api key
&#x27;))) ? true : false;

	// Throw on invalid options in 4.0 (remove for 5.0)
	if (&#x27;geocodeGoogle&#x27; in options) {
		throw new Error(&#x27;The geocodeGoogle option for Location fields has been renamed to enableImprove&#x27;);
	}

	if (!options.defaults) {
		options.defaults = {};
	}

	if (options.required) {
		if (Array.isArray(options.required)) {
			// required can be specified as an array of paths
			this.requiredPaths = options.required;
		} else if (typeof options.required === &#x27;string&#x27;) {
			// or it can be specified as a comma-delimited list
			this.requiredPaths = options.required.replace(/,/g, &#x27; &#x27;).split(/\s+/);
		}
		// options.required should always be simplified to a boolean
		options.required = true;
	}

	// default this.requiredPaths
	if (!this.requiredPaths) {
		this.requiredPaths = [&#x27;street1&#x27;, &#x27;suburb&#x27;];
	}

	location.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.MarkdownType" id="apidoc.element.keystone.MarkdownType">
        function <span class="apidocSignatureSpan">keystone.</span>MarkdownType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function markdown(list, path, options) {
	this._defaultSize = &#x27;full&#x27;;

	this.toolbarOptions = options.toolbarOptions || {};
	this.markedOptions = options.markedOptions || {};
	this.height = options.height || 90;
	this.wysiwyg = (&#x27;wysiwyg&#x27; in options) ? options.wysiwyg : true;

	this._properties = [&#x27;wysiwyg&#x27;, &#x27;height&#x27;, &#x27;toolbarOptions&#x27;];
	markdown.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.MoneyType" id="apidoc.element.keystone.MoneyType">
        function <span class="apidocSignatureSpan">keystone.</span>MoneyType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function money(list, path, options) {
	this.currency = options.currency;
	this._nativeType = Number;
	this._underscoreMethods = [&#x27;format&#x27;];
	this._properties = [&#x27;currency&#x27;];
	this._fixedSize = &#x27;small&#x27;;
	this._formatString = (options.format === false) ? false : (options.format || &#x27;$0,0.00&#x27;);
	if (this._formatString &#x26;&#x26; typeof this._formatString !== &#x27;string&#x27;) {
		throw new Error(&#x27;FieldType.Money: options.format must be a string.&#x27;);
	}
	money.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.NameType" id="apidoc.element.keystone.NameType">
        function <span class="apidocSignatureSpan">keystone.</span>NameType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function name(list, path, options) {
	this._fixedSize = &#x27;full&#x27;;
	options.default = { first: &#x27;&#x27;, last: &#x27;&#x27; };
	name.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.NumberArrayType" id="apidoc.element.keystone.NumberArrayType">
        function <span class="apidocSignatureSpan">keystone.</span>NumberArrayType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function numberarray(list, path, options) {
	this._nativeType = [Number];
	this._underscoreMethods = [&#x27;format&#x27;];
	this._formatString = (options.format === false) ? false : (options.format || &#x27;0,0[.][000000000000]&#x27;);
	this._defaultSize = &#x27;small&#x27;;
	if (this._formatString &#x26;&#x26; typeof this._formatString !== &#x27;string&#x27;) {
		throw new Error(&#x27;FieldType.NumberArray: options.format must be a string.&#x27;);
	}
	this.separator = options.separator || &#x27; | &#x27;;
	numberarray.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.NumberType" id="apidoc.element.keystone.NumberType">
        function <span class="apidocSignatureSpan">keystone.</span>NumberType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function number(list, path, options) {
	this._nativeType = Number;
	this._fixedSize = &#x27;small&#x27;;
	this._underscoreMethods = [&#x27;format&#x27;];
	this.formatString = (options.format === false) ? false : (options.format || &#x27;0,0[.][000000000000]&#x27;);
	if (this.formatString &#x26;&#x26; typeof this.formatString !== &#x27;string&#x27;) {
		throw new Error(&#x27;FieldType.Number: options.format must be a string.&#x27;);
	}
	number.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.PasswordType" id="apidoc.element.keystone.PasswordType">
        function <span class="apidocSignatureSpan">keystone.</span>PasswordType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function password(list, path, options) {
	this.options = options;
	this._nativeType = String;
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;compare&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	// You can&#x27;t sort on password fields
	options.nosort = true;
	this.workFactor = options.workFactor || 10;
	password.super_.call(this, list, path, options);
	for (var key in this.options.complexity) {
		if ({}.hasOwnProperty.call(this.options.complexity, key)) {
			if (key in regexChunk !== key in this.options.complexity) {
				throw new Error(&#x27;FieldType.Password: options.complexity - option does not exist.&#x27;);
			}
			if (typeof this.options.complexity[key] !== &#x27;boolean&#x27;) {
				throw new Error(&#x27;FieldType.Password: options.complexity - Value must be boolean.&#x27;);
			}
		}
	}
	if (this.options.max &#x3c;= this.options.min) {
		throw new Error(&#x27;FieldType.Password: options - min must be set at a lower value than max.&#x27;);
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.RelationshipType" id="apidoc.element.keystone.RelationshipType">
        function <span class="apidocSignatureSpan">keystone.</span>RelationshipType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function relationship(list, path, options) {
	this.many = (options.many) ? true : false;
	this.filters = options.filters;
	this.createInline = (options.createInline) ? true : false;
	this._defaultSize = &#x27;full&#x27;;
	this._nativeType = keystone.mongoose.Schema.Types.ObjectId;
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;getExpandedData&#x27;];
	this._properties = [&#x27;isValid&#x27;, &#x27;many&#x27;, &#x27;filters&#x27;, &#x27;createInline&#x27;];
	relationship.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.S3FileType" id="apidoc.element.keystone.S3FileType">
        function <span class="apidocSignatureSpan">keystone.</span>S3FileType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function s3file(list, path, options) {

	throw new Error(&#x27;The S3File field type has been removed. Please use File instead.&#x27;
		+ &#x27;\n\nSee https://github.com/keystonejs/keystone/wiki/File-Fields-Upgrade-Guide\n&#x27;);

	<span class="apidocCodeCommentSpan">/*
	grappling.mixin(this).allowHooks(&#x27;pre:upload&#x27;);

	this._underscoreMethods = [&#x27;format&#x27;, &#x27;uploadFile&#x27;];
	this._fixedSize = &#x27;full&#x27;;

	// TODO: implement filtering, usage disabled for now
	options.nofilter = true;

	// TODO: implement initial form, usage disabled for now
	if (options.initial) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;S3File fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) do not currently support being used as initial fields.\n&#x27;);
	}

	s3file.super_.call(this, list, path, options);

	// validate s3 config (has to happen after super_.call)
	if (!this.s3config) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;S3File fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require the &#x22;s3 config&#x22; option to be set.\n\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/configuration/#services-amazons3 for more information.\n&#x27;);
	}

	// Could be more pre- hooks, just upload for now
	if (options.pre &#x26;&#x26; options.pre.upload) {
		this.pre(&#x27;upload&#x27;, options.pre.upload);
	}
	*/
</span>
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.SelectType" id="apidoc.element.keystone.SelectType">
        function <span class="apidocSignatureSpan">keystone.</span>SelectType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function select(list, path, options) {
	this.ui = options.ui || &#x27;select&#x27;;
	this.numeric = options.numeric ? true : false;
	this._nativeType = (options.numeric) ? Number : String;
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;pluck&#x27;];
	this._properties = [&#x27;ops&#x27;, &#x27;numeric&#x27;];
	if (typeof options.options === &#x27;string&#x27;) {
		options.options = options.options.split(&#x27;,&#x27;);
	}
	if (!Array.isArray(options.options)) {
		throw new Error(&#x27;Select fields require an options array.&#x27;);
	}
	this.ops = options.options.map(function (i) {
		var op = typeof i === &#x27;string&#x27; ? { value: i.trim(), label: utils.keyToLabel(i) } : i;
		if (!_.isObject(op)) {
			op = { label: &#x27;&#x27; + i, value: &#x27;&#x27; + i };
		}
		if (options.numeric &#x26;&#x26; !_.isNumber(op.value)) {
			op.value = Number(op.value);
		}
		return op;
	});
	// undefined options.emptyOption defaults to true
	if (options.emptyOption === undefined) {
		options.emptyOption = true;
	}
	// ensure this.emptyOption is a boolean
	this.emptyOption = !!options.emptyOption;
	// cached maps for options, labels and values
	this.map = utils.optionsMap(this.ops);
	this.labels = utils.optionsMap(this.ops, &#x27;label&#x27;);
	this.values = _.map(this.ops, &#x27;value&#x27;);
	select.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Storage" id="apidoc.element.keystone.Storage">
        function <span class="apidocSignatureSpan">keystone.</span>Storage
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Storage(options) {
	// we&#x27;re going to mutate options so get a clean copy of it
	options = assign({}, options);

	var AdapterType = options.adapter;
	delete options.adapter;

	if (typeof AdapterType !== &#x27;function&#x27;) {
		throw new Error(&#x27;Invalid Storage Adapter\n&#x27;
			+ &#x27;The storage adapter specified is not a function. Did you &#x27;
			+ &#x27;require the right package?\n&#x27;);
	}

	debug(&#x27;Initialising Storage with adapter &#x27; + AdapterType.name);

	// ensure the adapter compatibilityLevel of the adapter matches
	if (AdapterType.compatibilityLevel !== ADAPTER_COMPATIBILITY_LEVEL) {
		throw new Error(&#x27;Incompatible Storage Adapter\n&#x27;
			+ &#x27;The storage adapter specified (&#x27; + AdapterType.name + &#x27;) &#x27;
			+ &#x27;does not match the compatibility level required for this &#x27;
			+ &#x27;version of Keystone.\n&#x27;);
	}

	// assign ensures the default schema constant isn&#x27;t exposed as a property
	var schemaFields = assign({}, SCHEMA_FIELD_DEFAULTS, AdapterType.SCHEMA_FIELD_DEFAULTS, options.schema);
	delete options.schema;

	// Copy requested fields into local schema.
	var schema = this.schema = {};
	for (var path in schemaFields) {
		if (!schemaFields[path]) continue;

		var type = AdapterType.SCHEMA_TYPES[path] || SCHEMA_TYPES[path];
		if (!type) throw Error(&#x27;Unknown type for requested schema field &#x27; + path);
		schema[path] = type;
	}

	// ensure Storage schema features are supported by the Adapter
	if (schema.url &#x26;&#x26; typeof AdapterType.prototype.getFileURL !== &#x27;function&#x27;) {
		throw Error(&#x27;URL schema field is not supported by the &#x27; + AdapterType.name + &#x27; adapter&#x27;);
	}

	// create the adapter
	this.adapter = new AdapterType(options, schema);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.TextArrayType" id="apidoc.element.keystone.TextArrayType">
        function <span class="apidocSignatureSpan">keystone.</span>TextArrayType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function textarray(list, path, options) {
	this._nativeType = [String];
	this._underscoreMethods = [&#x27;format&#x27;];
	this.separator = options.separator || &#x27; | &#x27;;
	textarray.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.TextType" id="apidoc.element.keystone.TextType">
        function <span class="apidocSignatureSpan">keystone.</span>TextType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function text(list, path, options) {
	this.options = options;
	this._nativeType = String;
	this._properties = [&#x27;monospace&#x27;];
	this._underscoreMethods = [&#x27;crop&#x27;];
	text.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.TextareaType" id="apidoc.element.keystone.TextareaType">
        function <span class="apidocSignatureSpan">keystone.</span>TextareaType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function textarea(list, path, options) {
	this._nativeType = String;
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;crop&#x27;];
	this.height = options.height || 90;
	this.multiline = true;
	this._properties = [&#x27;height&#x27;, &#x27;multiline&#x27;];
	textarea.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.UrlType" id="apidoc.element.keystone.UrlType">
        function <span class="apidocSignatureSpan">keystone.</span>UrlType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function url(list, path, options) {
	this._nativeType = String;
	this._underscoreMethods = [&#x27;format&#x27;];
	url.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.View" id="apidoc.element.keystone.View">
        function <span class="apidocSignatureSpan">keystone.</span>View
        <span class="apidocSignatureSpan">(req, res)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function View(req, res) {

	if (!req || req.constructor.name !== &#x27;IncomingMessage&#x27;) {
		throw new Error(&#x27;Keystone.View Error: Express request object is required.&#x27;);
	}

	if (!res || res.constructor.name !== &#x27;ServerResponse&#x27;) {
		throw new Error(&#x27;Keystone.View Error: Express response object is required.&#x27;);
	}

	this.req = req;
	this.res = res;

	this.initQueue = [];	// executed first in series
	this.actionQueue = [];	// executed second in parallel, if optional conditions are met
	this.queryQueue = [];	// executed third in parallel
	this.renderQueue = [];	// executed fourth in parallel

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.addAsyncHooks" id="apidoc.element.keystone.addAsyncHooks">
        function <span class="apidocSignatureSpan">keystone.</span>addAsyncHooks
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addAsyncHooks = function () {
		var config = addHooks(this, _.flatten(_.toArray(arguments)));
		createHooks(this, config);
		return this;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.addHooks" id="apidoc.element.keystone.addHooks">
        function <span class="apidocSignatureSpan">keystone.</span>addHooks
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addHooks = function () {
		var config = addHooks(this, _.flatten(_.toArray(arguments)));
		createHooks(this, config);
		return this;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.addSyncHooks" id="apidoc.element.keystone.addSyncHooks">
        function <span class="apidocSignatureSpan">keystone.</span>addSyncHooks
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addSyncHooks = function () {
		var config = addHooks(this, _.flatten(_.toArray(arguments)));
		createSyncHooks(this, config);
		return this;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.addThenableHooks" id="apidoc.element.keystone.addThenableHooks">
        function <span class="apidocSignatureSpan">keystone.</span>addThenableHooks
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addThenableHooks = function () {
		var config = addHooks(this, _.flatten(_.toArray(arguments)));
		createThenableHooks(this, config);
		return this;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.allowHooks" id="apidoc.element.keystone.allowHooks">
        function <span class="apidocSignatureSpan">keystone.</span>allowHooks
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">allowHooks = function () {
		var args = _.flatten(_.toArray(arguments));
		var q = this.__grappling.opts.qualifiers;
		_.each(args, function(hook) {
			if (!_.isString(hook)) {
				throw new Error(&#x27;`allowHooks` expects (arrays of) Strings&#x27;);
			}
			var hookObj = parseHook(hook);
			var middleware = this.__grappling.middleware;
			if (hookObj.type) {
				if (hookObj.type !== q.pre &#x26;&#x26; hookObj.type !== q.post) {
					throw new Error(&#x27;Only &#x22;&#x27; + q.pre + &#x27;&#x22; and &#x22;&#x27; + q.post + &#x27;&#x22; types are allowed, not &#x22;&#x27; + hookObj.type + &#x27;&#x22;&#x27;);
				}
				middleware[hook] = middleware[hook] || [];
			} else {
				middleware[q.pre + &#x27;:&#x27; + hookObj.name] = middleware[q.pre + &#x27;:&#x27; + hookObj.name] || [];
				middleware[q.post + &#x27;:&#x27; + hookObj.name] = middleware[q.post + &#x27;:&#x27; + hookObj.name] || [];
			}
		}, this);
		return this;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
})(module.parent ? module.parent.paths[0] : module.paths[0]);


/**
 * Keystone Class
 */
var Keystone = function () {
	grappling.mixin(this).<span class="apidocCodeKeywordSpan">allowHooks</span>(&#x27;pre:static&#x27;, &#x27;pre:bodyparser&#x27;, &#
x27;pre:session&#x27;, &#x27;pre:logger&#x27;, &#x27;pre:admin&#x27;, &#x27;pre:routes&#x27;, &#x27;pre:render&#x27;, &#x27;updates
&#x27;, &#x27;signin&#x27;, &#x27;signout&#x27;);
	this.lists = {};
	this.fieldTypes = {};
	this.paths = {};
	this._options = {
		&#x27;name&#x27;: &#x27;Keystone&#x27;,
		&#x27;brand&#x27;: &#x27;Keystone&#x27;,
		&#x27;admin path&#x27;: &#x27;keystone&#x27;,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.callAsyncHook" id="apidoc.element.keystone.callAsyncHook">
        function <span class="apidocSignatureSpan">keystone.</span>callAsyncHook
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">callAsyncHook = function () {
		//todo: decide whether we should enforce passing a callback
		var params = parseCallHookParams(this, _.toArray(arguments));
		params.done = (_.isFunction(params.args[params.args.length - 1])) ? params.args.pop() : null;
		if(params.done){
			var self = this;
			dezalgofy(function(safeDone) {
				iterateAsyncMiddleware(params.context, self.getMiddleware(params.hook), params.args, safeDone);
			}, params.done);
		}else{
			iterateAsyncMiddleware(params.context, this.getMiddleware(params.hook), params.args);
		}
		return this;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.callHook" id="apidoc.element.keystone.callHook">
        function <span class="apidocSignatureSpan">keystone.</span>callHook
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">callHook = function () {
		//todo: decide whether we should enforce passing a callback
		var params = parseCallHookParams(this, _.toArray(arguments));
		params.done = (_.isFunction(params.args[params.args.length - 1])) ? params.args.pop() : null;
		if(params.done){
			var self = this;
			dezalgofy(function(safeDone) {
				iterateAsyncMiddleware(params.context, self.getMiddleware(params.hook), params.args, safeDone);
			}, params.done);
		}else{
			iterateAsyncMiddleware(params.context, this.getMiddleware(params.hook), params.args);
		}
		return this;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
 * Applies Application updates
 */

Keystone.prototype.applyUpdates = function (callback) {
	var self = this;
	self.<span class="apidocCodeKeywordSpan">callHook</span>(&#x27;pre:updates&#x27;, function (err) {
		if (err) return callback(err);
		require(&#x27;./lib/updates&#x27;).apply(function (err) {
			if (err) return callback(err);
			self.callHook(&#x27;post:updates&#x27;, callback);
		});
	});
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.callSyncHook" id="apidoc.element.keystone.callSyncHook">
        function <span class="apidocSignatureSpan">keystone.</span>callSyncHook
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">callSyncHook = function () {
		var params = parseCallHookParams(this, _.toArray(arguments));
		iterateSyncMiddleware(params.context, this.getMiddleware(params.hook), params.args);
		return this;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.callThenableHook" id="apidoc.element.keystone.callThenableHook">
        function <span class="apidocSignatureSpan">keystone.</span>callThenableHook
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">callThenableHook = function () {
		var params = parseCallHookParams(this, _.toArray(arguments));
		var deferred = {};
		var thenable = this.__grappling.opts.createThenable(function(resolve, reject) {
			deferred.resolve = resolve;
			deferred.reject = reject;
		});
		var self = this;
		dezalgofy(function(safeDone) {
			iterateAsyncMiddleware(params.context, self.getMiddleware(params.hook), params.args, safeDone);
		}, function(err) {
			if (err) {
				return deferred.reject(err);
			}
			return deferred.resolve();
		});
		return thenable;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express" id="apidoc.element.keystone.express">
        function <span class="apidocSignatureSpan">keystone.</span>express
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function createApplication() {
  var app = function(req, res, next) {
    app.handle(req, res, next);
  };

  mixin(app, EventEmitter.prototype, false);
  mixin(app, proto, false);

  app.request = { __proto__: req, app: app };
  app.response = { __proto__: res, app: app };
  app.init();
  return app;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route" id="apidoc.element.keystone.express.Route">
        function <span class="apidocSignatureSpan">keystone.</span>express.Route
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Route(path) {
  this.path = path;
  this.stack = [];

  debug(&#x27;new %s&#x27;, path);

  // route handlers for various http methods
  this.methods = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router" id="apidoc.element.keystone.express.Router">
        function <span class="apidocSignatureSpan">keystone.</span>express.Router
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">express.Router = function (options) {
  var opts = options || {};

  function router(req, res, next) {
    router.handle(req, res, next);
  }

  // mixin Router class functions
  router.__proto__ = proto;

  router.params = {};
  router._params = [];
  router.caseSensitive = opts.caseSensitive;
  router.mergeParams = opts.mergeParams;
  router.strict = opts.strict;
  router.stack = [];

  return router;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.getMiddleware" id="apidoc.element.keystone.getMiddleware">
        function <span class="apidocSignatureSpan">keystone.</span>getMiddleware
        <span class="apidocSignatureSpan">(qualifiedHook)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getMiddleware = function (qualifiedHook) {
		qualifyHook(parseHook(qualifiedHook));
		var middleware = this.__grappling.middleware[qualifiedHook];
		if (middleware) {
			return middleware.slice(0);
		}
		return [];
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.hasMiddleware" id="apidoc.element.keystone.hasMiddleware">
        function <span class="apidocSignatureSpan">keystone.</span>hasMiddleware
        <span class="apidocSignatureSpan">(qualifiedHook)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasMiddleware = function (qualifiedHook) {
		return this.getMiddleware(qualifiedHook).length &#x3e; 0;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.hook" id="apidoc.element.keystone.hook">
        function <span class="apidocSignatureSpan">keystone.</span>hook
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hook = function () {
		var fns = _.toArray(arguments);
		var hook = fns.shift();
		var output;
		qualifyHook(parseHook(hook));
		if(fns.length){
			output = this;
		}else{
			output = this.__grappling.opts.createThenable(function(resolve){
				fns = [resolve];
			});
		}
		addMiddleware(this, hook, fns);
		return output;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.hookable" id="apidoc.element.keystone.hookable">
        function <span class="apidocSignatureSpan">keystone.</span>hookable
        <span class="apidocSignatureSpan">(qualifiedHook)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hookable = function (qualifiedHook) { //eslint-disable-line no-unused-vars
		if (!this.__grappling.opts.strict) {
			return true;
		}
		var args = _.flatten(_.toArray(arguments));
		return _.every(args, function(qualifiedHook) {
			qualifyHook(parseHook(qualifiedHook));
			return !!this.__grappling.middleware[qualifiedHook];
		}, this);
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.html" id="apidoc.element.keystone.html">
        function <span class="apidocSignatureSpan">keystone.</span>html
        <span class="apidocSignatureSpan">(path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function html(path, options) {
	html.super_.call(path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			// Wrap the textarea
			if (container.is(&#x27;textarea&#x27;)) {
				container.before(editor);
				textarea = container;
				textarea.addClass(&#x27;md-input&#x27;);
				editor.append(textarea);
			} else {
				var rawContent = typeof toMarkdown == &#x27;function&#x27; ? toMarkdown(container.<span class="apidocCodeKeywordSpan">html</
span>()) : container.html(),
				    currentContent = $.trim(rawContent);

				// This is some arbitrary content that could be edited
				textarea = $(&#x27;&#x3c;textarea/&#x3e;&#x27;, {
					&#x27;class&#x27;: &#x27;md-input&#x27;,
					&#x27;val&#x27;: currentContent
				});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.page" id="apidoc.element.keystone.page">
        function <span class="apidocSignatureSpan">keystone.</span>page
        <span class="apidocSignatureSpan">(key, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Page(key, options) {

	if (!(this instanceof Page)) {
		return new Page(key, options);
	}

	this.options = assign({}, options);
	this.key = key;
	this.fields = {};

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * ####Example:
 *
 * 		var homePage = new keystone.content.Page(&#x27;home&#x27;);
 * 		// ...
 * 		homePage.register();
 *
 * 		// later...
 * 		var homePage = keystone.content.<span class="apidocCodeKeywordSpan">page</span>(&#x27;home&#x27;);
 *
 * @api public
 */

Page.prototype.register = function () {
	return keystone.content.page(this.key, this);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.post" id="apidoc.element.keystone.post">
        function <span class="apidocSignatureSpan">keystone.</span>post
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">post = function () {
		var fns = _.toArray(arguments);
		var hookName = fns.shift();
		var output;
		if(fns.length){ //old skool way with callbacks
			output = this;
		}else{
			output = this.__grappling.opts.createThenable(function(resolve){
				fns = [resolve];
			});
		}
		addMiddleware(this, qualifier + &#x27;:&#x27; + hookName, fns);
		return output;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	// Init API request helpers
	router.use(&#x27;/api&#x27;, require(&#x27;../middleware/apiError&#x27;));
	router.use(&#x27;/api&#x27;, require(&#x27;../middleware/logError&#x27;));

	// #1: Session API
	// TODO: this should respect keystone auth options
	router.get(&#x27;/api/session&#x27;, require(&#x27;../api/session/get&#x27;));
	router.<span class="apidocCodeKeywordSpan">post</span>(&#x27;/api/session/signin&#x27;, require(&#x27;../api/session/signin&#x27
;));
	router.post(&#x27;/api/session/signout&#x27;, require(&#x27;../api/session/signout&#x27;));

	// #2: Session Routes
	// Bind auth middleware (generic or custom) to * routes, allowing
	// access to the generic signin page if generic auth is used
	if (keystone.get(&#x27;auth&#x27;) === true) {
		// TODO: poor separation of concerns; settings should be defaulted elsewhere
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.pre" id="apidoc.element.keystone.pre">
        function <span class="apidocSignatureSpan">keystone.</span>pre
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pre = function () {
		var fns = _.toArray(arguments);
		var hookName = fns.shift();
		var output;
		if(fns.length){ //old skool way with callbacks
			output = this;
		}else{
			output = this.__grappling.opts.createThenable(function(resolve){
				fns = [resolve];
			});
		}
		addMiddleware(this, qualifier + &#x27;:&#x27; + hookName, fns);
		return output;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			} else {
				doc.set(autokey.path, src);
				return callback();
			}
		});
	};

	this.schema.<span class="apidocCodeKeywordSpan">pre</span>(&#x27;save&#x27;, function (next) {

		var modified = false;
		var incomplete = false;
		var values = [];

		autokey.from.forEach(function (ops) {
			if (list.fields[ops.path]) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.text" id="apidoc.element.keystone.text">
        function <span class="apidocSignatureSpan">keystone.</span>text
        <span class="apidocSignatureSpan">(path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function text(path, options) {
	text.super_.call(path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					    btnClass = button.btnClass ? button.btnClass : &#x27;md-editor__btn&#x27;,
					    tabIndex = button.tabIndex ? button.tabIndex : &#x27;-1&#x27;,
					    hotkey = typeof button.hotkey !== &#x27;undefined&#x27; ? button.hotkey : &#x27;&#x27;,
					    hotkeyCaption = typeof jQuery.hotkeys !== &#x27;undefined&#x27; &#x26;&#x26; hotkey !== &#x27;&#x27; ? &#x27; (&#x27; +
hotkey + &#x27;)&#x27; : &#x27;&#x27;;

					// Construct the button object
					buttonContainer = $(&#x27;&#x3c;button&#x3e;&#x3c;/button&#x3e;&#x27;);
					buttonContainer.<span class="apidocCodeKeywordSpan">text</span>(&#x27; &#x27; + this.__localize(btnText)).addClass(&#x27;md
-editor__btn&#x27;).addClass(btnClass);
					if (btnClass.match(/md-editor__btn\--(primary|success|info|warning|danger|link)/)) {
						buttonContainer.removeClass(&#x27;md-editor__btn&#x27;);
					}
					buttonContainer.attr({
						&#x27;type&#x27;: &#x27;button&#x27;,
						&#x27;title&#x27;: this.__localize(button.title) + hotkeyCaption,
						&#x27;tabindex&#x27;: tabIndex,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.unhook" id="apidoc.element.keystone.unhook">
        function <span class="apidocSignatureSpan">keystone.</span>unhook
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unhook = function () {
		var fns = _.toArray(arguments);
		var hook = fns.shift();
		var hookObj = parseHook(hook);
		var middleware = this.__grappling.middleware;
		var q = this.__grappling.opts.qualifiers;
		if (hookObj.type || fns.length) {
			qualifyHook(hookObj);
			if (middleware[hook]) middleware[hook] = (fns.length ) ? _.without.apply(null, [middleware[hook]].concat(fns)) : [];
		} else if (hookObj.name) {
			<span class="apidocCodeCommentSpan">/* istanbul ignore else: nothing _should_ happen */
</span>			if (middleware[q.pre + &#x27;:&#x27; + hookObj.name]) middleware[q.pre + &#x27;:&#x27; + hookObj.name] = [];
			/* istanbul ignore else: nothing _should_ happen */
			if (middleware[q.post + &#x27;:&#x27; + hookObj.name]) middleware[q.post + &#x27;:&#x27; + hookObj.name] = [];
		} else {
			_.each(middleware, function(callbacks, hook) {
				middleware[hook] = [];
			});
		}
		return this;
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.updateHandler" id="apidoc.element.keystone.updateHandler">
        function <span class="apidocSignatureSpan">keystone.</span>updateHandler
        <span class="apidocSignatureSpan">(list, item, req, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function UpdateHandler(list, item, req, options) {
	this.list = list;
	this.item = item;
	this.req = req;
	if (arguments.length === 5) {
		// old signature; set options to the last argument
		options = arguments[4];
	}
	this.options = options || {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>










































































































































</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.AzureFileType" id="apidoc.module.keystone.AzureFileType">module keystone.AzureFileType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.AzureFileType.AzureFileType" id="apidoc.element.keystone.AzureFileType.AzureFileType">
        function <span class="apidocSignatureSpan">keystone.</span>AzureFileType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function azurefile(list, path, options) {

	throw new Error(&#x27;The AzureFile field type has been removed. Please use File instead.&#x27;
		+ &#x27;\n\nSee https://github.com/keystonejs/keystone/wiki/File-Fields-Upgrade-Guide\n&#x27;);

	<span class="apidocCodeCommentSpan">/*

	grappling.mixin(this).allowHooks(&#x27;pre:upload&#x27;);

	this._underscoreMethods = [&#x27;format&#x27;, &#x27;uploadFile&#x27;];
	this._fixedSize = &#x27;full&#x27;;

	// TODO: implement filtering, usage disabled for now
	options.nofilter = true;

	// TODO: implement initial form, usage disabled for now
	if (options.initial) {
		throw new Error(&#x27;Invalid Configuration\n\nAzureFile fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) do not currently support being used
 as initial fields.\n&#x27;);
	}

	var self = this;
	options.filenameFormatter = options.filenameFormatter || function (item, filename) { return filename; };
	options.containerFormatter = options.containerFormatter || function (item, filename) { return self.azurefileconfig.container; };//
eslint-disable-line no-unused-vars

	azurefile.super_.call(this, list, path, options);

	// validate azurefile config (has to happen after super_.call)
	if (!this.azurefileconfig) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;AzureFile fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require the &#x22;azurefile config&#x22; option to be set.\n\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/configuration/#services-azure for more information.\n&#x27;);
	}

	// TODO; this is really bad, we shouldn&#x27;t be overwriting global env!
	process.env.AZURE_STORAGE_ACCOUNT = this.azurefileconfig.account;
	process.env.AZURE_STORAGE_ACCESS_KEY = this.azurefileconfig.key;

	this.azurefileconfig.container = this.azurefileconfig.container || &#x27;keystone&#x27;;

	// Could be more pre- hooks, just upload for now
	if (options.pre &#x26;&#x26; options.pre.upload) {
		this.pre(&#x27;upload&#x27;, options.pre.upload);
	}

	*/
</span>
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.BooleanType" id="apidoc.module.keystone.BooleanType">module keystone.BooleanType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.BooleanType.BooleanType" id="apidoc.element.keystone.BooleanType.BooleanType">
        function <span class="apidocSignatureSpan">keystone.</span>BooleanType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function boolean(list, path, options) {
	this._nativeType = Boolean;
	this._properties = [&#x27;indent&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this.indent = (options.indent) ? true : false;
	boolean.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.BooleanType.super_" id="apidoc.element.keystone.BooleanType.super_">
        function <span class="apidocSignatureSpan">keystone.BooleanType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.CloudinaryImageType" id="apidoc.module.keystone.CloudinaryImageType">module keystone.CloudinaryImageType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.CloudinaryImageType.CloudinaryImageType" id="apidoc.element.keystone.CloudinaryImageType.CloudinaryImageType">
        function <span class="apidocSignatureSpan">keystone.</span>CloudinaryImageType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function cloudinaryimage(list, path, options) {
	this._underscoreMethods = [&#x27;format&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this._properties = [&#x27;select&#x27;, &#x27;selectPrefix&#x27;, &#x27;autoCleanup&#x27;];

	if (options.filenameAsPublicID) {
		// Produces the same result as the legacy filenameAsPublicID option
		options.generateFilename = nameFunctions.originalFilename;
		options.whenExists = &#x27;overwrite&#x27;;
	}
	options = assign({}, DEFAULT_OPTIONS, options);
	options.generateFilename = ensureCallback(options.generateFilename);

	cloudinaryimage.super_.call(this, list, path, options);
	// validate cloudinary config
	if (!keystone.get(&#x27;cloudinary config&#x27;)) {
		throw new Error(
			&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;CloudinaryImage fields (&#x27; + list.key + &#x27;.&#x27; + this.path + &#x27;) require the &#x22;cloudinary config&#x22; option to be set.\n\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/configuration/#services-cloudinary for more information.\n&#x27;
		);
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.CloudinaryImageType.super_" id="apidoc.element.keystone.CloudinaryImageType.super_">
        function <span class="apidocSignatureSpan">keystone.CloudinaryImageType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.CloudinaryImagesType" id="apidoc.module.keystone.CloudinaryImagesType">module keystone.CloudinaryImagesType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.CloudinaryImagesType.CloudinaryImagesType" id="apidoc.element.keystone.CloudinaryImagesType.CloudinaryImagesType">
        function <span class="apidocSignatureSpan">keystone.</span>CloudinaryImagesType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function cloudinaryimages(list, path, options) {
	this._underscoreMethods = [&#x27;format&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this._properties = [&#x27;select&#x27;, &#x27;selectPrefix&#x27;, &#x27;autoCleanup&#x27;, &#x27;publicID&#x27;, &#x27;folder&#x27;, &#x27;filenameAsPublicID&#x27;];

	cloudinaryimages.super_.call(this, list, path, options);

	// validate cloudinary config
	if (!keystone.get(&#x27;cloudinary config&#x27;)) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;CloudinaryImages fields (&#x27; + list.key + &#x27;.&#x27; + this.path + &#x27;) require the &#x22;cloudinary config&#x22; option to be set.\n\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/configuration/#services-cloudinary for more information.\n&#x27;);
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.CloudinaryImagesType.super_" id="apidoc.element.keystone.CloudinaryImagesType.super_">
        function <span class="apidocSignatureSpan">keystone.CloudinaryImagesType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.CodeType" id="apidoc.module.keystone.CodeType">module keystone.CodeType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.CodeType.CodeType" id="apidoc.element.keystone.CodeType.CodeType">
        function <span class="apidocSignatureSpan">keystone.</span>CodeType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function code(list, path, options) {
	this._nativeType = String;
	this._defaultSize = &#x27;full&#x27;;
	this.height = options.height || 180;
	this.lang = options.lang || options.language;
	this._properties = [&#x27;editor&#x27;, &#x27;height&#x27;, &#x27;lang&#x27;];
	this.codemirror = options.codemirror || {};
	this.editor = assign({ mode: this.lang }, this.codemirror);
	code.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.CodeType.super_" id="apidoc.element.keystone.CodeType.super_">
        function <span class="apidocSignatureSpan">keystone.CodeType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.ColorType" id="apidoc.module.keystone.ColorType">module keystone.ColorType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.ColorType.ColorType" id="apidoc.element.keystone.ColorType.ColorType">
        function <span class="apidocSignatureSpan">keystone.</span>ColorType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function color(list, path, options) {
	this._nativeType = String;
	color.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.ColorType.super_" id="apidoc.element.keystone.ColorType.super_">
        function <span class="apidocSignatureSpan">keystone.ColorType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.DateArrayType" id="apidoc.module.keystone.DateArrayType">module keystone.DateArrayType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.DateArrayType.DateArrayType" id="apidoc.element.keystone.DateArrayType.DateArrayType">
        function <span class="apidocSignatureSpan">keystone.</span>DateArrayType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function datearray(list, path, options) {
	this._nativeType = [Date];
	this._defaultSize = &#x27;medium&#x27;;
	this._underscoreMethods = [&#x27;format&#x27;];
	this._properties = [&#x27;formatString&#x27;];
	this.parseFormatString = options.parseFormat || &#x27;YYYY-MM-DD&#x27;;
	this.formatString = (options.format === false) ? false : (options.format || &#x27;Do MMM YYYY&#x27;);
	if (this.formatString &#x26;&#x26; typeof this.formatString !== &#x27;string&#x27;) {
		throw new Error(&#x27;FieldType.DateArray: options.format must be a string.&#x27;);
	}
	this.separator = options.separator || &#x27; | &#x27;;
	datearray.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.DateArrayType.super_" id="apidoc.element.keystone.DateArrayType.super_">
        function <span class="apidocSignatureSpan">keystone.DateArrayType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.DateType" id="apidoc.module.keystone.DateType">module keystone.DateType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.DateType.DateType" id="apidoc.element.keystone.DateType.DateType">
        function <span class="apidocSignatureSpan">keystone.</span>DateType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function date(list, path, options) {
	this._nativeType = Date;
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;moment&#x27;, &#x27;parse&#x27;];
	this._fixedSize = &#x27;medium&#x27;;
	this._properties = [&#x27;formatString&#x27;, &#x27;yearRange&#x27;, &#x27;isUTC&#x27;, &#x27;inputFormat&#x27;];
	this.parseFormatString = options.inputFormat || &#x27;YYYY-MM-DD&#x27;;
	this.formatString = (options.format === false) ? false : (options.format || &#x27;Do MMM YYYY&#x27;);

	this.yearRange = options.yearRange;
	this.isUTC = options.utc || false;
	if (this.formatString &#x26;&#x26; typeof this.formatString !== &#x27;string&#x27;) {
		throw new Error(&#x27;FieldType.Date: options.format must be a string.&#x27;);
	}
	date.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.DateType.super_" id="apidoc.element.keystone.DateType.super_">
        function <span class="apidocSignatureSpan">keystone.DateType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.DatetimeType" id="apidoc.module.keystone.DatetimeType">module keystone.DatetimeType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.DatetimeType.DatetimeType" id="apidoc.element.keystone.DatetimeType.DatetimeType">
        function <span class="apidocSignatureSpan">keystone.</span>DatetimeType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function datetime(list, path, options) {
	this._nativeType = Date;
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;moment&#x27;, &#x27;parse&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this._properties = [&#x27;formatString&#x27;, &#x27;isUTC&#x27;];
	this.typeDescription = &#x27;date and time&#x27;;
	this.parseFormatString = options.parseFormat || parseFormats;
	this.formatString = (options.format === false) ? false : (options.format || &#x27;YYYY-MM-DD h:mm:ss a&#x27;);
	this.isUTC = options.utc || false;
	if (this.formatString &#x26;&#x26; typeof this.formatString !== &#x27;string&#x27;) {
		throw new Error(&#x27;FieldType.DateTime: options.format must be a string.&#x27;);
	}
	datetime.super_.call(this, list, path, options);
	this.paths = {
		date: this.path + &#x27;_date&#x27;,
		time: this.path + &#x27;_time&#x27;,
		tzOffset: this.path + &#x27;_tzOffset&#x27;,
	};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.DatetimeType.super_" id="apidoc.element.keystone.DatetimeType.super_">
        function <span class="apidocSignatureSpan">keystone.DatetimeType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.EmailType" id="apidoc.module.keystone.EmailType">module keystone.EmailType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.EmailType.EmailType" id="apidoc.element.keystone.EmailType.EmailType">
        function <span class="apidocSignatureSpan">keystone.</span>EmailType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function email(list, path, options) {
	this._nativeType = String;
	this._underscoreMethods = [&#x27;gravatarUrl&#x27;];
	this.typeDescription = &#x27;email address&#x27;;
	email.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.EmailType.super_" id="apidoc.element.keystone.EmailType.super_">
        function <span class="apidocSignatureSpan">keystone.EmailType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.EmbedlyType" id="apidoc.module.keystone.EmbedlyType">module keystone.EmbedlyType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.EmbedlyType.EmbedlyType" id="apidoc.element.keystone.EmbedlyType.EmbedlyType">
        function <span class="apidocSignatureSpan">keystone.</span>EmbedlyType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function embedly(list, path, options) {

	this._underscoreMethods = [&#x27;reset&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this.fromPath = options.from;
	this.embedlyOptions = options.options || {};

	// check and api key has been set, or bail.
	if (!keystone.get(&#x27;embedly api key&#x27;)) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;Embedly fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require the &#x22;embedly api key&#x22; option to be set.\n\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/configuration/#services-embedly for more information.\n&#x27;);
	}

	// ensure a fromPath has been defined
	if (!options.from) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;Embedly fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require a fromPath option to be set.\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/database/#fieldtypes-embedly for more information.\n&#x27;);
	}

	// embedly fields cannot be set as initial fields
	if (options.initial) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;Embedly fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) cannot be set as initial fields.\n&#x27;);
	}

	embedly.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.EmbedlyType.super_" id="apidoc.element.keystone.EmbedlyType.super_">
        function <span class="apidocSignatureSpan">keystone.EmbedlyType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field" id="apidoc.module.keystone.Field">module keystone.Field</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Field" id="apidoc.element.keystone.Field.Field">
        function <span class="apidocSignatureSpan">keystone.</span>Field
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types" id="apidoc.module.keystone.Field.Types">module keystone.Field.Types</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.AzureFile" id="apidoc.element.keystone.Field.Types.AzureFile">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>AzureFile
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function azurefile(list, path, options) {

	throw new Error(&#x27;The AzureFile field type has been removed. Please use File instead.&#x27;
		+ &#x27;\n\nSee https://github.com/keystonejs/keystone/wiki/File-Fields-Upgrade-Guide\n&#x27;);

	<span class="apidocCodeCommentSpan">/*

	grappling.mixin(this).allowHooks(&#x27;pre:upload&#x27;);

	this._underscoreMethods = [&#x27;format&#x27;, &#x27;uploadFile&#x27;];
	this._fixedSize = &#x27;full&#x27;;

	// TODO: implement filtering, usage disabled for now
	options.nofilter = true;

	// TODO: implement initial form, usage disabled for now
	if (options.initial) {
		throw new Error(&#x27;Invalid Configuration\n\nAzureFile fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) do not currently support being used
 as initial fields.\n&#x27;);
	}

	var self = this;
	options.filenameFormatter = options.filenameFormatter || function (item, filename) { return filename; };
	options.containerFormatter = options.containerFormatter || function (item, filename) { return self.azurefileconfig.container; };//
eslint-disable-line no-unused-vars

	azurefile.super_.call(this, list, path, options);

	// validate azurefile config (has to happen after super_.call)
	if (!this.azurefileconfig) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;AzureFile fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require the &#x22;azurefile config&#x22; option to be set.\n\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/configuration/#services-azure for more information.\n&#x27;);
	}

	// TODO; this is really bad, we shouldn&#x27;t be overwriting global env!
	process.env.AZURE_STORAGE_ACCOUNT = this.azurefileconfig.account;
	process.env.AZURE_STORAGE_ACCESS_KEY = this.azurefileconfig.key;

	this.azurefileconfig.container = this.azurefileconfig.container || &#x27;keystone&#x27;;

	// Could be more pre- hooks, just upload for now
	if (options.pre &#x26;&#x26; options.pre.upload) {
		this.pre(&#x27;upload&#x27;, options.pre.upload);
	}

	*/
</span>
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Boolean" id="apidoc.element.keystone.Field.Types.Boolean">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Boolean
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function boolean(list, path, options) {
	this._nativeType = Boolean;
	this._properties = [&#x27;indent&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this.indent = (options.indent) ? true : false;
	boolean.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImage" id="apidoc.element.keystone.Field.Types.CloudinaryImage">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>CloudinaryImage
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function cloudinaryimage(list, path, options) {
	this._underscoreMethods = [&#x27;format&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this._properties = [&#x27;select&#x27;, &#x27;selectPrefix&#x27;, &#x27;autoCleanup&#x27;];

	if (options.filenameAsPublicID) {
		// Produces the same result as the legacy filenameAsPublicID option
		options.generateFilename = nameFunctions.originalFilename;
		options.whenExists = &#x27;overwrite&#x27;;
	}
	options = assign({}, DEFAULT_OPTIONS, options);
	options.generateFilename = ensureCallback(options.generateFilename);

	cloudinaryimage.super_.call(this, list, path, options);
	// validate cloudinary config
	if (!keystone.get(&#x27;cloudinary config&#x27;)) {
		throw new Error(
			&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;CloudinaryImage fields (&#x27; + list.key + &#x27;.&#x27; + this.path + &#x27;) require the &#x22;cloudinary config&#x22; option to be set.\n\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/configuration/#services-cloudinary for more information.\n&#x27;
		);
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImages" id="apidoc.element.keystone.Field.Types.CloudinaryImages">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>CloudinaryImages
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function cloudinaryimages(list, path, options) {
	this._underscoreMethods = [&#x27;format&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this._properties = [&#x27;select&#x27;, &#x27;selectPrefix&#x27;, &#x27;autoCleanup&#x27;, &#x27;publicID&#x27;, &#x27;folder&#x27;, &#x27;filenameAsPublicID&#x27;];

	cloudinaryimages.super_.call(this, list, path, options);

	// validate cloudinary config
	if (!keystone.get(&#x27;cloudinary config&#x27;)) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;CloudinaryImages fields (&#x27; + list.key + &#x27;.&#x27; + this.path + &#x27;) require the &#x22;cloudinary config&#x22; option to be set.\n\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/configuration/#services-cloudinary for more information.\n&#x27;);
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Code" id="apidoc.element.keystone.Field.Types.Code">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Code
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function code(list, path, options) {
	this._nativeType = String;
	this._defaultSize = &#x27;full&#x27;;
	this.height = options.height || 180;
	this.lang = options.lang || options.language;
	this._properties = [&#x27;editor&#x27;, &#x27;height&#x27;, &#x27;lang&#x27;];
	this.codemirror = options.codemirror || {};
	this.editor = assign({ mode: this.lang }, this.codemirror);
	code.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Color" id="apidoc.element.keystone.Field.Types.Color">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Color
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function color(list, path, options) {
	this._nativeType = String;
	color.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Date" id="apidoc.element.keystone.Field.Types.Date">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Date
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function date(list, path, options) {
	this._nativeType = Date;
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;moment&#x27;, &#x27;parse&#x27;];
	this._fixedSize = &#x27;medium&#x27;;
	this._properties = [&#x27;formatString&#x27;, &#x27;yearRange&#x27;, &#x27;isUTC&#x27;, &#x27;inputFormat&#x27;];
	this.parseFormatString = options.inputFormat || &#x27;YYYY-MM-DD&#x27;;
	this.formatString = (options.format === false) ? false : (options.format || &#x27;Do MMM YYYY&#x27;);

	this.yearRange = options.yearRange;
	this.isUTC = options.utc || false;
	if (this.formatString &#x26;&#x26; typeof this.formatString !== &#x27;string&#x27;) {
		throw new Error(&#x27;FieldType.Date: options.format must be a string.&#x27;);
	}
	date.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.DateArray" id="apidoc.element.keystone.Field.Types.DateArray">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>DateArray
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function datearray(list, path, options) {
	this._nativeType = [Date];
	this._defaultSize = &#x27;medium&#x27;;
	this._underscoreMethods = [&#x27;format&#x27;];
	this._properties = [&#x27;formatString&#x27;];
	this.parseFormatString = options.parseFormat || &#x27;YYYY-MM-DD&#x27;;
	this.formatString = (options.format === false) ? false : (options.format || &#x27;Do MMM YYYY&#x27;);
	if (this.formatString &#x26;&#x26; typeof this.formatString !== &#x27;string&#x27;) {
		throw new Error(&#x27;FieldType.DateArray: options.format must be a string.&#x27;);
	}
	this.separator = options.separator || &#x27; | &#x27;;
	datearray.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Datetime" id="apidoc.element.keystone.Field.Types.Datetime">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Datetime
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function datetime(list, path, options) {
	this._nativeType = Date;
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;moment&#x27;, &#x27;parse&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this._properties = [&#x27;formatString&#x27;, &#x27;isUTC&#x27;];
	this.typeDescription = &#x27;date and time&#x27;;
	this.parseFormatString = options.parseFormat || parseFormats;
	this.formatString = (options.format === false) ? false : (options.format || &#x27;YYYY-MM-DD h:mm:ss a&#x27;);
	this.isUTC = options.utc || false;
	if (this.formatString &#x26;&#x26; typeof this.formatString !== &#x27;string&#x27;) {
		throw new Error(&#x27;FieldType.DateTime: options.format must be a string.&#x27;);
	}
	datetime.super_.call(this, list, path, options);
	this.paths = {
		date: this.path + &#x27;_date&#x27;,
		time: this.path + &#x27;_time&#x27;,
		tzOffset: this.path + &#x27;_tzOffset&#x27;,
	};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Email" id="apidoc.element.keystone.Field.Types.Email">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Email
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function email(list, path, options) {
	this._nativeType = String;
	this._underscoreMethods = [&#x27;gravatarUrl&#x27;];
	this.typeDescription = &#x27;email address&#x27;;
	email.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Embedly" id="apidoc.element.keystone.Field.Types.Embedly">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Embedly
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function embedly(list, path, options) {

	this._underscoreMethods = [&#x27;reset&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this.fromPath = options.from;
	this.embedlyOptions = options.options || {};

	// check and api key has been set, or bail.
	if (!keystone.get(&#x27;embedly api key&#x27;)) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;Embedly fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require the &#x22;embedly api key&#x22; option to be set.\n\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/configuration/#services-embedly for more information.\n&#x27;);
	}

	// ensure a fromPath has been defined
	if (!options.from) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;Embedly fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require a fromPath option to be set.\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/database/#fieldtypes-embedly for more information.\n&#x27;);
	}

	// embedly fields cannot be set as initial fields
	if (options.initial) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;Embedly fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) cannot be set as initial fields.\n&#x27;);
	}

	embedly.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.File" id="apidoc.element.keystone.Field.Types.File">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>File
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function file(list, path, options) {
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;upload&#x27;, &#x27;remove&#x27;, &#x27;reset&#x27;];
	this._fixedSize = &#x27;full&#x27;;

	if (!options.storage) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;File fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require storage to be provided.&#x27;);
	}
	this.storage = options.storage;
	file.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.GeoPoint" id="apidoc.element.keystone.Field.Types.GeoPoint">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>GeoPoint
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function geopoint(list, path, options) {
	this._fixedSize = &#x27;medium&#x27;;
	geopoint.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Html" id="apidoc.element.keystone.Field.Types.Html">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Html
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function html(list, path, options) {
	this._nativeType = String;
	this._defaultSize = &#x27;full&#x27;;
	this.wysiwyg = options.wysiwyg || false;
	this.height = options.height || 180;
	this._properties = [&#x27;wysiwyg&#x27;, &#x27;height&#x27;];
	html.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Key" id="apidoc.element.keystone.Field.Types.Key">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Key
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function key(list, path, options) {
	this._nativeType = String;
	this._defaultSize = &#x27;medium&#x27;;
	this.separator = options.separator || &#x27;-&#x27;;
	key.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFile" id="apidoc.element.keystone.Field.Types.LocalFile">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>LocalFile
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function localfile(list, path, options) {

	throw new Error(&#x27;The LocalFile field type has been removed. Please use File instead.&#x27;
		+ &#x27;\n\nSee https://github.com/keystonejs/keystone/wiki/File-Fields-Upgrade-Guide\n&#x27;);

	<span class="apidocCodeCommentSpan">/*

	grappling.mixin(this).allowHooks(&#x27;move&#x27;);
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;uploadFile&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this.autoCleanup = options.autoCleanup || false;

	if (options.overwrite !== false) {
		options.overwrite = true;
	}

	localfile.super_.call(this, list, path, options);

	// validate destination dir
	if (!options.dest) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;localfile fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require the &#x22;dest&#x22; option to be set.&#x27;);
	}
	// Allow hook into before and after
	if (options.pre &#x26;&#x26; options.pre.move) {
		this.pre(&#x27;move&#x27;, options.pre.move);
	}

	if (options.post &#x26;&#x26; options.post.move) {
		this.post(&#x27;move&#x27;, options.post.move);
	}

	*/
</span>
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFiles" id="apidoc.element.keystone.Field.Types.LocalFiles">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>LocalFiles
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function localfiles(list, path, options) {

	throw new Error(&#x27;The LocalFiles field type has been removed. Please use File instead.&#x27;
		+ &#x27;\n\nSee https://github.com/keystonejs/keystone/wiki/File-Fields-Upgrade-Guide\n&#x27;);

	<span class="apidocCodeCommentSpan">/*
	grappling.mixin(this).allowHooks(&#x27;move&#x27;);
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;uploadFiles&#x27;];
	this._fixedSize = &#x27;full&#x27;;

	// TODO: implement filtering, usage disabled for now
	options.nofilter = true;

	// TODO: implement initial form, usage disabled for now
	if (options.initial) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;localfiles fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) do not currently support being used as initial fields.\n&#x27;);
	}

	if (options.overwrite !== false) {
		options.overwrite = true;
	}

	localfiles.super_.call(this, list, path, options);

	// validate destination dir
	if (!options.dest) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;localfiles fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require the &#x22;dest&#x22; option to be set.&#x27;);
	}

	// Allow hook into before and after
	if (options.pre &#x26;&#x26; options.pre.move) {
		this.pre(&#x27;move&#x27;, options.pre.move);
	}

	if (options.post &#x26;&#x26; options.post.move) {
		this.post(&#x27;move&#x27;, options.post.move);
	}
	*/
</span>}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Location" id="apidoc.element.keystone.Field.Types.Location">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Location
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function location(list, path, options) {

	this._underscoreMethods = [&#x27;format&#x27;, &#x27;googleLookup&#x27;, &#x27;kmFrom&#x27;, &#x27;milesFrom&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this._properties = [&#x27;enableMapsAPI&#x27;];
	this.enableMapsAPI = (options.enableImprove === true || (options.enableImprove !== false &#x26;&#x26; keystone.get(&#x27;google server api key
&#x27;))) ? true : false;

	// Throw on invalid options in 4.0 (remove for 5.0)
	if (&#x27;geocodeGoogle&#x27; in options) {
		throw new Error(&#x27;The geocodeGoogle option for Location fields has been renamed to enableImprove&#x27;);
	}

	if (!options.defaults) {
		options.defaults = {};
	}

	if (options.required) {
		if (Array.isArray(options.required)) {
			// required can be specified as an array of paths
			this.requiredPaths = options.required;
		} else if (typeof options.required === &#x27;string&#x27;) {
			// or it can be specified as a comma-delimited list
			this.requiredPaths = options.required.replace(/,/g, &#x27; &#x27;).split(/\s+/);
		}
		// options.required should always be simplified to a boolean
		options.required = true;
	}

	// default this.requiredPaths
	if (!this.requiredPaths) {
		this.requiredPaths = [&#x27;street1&#x27;, &#x27;suburb&#x27;];
	}

	location.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Markdown" id="apidoc.element.keystone.Field.Types.Markdown">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Markdown
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function markdown(list, path, options) {
	this._defaultSize = &#x27;full&#x27;;

	this.toolbarOptions = options.toolbarOptions || {};
	this.markedOptions = options.markedOptions || {};
	this.height = options.height || 90;
	this.wysiwyg = (&#x27;wysiwyg&#x27; in options) ? options.wysiwyg : true;

	this._properties = [&#x27;wysiwyg&#x27;, &#x27;height&#x27;, &#x27;toolbarOptions&#x27;];
	markdown.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Money" id="apidoc.element.keystone.Field.Types.Money">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Money
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function money(list, path, options) {
	this.currency = options.currency;
	this._nativeType = Number;
	this._underscoreMethods = [&#x27;format&#x27;];
	this._properties = [&#x27;currency&#x27;];
	this._fixedSize = &#x27;small&#x27;;
	this._formatString = (options.format === false) ? false : (options.format || &#x27;$0,0.00&#x27;);
	if (this._formatString &#x26;&#x26; typeof this._formatString !== &#x27;string&#x27;) {
		throw new Error(&#x27;FieldType.Money: options.format must be a string.&#x27;);
	}
	money.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Name" id="apidoc.element.keystone.Field.Types.Name">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Name
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function name(list, path, options) {
	this._fixedSize = &#x27;full&#x27;;
	options.default = { first: &#x27;&#x27;, last: &#x27;&#x27; };
	name.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Number" id="apidoc.element.keystone.Field.Types.Number">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Number
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function number(list, path, options) {
	this._nativeType = Number;
	this._fixedSize = &#x27;small&#x27;;
	this._underscoreMethods = [&#x27;format&#x27;];
	this.formatString = (options.format === false) ? false : (options.format || &#x27;0,0[.][000000000000]&#x27;);
	if (this.formatString &#x26;&#x26; typeof this.formatString !== &#x27;string&#x27;) {
		throw new Error(&#x27;FieldType.Number: options.format must be a string.&#x27;);
	}
	number.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.NumberArray" id="apidoc.element.keystone.Field.Types.NumberArray">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>NumberArray
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function numberarray(list, path, options) {
	this._nativeType = [Number];
	this._underscoreMethods = [&#x27;format&#x27;];
	this._formatString = (options.format === false) ? false : (options.format || &#x27;0,0[.][000000000000]&#x27;);
	this._defaultSize = &#x27;small&#x27;;
	if (this._formatString &#x26;&#x26; typeof this._formatString !== &#x27;string&#x27;) {
		throw new Error(&#x27;FieldType.NumberArray: options.format must be a string.&#x27;);
	}
	this.separator = options.separator || &#x27; | &#x27;;
	numberarray.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Password" id="apidoc.element.keystone.Field.Types.Password">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Password
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function password(list, path, options) {
	this.options = options;
	this._nativeType = String;
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;compare&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	// You can&#x27;t sort on password fields
	options.nosort = true;
	this.workFactor = options.workFactor || 10;
	password.super_.call(this, list, path, options);
	for (var key in this.options.complexity) {
		if ({}.hasOwnProperty.call(this.options.complexity, key)) {
			if (key in regexChunk !== key in this.options.complexity) {
				throw new Error(&#x27;FieldType.Password: options.complexity - option does not exist.&#x27;);
			}
			if (typeof this.options.complexity[key] !== &#x27;boolean&#x27;) {
				throw new Error(&#x27;FieldType.Password: options.complexity - Value must be boolean.&#x27;);
			}
		}
	}
	if (this.options.max &#x3c;= this.options.min) {
		throw new Error(&#x27;FieldType.Password: options - min must be set at a lower value than max.&#x27;);
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Relationship" id="apidoc.element.keystone.Field.Types.Relationship">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Relationship
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function relationship(list, path, options) {
	this.many = (options.many) ? true : false;
	this.filters = options.filters;
	this.createInline = (options.createInline) ? true : false;
	this._defaultSize = &#x27;full&#x27;;
	this._nativeType = keystone.mongoose.Schema.Types.ObjectId;
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;getExpandedData&#x27;];
	this._properties = [&#x27;isValid&#x27;, &#x27;many&#x27;, &#x27;filters&#x27;, &#x27;createInline&#x27;];
	relationship.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.S3File" id="apidoc.element.keystone.Field.Types.S3File">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>S3File
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function s3file(list, path, options) {

	throw new Error(&#x27;The S3File field type has been removed. Please use File instead.&#x27;
		+ &#x27;\n\nSee https://github.com/keystonejs/keystone/wiki/File-Fields-Upgrade-Guide\n&#x27;);

	<span class="apidocCodeCommentSpan">/*
	grappling.mixin(this).allowHooks(&#x27;pre:upload&#x27;);

	this._underscoreMethods = [&#x27;format&#x27;, &#x27;uploadFile&#x27;];
	this._fixedSize = &#x27;full&#x27;;

	// TODO: implement filtering, usage disabled for now
	options.nofilter = true;

	// TODO: implement initial form, usage disabled for now
	if (options.initial) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;S3File fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) do not currently support being used as initial fields.\n&#x27;);
	}

	s3file.super_.call(this, list, path, options);

	// validate s3 config (has to happen after super_.call)
	if (!this.s3config) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;S3File fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require the &#x22;s3 config&#x22; option to be set.\n\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/configuration/#services-amazons3 for more information.\n&#x27;);
	}

	// Could be more pre- hooks, just upload for now
	if (options.pre &#x26;&#x26; options.pre.upload) {
		this.pre(&#x27;upload&#x27;, options.pre.upload);
	}
	*/
</span>
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Select" id="apidoc.element.keystone.Field.Types.Select">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Select
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function select(list, path, options) {
	this.ui = options.ui || &#x27;select&#x27;;
	this.numeric = options.numeric ? true : false;
	this._nativeType = (options.numeric) ? Number : String;
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;pluck&#x27;];
	this._properties = [&#x27;ops&#x27;, &#x27;numeric&#x27;];
	if (typeof options.options === &#x27;string&#x27;) {
		options.options = options.options.split(&#x27;,&#x27;);
	}
	if (!Array.isArray(options.options)) {
		throw new Error(&#x27;Select fields require an options array.&#x27;);
	}
	this.ops = options.options.map(function (i) {
		var op = typeof i === &#x27;string&#x27; ? { value: i.trim(), label: utils.keyToLabel(i) } : i;
		if (!_.isObject(op)) {
			op = { label: &#x27;&#x27; + i, value: &#x27;&#x27; + i };
		}
		if (options.numeric &#x26;&#x26; !_.isNumber(op.value)) {
			op.value = Number(op.value);
		}
		return op;
	});
	// undefined options.emptyOption defaults to true
	if (options.emptyOption === undefined) {
		options.emptyOption = true;
	}
	// ensure this.emptyOption is a boolean
	this.emptyOption = !!options.emptyOption;
	// cached maps for options, labels and values
	this.map = utils.optionsMap(this.ops);
	this.labels = utils.optionsMap(this.ops, &#x27;label&#x27;);
	this.values = _.map(this.ops, &#x27;value&#x27;);
	select.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Text" id="apidoc.element.keystone.Field.Types.Text">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Text
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function text(list, path, options) {
	this.options = options;
	this._nativeType = String;
	this._properties = [&#x27;monospace&#x27;];
	this._underscoreMethods = [&#x27;crop&#x27;];
	text.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.TextArray" id="apidoc.element.keystone.Field.Types.TextArray">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>TextArray
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function textarray(list, path, options) {
	this._nativeType = [String];
	this._underscoreMethods = [&#x27;format&#x27;];
	this.separator = options.separator || &#x27; | &#x27;;
	textarray.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Textarea" id="apidoc.element.keystone.Field.Types.Textarea">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Textarea
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function textarea(list, path, options) {
	this._nativeType = String;
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;crop&#x27;];
	this.height = options.height || 90;
	this.multiline = true;
	this._properties = [&#x27;height&#x27;, &#x27;multiline&#x27;];
	textarea.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Url" id="apidoc.element.keystone.Field.Types.Url">
        function <span class="apidocSignatureSpan">keystone.Field.Types.</span>Url
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function url(list, path, options) {
	this._nativeType = String;
	this._underscoreMethods = [&#x27;format&#x27;];
	url.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.AzureFile.prototype" id="apidoc.module.keystone.Field.Types.AzureFile.prototype">module keystone.Field.Types.AzureFile.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.AzureFile.prototype.addToSchema" id="apidoc.element.keystone.Field.Types.AzureFile.prototype.addToSchema">
        function <span class="apidocSignatureSpan">keystone.Field.Types.AzureFile.prototype.</span>addToSchema
        <span class="apidocSignatureSpan">(schema)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addToSchema = function (schema) {

	var azure = require(&#x27;azure-storage&#x27;);

	var field = this;

	var paths = this.paths = {
		// fields
		filename: this.path + &#x27;.filename&#x27;,
		path: this.path + &#x27;.path&#x27;,
		size: this.path + &#x27;.size&#x27;,
		filetype: this.path + &#x27;.filetype&#x27;,
		url: this.path + &#x27;.url&#x27;,
		etag: this.path + &#x27;.etag&#x27;,
		container: this.path + &#x27;.container&#x27;,
		// virtuals
		exists: this.path + &#x27;.exists&#x27;,
		upload: this.path + &#x27;_upload&#x27;,
		action: this.path + &#x27;_action&#x27;,
	};

	var schemaPaths = this._path.addTo({}, {
		filename: String,
		path: String,
		size: Number,
		filetype: String,
		url: String,
		etag: String,
		container: String,
	});

	schema.add(schemaPaths);

	var exists = function (item) {
		return (item.get(paths.url) ? true : false);
	};

	// The .exists virtual indicates whether a file is stored
	schema.virtual(paths.exists).get(function () {
		return schemaMethods.exists.apply(this);
	});

	var reset = function (item) {
		item.set(field.path, {
			filename: &#x27;&#x27;,
			path: &#x27;&#x27;,
			size: 0,
			filetype: &#x27;&#x27;,
			url: &#x27;&#x27;,
		});
	};

	var schemaMethods = {
		exists: function () {
			return exists(this);
		},
		<span class="apidocCodeCommentSpan">/**
		 * Resets the value of the field
		 *
		 * @api public
		 */
</span>		reset: function () {
			try {
				azure.createBlobService().deleteBlob(this.get(paths.container), this.get(paths.filename), function () {});
			} catch (e) {} // eslint-disable-line no-empty
			reset(this);
		},
		/**
		 * Deletes the file from AzureFile and resets the field
		 *
		 * @api public
		 */
		delete: function () {
			try {
				azure.createBlobService().blobService.deleteBlob(this.get(paths.container), this.get(paths.filename), function () {});
			} catch (e) {} // eslint-disable-line no-empty
			reset(this);
		},
	};

	_.forEach(schemaMethods, function (fn, key) {
		field.underscoreMethod(key, fn);
	});

	// expose a method on the field to call schema methods
	this.apply = function (item, method) {
		return schemaMethods[method].apply(item, Array.prototype.slice.call(arguments, 2));
	};

	this.bindUnderscoreMethods();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.AzureFile.prototype.format" id="apidoc.element.keystone.Field.Types.AzureFile.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.AzureFile.prototype.</span>format
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item) {
	return item.get(this.paths.url);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.AzureFile.prototype.getRequestHandler" id="apidoc.element.keystone.Field.Types.AzureFile.prototype.getRequestHandler">
        function <span class="apidocSignatureSpan">keystone.Field.Types.AzureFile.prototype.</span>getRequestHandler
        <span class="apidocSignatureSpan">(item, req, paths, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getRequestHandler = function (item, req, paths, callback) {

	var field = this;

	if (utils.isFunction(paths)) {
		callback = paths;
		paths = field.paths;
	} else if (!paths) {
		paths = field.paths;
	}

	callback = callback || function () {};

	return function () {
		if (req.body) {
			var action = req.body[paths.action];

			if (/^(delete|reset)$/.test(action)) {
				field.apply(item, action);
			}
		}

		if (req.files &#x26;&#x26; req.files[paths.upload] &#x26;&#x26; req.files[paths.upload].size) {
			return field.uploadFile(item, req.files[paths.upload], true, callback);
		}

		return callback();

	};

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.AzureFile.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.AzureFile.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.AzureFile.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data) { // eslint-disable-line no-unused-vars
	// TODO - how should file field input be validated?
	return true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.AzureFile.prototype.isModified" id="apidoc.element.keystone.Field.Types.AzureFile.prototype.isModified">
        function <span class="apidocSignatureSpan">keystone.Field.Types.AzureFile.prototype.</span>isModified
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isModified = function (item) {
	return item.isModified(this.paths.url);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var modified = false;
		var incomplete = false;
		var values = [];

		autokey.from.forEach(function (ops) {
			if (list.fields[ops.path]) {
				values.push(list.fields[ops.path].format(this, ops.format));
				if (list.fields[ops.path].<span class="apidocCodeKeywordSpan">isModified</span>(this)) {
					modified = true;
				}
				// if source field is neither selected nor modified we don&#x27;t have a way to generate a complete autokey
				else if (!this.isSelected(ops.path)) {
					incomplete = true;
				}
			} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.AzureFile.prototype.updateItem" id="apidoc.element.keystone.Field.Types.AzureFile.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.AzureFile.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {
	// TODO - direct updating of data (not via upload)
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.AzureFile.prototype.uploadFile" id="apidoc.element.keystone.Field.Types.AzureFile.prototype.uploadFile">
        function <span class="apidocSignatureSpan">keystone.Field.Types.AzureFile.prototype.</span>uploadFile
        <span class="apidocSignatureSpan">(item, file, update, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">uploadFile = function (item, file, update, callback) {

	var azure = require(&#x27;azure-storage&#x27;);

	var field = this;
	var filetype = file.mimetype || file.type;

	if (field.options.allowedTypes &#x26;&#x26; !_.contains(field.options.allowedTypes, filetype)) {
		return callback(new Error(&#x27;Unsupported File Type: &#x27; + filetype));
	}

	if (typeof update === &#x27;function&#x27;) {
		callback = update;
		update = false;
	}

	var doUpload = function () {
		var blobService = azure.createBlobService();
		var container = field.options.containerFormatter(item, file.name);

		blobService.createContainerIfNotExists(container, { publicAccessLevel: &#x27;blob&#x27; }, function (err) {

			if (err) return callback(err);

			blobService.createBlockBlobFromLocalFile(container, field.options.filenameFormatter(item, file.name), file.path, function (err
, blob, res) {

				if (err) return callback(err);

				var fileData = {
					filename: blob.blob,
					size: file.size,
					filetype: filetype,
					etag: blob.etag,
					container: container,
					url: &#x27;http://&#x27; + field.azurefileconfig.account + &#x27;.blob.core.windows.net/&#x27; + container + &#x27;/&#x27; + blob.blob,
				};

				if (update) {
					item.set(field.path, fileData);
				}

				callback(null, fileData);

			});
		});
	};

	this.callHook(&#x27;pre:upload&#x27;, item, file, function (err) {
		if (err) return callback(err);
		doUpload();
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

			if (/^(delete|reset)$/.test(action)) {
				field.apply(item, action);
			}
		}

		if (req.files &#x26;&#x26; req.files[paths.upload] &#x26;&#x26; req.files[paths.upload].size) {
			return field.<span class="apidocCodeKeywordSpan">uploadFile</span>(item, req.files[paths.upload], true, callback);
		}

		return callback();

	};

};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Boolean.prototype" id="apidoc.module.keystone.Field.Types.Boolean.prototype">module keystone.Field.Types.Boolean.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Boolean.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Boolean.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Boolean.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	if (!filter.value || filter.value === &#x27;false&#x27;) {
		query[this.path] = { $ne: true };
	} else {
		query[this.path] = true;
	}
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Boolean.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.Boolean.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Boolean.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data, required)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data, required) {
	if (required) {
		return (data[this.path] === true || data[this.path] === &#x27;true&#x27;) ? true : false;
	} else {
		return true;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Boolean.prototype.updateItem" id="apidoc.element.keystone.Field.Types.Boolean.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Boolean.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {
	var value = this.getValueFromData(data);
	if (typeof value === &#x27;undefined&#x27;) {
		return process.nextTick(callback);
	}
	if (!value || value === &#x27;false&#x27;) {
		if (item.get(this.path) !== false) {
			item.set(this.path, false);
		}
	} else if (!item.get(this.path)) {
		item.set(this.path, true);
	}
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Boolean.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Boolean.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Boolean.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var value = this.getValueFromData(data);
	var result = true;
	if (value !== undefined
		&#x26;&#x26; value !== null
		&#x26;&#x26; typeof value !== &#x27;string&#x27;
		&#x26;&#x26; typeof value !== &#x27;number&#x27;
		&#x26;&#x26; typeof value !== &#x27;boolean&#x27;) {
		result = false;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Boolean.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Boolean.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Boolean.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = (value &#x26;&#x26; value !== &#x27;false&#x27;) || item.get(this.path) ? true : false;
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.CloudinaryImage.prototype" id="apidoc.module.keystone.Field.Types.CloudinaryImage.prototype">module keystone.Field.Types.CloudinaryImage.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.addToSchema" id="apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.addToSchema">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>addToSchema
        <span class="apidocSignatureSpan">(schema)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addToSchema = function (schema) {

	var cloudinary = require(&#x27;cloudinary&#x27;);

	var field = this;

	var paths = this.paths = {
		// cloudinary fields
		public_id: this.path + &#x27;.public_id&#x27;,
		version: this.path + &#x27;.version&#x27;,
		signature: this.path + &#x27;.signature&#x27;,
		format: this.path + &#x27;.format&#x27;,
		resource_type: this.path + &#x27;.resource_type&#x27;,
		url: this.path + &#x27;.url&#x27;,
		width: this.path + &#x27;.width&#x27;,
		height: this.path + &#x27;.height&#x27;,
		secure_url: this.path + &#x27;.secure_url&#x27;,
		// virtuals
		exists: this.path + &#x27;.exists&#x27;,
		folder: this.path + &#x27;.folder&#x27;,
		// form paths
		select: this.path + &#x27;_select&#x27;,
	};

	var schemaPaths = this._path.addTo({}, {
		public_id: String,
		version: Number,
		signature: String,
		format: String,
		resource_type: String,
		url: String,
		width: Number,
		height: Number,
		secure_url: String,
	});

	schema.add(schemaPaths);

	var exists = function (item) {
		return (item.get(paths.public_id) ? true : false);
	};

	// The .exists virtual indicates whether an image is stored
	schema.virtual(paths.exists).get(function () {
		return schemaMethods.exists.apply(this);
	});

	// The .folder virtual returns the cloudinary folder used to upload/select images
	schema.virtual(paths.folder).get(function () {
		return schemaMethods.folder.apply(this);
	});

	var src = function (item, options) {
		if (!exists(item)) {
			return &#x27;&#x27;;
		}
		options = (typeof options === &#x27;object&#x27;) ? options : {};
		if (!(&#x27;fetch_format&#x27; in options) &#x26;&#x26; keystone.get(&#x27;cloudinary webp&#x27;) !== false) {
			options.fetch_format = &#x27;auto&#x27;;
		}
		if (!(&#x27;progressive&#x27; in options) &#x26;&#x26; keystone.get(&#x27;cloudinary progressive&#x27;) !== false) {
			options.progressive = true;
		}
		if (!(&#x27;secure&#x27; in options) &#x26;&#x26; keystone.get(&#x27;cloudinary secure&#x27;)) {
			options.secure = true;
		}
		options.version = item.get(paths.version);
		options.format = options.format || item.get(paths.format);

		return cloudinary.url(item.get(paths.public_id), options);
	};

	var reset = function (item) {
		item.set(field.path, getEmptyValue());
	};

	var addSize = function (options, width, height, other) {
		if (width) options.width = width;
		if (height) options.height = height;
		if (typeof other === &#x27;object&#x27;) {
			assign(options, other);
		}
		return options;
	};

	var schemaMethods = {
		exists: function () {
			return exists(this);
		},
		folder: function () {
			return field.getFolder();
		},
		src: function (options) {
			return src(this, options);
		},
		tag: function (options) {
			return exists(this) ? cloudinary.image(this.get(field.path).public_id, options) : &#x27;&#x27;;
		},
		scale: function (width, height, options) {
			return src(this, addSize({ crop: &#x27;scale&#x27; }, width, height, options));
		},
		fill: function (width, height, options) {
			return src(this, addSize({ crop: &#x27;fill&#x27;, gravity: &#x27;faces&#x27; }, width, height, options));
		},
		lfill: function (width, height, options) {
			return src(this, addSize({ crop: &#x27;lfill&#x27;, gravity: &#x27;faces&#x27; }, width, height, options));
		},
		fit: function (width, height, options) {
			return src(this, addSize({ crop: &#x27;fit&#x27; }, width, height, options));
		},
		limit: function (width, height, options) {
			return src(this, addSize({ crop: &#x27;limit&#x27; }, width, height, options));
		},
		pad: function (width, height, options) {
			return src(this, addSize({ crop: &#x27;pad&#x27; }, width, height, options));
		},
		lpad: function (width, height, options) {
			return src(this, addSize({ crop: &#x27;lpad&#x27; }, width, height, options));
		},
		crop: function (width, height, options) {
			return src(this, addSize({ crop: &#x27;crop&#x27;, gravity: &#x27;faces&#x27; }, width, height, options));
		},
		thumbnail: function (width, height, options) {
			return src(this, addSize({ crop: &#x27;thumb&#x27;, gravity: &#x27;faces&#x27; }, width, height, options));
		},
		<span class="apidocCodeCommentSpan">/**
		 * Resets the value of the field
		 *
		 * @api public
		 */
</span>		reset: function () {
			reset(this);
		},
		/**
		 * Deletes the image from Cloudinary and resets the field
		 *
		 * @api public
		 */
		delete: function () {
			var _this = this;
			var promise = new Promise(function (resolve) {
				cloudinary.uploader.destroy(_this.get(paths.public_id), function (result) { ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.fileExists" id="apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.fileExists">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>fileExists
        <span class="apidocSignatureSpan">(filename, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">fileExists = function (filename, callback) {
	var cloudinary = require(&#x27;cloudinary&#x27;);
	cloudinary.api.resource(filename, function (result) {
		if (result.error &#x26;&#x26; result.error.http_code === 404) {
			// File doesn&#x27;t exist
			callback(null, false);
		} else if (result.error) {
			// Error
			callback(result.error, null);
		} else {
			// File exists
			callback(null, true);
		}
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.format" id="apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>format
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item) {
	return item.get(this.paths.url);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.getData" id="apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.getData">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>getData
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getData = function (item) {
	var value = item.get(this.path);
	return typeof value === &#x27;object&#x27; ? value : {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					process.exit(1);
				}
			}
			break;
		case &#x27;module root&#x27;:
			// if relative path is used, resolve it based on the caller&#x27;s path
			if (!isAbsolutePath(value)) {
				var caller = callerId.<span class="apidocCodeKeywordSpan">getData</span>();
				value = path.resolve(path.dirname(caller.filePath), value);
			}
			break;
		case &#x27;app&#x27;:
			this.app = value;
			break;
		case &#x27;mongoose&#x27;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.getFilename" id="apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.getFilename">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>getFilename
        <span class="apidocSignatureSpan">(file, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getFilename = function (file, callback) {
	var self = this;
	switch (self.options.whenExists) {
		case &#x27;overwrite&#x27;:
			self.options.generateFilename(file, 0, callback);
			break;
		case &#x27;error&#x27;:
			self.options.generateFilename(file, 0, function (err, filename) {
				if (err) return callback(err);
				self.fileExists(filename, function (err, result) {
					if (err) return callback(err);
					if (result === true) return callback(Error(&#x27;File already exists&#x27;));
					callback(null, filename);
				});
			});
			break;
		case &#x27;retry&#x27;:
			self.retryFilename(0, file, callback);
			break;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

		return _react2.default.createElement(
			&#x27;div&#x27;,
			null,
			this.hasImage() ? _react2.default.createElement(
				_FileChangeMessage2.default,
				null,
				this.<span class="apidocCodeKeywordSpan">getFilename</span>()
			) : null,
			showChangeMessage &#x26;&#x26; this.renderChangeMessage()
		);
	},
	renderChangeMessage: function renderChangeMessage() {
		if (this.state.userSelectedFile) {
			return _react2.default.createElement(
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.getFolder" id="apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.getFolder">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>getFolder
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getFolder = function () {
	var folder = null;
	if (keystone.get(&#x27;cloudinary folders&#x27;) || this.options.folder) {
		if (typeof this.options.folder === &#x27;string&#x27;) {
			folder = this.options.folder;
		} else {
			var folderList = keystone.get(&#x27;cloudinary prefix&#x27;) ? [keystone.get(&#x27;cloudinary prefix&#x27;)] : [];
			folderList.push(this.list.path);
			folderList.push(this.path);
			folder = folderList.join(&#x27;/&#x27;);
		}
	}
	return folder;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	};

	var schemaMethods = {
		exists: function () {
			return exists(this);
		},
		folder: function () {
			return field.<span class="apidocCodeKeywordSpan">getFolder</span>();
		},
		src: function (options) {
			return src(this, options);
		},
		tag: function (options) {
			return exists(this) ? cloudinary.image(this.get(field.path).public_id, options) : &#x27;&#x27;;
		},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.getRequestHandler" id="apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.getRequestHandler">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>getRequestHandler
        <span class="apidocSignatureSpan">(item, req, paths, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getRequestHandler = function (item, req, paths, callback) {

	var cloudinary = require(&#x27;cloudinary&#x27;);
	var field = this;
	if (utils.isFunction(paths)) {
		callback = paths;
		paths = field.paths;
	} else if (!paths) {
		paths = field.paths;
	}
	callback = callback || function () {};

	return function () {
		if (req.body) {
			var action = req.body[paths.action];
			if (/^(delete|reset)$/.test(action)) {
				field.apply(item, action);
			}
		}
		if (req.body &#x26;&#x26; req.body[paths.select]) {
			cloudinary.api.resource(req.body[paths.select], function (result) {
				if (result.error) {
					callback(result.error);
				} else {
					item.set(field.path, result);
					callback();
				}
			});
		} else if (req.files &#x26;&#x26; req.files[paths.upload] &#x26;&#x26; req.files[paths.upload].size) {
			var tp = keystone.get(&#x27;cloudinary prefix&#x27;) || &#x27;&#x27;;
			var imageDelete;
			if (tp.length) {
				tp += &#x27;_&#x27;;
			}
			var uploadOptions = {
				tags: [tp + field.list.path + &#x27;_&#x27; + field.path, tp + field.list.path + &#x27;_&#x27; + field.path + &#x27;_&#x27; + item.id],
			};
			if (keystone.get(&#x27;cloudinary folders&#x27;)) {
				uploadOptions.folder = item.get(paths.folder);
			}
			if (keystone.get(&#x27;cloudinary prefix&#x27;)) {
				uploadOptions.tags.push(keystone.get(&#x27;cloudinary prefix&#x27;));
			}
			if (keystone.get(&#x27;env&#x27;) !== &#x27;production&#x27;) {
				uploadOptions.tags.push(tp + &#x27;dev&#x27;);
			}
			if (field.options.publicID) {
				var publicIdValue = item.get(field.options.publicID);
				if (publicIdValue) {
					uploadOptions.public_id = publicIdValue;
				}
			} else if (field.options.filenameAsPublicID) {
				uploadOptions.public_id = req.files[paths.upload].originalname.substring(0, req.files[paths.upload].originalname.lastIndexOf
(&#x27;.&#x27;));
			}

			if (field.options.autoCleanup &#x26;&#x26; item.get(field.paths.exists)) {
				// capture image delete promise
				imageDelete = field.apply(item, &#x27;delete&#x27;);
			}

			// callback to be called upon completion of the &#x27;upload&#x27; method
			var uploadComplete = function (result) {
				if (result.error) {
					callback(result.error);
				} else {
					item.set(field.path, result);
					callback();
				}
			};

			// upload immediately if image is not being delete
			if (typeof imageDelete === &#x27;undefined&#x27;) {
				field.apply(item, &#x27;upload&#x27;, req.files[paths.upload].path, uploadOptions).then(uploadComplete);
			} else {
				// otherwise wait until image is deleted before uploading
				// this avoids problems when deleting/uploading images with the same public_id (issue #598)
				imageDelete.then(function (result) {
					if (result.error) {
						callback(result.error);
					} else {
						field.apply(item, &#x27;upload&#x27;, req.files[paths.upload].path, uploadOptions).then(uploadComplete);
					}
				});
			}
		} else {
			callback();
		}
	};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function () {
	return true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.isModified" id="apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.isModified">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>isModified
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isModified = function (item) {
	return item.isModified(this.paths.public_id);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var modified = false;
		var incomplete = false;
		var values = [];

		autokey.from.forEach(function (ops) {
			if (list.fields[ops.path]) {
				values.push(list.fields[ops.path].format(this, ops.format));
				if (list.fields[ops.path].<span class="apidocCodeKeywordSpan">isModified</span>(this)) {
					modified = true;
				}
				// if source field is neither selected nor modified we don&#x27;t have a way to generate a complete autokey
				else if (!this.isSelected(ops.path)) {
					incomplete = true;
				}
			} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.retryFilename" id="apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.retryFilename">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>retryFilename
        <span class="apidocSignatureSpan">(attempt, file, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">retryFilename = function (attempt, file, callback) {
	var self = this;
	if (attempt &#x3e; self.options.retryAttempts) {
		return callback(Error(&#x27;Unique filename could not be generated; Maximum attempts exceeded&#x27;));
	}
	self.options.generateFilename(file, attempt, function (err, filename) {
		if (err) return callback(err);
		self.fileExists(filename, function (err, exists) {
			if (err) return callback(err);
			if (exists) return self.retryFilename(attempt + 1, file, callback);
			callback(null, filename);
		});
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.updateItem" id="apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, files, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, files, callback) {
	// Process arguments
	if (typeof files === &#x27;function&#x27;) {
		callback = files;
		files = {};
	}
	if (!files) {
		files = {};
	}

	var cloudinary = require(&#x27;cloudinary&#x27;);
	var field = this;

	// Prepare values
	var value = this.getValueFromData(data);
	var uploadedFile;

	// Providing the string &#x22;remove&#x22; removes the file and resets the field
	if (value === &#x27;remove&#x27;) {
		cloudinary.uploader.destroy(item.get(field.paths.public_id), function (result) {
			if (result.error) {
				callback(result.error);
			} else {
				item.set(field.path, getEmptyValue());
				callback();
			}
		});
		return;
	}

	// Find an uploaded file in the files argument, either referenced in the
	// data argument or named with the field path / field_upload path + suffix
	// Base64 data and remote URLs are also accepted as images to upload
	if (typeof value === &#x27;string&#x27; &#x26;&#x26; value.substr(0, 7) === &#x27;upload:&#x27;) {
		uploadedFile = files[value.substr(7)];
	} else if (typeof value === &#x27;string&#x27; &#x26;&#x26; /^(data:[a-z\/]+;base64)|(https?\:\/\/)/.test(value)) {
		uploadedFile = { path: value };
	} else {
		uploadedFile = this.getValueFromData(files) || this.getValueFromData(files, &#x27;_upload&#x27;);
	}

	// Ensure a valid file was uploaded, else null out the value
	if (uploadedFile &#x26;&#x26; !uploadedFile.path) {
		uploadedFile = undefined;
	}

	// If we have a file to upload, we do that and stop here
	if (uploadedFile) {
		var tagPrefix = keystone.get(&#x27;cloudinary prefix&#x27;) || &#x27;&#x27;;
		var uploadOptions = {
			tags: [],
		};
		if (tagPrefix.length) {
			uploadOptions.tags.push(tagPrefix);
			tagPrefix += &#x27;_&#x27;;
		}
		uploadOptions.tags.push(tagPrefix + field.list.path + &#x27;_&#x27; + field.path);
		if (keystone.get(&#x27;env&#x27;) !== &#x27;production&#x27;) {
			uploadOptions.tags.push(tagPrefix + &#x27;dev&#x27;);
		}
		var folder = this.getFolder();
		if (folder) {
			uploadOptions.folder = folder;
		}
		this.getFilename(uploadedFile, function (err, filename) {
			if (err) return callback(err);
			// If an undefined filename is returned, Cloudinary will automatically generate a unique
			//   filename. Therefore undefined is a valid filename value.
			if (filename !== undefined) {
				filename = sanitize(filename);
				uploadOptions.public_id = trimSupportedFileExtensions(filename);
			}
			// TODO: implement autoCleanup; should delete existing images before uploading
			cloudinary.uploader.upload(uploadedFile.path, function (result) {
				if (result.error) {
					return callback(result.error);
				} else {
					item.set(field.path, result);
					return callback();
				}
			}, uploadOptions);
		});

		return;
	}

	// Empty / null values reset the field
	if (value === null || value === &#x27;&#x27; || (typeof value === &#x27;object&#x27; &#x26;&#x26; !Object.keys(value).length)) {
		value = getEmptyValue();
	}

	// If there is a valid value at this point, set it on the field
	if (typeof value === &#x27;object&#x27;) {
		item.set(this.path, value);
	}
	utils.defer(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.validateInput" id="apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var value = this.getValueFromData(data);
	var result = validateInput(value);
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.CloudinaryImage.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImage.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	// TODO: We need to also get the `files` argument, so we can check for
	// uploaded files. without it, this will return false negatives so we
	// can&#x27;t actually validate required input at the moment.
	var result = true;
	// var value = this.getValueFromData(data);
	// var result = (value || item.get(this.path).public_id) ? true : false;
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.CloudinaryImages.prototype" id="apidoc.module.keystone.Field.Types.CloudinaryImages.prototype">module keystone.Field.Types.CloudinaryImages.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImages.prototype.addToSchema" id="apidoc.element.keystone.Field.Types.CloudinaryImages.prototype.addToSchema">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImages.prototype.</span>addToSchema
        <span class="apidocSignatureSpan">(schema)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addToSchema = function (schema) {

	var cloudinary = require(&#x27;cloudinary&#x27;);
	var mongoose = keystone.mongoose;
	var field = this;

	this.paths = {
		// virtuals
		folder: this.path + &#x27;.folder&#x27;,
		// form paths
		upload: this.path + &#x27;_upload&#x27;,
		uploads: this.path + &#x27;_uploads&#x27;,
		action: this.path + &#x27;_action&#x27;,
	};

	var ImageSchema = new mongoose.Schema({
		public_id: String,
		version: Number,
		signature: String,
		format: String,
		resource_type: String,
		url: String,
		width: Number,
		height: Number,
		secure_url: String,
	});

	// Generate cloudinary folder used to upload/select images
	var folder = function (item) { // eslint-disable-line no-unused-vars
		var folderValue = &#x27;&#x27;;

		if (keystone.get(&#x27;cloudinary folders&#x27;)) {
			if (field.options.folder) {
				folderValue = field.options.folder;
			} else {
				var folderList = keystone.get(&#x27;cloudinary prefix&#x27;) ? [keystone.get(&#x27;cloudinary prefix&#x27;)] : [];
				folderList.push(field.list.path);
				folderList.push(field.path);
				folderValue = folderList.join(&#x27;/&#x27;);
			}
		}

		return folderValue;
	};

	// The .folder virtual returns the cloudinary folder used to upload/select images
	schema.virtual(field.paths.folder).get(function () {
		return folder(this);
	});

	var src = function (img, options) {
		if (keystone.get(&#x27;cloudinary secure&#x27;)) {
			options = options || {};
			options.secure = true;
		}
		options.format = options.format || img.format;
		return img.public_id ? cloudinary.url(img.public_id, options) : &#x27;&#x27;;
	};

	var addSize = function (options, width, height, other) {
		if (width) options.width = width;
		if (height) options.height = height;
		if (typeof other === &#x27;object&#x27;) {
			assign(options, other);
		}
		return options;
	};
	ImageSchema.method(&#x27;src&#x27;, function (options) {
		return src(this, options);
	});
	ImageSchema.method(&#x27;scale&#x27;, function (width, height, options) {
		return src(this, addSize({ crop: &#x27;scale&#x27; }, width, height, options));
	});
	ImageSchema.method(&#x27;fill&#x27;, function (width, height, options) {
		return src(this, addSize({ crop: &#x27;fill&#x27;, gravity: &#x27;faces&#x27; }, width, height, options));
	});
	ImageSchema.method(&#x27;lfill&#x27;, function (width, height, options) {
		return src(this, addSize({ crop: &#x27;lfill&#x27;, gravity: &#x27;faces&#x27; }, width, height, options));
	});
	ImageSchema.method(&#x27;fit&#x27;, function (width, height, options) {
		return src(this, addSize({ crop: &#x27;fit&#x27; }, width, height, options));
	});
	ImageSchema.method(&#x27;limit&#x27;, function (width, height, options) {
		return src(this, addSize({ crop: &#x27;limit&#x27; }, width, height, options));
	});
	ImageSchema.method(&#x27;pad&#x27;, function (width, height, options) {
		return src(this, addSize({ crop: &#x27;pad&#x27; }, width, height, options));
	});
	ImageSchema.method(&#x27;lpad&#x27;, function (width, height, options) {
		return src(this, addSize({ crop: &#x27;lpad&#x27; }, width, height, options));
	});
	ImageSchema.method(&#x27;crop&#x27;, function (width, height, options) {
		return src(this, addSize({ crop: &#x27;crop&#x27;, gravity: &#x27;faces&#x27; }, width, height, options));
	});
	ImageSchema.method(&#x27;thumbnail&#x27;, function (width, height, options) {
		return src(this, addSize({ crop: &#x27;thumb&#x27;, gravity: &#x27;faces&#x27; }, width, height, options));
	});

	schema.add(this._path.addTo({}, [ImageSchema]));

	this.removeImage = function (item, id, method, callback) {
		var images = item.get(field.path);
		if (typeof id !== &#x27;number&#x27;) {
			for (var i = 0; i &#x3c; images.length; i++) {
				if (images[i].public_id === id) {
					id = i;
					break;
				}
			}
		}
		var img = images[id];
		if (!img) return;
		if (method === &#x27;delete&#x27;) {
			cloudinary.uploader.destroy(img.public_id, function () {});
		}
		images.splice(id, 1);
		if (callback) {
			item.save((typeof callback !== &#x27;function&#x27;) ? callback : undefined);
		}
	};
	this.underscoreMethod(&#x27;remove&#x27;, function (id, callback) {
		field.removeImage(this, id, &#x27;remove&#x27;, callback);
	});
	this.underscoreMethod(&#x27;delete&#x27;, function (id, callback) {
		field.removeImage(this, id, &#x27;delete&#x27;, callback);
	});
	this.bindUnderscoreMethods();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImages.prototype.format" id="apidoc.element.keystone.Field.Types.CloudinaryImages.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImages.prototype.</span>format
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item) {
	return _.map(item.get(this.path), function (img) {
		return img.src();
	}).join(&#x27;, &#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImages.prototype.getData" id="apidoc.element.keystone.Field.Types.CloudinaryImages.prototype.getData">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImages.prototype.</span>getData
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getData = function (item) {
	var value = item.get(this.path);
	return Array.isArray(value) ? value : [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					process.exit(1);
				}
			}
			break;
		case &#x27;module root&#x27;:
			// if relative path is used, resolve it based on the caller&#x27;s path
			if (!isAbsolutePath(value)) {
				var caller = callerId.<span class="apidocCodeKeywordSpan">getData</span>();
				value = path.resolve(path.dirname(caller.filePath), value);
			}
			break;
		case &#x27;app&#x27;:
			this.app = value;
			break;
		case &#x27;mongoose&#x27;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImages.prototype.getFolder" id="apidoc.element.keystone.Field.Types.CloudinaryImages.prototype.getFolder">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImages.prototype.</span>getFolder
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getFolder = function () {
	var folder = null;

	if (keystone.get(&#x27;cloudinary folders&#x27;) || this.options.folder) {
		if (typeof this.options.folder === &#x27;string&#x27;) {
			folder = this.options.folder;
		} else {
			folder = this.list.path + &#x27;/&#x27; + this.path;
		}
	}

	return folder;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	};

	var schemaMethods = {
		exists: function () {
			return exists(this);
		},
		folder: function () {
			return field.<span class="apidocCodeKeywordSpan">getFolder</span>();
		},
		src: function (options) {
			return src(this, options);
		},
		tag: function (options) {
			return exists(this) ? cloudinary.image(this.get(field.path).public_id, options) : &#x27;&#x27;;
		},
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImages.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.CloudinaryImages.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImages.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data) { // eslint-disable-line no-unused-vars
	// TODO - how should image field input be validated?
	return true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.CloudinaryImages.prototype.updateItem" id="apidoc.element.keystone.Field.Types.CloudinaryImages.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.CloudinaryImages.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, files, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, files, callback) {
	if (typeof files === &#x27;function&#x27;) {
		callback = files;
		files = {};
	} else if (!files) {
		files = {};
	}

	var cloudinary = require(&#x27;cloudinary&#x27;);
	var field = this;
	var values = this.getValueFromData(data);

	// TODO: This logic needs to block uploading of files from the data argument,
	// see CloudinaryImage for a reference on how it should be implemented

	// Early exit path: reset value when falsy, or bail if no value was provided
	if (!values) {
		if (values !== undefined) {
			item.set(field.path, []);
		}
		return process.nextTick(callback);
	}

	// When the value exists, but isn&#x27;t an array, turn it into one (this just
	// means a single field was submitted in the formdata)
	if (!Array.isArray(values)) {
		values = [values];
	}

	// We cache options to avoid recalculating them on each iteration in the map below
	var cachedUploadOptions;
	function getUploadOptions () {
		if (cachedUploadOptions) {
			return cachedUploadOptions;
		}
		var tagPrefix = keystone.get(&#x27;cloudinary prefix&#x27;) || &#x27;&#x27;;
		var uploadOptions = {
			tags: [],
		};
		if (tagPrefix.length) {
			uploadOptions.tags.push(tagPrefix);
			tagPrefix += &#x27;_&#x27;;
		}
		uploadOptions.tags.push(tagPrefix + field.list.path + &#x27;_&#x27; + field.path);
		if (keystone.get(&#x27;env&#x27;) !== &#x27;production&#x27;) {
			uploadOptions.tags.push(tagPrefix + &#x27;dev&#x27;);
		}
		var folder = field.getFolder();
		if (folder) {
			uploadOptions.folder = folder;
		}
		cachedUploadOptions = uploadOptions;
		return uploadOptions;
	}

	// Preprocess values to deserialise JSON, detect mappings to uploaded files
	// and flatten out arrays
	values = values.map(function (value) {
		// When the value is a string, it may be JSON serialised data.
		if (typeof value === &#x27;string&#x27;
			&#x26;&#x26; value.charAt(0) === &#x27;{&#x27;
			&#x26;&#x26; value.charAt(value.length - 1) === &#x27;}&#x27;
		) {
			try {
				return JSON.parse(value);
			} catch (e) { /* value isn&#x27;t JSON */ }
		}
		if (typeof value === &#x27;string&#x27;) {
			// detect file upload (field value must be a reference to a field in the
			// uploaded files object provided by multer)
			if (value.substr(0, 7) === &#x27;upload:&#x27;) {
				var uploadFieldPath = value.substr(7);
				return files[uploadFieldPath];
			}
			// detect a URL or Base64 Data
			else if (/^(data:[a-z\/]+;base64)|(https?\:\/\/)/.test(value)) {
				return { path: value };
			}
		}
		return value;
	});
	values = _.flatten(values);

	async.map(values, function (value, next) {
		if (typeof value === &#x27;object&#x27; &#x26;&#x26; &#x27;public_id&#x27; in value) {
			// Cloudinary Image data provided
			if (value.public_id) {
				// Default the object with empty values
				var v = assign(getEmptyValue(), value);
				return next(null, v);
			} else {
				// public_id is falsy, remove the value
				return next();
			}
		} else if (typeof value === &#x27;object&#x27; &#x26;&#x26; value.path) {
			// File provided - upload it
			var uploadOptions = getUploadOptions();
			// NOTE: field.options.publicID has been deprecated (tbc)
			if (field.options.filenameAsPublicID &#x26;&#x26; value.originalname &#x26;&#x26; typeof value.originalname === &#x27;string&#x27;) {
				uploadOptions = assign({}, uploadOptions, {
					public_id: value.originalname.substring(0, value.originalname.lastIndexOf(&#x27;.&#x27;)),
				});
			}
			// TODO: implement autoCleanup; should delete existing images before uploading
			cloudinary.uploader.upload(value.path, function (result) {
				if (result.error) {
					next(result.error);
				} else {
					next(null, result);
				}
			}, uploadOptions);
		} else {
			// Nothing to do
			// TODO: We should really also support deleting images from cloudinary,
			// see the CloudinaryImageType field for reference
			return next();
		}
	}, function (err, result) {
		if (err) return callback(err);
		result = result.filter(truthy);
		item.set(field.path, result);
		return callback();
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Code.prototype" id="apidoc.module.keystone.Field.Types.Code.prototype">module keystone.Field.Types.Code.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Code.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Code.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Code.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	if (filter.mode === &#x27;exactly&#x27; &#x26;&#x26; !filter.value) {
		query[this.path] = filter.inverted ? { $nin: [&#x27;&#x27;, null] } : { $in: [&#x27;&#x27;, null] };
		return query;
	}
	var value = utils.escapeRegExp(filter.value);
	if (filter.mode === &#x27;beginsWith&#x27;) {
		value = &#x27;^&#x27; + value;
	} else if (filter.mode === &#x27;endsWith&#x27;) {
		value = value + &#x27;$&#x27;;
	} else if (filter.mode === &#x27;exactly&#x27;) {
		value = &#x27;^&#x27; + value + &#x27;$&#x27;;
	}
	value = new RegExp(value, filter.caseSensitive ? &#x27;&#x27; : &#x27;i&#x27;);
	query[this.path] = filter.inverted ? { $not: value } : value;
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Code.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Code.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Code.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var max = this.options.max;
	var min = this.options.min;
	var value = this.getValueFromData(data);
	var result = value === undefined || value === null || typeof value === &#x27;string&#x27;;
	if (max &#x26;&#x26; typeof value === &#x27;string&#x27;) {
		result = value.length &#x3c; max;
	}
	if (min &#x26;&#x26; typeof value === &#x27;string&#x27;) {
		result = value.length &#x3e; min;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Code.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Code.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Code.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = !!value;
	if (value === undefined &#x26;&#x26; item.get(this.path)) {
		result = true;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Color.prototype" id="apidoc.module.keystone.Field.Types.Color.prototype">module keystone.Field.Types.Color.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Color.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Color.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Color.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	if (filter.mode === &#x27;exactly&#x27; &#x26;&#x26; !filter.value) {
		query[this.path] = filter.inverted ? { $nin: [&#x27;&#x27;, null] } : { $in: [&#x27;&#x27;, null] };
		return query;
	}
	var value = utils.escapeRegExp(filter.value);
	if (filter.mode === &#x27;beginsWith&#x27;) {
		value = &#x27;^&#x27; + value;
	} else if (filter.mode === &#x27;endsWith&#x27;) {
		value = value + &#x27;$&#x27;;
	} else if (filter.mode === &#x27;exactly&#x27;) {
		value = &#x27;^&#x27; + value + &#x27;$&#x27;;
	}
	value = new RegExp(value, filter.caseSensitive ? &#x27;&#x27; : &#x27;i&#x27;);
	query[this.path] = filter.inverted ? { $not: value } : value;
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Color.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Color.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Color.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var max = this.options.max;
	var min = this.options.min;
	var value = this.getValueFromData(data);
	var result = value === undefined || value === null || typeof value === &#x27;string&#x27;;
	if (max &#x26;&#x26; typeof value === &#x27;string&#x27;) {
		result = value.length &#x3c; max;
	}
	if (min &#x26;&#x26; typeof value === &#x27;string&#x27;) {
		result = value.length &#x3e; min;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Color.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Color.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Color.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = !!value;
	if (value === undefined &#x26;&#x26; item.get(this.path)) {
		result = true;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Date.prototype" id="apidoc.module.keystone.Field.Types.Date.prototype">module keystone.Field.Types.Date.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Date.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Date.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Date.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	if (filter.mode === &#x27;between&#x27;) {
		if (filter.after &#x26;&#x26; filter.before) {
			filter.after = moment(filter.after);
			filter.before = moment(filter.before);
			if (filter.after.isValid() &#x26;&#x26; filter.before.isValid()) {
				query[this.path] = {
					$gte: filter.after.startOf(&#x27;day&#x27;).toDate(),
					$lte: filter.before.endOf(&#x27;day&#x27;).toDate(),
				};
			}
		}
	} else if (filter.value) {
		var day = {
			moment: moment(filter.value),
		};
		day.start = day.moment.startOf(&#x27;day&#x27;).toDate();
		day.end = moment(filter.value).endOf(&#x27;day&#x27;).toDate();
		if (day.moment.isValid()) {
			if (filter.mode === &#x27;after&#x27;) {
				query[this.path] = { $gt: day.end };
			} else if (filter.mode === &#x27;before&#x27;) {
				query[this.path] = { $lt: day.start };
			} else {
				query[this.path] = { $gte: day.start, $lte: day.end };
			}
		}
	}
	if (filter.inverted) {
		query[this.path] = { $not: query[this.path] };
	}
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Date.prototype.format" id="apidoc.element.keystone.Field.Types.Date.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Date.prototype.</span>format
        <span class="apidocSignatureSpan">(item, format)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item, format) {
	if (format || this.formatString) {
		return item.get(this.path) ? this.moment(item).format(format || this.formatString) : &#x27;&#x27;;
	} else {
		return item.get(this.path) || &#x27;&#x27;;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Date.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.Date.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Date.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data, required, item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data, required, item) {
	if (!(this.path in data) &#x26;&#x26; item &#x26;&#x26; item.get(this.path)) return true;
	var newValue = moment(data[this.path], this.parseFormatString);
	if (required &#x26;&#x26; (!newValue.isValid())) {
		return false;
	} else if (data[this.path] &#x26;&#x26; newValue &#x26;&#x26; !newValue.isValid()) {
		return false;
	} else {
		return true;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Date.prototype.moment" id="apidoc.element.keystone.Field.Types.Date.prototype.moment">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Date.prototype.</span>moment
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">moment = function (item) {
	var m = moment(item.get(this.path));
	if (this.isUTC) m.utc();
	return m;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	},
	moment: function moment(value) {
		var m = (0, _moment3.default)(value);
		if (this.props.isUTC) m.utc();
		return m;
	},
	isValid: function isValid(value) {
		return this.<span class="apidocCodeKeywordSpan">moment</span>(value, this.inputFormat).isValid();
	},
	format: function format(value) {
		return value ? this.moment(value).format(this.props.formatString) : &#x27;&#x27;;
	},
	setToday: function setToday() {
		this.valueChanged({
			value: this.moment(new Date()).format(this.props.inputFormat)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Date.prototype.parse" id="apidoc.element.keystone.Field.Types.Date.prototype.parse">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Date.prototype.</span>parse
        <span class="apidocSignatureSpan">(value, format, strict)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parse = function (value, format, strict) {
	var m = this.isUTC ? moment.utc : moment;
	// TODO Check should maybe be if (typeof value === &#x27;string&#x27;)
	// use the parseFormatString. Ever relevant?
	if (typeof value === &#x27;number&#x27; || value instanceof Date) {
		return m(value);
	} else {
		return m(value, format || this.parseFormatString, strict);
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		// throw on unsupported options
		case &#x27;email rules&#x27;:
			throw new Error(&#x27;The option &#x22;&#x27; + key + &#x27;&#x22; is no longer supported. See https://github.com/keystonejs/
keystone/wiki/0.3.x-to-0.4.x-Changes&#x27;);
		// handle special settings
		case &#x27;cloudinary config&#x27;:
			var cloudinary = require(&#x27;cloudinary&#x27;);
			if (typeof value === &#x27;string&#x27;) {
				var parts = url.<span class="apidocCodeKeywordSpan">parse</span>(value, true);
				var auth = parts.auth ? parts.auth.split(&#x27;:&#x27;) : [];
				value = {
					cloud_name: parts.host,
					api_key: auth[0],
					api_secret: auth[1],
					private_cdn: parts.pathname != null,
					secure_distribution: parts.pathname &#x26;&#x26; parts.pathname.substring(1),
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Date.prototype.updateItem" id="apidoc.element.keystone.Field.Types.Date.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Date.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {
	var value = this.getValueFromData(data);
	if (value !== null &#x26;&#x26; value !== &#x27;&#x27;) {
		// If the value is not null, empty string or undefined, parse it
		var newValue = this.parse(value);
		// If it&#x27;s valid and not the same as the last value, save it
		if (newValue.isValid() &#x26;&#x26; (!item.get(this.path) || !newValue.isSame(item.get(this.path)))) {
			item.set(this.path, newValue.toDate());
		}
	} else {
		// If it&#x27;s null or empty string, clear it out
		item.set(this.path, null);
	}
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Date.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Date.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Date.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var value = this.getValueFromData(data);
	var result = true;
	if (value) {
		result = this.parse(value).isValid();
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Date.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Date.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Date.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = !!value;
	if (value === undefined &#x26;&#x26; item.get(this.path)) {
		result = true;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.DateArray.prototype" id="apidoc.module.keystone.Field.Types.DateArray.prototype">module keystone.Field.Types.DateArray.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.DateArray.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.DateArray.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.DateArray.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var dateTypeAddFilterToQuery = DateType.prototype.addFilterToQuery.bind(this);
	var query = dateTypeAddFilterToQuery(filter);
	if (query[this.path]) {
		query[this.path] = addPresenceToQuery(filter.presence || &#x27;some&#x27;, query[this.path]);
	}
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.DateArray.prototype.format" id="apidoc.element.keystone.Field.Types.DateArray.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.DateArray.prototype.</span>format
        <span class="apidocSignatureSpan">(item, format, separator)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item, format, separator) {
	var value = item.get(this.path);
	if (format || this.formatString) {
		value = value.map(function (d) {
			return moment(d).format(format || this._formatString);
		});
	}
	return value.join(separator || this.separator);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.DateArray.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.DateArray.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.DateArray.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data, required, item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data, required, item) {

	var value = this.getValueFromData(data);
	var parseFormatString = this.parseFormatString;

	if (typeof value === &#x27;string&#x27;) {
		if (!moment(value, parseFormatString).isValid()) {
			return false;
		}
		value = [value];
	}

	if (required) {
		if (value === undefined &#x26;&#x26; item &#x26;&#x26; item.get(this.path) &#x26;&#x26; item.get(this.path).length) {
			return true;
		}
		if (value === undefined || !Array.isArray(value)) {
			return false;
		}
		if (Array.isArray(value) &#x26;&#x26; !value.length) {
			return false;
		}
	}

	if (Array.isArray(value)) {
		// filter out empty fields
		value = value.filter(function (date) {
			return date.trim() !== &#x27;&#x27;;
		});
		// if there are no values left, and requried is true, return false
		if (required &#x26;&#x26; !value.length) {
			return false;
		}
		// if any date in the array is invalid, return false
		if (value.some(function (dateValue) { return !moment(dateValue, parseFormatString).isValid(); })) {
			return false;
		}
	}

	return (value === undefined || Array.isArray(value));

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.DateArray.prototype.updateItem" id="apidoc.element.keystone.Field.Types.DateArray.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.DateArray.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {

	var value = this.getValueFromData(data);

	if (Array.isArray(value)) {
		// Only save valid dates
		value = value.filter(function (date) {
			return moment(date).isValid();
		});
	}
	if (value === null || value === undefined) {
		value = [];
	}
	if (typeof value === &#x27;string&#x27;) {
		if (moment(value).isValid()) {
			value = [value];
		}
	}
	if (Array.isArray(value)) {
		item.set(this.path, value);
	}

	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.DateArray.prototype.validateInput" id="apidoc.element.keystone.Field.Types.DateArray.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.DateArray.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var value = this.getValueFromData(data);
	var result = true;
	if (value !== undefined &#x26;&#x26; value !== null &#x26;&#x26; value !== &#x27;&#x27;) {
		if (!Array.isArray(value)) {
			value = [value];
		}
		for (var i = 0; i &#x3c; value.length; i++) {
			var currentValue;
			// If we pass it an epoch, parse it without the format string
			if (typeof value[i] === &#x27;number&#x27;) {
				currentValue = moment(value[i]);
			} else {
				currentValue = moment(value[i], this.parseFormatString);
			}
			// If moment does not think it&#x27;s a valid date, invalidate
			if (!currentValue.isValid()) {
				result = false;
				break;
			}
		}
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.DateArray.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.DateArray.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.DateArray.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = false;
	// If the field is undefined but has a value saved already, validate
	if (value === undefined) {
		if (item.get(this.path) &#x26;&#x26; item.get(this.path).length) {
			result = true;
		}
	}
	if (typeof value === &#x27;string&#x27; || typeof value === &#x27;number&#x27;) {
		if (moment(value).isValid()) {
			result = true;
		}
	// If it&#x27;s an array of only dates and/or dateify-able data, validate
	} else if (Array.isArray(value)) {
		var invalidContent = false;
		for (var i = 0; i &#x3c; value.length; i++) {
			var currentValue;
			// If we pass it an epoch, parse it without the format string
			if (typeof value[i] === &#x27;number&#x27;) {
				currentValue = moment(value[i]);
			} else {
				currentValue = moment(value[i], this.parseFormatString);
			}
			// If even a single item is not a valid date, invalidate
			if (!currentValue.isValid()) {
				invalidContent = true;
				break;
			}
		}
		if (invalidContent === false) {
			result = true;
		}
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Datetime.prototype" id="apidoc.module.keystone.Field.Types.Datetime.prototype">module keystone.Field.Types.Datetime.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Datetime.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Datetime.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Datetime.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	if (filter.mode === &#x27;between&#x27;) {
		if (filter.after &#x26;&#x26; filter.before) {
			filter.after = moment(filter.after);
			filter.before = moment(filter.before);
			if (filter.after.isValid() &#x26;&#x26; filter.before.isValid()) {
				query[this.path] = {
					$gte: filter.after.startOf(&#x27;day&#x27;).toDate(),
					$lte: filter.before.endOf(&#x27;day&#x27;).toDate(),
				};
			}
		}
	} else if (filter.value) {
		var day = {
			moment: moment(filter.value),
		};
		day.start = day.moment.startOf(&#x27;day&#x27;).toDate();
		day.end = moment(filter.value).endOf(&#x27;day&#x27;).toDate();
		if (day.moment.isValid()) {
			if (filter.mode === &#x27;after&#x27;) {
				query[this.path] = { $gt: day.end };
			} else if (filter.mode === &#x27;before&#x27;) {
				query[this.path] = { $lt: day.start };
			} else {
				query[this.path] = { $gte: day.start, $lte: day.end };
			}
		}
	}
	if (filter.inverted) {
		query[this.path] = { $not: query[this.path] };
	}
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Datetime.prototype.format" id="apidoc.element.keystone.Field.Types.Datetime.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Datetime.prototype.</span>format
        <span class="apidocSignatureSpan">(item, format)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item, format) {
	if (format || this.formatString) {
		return item.get(this.path) ? this.moment(item).format(format || this.formatString) : &#x27;&#x27;;
	} else {
		return item.get(this.path) || &#x27;&#x27;;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Datetime.prototype.getInputFromData" id="apidoc.element.keystone.Field.Types.Datetime.prototype.getInputFromData">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Datetime.prototype.</span>getInputFromData
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getInputFromData = function (data) {
	var dateValue = this.getValueFromData(data, &#x27;_date&#x27;);
	var timeValue = this.getValueFromData(data, &#x27;_time&#x27;);
	var tzOffsetValue = this.getValueFromData(data, &#x27;_tzOffset&#x27;);
	if (dateValue &#x26;&#x26; timeValue) {
		var combined = dateValue + &#x27; &#x27; + timeValue;
		if (typeof tzOffsetValue !== &#x27;undefined&#x27;) {
			combined += &#x27; &#x27; + tzOffsetValue;
		}
		return combined;
	}

	return this.getValueFromData(data);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	}

	return this.getValueFromData(data);
};


datetime.prototype.validateRequiredInput = function (item, data, callback) {
	var value = this.<span class="apidocCodeKeywordSpan">getInputFromData</span>(data);
	var result = !!value;
	if (value === undefined &#x26;&#x26; item.get(this.path)) {
		result = true;
	}
	utils.defer(callback, result);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Datetime.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.Datetime.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Datetime.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data, required, item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data, required, item) {
	if (!(this.path in data &#x26;&#x26; !(this.paths.date in data &#x26;&#x26; this.paths.time in data)) &#x26;&#x26; item &#x26;&#x26; item.get(this.path)) return true;
	var newValue = moment(this.getInputFromData(data), parseFormats);
	if (required &#x26;&#x26; (!newValue || !newValue.isValid())) {
		return false;
	} else if (this.getInputFromData(data) &#x26;&#x26; newValue &#x26;&#x26; !newValue.isValid()) {
		return false;
	} else {
		return true;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Datetime.prototype.moment" id="apidoc.element.keystone.Field.Types.Datetime.prototype.moment">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Datetime.prototype.</span>moment
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">moment = function (item) {
	var m = moment(item.get(this.path));
	if (this.isUTC) m.utc();
	return m;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	},
	moment: function moment(value) {
		var m = (0, _moment3.default)(value);
		if (this.props.isUTC) m.utc();
		return m;
	},
	isValid: function isValid(value) {
		return this.<span class="apidocCodeKeywordSpan">moment</span>(value, this.inputFormat).isValid();
	},
	format: function format(value) {
		return value ? this.moment(value).format(this.props.formatString) : &#x27;&#x27;;
	},
	setToday: function setToday() {
		this.valueChanged({
			value: this.moment(new Date()).format(this.props.inputFormat)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Datetime.prototype.parse" id="apidoc.element.keystone.Field.Types.Datetime.prototype.parse">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Datetime.prototype.</span>parse
        <span class="apidocSignatureSpan">(value, format, strict)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">parse = function (value, format, strict) {
	var m = this.isUTC ? moment.utc : moment;
	// TODO Check should maybe be if (typeof value === &#x27;string&#x27;)
	// use the parseFormatString. Ever relevant?
	if (typeof value === &#x27;number&#x27; || value instanceof Date) {
		return m(value);
	} else {
		return m(value, format || this.parseFormatString, strict);
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		// throw on unsupported options
		case &#x27;email rules&#x27;:
			throw new Error(&#x27;The option &#x22;&#x27; + key + &#x27;&#x22; is no longer supported. See https://github.com/keystonejs/
keystone/wiki/0.3.x-to-0.4.x-Changes&#x27;);
		// handle special settings
		case &#x27;cloudinary config&#x27;:
			var cloudinary = require(&#x27;cloudinary&#x27;);
			if (typeof value === &#x27;string&#x27;) {
				var parts = url.<span class="apidocCodeKeywordSpan">parse</span>(value, true);
				var auth = parts.auth ? parts.auth.split(&#x27;:&#x27;) : [];
				value = {
					cloud_name: parts.host,
					api_key: auth[0],
					api_secret: auth[1],
					private_cdn: parts.pathname != null,
					secure_distribution: parts.pathname &#x26;&#x26; parts.pathname.substring(1),
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Datetime.prototype.updateItem" id="apidoc.element.keystone.Field.Types.Datetime.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Datetime.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {
	// Get the values from the data
	var value = this.getInputFromData(data);
	if (value !== undefined) {
		if (value !== null &#x26;&#x26; value !== &#x27;&#x27;) {
			// If the value is not null, empty string or undefined, parse it
			var newValue = this.parse(value, this.parseFormatString, true);
			// If it&#x27;s valid and not the same as the last value, save it
			if (!item.get(this.path) || !newValue.isSame(item.get(this.path))) {
				item.set(this.path, newValue.toDate());
			}
		// If it&#x27;s null or empty string, clear it out
		} else {
			item.set(this.path, null);
		}
	}
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Datetime.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Datetime.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Datetime.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var value = this.getInputFromData(data);
	// If the value is null, undefined or an empty string
	// bail early since updateItem sanitizes that just fine
	var result = true;
	if (value) {
		result = this.parse(value, this.parseFormatString, true).isValid();
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Datetime.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Datetime.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Datetime.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getInputFromData(data);
	var result = !!value;
	if (value === undefined &#x26;&#x26; item.get(this.path)) {
		result = true;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Email.prototype" id="apidoc.module.keystone.Field.Types.Email.prototype">module keystone.Field.Types.Email.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Email.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Email.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Email.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	if (filter.mode === &#x27;exactly&#x27; &#x26;&#x26; !filter.value) {
		query[this.path] = filter.inverted ? { $nin: [&#x27;&#x27;, null] } : { $in: [&#x27;&#x27;, null] };
		return query;
	}
	var value = utils.escapeRegExp(filter.value);
	if (filter.mode === &#x27;beginsWith&#x27;) {
		value = &#x27;^&#x27; + value;
	} else if (filter.mode === &#x27;endsWith&#x27;) {
		value = value + &#x27;$&#x27;;
	} else if (filter.mode === &#x27;exactly&#x27;) {
		value = &#x27;^&#x27; + value + &#x27;$&#x27;;
	}
	value = new RegExp(value, filter.caseSensitive ? &#x27;&#x27; : &#x27;i&#x27;);
	query[this.path] = filter.inverted ? { $not: value } : value;
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Email.prototype.gravatarUrl" id="apidoc.element.keystone.Field.Types.Email.prototype.gravatarUrl">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Email.prototype.</span>gravatarUrl
        <span class="apidocSignatureSpan">(item, size, defaultImage, rating)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">gravatarUrl = function (item, size, defaultImage, rating) {
	var value = item.get(this.path);
	if (typeof value !== &#x27;string&#x27;) {
		return &#x27;&#x27;;
	}
	return [
		// base url protocol-less for both http/https
		&#x27;//www.gravatar.com/avatar/&#x27;,
		// md5 hash the trimmed lowercase email
		crypto.createHash(&#x27;md5&#x27;).update(value.toLowerCase().trim()).digest(&#x27;hex&#x27;),
		// size of images ranging from 1 to 2048 pixels, square
		&#x27;?s=&#x27; + (/^(?:[1-9][0-9]{0,2}|1[0-9]{3}|20[0-3][0-9]|204[0-8])$/.test(size) ? size : 80),
		// default image url encoded href or one of the built in options: 404, mm, identicon, monsterid, wavatar, retro, blank
		&#x27;&#x26;d=&#x27; + (defaultImage ? encodeURIComponent(defaultImage) : &#x27;identicon&#x27;),
		// rating, g, pg, r or x
		&#x27;&#x26;r=&#x27; + (/^(?:g|pg|r|x)$/i.test(rating) ? rating.toLowerCase() : &#x27;g&#x27;),
	].join(&#x27;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Email.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.Email.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Email.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data, required, item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data, required, item) {
	var value = this.getValueFromData(data);
	if (value) {
		return utils.isEmail(value);
	} else {
		return (!required || (item &#x26;&#x26; item.get(this.path))) ? true : false;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Email.prototype.updateItem" id="apidoc.element.keystone.Field.Types.Email.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Email.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {
	var newValue = this.getValueFromData(data);
	if (typeof newValue === &#x27;string&#x27;) {
		newValue = newValue.toLowerCase();
	}
	if (newValue !== undefined &#x26;&#x26; newValue !== item.get(this.path)) {
		item.set(this.path, newValue);
	}
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Email.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Email.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Email.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var input = this.getValueFromData(data);
	var result = true;
	if (input) {
		result = utils.isEmail(input);
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Email.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Email.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Email.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = !!value;
	if (value === undefined &#x26;&#x26; item.get(this.path)) {
		result = true;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Embedly.prototype" id="apidoc.module.keystone.Field.Types.Embedly.prototype">module keystone.Field.Types.Embedly.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Embedly.prototype.addToSchema" id="apidoc.element.keystone.Field.Types.Embedly.prototype.addToSchema">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Embedly.prototype.</span>addToSchema
        <span class="apidocSignatureSpan">(schema)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addToSchema = function (schema) {

	var field = this;

	this.paths = {
		exists: this.path + &#x27;.exists&#x27;,
		type: this.path + &#x27;.type&#x27;,
		title: this.path + &#x27;.title&#x27;,
		url: this.path + &#x27;.url&#x27;,
		width: this.path + &#x27;.width&#x27;,
		height: this.path + &#x27;.height&#x27;,
		version: this.path + &#x27;.version&#x27;,
		description: this.path + &#x27;.description&#x27;,
		html: this.path + &#x27;.html&#x27;,
		authorName: this.path + &#x27;.authorName&#x27;,
		authorUrl: this.path + &#x27;.authorUrl&#x27;,
		providerName: this.path + &#x27;.providerName&#x27;,
		providerUrl: this.path + &#x27;.providerUrl&#x27;,
		thumbnailUrl: this.path + &#x27;.thumbnailUrl&#x27;,
		thumbnailWidth: this.path + &#x27;.thumbnailWidth&#x27;,
		thumbnailHeight: this.path + &#x27;.thumbnailHeight&#x27;,
	};

	schema.nested[this.path] = true;
	schema.add({
		exists: Boolean,
		type: String,
		title: String,
		url: String,
		width: Number,
		height: Number,
		version: String,
		description: String,
		html: String,
		authorName: String,
		authorUrl: String,
		providerName: String,
		providerUrl: String,
		thumbnailUrl: String,
		thumbnailWidth: Number,
		thumbnailHeight: Number,
	}, this.path + &#x27;.&#x27;);

	// Bind the pre-save hook to hit the embedly api if the source path has changed

	schema.pre(&#x27;save&#x27;, function (next) {

		if (!this.isModified(field.fromPath)) {
			return next();
		}

		var fromValue = this.get(field.fromPath);

		if (!fromValue) {
			field.reset(this);
			return next();
		}

		var post = this;

		var api = new EmbedlyAPI({ key: keystone.get(&#x27;embedly api key&#x27;) });
		var opts = _.defaults({ url: fromValue }, field.embedlyOptions);

		api.oembed(opts, function (err, objs) {
			if (err) {
				console.error(&#x27;Embedly API Error:&#x27;);
				console.error(err, objs);
				field.reset(post);
			} else {
				var data = objs[0];
				if (data &#x26;&#x26; data.type !== &#x27;error&#x27;) {
					post.set(field.path, {
						exists: true,
						type: data.type,
						title: data.title,
						url: data.url,
						width: data.width,
						height: data.height,
						version: data.version,
						description: data.description,
						html: data.html,
						authorName: data.author_name,
						authorUrl: data.author_url,
						providerName: data.provider_name,
						providerUrl: data.provider_url,
						thumbnailUrl: data.thumbnail_url,
						thumbnailWidth: data.thumbnail_width,
						thumbnailHeight: data.thumbnail_height,
					});
				} else {
					field.reset(post);
				}
			}
			return next();
		});
	});

	this.bindUnderscoreMethods();

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Embedly.prototype.format" id="apidoc.element.keystone.Field.Types.Embedly.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Embedly.prototype.</span>format
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item) {
	return item.get(this.paths.html);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Embedly.prototype.getData" id="apidoc.element.keystone.Field.Types.Embedly.prototype.getData">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Embedly.prototype.</span>getData
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getData = function (item) {
	var value = item.get(this.path);
	return typeof value === &#x27;object&#x27; ? value : {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					process.exit(1);
				}
			}
			break;
		case &#x27;module root&#x27;:
			// if relative path is used, resolve it based on the caller&#x27;s path
			if (!isAbsolutePath(value)) {
				var caller = callerId.<span class="apidocCodeKeywordSpan">getData</span>();
				value = path.resolve(path.dirname(caller.filePath), value);
			}
			break;
		case &#x27;app&#x27;:
			this.app = value;
			break;
		case &#x27;mongoose&#x27;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Embedly.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.Embedly.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Embedly.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function () {
	return true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Embedly.prototype.isModified" id="apidoc.element.keystone.Field.Types.Embedly.prototype.isModified">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Embedly.prototype.</span>isModified
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isModified = function (item) {
	// Assume that it has changed if the url is different
	return item.isModified(this.paths.url);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var modified = false;
		var incomplete = false;
		var values = [];

		autokey.from.forEach(function (ops) {
			if (list.fields[ops.path]) {
				values.push(list.fields[ops.path].format(this, ops.format));
				if (list.fields[ops.path].<span class="apidocCodeKeywordSpan">isModified</span>(this)) {
					modified = true;
				}
				// if source field is neither selected nor modified we don&#x27;t have a way to generate a complete autokey
				else if (!this.isSelected(ops.path)) {
					incomplete = true;
				}
			} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Embedly.prototype.reset" id="apidoc.element.keystone.Field.Types.Embedly.prototype.reset">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Embedly.prototype.</span>reset
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reset = function (item) {
	return item.set(item.set(this.path, {
		exists: false,
		type: null,
		title: null,
		url: null,
		width: null,
		height: null,
		version: null,
		description: null,
		html: null,
		authorName: null,
		authorUrl: null,
		providerName: null,
		providerUrl: null,
		thumbnailUrl: null,
		thumbnailWidth: null,
		thumbnailHeight: null,
	}));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		if (!this.isModified(field.fromPath)) {
			return next();
		}

		var fromValue = this.get(field.fromPath);

		if (!fromValue) {
			field.<span class="apidocCodeKeywordSpan">reset</span>(this);
			return next();
		}

		var post = this;

		var api = new EmbedlyAPI({ key: keystone.get(&#x27;embedly api key&#x27;) });
		var opts = _.defaults({ url: fromValue }, field.embedlyOptions);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Embedly.prototype.updateItem" id="apidoc.element.keystone.Field.Types.Embedly.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Embedly.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {
	// TODO: This could be more granular and check for actual changes to values,
	// see the Location field for an example
	item.set(item.set(this.path, {
		exists: data[this.paths.exists],
		type: data[this.paths.type],
		title: data[this.paths.title],
		url: data[this.paths.url],
		width: data[this.paths.width],
		height: data[this.paths.height],
		version: data[this.paths.version],
		description: data[this.paths.description],
		html: data[this.paths.html],
		authorName: data[this.paths.authorName],
		authorUrl: data[this.paths.authorUrl],
		providerName: data[this.paths.providerName],
		providerUrl: data[this.paths.providerUrl],
		thumbnailUrl: data[this.paths.thumbnailUrl],
		thumbnailWidth: data[this.paths.thumbnailWidth],
		thumbnailHeight: data[this.paths.thumbnailHeight],
	}));
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.File.prototype" id="apidoc.module.keystone.Field.Types.File.prototype">module keystone.Field.Types.File.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.File.prototype.addToSchema" id="apidoc.element.keystone.Field.Types.File.prototype.addToSchema">
        function <span class="apidocSignatureSpan">keystone.Field.Types.File.prototype.</span>addToSchema
        <span class="apidocSignatureSpan">(schema)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addToSchema = function (schema) {

	var field = this;

	this.paths = {};
	// add field paths from the storage schema
	Object.keys(this.storage.schema).forEach(function (path) {
		field.paths[path] = field.path + &#x27;.&#x27; + path;
	});

	var schemaPaths = this._path.addTo({}, this.storage.schema);
	schema.add(schemaPaths);

	this.bindUnderscoreMethods();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.File.prototype.format" id="apidoc.element.keystone.Field.Types.File.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.File.prototype.</span>format
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item) {
	var value = item.get(this.path);
	if (value) return value.filename || &#x27;&#x27;;
	return &#x27;&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.File.prototype.isModified" id="apidoc.element.keystone.Field.Types.File.prototype.isModified">
        function <span class="apidocSignatureSpan">keystone.Field.Types.File.prototype.</span>isModified
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isModified = function (item) {
	var modified = false;
	var paths = this.paths;
	Object.keys(this.storageSchema).forEach(function (path) {
		if (item.isModified(paths[path])) modified = true;
	});
	return modified;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var modified = false;
		var incomplete = false;
		var values = [];

		autokey.from.forEach(function (ops) {
			if (list.fields[ops.path]) {
				values.push(list.fields[ops.path].format(this, ops.format));
				if (list.fields[ops.path].<span class="apidocCodeKeywordSpan">isModified</span>(this)) {
					modified = true;
				}
				// if source field is neither selected nor modified we don&#x27;t have a way to generate a complete autokey
				else if (!this.isSelected(ops.path)) {
					incomplete = true;
				}
			} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.File.prototype.remove" id="apidoc.element.keystone.Field.Types.File.prototype.remove">
        function <span class="apidocSignatureSpan">keystone.Field.Types.File.prototype.</span>remove
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">remove = function (item) {
	this.storage.removeFile(item.get(this.path));
	this.reset();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
function getId() {
	return &#x27;keystone-html-&#x27; + lastId++;
}

// Workaround for #2834 found here https://github.com/tinymce/tinymce/issues/794#issuecomment-203701329
function removeTinyMCEInstance(editor) {
	var oldLength = _tinymce2.default.editors.length;
	_tinymce2.default.<span class="apidocCodeKeywordSpan">remove</span>(editor);
	if (oldLength === _tinymce2.default.editors.length) {
		_tinymce2.default.editors.remove(editor);
	}
}

module.exports = _Field2.default.create({
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.File.prototype.reset" id="apidoc.element.keystone.Field.Types.File.prototype.reset">
        function <span class="apidocSignatureSpan">keystone.Field.Types.File.prototype.</span>reset
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reset = function (item) {
	var value = {};
	Object.keys(this.storage.schema).forEach(function (path) {
		value[path] = null;
	});
	item.set(this.path, value);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		if (!this.isModified(field.fromPath)) {
			return next();
		}

		var fromValue = this.get(field.fromPath);

		if (!fromValue) {
			field.<span class="apidocCodeKeywordSpan">reset</span>(this);
			return next();
		}

		var post = this;

		var api = new EmbedlyAPI({ key: keystone.get(&#x27;embedly api key&#x27;) });
		var opts = _.defaults({ url: fromValue }, field.embedlyOptions);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.File.prototype.updateItem" id="apidoc.element.keystone.Field.Types.File.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.File.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, files, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, files, callback) {
	// Process arguments
	if (typeof files === &#x27;function&#x27;) {
		callback = files;
		files = {};
	}
	if (!files) {
		files = {};
	}

	// Prepare values
	var value = this.getValueFromData(data);
	var uploadedFile;

	// Providing the string &#x22;remove&#x22; removes the file and resets the field
	if (value === &#x27;remove&#x27;) {
		this.remove(item);
		utils.defer(callback);
	}

	// Find an uploaded file in the files argument, either referenced in the
	// data argument or named with the field path / field_upload path + suffix
	if (typeof value === &#x27;string&#x27; &#x26;&#x26; value.substr(0, 7) === &#x27;upload:&#x27;) {
		uploadedFile = files[value.substr(7)];
	} else {
		uploadedFile = this.getValueFromData(files) || this.getValueFromData(files, &#x27;_upload&#x27;);
	}

	// Ensure a valid file was uploaded, else null out the value
	if (uploadedFile &#x26;&#x26; !uploadedFile.path) {
		uploadedFile = undefined;
	}

	// If we have a file to upload, we do that and stop here
	if (uploadedFile) {
		return this.upload(item, uploadedFile, callback);
	}

	// Empty / null values reset the field
	if (value === null || value === &#x27;&#x27; || (typeof value === &#x27;object&#x27; &#x26;&#x26; !Object.keys(value).length)) {
		this.reset(item);
		value = undefined;
	}

	// If there is a valid value at this point, set it on the field
	if (typeof value === &#x27;object&#x27;) {
		item.set(this.path, value);
	}
	utils.defer(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.File.prototype.upload" id="apidoc.element.keystone.Field.Types.File.prototype.upload">
        function <span class="apidocSignatureSpan">keystone.Field.Types.File.prototype.</span>upload
        <span class="apidocSignatureSpan">(item, file, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">upload = function (item, file, callback) {
	var field = this;
	// TODO; Validate there is actuall a file to upload
	debug(&#x27;[%s.%s] Uploading file for item %s:&#x27;, this.list.key, this.path, item.id, file);
	this.storage.uploadFile(file, function (err, result) {
		if (err) return callback(err);
		debug(&#x27;[%s.%s] Uploaded file for item %s with result:&#x27;, field.list.key, field.path, item.id, result);
		item.set(field.path, result);
		callback(null, result);
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		if (req.files &#x26;&#x26; req.files.file) {
			var options = {};

			if (keystone.get(&#x27;wysiwyg cloudinary images filenameAsPublicID&#x27;)) {
				options.public_id = req.files.file.originalname.substring(0, req.files.file.originalname.lastIndexOf(&#x27;.&#x27;));
			}

			cloudinary.uploader.<span class="apidocCodeKeywordSpan">upload</span>(req.files.file.path, function (result) {
				var sendResult = function () {
					if (result.error) {
						res.send({ error: { message: result.error.message } });
					} else {
						res.send({ image: { url: (keystone.get(&#x27;cloudinary secure&#x27;) === true) ? result.secure_url : result.url } });
					}
				};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.File.prototype.validateInput" id="apidoc.element.keystone.Field.Types.File.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.File.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var value = this.getValueFromData(data);
	debug(&#x27;[%s.%s] Validating input: &#x27;, this.list.key, this.path, value);
	var result = validateInput(value);
	debug(&#x27;[%s.%s] Validation result: &#x27;, this.list.key, this.path, result);
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.File.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.File.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.File.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	// TODO: We need to also get the `files` argument, so we can check for
	// uploaded files. without it, this will return false negatives so we
	// can&#x27;t actually validate required input at the moment.
	var result = true;
	// var value = this.getValueFromData(data);
	// debug(&#x27;[%s.%s] Validating required input: &#x27;, this.list.key, this.path, value);
	// TODO: Need to actually check a dynamic path based on the adapter
	// TODO: This incorrectly allows empty values in the object to pass validation
	// var result = (value || item.get(this.paths.filename)) ? true : false;
	// debug(&#x27;[%s.%s] Validation result: &#x27;, this.list.key, this.path, result);
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.GeoPoint.prototype" id="apidoc.module.keystone.Field.Types.GeoPoint.prototype">module keystone.Field.Types.GeoPoint.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.GeoPoint.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.GeoPoint.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.GeoPoint.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	// If latitude or longitude aren&#x27;t specified, don&#x27;t filter anything
	if (filter.lon &#x26;&#x26; filter.lat) {
		query[this.path] = {
			$near: {
				$geometry: {
					type: &#x27;Point&#x27;,
					coordinates: [filter.lon, filter.lat],
				},
			},
		};
		// MongoDB wants meters, but we accept kilometers via input so we * 1000
		var distance = (filter.distance.value &#x26;&#x26; filter.distance.value * 1000) || 500000;
		if (filter.distance.mode === &#x27;min&#x27;) {
			query[this.path].$near.$minDistance = distance;
		} else {
			query[this.path].$near.$maxDistance = distance;
		}
	}
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.GeoPoint.prototype.addToSchema" id="apidoc.element.keystone.Field.Types.GeoPoint.prototype.addToSchema">
        function <span class="apidocSignatureSpan">keystone.Field.Types.GeoPoint.prototype.</span>addToSchema
        <span class="apidocSignatureSpan">(schema)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addToSchema = function (schema) {
	schema.path(this.path, _.defaults({ type: [Number], index: &#x27;2dsphere&#x27; }, this.options));
	this.bindUnderscoreMethods();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.GeoPoint.prototype.format" id="apidoc.element.keystone.Field.Types.GeoPoint.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.GeoPoint.prototype.</span>format
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item) {
	if (item.get(this.path)) {
		return item.get(this.path).reverse().join(&#x27;, &#x27;);
	}
	return null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.GeoPoint.prototype.getData" id="apidoc.element.keystone.Field.Types.GeoPoint.prototype.getData">
        function <span class="apidocSignatureSpan">keystone.Field.Types.GeoPoint.prototype.</span>getData
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getData = function (item) {
	var points = item.get(this.path);
	return (points &#x26;&#x26; points.length === 2) ? points : [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					process.exit(1);
				}
			}
			break;
		case &#x27;module root&#x27;:
			// if relative path is used, resolve it based on the caller&#x27;s path
			if (!isAbsolutePath(value)) {
				var caller = callerId.<span class="apidocCodeKeywordSpan">getData</span>();
				value = path.resolve(path.dirname(caller.filePath), value);
			}
			break;
		case &#x27;app&#x27;:
			this.app = value;
			break;
		case &#x27;mongoose&#x27;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.GeoPoint.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.GeoPoint.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.GeoPoint.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data, required, item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data, required, item) { // eslint-disable-line no-unused-vars
	var values = this.getValueFromData(data);
	// Input is valid if the field is not required, and not present
	if (values === undefined &#x26;&#x26; !required) return true;
	if (Array.isArray(values)) {
		values = values.length === 2 ? values.join(&#x27;,&#x27;) : &#x27;&#x27;;
	}
	if (typeof values !== &#x27;string&#x27;) return false;
	if ((values === &#x27;&#x27; || values.charAt(0) === &#x27;,&#x27; || values.charAt(values.length - 1) === &#x27;,&#x27;) &#x26;&#x26; !required) return true;
	return REGEXP_LNGLAT.test(values);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.GeoPoint.prototype.updateItem" id="apidoc.element.keystone.Field.Types.GeoPoint.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.GeoPoint.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {
	var value = this.getValueFromData(data);
	if (value === undefined) return process.nextTick(callback);
	if (typeof value === &#x27;string&#x27;) {
		// Value should be formatted lng,lat
		var values = REGEXP_LNGLAT.exec(value);
		if (values) {
			item.set(this.path, [values[1], values[2]]);
		} else {
			item.set(this.path, undefined);
		}
	} else if (Array.isArray(value)) {
		if (value.length === 2 &#x26;&#x26; REGEXP_LNGLAT.test(_.compact(value).join(&#x27;,&#x27;))) {
			item.set(this.path, value);
		} else {
			item.set(this.path, undefined);
		}
	}
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.GeoPoint.prototype.validateInput" id="apidoc.element.keystone.Field.Types.GeoPoint.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.GeoPoint.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var value = this.getValueFromData(data);
	var result = false;
	if (value === undefined || value === null || value === &#x27;&#x27;) {
		result = true;
	} else {
		if (Array.isArray(value)) {
			value = value.length === 2 ? value.join(&#x27;,&#x27;) : &#x27;&#x27;;
		}
		if (typeof value === &#x27;string&#x27;) {
			result = REGEXP_LNGLAT.test(value);
		}
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.GeoPoint.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.GeoPoint.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.GeoPoint.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = (value || (value === undefined &#x26;&#x26; item.get(this.path) &#x26;&#x26; item.get(this.path).length === 2)) ? true : false;
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Html.prototype" id="apidoc.module.keystone.Field.Types.Html.prototype">module keystone.Field.Types.Html.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Html.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Html.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Html.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	if (filter.mode === &#x27;exactly&#x27; &#x26;&#x26; !filter.value) {
		query[this.path] = filter.inverted ? { $nin: [&#x27;&#x27;, null] } : { $in: [&#x27;&#x27;, null] };
		return query;
	}
	var value = utils.escapeRegExp(filter.value);
	if (filter.mode === &#x27;beginsWith&#x27;) {
		value = &#x27;^&#x27; + value;
	} else if (filter.mode === &#x27;endsWith&#x27;) {
		value = value + &#x27;$&#x27;;
	} else if (filter.mode === &#x27;exactly&#x27;) {
		value = &#x27;^&#x27; + value + &#x27;$&#x27;;
	}
	value = new RegExp(value, filter.caseSensitive ? &#x27;&#x27; : &#x27;i&#x27;);
	query[this.path] = filter.inverted ? { $not: value } : value;
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Html.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Html.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Html.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var max = this.options.max;
	var min = this.options.min;
	var value = this.getValueFromData(data);
	var result = value === undefined || value === null || typeof value === &#x27;string&#x27;;
	if (max &#x26;&#x26; typeof value === &#x27;string&#x27;) {
		result = value.length &#x3c; max;
	}
	if (min &#x26;&#x26; typeof value === &#x27;string&#x27;) {
		result = value.length &#x3e; min;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Html.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Html.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Html.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = !!value;
	if (value === undefined &#x26;&#x26; item.get(this.path)) {
		result = true;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Key.prototype" id="apidoc.module.keystone.Field.Types.Key.prototype">module keystone.Field.Types.Key.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Key.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Key.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Key.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	if (filter.mode === &#x27;exactly&#x27; &#x26;&#x26; !filter.value) {
		query[this.path] = filter.inverted ? { $nin: [&#x27;&#x27;, null] } : { $in: [&#x27;&#x27;, null] };
		return query;
	}
	var value = utils.escapeRegExp(filter.value);
	if (filter.mode === &#x27;beginsWith&#x27;) {
		value = &#x27;^&#x27; + value;
	} else if (filter.mode === &#x27;endsWith&#x27;) {
		value = value + &#x27;$&#x27;;
	} else if (filter.mode === &#x27;exactly&#x27;) {
		value = &#x27;^&#x27; + value + &#x27;$&#x27;;
	}
	value = new RegExp(value, filter.caseSensitive ? &#x27;&#x27; : &#x27;i&#x27;);
	query[this.path] = filter.inverted ? { $not: value } : value;
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Key.prototype.generateKey" id="apidoc.element.keystone.Field.Types.Key.prototype.generateKey">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Key.prototype.</span>generateKey
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">generateKey = function (str) {
	return utils.slug(String(str), this.separator);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * Deprecated
 */
key.prototype.inputIsValid = function (data, required, item) {
	var value = this.getValueFromData(data);
	if (value === undefined &#x26;&#x26; item &#x26;&#x26; item.get(this.path)) {
		return true;
	}
	value = this.<span class="apidocCodeKeywordSpan">generateKey</span>(value);
	return (value || !required) ? true : false;
};

/**
 * Updates the value for this field in the item from a data object
 */
key.prototype.updateItem = function (item, data, callback) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Key.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.Key.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Key.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data, required, item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data, required, item) {
	var value = this.getValueFromData(data);
	if (value === undefined &#x26;&#x26; item &#x26;&#x26; item.get(this.path)) {
		return true;
	}
	value = this.generateKey(value);
	return (value || !required) ? true : false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Key.prototype.updateItem" id="apidoc.element.keystone.Field.Types.Key.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Key.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {
	var value = this.getValueFromData(data);
	if (value === undefined) {
		return process.nextTick(callback);
	}
	value = this.generateKey(value);
	if (item.get(this.path) !== value) {
		item.set(this.path, value);
	}
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Key.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Key.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Key.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var max = this.options.max;
	var min = this.options.min;
	var value = this.getValueFromData(data);
	var result = value === undefined || value === null || typeof value === &#x27;string&#x27;;
	if (max &#x26;&#x26; typeof value === &#x27;string&#x27;) {
		result = value.length &#x3c; max;
	}
	if (min &#x26;&#x26; typeof value === &#x27;string&#x27;) {
		result = value.length &#x3e; min;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Key.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Key.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Key.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = !!value;
	if (value === undefined &#x26;&#x26; item.get(this.path)) {
		result = true;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.LocalFile.prototype" id="apidoc.module.keystone.Field.Types.LocalFile.prototype">module keystone.Field.Types.LocalFile.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.addToSchema" id="apidoc.element.keystone.Field.Types.LocalFile.prototype.addToSchema">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>addToSchema
        <span class="apidocSignatureSpan">(schema)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addToSchema = function (schema) {

	var field = this;

	var paths = this.paths = {
		// fields
		filename: this.path + &#x27;.filename&#x27;,
		originalname: this.path + &#x27;.originalname&#x27;,
		path: this.path + &#x27;.path&#x27;,
		size: this.path + &#x27;.size&#x27;,
		filetype: this.path + &#x27;.filetype&#x27;,
		// virtuals
		exists: this.path + &#x27;.exists&#x27;,
		href: this.path + &#x27;.href&#x27;,
		upload: this.path + &#x27;_upload&#x27;,
		action: this.path + &#x27;_action&#x27;,
	};

	var schemaPaths = this._path.addTo({}, {
		filename: String,
		originalname: String,
		path: String,
		size: Number,
		filetype: String,
	});

	schema.add(schemaPaths);

	// exists checks for a matching file at run-time
	var exists = function (item) {
		var filepath = item.get(paths.path);
		var filename = item.get(paths.filename);

		if (!filepath || !filename) {
			return false;
		}

		return fs.existsSync(path.join(filepath, filename));
	};

	// The .exists virtual indicates whether a file is stored
	schema.virtual(paths.exists).get(function () {
		return schemaMethods.exists.apply(this);
	});

	// The .href virtual returns the public path of the file
	schema.virtual(paths.href).get(function () {
		return field.href(this);
	});

	// reset clears the value of the field
	var reset = function (item) {
		item.set(field.path, {
			filename: &#x27;&#x27;,
			path: &#x27;&#x27;,
			size: 0,
			filetype: &#x27;&#x27;,
		});
	};

	var schemaMethods = {
		exists: function () {
			return exists(this);
		},
		<span class="apidocCodeCommentSpan">/**
		 * Resets the value of the field
		 *
		 * @api public
		 */
</span>		reset: function () {
			reset(this);
		},
		/**
		 * Deletes the file from localfile and resets the field
		 *
		 * @api public
		 */
		delete: function () {
			if (exists(this)) {
				fs.unlinkSync(path.join(this.get(paths.path), this.get(paths.filename)));
			}
			reset(this);
		},
	};

	_.forEach(schemaMethods, function (fn, key) {
		field.underscoreMethod(key, fn);
	});

	// expose a method on the field to call schema methods
	this.apply = function (item, method) {
		return schemaMethods[method].apply(item, Array.prototype.slice.call(arguments, 2));
	};

	this.bindUnderscoreMethods();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.format" id="apidoc.element.keystone.Field.Types.LocalFile.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>format
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item) {
	if (!item.get(this.paths.filename)) return &#x27;&#x27;;
	if (this.hasFormatter()) {
		var file = item.get(this.path);
		file.href = this.href(item);
		return this.options.format.call(this, item, file);
	}
	return this.href(item);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.getRequestHandler" id="apidoc.element.keystone.Field.Types.LocalFile.prototype.getRequestHandler">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>getRequestHandler
        <span class="apidocSignatureSpan">(item, req, paths, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getRequestHandler = function (item, req, paths, callback) {

	var field = this;

	if (utils.isFunction(paths)) {
		callback = paths;
		paths = field.paths;
	} else if (!paths) {
		paths = field.paths;
	}

	callback = callback || function () {};

	return function () {

		if (req.body) {
			var action = req.body[paths.action];

			if (/^(delete|reset)$/.test(action)) {
				field.apply(item, action);
			}
		}

		if (req.files &#x26;&#x26; req.files[paths.upload] &#x26;&#x26; req.files[paths.upload].size) {
			return field.uploadFile(item, req.files[paths.upload], true, callback);
		}

		return callback();

	};

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.hasFormatter" id="apidoc.element.keystone.Field.Types.LocalFile.prototype.hasFormatter">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>hasFormatter
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasFormatter = function () {
	return typeof this.options.format === &#x27;function&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * Formats the field value
 *
 * Delegates to the options.format function if it exists.
 * @api public
 */
localfile.prototype.format = function (item) {
	if (!item.get(this.paths.filename)) return &#x27;&#x27;;
	if (this.<span class="apidocCodeKeywordSpan">hasFormatter</span>()) {
		var file = item.get(this.path);
		file.href = this.href(item);
		return this.options.format.call(this, item, file);
	}
	return this.href(item);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.href" id="apidoc.element.keystone.Field.Types.LocalFile.prototype.href">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>href
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">href = function (item) {
	if (!item.get(this.paths.filename)) return &#x27;&#x27;;
	var prefix = this.options.prefix ? this.options.prefix : item.get(this.paths.path);
	return prefix + &#x27;/&#x27; + item.get(this.paths.filename);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	// The .exists virtual indicates whether a file is stored
	schema.virtual(paths.exists).get(function () {
		return schemaMethods.exists.apply(this);
	});

	// The .href virtual returns the public path of the file
	schema.virtual(paths.href).get(function () {
		return field.<span class="apidocCodeKeywordSpan">href</span>(this);
	});

	// reset clears the value of the field
	var reset = function (item) {
		item.set(field.path, {
			filename: &#x27;&#x27;,
			path: &#x27;&#x27;,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.LocalFile.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data) { // eslint-disable-line no-unused-vars
	// TODO - how should file field input be validated?
	return true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.isModified" id="apidoc.element.keystone.Field.Types.LocalFile.prototype.isModified">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>isModified
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isModified = function (item) {
	return item.isModified(this.paths.path);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var modified = false;
		var incomplete = false;
		var values = [];

		autokey.from.forEach(function (ops) {
			if (list.fields[ops.path]) {
				values.push(list.fields[ops.path].format(this, ops.format));
				if (list.fields[ops.path].<span class="apidocCodeKeywordSpan">isModified</span>(this)) {
					modified = true;
				}
				// if source field is neither selected nor modified we don&#x27;t have a way to generate a complete autokey
				else if (!this.isSelected(ops.path)) {
					incomplete = true;
				}
			} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.updateItem" id="apidoc.element.keystone.Field.Types.LocalFile.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) { // eslint-disable-line no-unused-vars
	// TODO - direct updating of data (not via upload)
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.uploadFile" id="apidoc.element.keystone.Field.Types.LocalFile.prototype.uploadFile">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>uploadFile
        <span class="apidocSignatureSpan">(item, file, update, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">uploadFile = function (item, file, update, callback) {
	var field = this;
	var prefix = field.options.datePrefix ? moment().format(field.options.datePrefix) + &#x27;-&#x27; : &#x27;&#x27;;
	var filename = prefix + file.name;
	var filetype = file.mimetype || file.type;

	if (field.options.allowedTypes &#x26;&#x26; !_.includes(field.options.allowedTypes, filetype)) {
		return callback(new Error(&#x27;Unsupported File Type: &#x27; + filetype));
	}

	if (typeof update === &#x27;function&#x27;) {
		callback = update;
		update = false;
	}

	var doMove = function (callback) {

		if (typeof field.options.filename === &#x27;function&#x27;) {
			filename = field.options.filename(item, file);
		}

		fs.move(file.path, path.join(field.options.dest, filename), { clobber: field.options.overwrite }, function (err) {

			if (err) return callback(err);

			var fileData = {
				filename: filename,
				originalname: file.originalname,
				path: field.options.dest,
				size: file.size,
				filetype: filetype,
			};

			if (update) {
				item.set(field.path, fileData);
			}

			callback(null, fileData);

		});
	};

	field.callHook(&#x27;pre:move&#x27;, item, file, function (err) {
		if (err) return callback(err);
		doMove(function (err, fileData) {
			if (err) return callback(err);
			field.callHook(&#x27;post:move&#x27;, [item, file, fileData], function (err) {
				if (err) return callback(err);
				callback(null, fileData);
			});
		});
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

			if (/^(delete|reset)$/.test(action)) {
				field.apply(item, action);
			}
		}

		if (req.files &#x26;&#x26; req.files[paths.upload] &#x26;&#x26; req.files[paths.upload].size) {
			return field.<span class="apidocCodeKeywordSpan">uploadFile</span>(item, req.files[paths.upload], true, callback);
		}

		return callback();

	};

};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.validateInput" id="apidoc.element.keystone.Field.Types.LocalFile.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var value = this.getValueFromData(data);
	utils.defer(callback, validateInput(value));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFile.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.LocalFile.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFile.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = (value || item.get(this.path).path) ? true : false;
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.LocalFiles.prototype" id="apidoc.module.keystone.Field.Types.LocalFiles.prototype">module keystone.Field.Types.LocalFiles.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFiles.prototype.addToSchema" id="apidoc.element.keystone.Field.Types.LocalFiles.prototype.addToSchema">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFiles.prototype.</span>addToSchema
        <span class="apidocSignatureSpan">(schema)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addToSchema = function (schema) {

	var field = this;
	var mongoose = keystone.mongoose;

	var paths = this.paths = {
		// fields
		filename: this.path + &#x27;.filename&#x27;,
		path: this.path + &#x27;.path&#x27;,
		originalname: this.path + &#x27;.originalname&#x27;,
		size: this.path + &#x27;.size&#x27;,
		filetype: this.path + &#x27;.filetype&#x27;,
		// virtuals
		exists: this.path + &#x27;.exists&#x27;,
		upload: this.path + &#x27;_upload&#x27;,
		action: this.path + &#x27;_action&#x27;,
		order: this.path + &#x27;_order&#x27;,
	};

	var schemaPaths = new mongoose.Schema({
		filename: String,
		originalname: String,
		path: String,
		size: Number,
		filetype: String,
	});

	// The .href virtual returns the public path of the file
	schemaPaths.virtual(&#x27;href&#x27;).get(function () {
		return field.href(this);
	});

	schema.add(this._path.addTo({}, [schemaPaths]));

	var exists = function (item, element_id) {
		var values = item.get(field.path);
		var value;

		if (typeof values === &#x27;undefined&#x27; || values.length === 0) {
			return false;
		}

		// if current Field contains any file, it means it exists
		if (typeof element_id === &#x27;undefined&#x27;) {
			value = values[0];
		} else {
			// allow implicit type coercion to compare string IDs with MongoID objects
			value = values.find(function (val) { return val._id == element_id; }); // eslint-disable-line eqeqeq
		}

		if (typeof value === &#x27;undefined&#x27;) {
			return false;
		}

		var filepaths = value.path;
		var filename = value.filename;

		if (!filepaths || !filename) {
			return false;
		}

		return fs.existsSync(path.join(filepaths, filename));
	};

	// The .exists virtual indicates whether a file is stored
	schema.virtual(paths.exists).get(function () {
		return schemaMethods.exists.apply(this);
	});

	var reset = function (item, element_id) {
		if (typeof element_id === &#x27;undefined&#x27;) {
			item.set(field.path, []);
		} else {
			var values = item.get(field.path);
			// allow implicit type coercion to compare string IDs with MongoID objects
			var value = values.find(function (val) { return val._id == element_id; }); // eslint-disable-line eqeqeq
			if (typeof value !== &#x27;undefined&#x27;) {
				values.splice(values.indexOf(value), 1);
				item.set(field.path, values);
			}
		}
	};

	var schemaMethods = {
		exists: function () {
			return exists(this);
		},
		<span class="apidocCodeCommentSpan">/**
		 * Resets the value of the field
		 */
</span>		reset: function () {
			reset(this);
		},
		/**
		 * Deletes the file from localfiles and resets the field
		 */
		delete: function (element_id) {
			if (exists(this, element_id)) {
				var values = this.get(field.path);
				// allow implicit type coercion to compare string IDs with MongoID objects
				var value = values.find(function (val) { return val._id == element_id; }); // eslint-disable-line eqeqeq
				if (typeof value !== &#x27;undefined&#x27;) {
					fs.unlinkSync(path.join(value.path, value.filename));
				}
			}
			reset(this, element_id);
		},
	};

	_.forEach(schemaMethods, function (fn, key) {
		field.underscoreMethod(key, fn);
	});

	// expose a method on the field to call schema methods
	this.apply = function (item, method) {
		return schemaMethods[method].apply(item, Array.prototype.slice.call(arguments, 2));
	};

	this.bindUnderscoreMethods();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFiles.prototype.format" id="apidoc.element.keystone.Field.Types.LocalFiles.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFiles.prototype.</span>format
        <span class="apidocSignatureSpan">(item, i)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item, i) {
	var files = item.get(this.path);
	if (typeof i === &#x27;undefined&#x27;) {
		return utils.plural(files.length, &#x27;* File&#x27;);
	}
	var file = files[i];
	if (!file) return &#x27;&#x27;;
	if (this.hasFormatter()) {
		file.href = this.href(file);
		return this.options.format.call(this, item, file);
	}
	return file.filename;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFiles.prototype.getRequestHandler" id="apidoc.element.keystone.Field.Types.LocalFiles.prototype.getRequestHandler">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFiles.prototype.</span>getRequestHandler
        <span class="apidocSignatureSpan">(item, req, paths, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getRequestHandler = function (item, req, paths, callback) {

	var field = this;

	if (utils.isFunction(paths)) {
		callback = paths;
		paths = field.paths;
	} else if (!paths) {
		paths = field.paths;
	}

	callback = callback || function () {};

	return function () {

		// Order
		if (req.body[paths.order]) {
			var files = item.get(field.path);
			var newOrder = req.body[paths.order].split(&#x27;,&#x27;);
			files.sort(function (a, b) {
				return (newOrder.indexOf(a._id.toString()) &#x3e; newOrder.indexOf(b._id.toString())) ? 1 : -1;
			});
		}

		// Removals
		if (req.body &#x26;&#x26; req.body[paths.action]) {
			var actions = req.body[paths.action].split(&#x27;|&#x27;);
			actions.forEach(function (action) {
				action = action.split(&#x27;:&#x27;);
				var method = action[0];
				var ids = action[1];
				if (!(/^(delete|reset)$/.test(method)) || !ids) return;
				ids.split(&#x27;,&#x27;).forEach(function (id) {
					field.apply(item, method, id);
				});
			});
		}

		// Upload new files
		if (req.files) {
			var upFiles = req.files[paths.upload];
			if (upFiles) {
				if (!Array.isArray(upFiles)) {
					upFiles = [upFiles];
				}
				if (upFiles.length &#x3e; 0) {
					upFiles = _.filter(upFiles, function (f) { return typeof f.name !== &#x27;undefined&#x27; &#x26;&#x26; f.name.length &#x3e; 0; });
					if (upFiles.length &#x3e; 0) {
						return field.uploadFiles(item, upFiles, true, callback);
					}
				}
			}
		}

		return callback();
	};

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFiles.prototype.hasFormatter" id="apidoc.element.keystone.Field.Types.LocalFiles.prototype.hasFormatter">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFiles.prototype.</span>hasFormatter
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasFormatter = function () {
	return typeof this.options.format === &#x27;function&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * Formats the field value
 *
 * Delegates to the options.format function if it exists.
 * @api public
 */
localfile.prototype.format = function (item) {
	if (!item.get(this.paths.filename)) return &#x27;&#x27;;
	if (this.<span class="apidocCodeKeywordSpan">hasFormatter</span>()) {
		var file = item.get(this.path);
		file.href = this.href(item);
		return this.options.format.call(this, item, file);
	}
	return this.href(item);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFiles.prototype.href" id="apidoc.element.keystone.Field.Types.LocalFiles.prototype.href">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFiles.prototype.</span>href
        <span class="apidocSignatureSpan">(file)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">href = function (file) {
	if (!file.filename) return &#x27;&#x27;;
	var prefix = this.options.prefix ? this.options.prefix : file.path;
	return prefix + &#x27;/&#x27; + file.filename;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	// The .exists virtual indicates whether a file is stored
	schema.virtual(paths.exists).get(function () {
		return schemaMethods.exists.apply(this);
	});

	// The .href virtual returns the public path of the file
	schema.virtual(paths.href).get(function () {
		return field.<span class="apidocCodeKeywordSpan">href</span>(this);
	});

	// reset clears the value of the field
	var reset = function (item) {
		item.set(field.path, {
			filename: &#x27;&#x27;,
			path: &#x27;&#x27;,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFiles.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.LocalFiles.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFiles.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data) { // eslint-disable-line no-unused-vars
	// TODO - how should file field input be validated?
	return true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFiles.prototype.isModified" id="apidoc.element.keystone.Field.Types.LocalFiles.prototype.isModified">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFiles.prototype.</span>isModified
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isModified = function (item) {
	return item.isModified(this.paths.path);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var modified = false;
		var incomplete = false;
		var values = [];

		autokey.from.forEach(function (ops) {
			if (list.fields[ops.path]) {
				values.push(list.fields[ops.path].format(this, ops.format));
				if (list.fields[ops.path].<span class="apidocCodeKeywordSpan">isModified</span>(this)) {
					modified = true;
				}
				// if source field is neither selected nor modified we don&#x27;t have a way to generate a complete autokey
				else if (!this.isSelected(ops.path)) {
					incomplete = true;
				}
			} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFiles.prototype.updateItem" id="apidoc.element.keystone.Field.Types.LocalFiles.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFiles.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) { // eslint-disable-line no-unused-vars
	// TODO - direct updating of data (not via upload)
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.LocalFiles.prototype.uploadFiles" id="apidoc.element.keystone.Field.Types.LocalFiles.prototype.uploadFiles">
        function <span class="apidocSignatureSpan">keystone.Field.Types.LocalFiles.prototype.</span>uploadFiles
        <span class="apidocSignatureSpan">(item, files, update, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">uploadFiles = function (item, files, update, callback) {

	var field = this;

	if (typeof update === &#x27;function&#x27;) {
		callback = update;
		update = false;
	}

	async.map(files, function (file, processedFile) {

		var prefix = field.options.datePrefix ? moment().format(field.options.datePrefix) + &#x27;-&#x27; : &#x27;&#x27;;
		var filename = prefix + file.name;
		var filetype = file.mimetype || file.type;

		if (field.options.allowedTypes &#x26;&#x26; !_.includes(field.options.allowedTypes, filetype)) {
			return processedFile(new Error(&#x27;Unsupported File Type: &#x27; + filetype));
		}

		var doMove = function (doneMove) {

			if (typeof field.options.filename === &#x27;function&#x27;) {
				filename = field.options.filename(item, file);
			}

			fs.move(file.path, path.join(field.options.dest, filename), { clobber: field.options.overwrite }, function (err) {
				if (err) return doneMove(err);
				var fileData = {
					filename: filename,
					originalname: file.originalname,
					path: field.options.dest,
					size: file.size,
					filetype: filetype,
				};
				if (update) {
					item.get(field.path).push(fileData);
				}
				doneMove(null, fileData);
			});

		};

		field.callHook(&#x27;pre:move&#x27;, item, file, function (err) {
			if (err) return processedFile(err);
			doMove(function (err, fileData) {
				if (err) return processedFile(err);
				field.callHook(&#x27;post:move&#x27;, item, file, fileData, function (err) {
					return processedFile(err, fileData);
				});
			});
		});

	}, callback);

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (upFiles) {
				if (!Array.isArray(upFiles)) {
					upFiles = [upFiles];
				}
				if (upFiles.length &#x3e; 0) {
					upFiles = _.filter(upFiles, function (f) { return typeof f.name !== &#x27;undefined&#x27; &#x26;&#x26; f.name.length &#x3e;
0; });
					if (upFiles.length &#x3e; 0) {
						return field.<span class="apidocCodeKeywordSpan">uploadFiles</span>(item, upFiles, true, callback);
					}
				}
			}
		}

		return callback();
	};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Location.prototype" id="apidoc.module.keystone.Field.Types.Location.prototype">module keystone.Field.Types.Location.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Location.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Location.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	var field = this;
	[&#x27;street&#x27;, &#x27;city&#x27;, &#x27;state&#x27;, &#x27;code&#x27;, &#x27;country&#x27;].forEach(function (i) {
		if (!filter[i]) return;
		var value = utils.escapeRegExp(filter[i]);
		value = new RegExp(value, &#x27;i&#x27;);
		query[field.paths[FILTER_PATH_MAP[i]]] = filter.inverted ? { $not: value } : value;
	});
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Location.prototype.addToSchema" id="apidoc.element.keystone.Field.Types.Location.prototype.addToSchema">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>addToSchema
        <span class="apidocSignatureSpan">(schema)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addToSchema = function (schema) {

	var field = this;
	var options = this.options;

	var paths = this.paths = {
		number: this.path + &#x27;.number&#x27;,
		name: this.path + &#x27;.name&#x27;,
		street1: this.path + &#x27;.street1&#x27;,
		street2: this.path + &#x27;.street2&#x27;,
		suburb: this.path + &#x27;.suburb&#x27;,
		state: this.path + &#x27;.state&#x27;,
		postcode: this.path + &#x27;.postcode&#x27;,
		country: this.path + &#x27;.country&#x27;,
		geo: this.path + &#x27;.geo&#x27;,
		geo_lat: this.path + &#x27;.geo_lat&#x27;,
		geo_lng: this.path + &#x27;.geo_lng&#x27;,
		serialised: this.path + &#x27;.serialised&#x27;,
		improve: this.path + &#x27;_improve&#x27;,
		overwrite: this.path + &#x27;_improve_overwrite&#x27;,
	};

	var getFieldDef = function (type, key) {
		var def = { type: type };
		if (options.defaults[key]) {
			def.default = options.defaults[key];
		}
		return def;
	};

	schema.nested[this.path] = true;
	schema.add({
		number: getFieldDef(String, &#x27;number&#x27;),
		name: getFieldDef(String, &#x27;name&#x27;),
		street1: getFieldDef(String, &#x27;street1&#x27;),
		street2: getFieldDef(String, &#x27;street2&#x27;),
		street3: getFieldDef(String, &#x27;street3&#x27;),
		suburb: getFieldDef(String, &#x27;suburb&#x27;),
		state: getFieldDef(String, &#x27;state&#x27;),
		postcode: getFieldDef(String, &#x27;postcode&#x27;),
		country: getFieldDef(String, &#x27;country&#x27;),
		geo: { type: [Number], index: &#x27;2dsphere&#x27; },
	}, this.path + &#x27;.&#x27;);

	schema.virtual(paths.serialised).get(function () {
		return _.compact([
			this.get(paths.number),
			this.get(paths.name),
			this.get(paths.street1),
			this.get(paths.street2),
			this.get(paths.suburb),
			this.get(paths.state),
			this.get(paths.postcode),
			this.get(paths.country),
		]).join(&#x27;, &#x27;);
	});

	// pre-save hook to fix blank geo fields
	// see http://stackoverflow.com/questions/16388836/does-applying-a-2dsphere-index-on-a-mongoose-schema-force-the-location-field
-to
	schema.pre(&#x27;save&#x27;, function (next) {
		var obj = field._path.get(this);
		var geo = (obj.geo || []).map(Number).filter(_.isFinite);
		obj.geo = (geo.length === 2) ? geo : undefined;
		next();
	});

	this.bindUnderscoreMethods();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Location.prototype.format" id="apidoc.element.keystone.Field.Types.Location.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>format
        <span class="apidocSignatureSpan">(item, values, delimiter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item, values, delimiter) {
	if (!values) {
		return item.get(this.paths.serialised);
	}
	var paths = this.paths;
	values = values.split(&#x27; &#x27;).map(function (i) {
		return item.get(paths[i]);
	});
	return _.compact(values).join(delimiter || &#x27;, &#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Location.prototype.getInputFromData" id="apidoc.element.keystone.Field.Types.Location.prototype.getInputFromData">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>getInputFromData
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getInputFromData = function (data) {
	// Allow JSON structured data
	var input = this.getValueFromData(data);

	// If there is no structured data, look for the flat paths
	if (!input) {
		input = {
			number: data[this.paths.number],
			name: data[this.paths.name],
			street1: data[this.paths.street1],
			street2: data[this.paths.street2],
			suburb: data[this.paths.suburb],
			state: data[this.paths.state],
			postcode: data[this.paths.postcode],
			country: data[this.paths.country],
			geo: data[this.paths.geo],
			geo_lat: data[this.paths.geo],
			geo_lng: data[this.paths.geo],
			improve: data[this.paths_improve],
			overwrite: data[this.paths_improve_overwrite],
		};
	}

	return input;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	}

	return this.getValueFromData(data);
};


datetime.prototype.validateRequiredInput = function (item, data, callback) {
	var value = this.<span class="apidocCodeKeywordSpan">getInputFromData</span>(data);
	var result = !!value;
	if (value === undefined &#x26;&#x26; item.get(this.path)) {
		result = true;
	}
	utils.defer(callback, result);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Location.prototype.googleLookup" id="apidoc.element.keystone.Field.Types.Location.prototype.googleLookup">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>googleLookup
        <span class="apidocSignatureSpan">(item, region, update, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">googleLookup = function (item, region, update, callback) {

	if (typeof update === &#x27;function&#x27;) {
		callback = update;
		update = false;
	}

	var field = this;
	var stored = item.get(this.path);
	var address = item.get(this.paths.serialised);

	if (address.length === 0) {
		return callback({
			status_code: 500,
			status_text: &#x27;No address to geocode&#x27;,
			status: &#x27;NO_ADDRESS&#x27;,
		});
	}

	doGoogleGeocodeRequest(address, region || keystone.get(&#x27;default region&#x27;), function (err, geocode) {

		if (err || geocode.status !== &#x27;OK&#x27;) {
			return callback(err || new Error(geocode.status + &#x27;: &#x27; + geocode.error_message));
		}

		// use the first result
		// if there were no results in the array, status would be ZERO_RESULTS
		var result = geocode.results[0];

		// parse the address components into a location object

		var location = {};

		_.forEach(result.address_components, function (val) {
			if (_.indexOf(val.types, &#x27;street_number&#x27;) &#x3e;= 0) {
				location.street1 = [val.long_name];
			}
			if (_.indexOf(val.types, &#x27;route&#x27;) &#x3e;= 0) {
				location.street1 = location.street1 || [];
				location.street1.push(val.short_name);
			}
			// in some cases, you get suburb, city as locality - so only use the first
			if (_.indexOf(val.types, &#x27;locality&#x27;) &#x3e;= 0 &#x26;&#x26; !location.suburb) {
				location.suburb = val.long_name;
			}
			if (_.indexOf(val.types, &#x27;administrative_area_level_1&#x27;) &#x3e;= 0) {
				location.state = val.short_name;
			}
			if (_.indexOf(val.types, &#x27;country&#x27;) &#x3e;= 0) {
				location.country = val.long_name;
			}
			if (_.indexOf(val.types, &#x27;postal_code&#x27;) &#x3e;= 0) {
				location.postcode = val.short_name;
			}
		});

		if (Array.isArray(location.street1)) {
			location.street1 = location.street1.join(&#x27; &#x27;);
		}

		location.geo = [
			result.geometry.location.lng,
			result.geometry.location.lat,
		];

		// console.log(&#x27;------ Google Geocode Results ------&#x27;);
		// console.log(address);
		// console.log(result);
		// console.log(location);

		if (update === &#x27;overwrite&#x27;) {
			item.set(field.path, location);
		} else if (update) {
			_.forEach(location, function (value, key) {
				if (key === &#x27;geo&#x27;) {
					return;
				}
				if (!stored[key]) {
					item.set(field.paths[key], value);
				}
			});
			if (!Array.isArray(stored.geo) || !stored.geo[0] || !stored.geo[1]) {
				item.set(field.paths.geo, location.geo);
			}
		}

		callback(null, location, result);

	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var lng = utils.number(values[valuePaths.geo_lng]);
		item.set(paths.geo, (lat &#x26;&#x26; lng) ? [lng, lat] : undefined);
	}

	var doGoogleLookup = this.getValueFromData(data, &#x27;_improve&#x27;);
	if (doGoogleLookup) {
		var googleUpdateMode = this.getValueFromData(data, &#x27;_improve_overwrite&#x27;) ? &#x27;overwrite&#x27; : true;
		this.<span class="apidocCodeKeywordSpan">googleLookup</span>(item, false, googleUpdateMode, function (err, location, result) {
			// TODO: we are currently discarding the error; it should probably be
			// sent back in the response, needs consideration
			callback();
		});
		return;
	}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Location.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.Location.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data, required, item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data, required, item) {
	if (!required) return true;
	var paths = this.paths;
	var nested = this._path.get(data);
	var values = nested || data;
	var valid = true;
	this.requiredPaths.forEach(function (path) {
		if (nested) {
			if (!(path in values) &#x26;&#x26; item &#x26;&#x26; item.get(paths[path])) {
				return;
			}
			if (!values[path]) {
				valid = false;
			}
		} else {
			if (!(paths[path] in values) &#x26;&#x26; item &#x26;&#x26; item.get(paths[path])) {
				return;
			}
			if (!values[paths[path]]) {
				valid = false;
			}
		}
	});
	return valid;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Location.prototype.isModified" id="apidoc.element.keystone.Field.Types.Location.prototype.isModified">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>isModified
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isModified = function (item) {
	return item.isModified(this.paths.number)
	|| item.isModified(this.paths.name)
	|| item.isModified(this.paths.street1)
	|| item.isModified(this.paths.street2)
	|| item.isModified(this.paths.suburb)
	|| item.isModified(this.paths.state)
	|| item.isModified(this.paths.postcode)
	|| item.isModified(this.paths.country)
	|| item.isModified(this.paths.geo);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var modified = false;
		var incomplete = false;
		var values = [];

		autokey.from.forEach(function (ops) {
			if (list.fields[ops.path]) {
				values.push(list.fields[ops.path].format(this, ops.format));
				if (list.fields[ops.path].<span class="apidocCodeKeywordSpan">isModified</span>(this)) {
					modified = true;
				}
				// if source field is neither selected nor modified we don&#x27;t have a way to generate a complete autokey
				else if (!this.isSelected(ops.path)) {
					incomplete = true;
				}
			} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Location.prototype.kmFrom" id="apidoc.element.keystone.Field.Types.Location.prototype.kmFrom">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>kmFrom
        <span class="apidocSignatureSpan">(item, point)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">kmFrom = function (item, point) {
	return calculateDistance(this.get(this.paths.geo), point) * RADIUS_KM;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Location.prototype.milesFrom" id="apidoc.element.keystone.Field.Types.Location.prototype.milesFrom">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>milesFrom
        <span class="apidocSignatureSpan">(item, point)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">milesFrom = function (item, point) {
	return calculateDistance(this.get(this.paths.geo), point) * RADIUS_MILES;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Location.prototype.updateItem" id="apidoc.element.keystone.Field.Types.Location.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {

	var paths = this.paths;
	var fieldKeys = [&#x27;number&#x27;, &#x27;name&#x27;, &#x27;street1&#x27;, &#x27;street2&#x27;, &#x27;suburb&#x27;, &#x27;state&#x27;, &#x27;postcode&#x27;, &#x27;country&#x27;];
	var geoKeys = [&#x27;geo&#x27;, &#x27;geo_lat&#x27;, &#x27;geo_lng&#x27;];
	var valueKeys = fieldKeys.concat(geoKeys);
	var valuePaths = valueKeys;
	var values = this._path.get(data);

	if (!values) {
		// Handle flattened values
		valuePaths = valueKeys.map(function (i) {
			return paths[i];
		});
		values = _.pick(data, valuePaths);
	}

	// convert valuePaths to a map for easier usage
	valuePaths = _.zipObject(valueKeys, valuePaths);

	var setValue = function (key) {
		if (valuePaths[key] in values &#x26;&#x26; values[valuePaths[key]] !== item.get(paths[key])) {
			item.set(paths[key], values[valuePaths[key]] || null);
		}
	};

	_.forEach(fieldKeys, setValue);

	if (valuePaths.geo in values) {
		var oldGeo = item.get(paths.geo) || [];
		if (oldGeo.length &#x3e; 1) {
			oldGeo[0] = item.get(paths.geo)[1];
			oldGeo[1] = item.get(paths.geo)[0];
		}
		var newGeo = values[valuePaths.geo];
		if (!Array.isArray(newGeo) || newGeo.length !== 2) {
			newGeo = [];
		}
		if (newGeo[0] !== oldGeo[0] || newGeo[1] !== oldGeo[1]) {
			item.set(paths.geo, newGeo);
		}
	} else if (valuePaths.geo_lat in values &#x26;&#x26; valuePaths.geo_lng in values) {
		var lat = utils.number(values[valuePaths.geo_lat]);
		var lng = utils.number(values[valuePaths.geo_lng]);
		item.set(paths.geo, (lat &#x26;&#x26; lng) ? [lng, lat] : undefined);
	}

	var doGoogleLookup = this.getValueFromData(data, &#x27;_improve&#x27;);
	if (doGoogleLookup) {
		var googleUpdateMode = this.getValueFromData(data, &#x27;_improve_overwrite&#x27;) ? &#x27;overwrite&#x27; : true;
		this.googleLookup(item, false, googleUpdateMode, function (err, location, result) {
			// TODO: we are currently discarding the error; it should probably be
			// sent back in the response, needs consideration
			callback();
		});
		return;
	}

	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Location.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Location.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	// var input = this.getInputFromData(data);
	// TODO: We should strictly check for types in input here
	utils.defer(callback, true);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Location.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Location.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Location.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var result = true;
	var input = this.getInputFromData(data);
	var currentValue = item.get(this.path);
	this.requiredPaths.forEach(function (path) {
		// ignore missing values if they already exist in the item
		if (input[path] === undefined &#x26;&#x26; currentValue[path]) return;
		// falsy values mean the input is invalid
		if (!input[path]) {
			result = false;
		}
	});
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Markdown.prototype" id="apidoc.module.keystone.Field.Types.Markdown.prototype">module keystone.Field.Types.Markdown.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Markdown.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Markdown.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Markdown.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	if (filter.mode === &#x27;exactly&#x27; &#x26;&#x26; !filter.value) {
		query[this.paths.md] = filter.inverted ? { $nin: [&#x27;&#x27;, null] } : { $in: [&#x27;&#x27;, null] };
		return query;
	}
	var value = utils.escapeRegExp(filter.value);
	if (filter.mode === &#x27;beginsWith&#x27;) {
		value = &#x27;^&#x27; + value;
	} else if (filter.mode === &#x27;endsWith&#x27;) {
		value = value + &#x27;$&#x27;;
	} else if (filter.mode === &#x27;exactly&#x27;) {
		value = &#x27;^&#x27; + value + &#x27;$&#x27;;
	}
	value = new RegExp(value, filter.caseSensitive ? &#x27;&#x27; : &#x27;i&#x27;);
	query[this.paths.md] = filter.inverted ? { $not: value } : value;
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Markdown.prototype.addToSchema" id="apidoc.element.keystone.Field.Types.Markdown.prototype.addToSchema">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Markdown.prototype.</span>addToSchema
        <span class="apidocSignatureSpan">(schema)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addToSchema = function (schema) {

	var paths = this.paths = {
		md: this.path + &#x27;.md&#x27;,
		html: this.path + &#x27;.html&#x27;,
	};

	var markedOptions = this.markedOptions;

	var setMarkdown = function (value) {
		if (value === this.get(paths.md)) {
			return value;
		}
		if (typeof value === &#x27;string&#x27;) {
			this.set(paths.html, marked(value, markedOptions));
			return value;
		} else {
			this.set(paths.html, undefined);
			return undefined;
		}
	};

	schema.nested[this.path] = true;
	schema.add({
		html: { type: String },
		md: { type: String, set: setMarkdown },
	}, this.path + &#x27;.&#x27;);

	this.bindUnderscoreMethods();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Markdown.prototype.format" id="apidoc.element.keystone.Field.Types.Markdown.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Markdown.prototype.</span>format
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item) {
	return item.get(this.paths.html);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Markdown.prototype.getData" id="apidoc.element.keystone.Field.Types.Markdown.prototype.getData">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Markdown.prototype.</span>getData
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getData = function (item) {
	var value = item.get(this.path);
	return typeof value === &#x27;object&#x27; ? value : {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					process.exit(1);
				}
			}
			break;
		case &#x27;module root&#x27;:
			// if relative path is used, resolve it based on the caller&#x27;s path
			if (!isAbsolutePath(value)) {
				var caller = callerId.<span class="apidocCodeKeywordSpan">getData</span>();
				value = path.resolve(path.dirname(caller.filePath), value);
			}
			break;
		case &#x27;app&#x27;:
			this.app = value;
			break;
		case &#x27;mongoose&#x27;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Markdown.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.Markdown.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Markdown.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data, required, item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data, required, item) {
	if (!(this.path in data) &#x26;&#x26; item &#x26;&#x26; item.get(this.paths.md)) {
		return true;
	}
	return (!required || data[this.path]) ? true : false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Markdown.prototype.isModified" id="apidoc.element.keystone.Field.Types.Markdown.prototype.isModified">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Markdown.prototype.</span>isModified
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isModified = function (item) {
	return item.isModified(this.paths.md);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var modified = false;
		var incomplete = false;
		var values = [];

		autokey.from.forEach(function (ops) {
			if (list.fields[ops.path]) {
				values.push(list.fields[ops.path].format(this, ops.format));
				if (list.fields[ops.path].<span class="apidocCodeKeywordSpan">isModified</span>(this)) {
					modified = true;
				}
				// if source field is neither selected nor modified we don&#x27;t have a way to generate a complete autokey
				else if (!this.isSelected(ops.path)) {
					incomplete = true;
				}
			} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Markdown.prototype.updateItem" id="apidoc.element.keystone.Field.Types.Markdown.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Markdown.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {
	var value = this.getValueFromData(data);
	if (value !== undefined) {
		item.set(this.paths.md, value);
	}	else if (this.paths.md in data) {
		item.set(this.paths.md, data[this.paths.md]);
	}
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Markdown.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Markdown.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Markdown.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var max = this.options.max;
	var min = this.options.min;
	var value = this.getValueFromData(data);
	var result = value === undefined || value === null || typeof value === &#x27;string&#x27;;
	if (max &#x26;&#x26; typeof value === &#x27;string&#x27;) {
		result = value.length &#x3c; max;
	}
	if (min &#x26;&#x26; typeof value === &#x27;string&#x27;) {
		result = value.length &#x3e; min;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Markdown.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Markdown.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Markdown.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = !!value;
	if (value === undefined &#x26;&#x26; item.get(this.path)) {
		result = true;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Money.prototype" id="apidoc.module.keystone.Field.Types.Money.prototype">module keystone.Field.Types.Money.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Money.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Money.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Money.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	if (filter.mode === &#x27;equals&#x27; &#x26;&#x26; !filter.value) {
		query[this.path] = filter.inverted ? { $nin: [&#x27;&#x27;, null] } : { $in: [&#x27;&#x27;, null] };
		return query;
	}
	if (filter.mode === &#x27;between&#x27;) {
		var min = utils.number(filter.value.min);
		var max = utils.number(filter.value.max);
		if (!isNaN(min) &#x26;&#x26; !isNaN(max)) {
			if (filter.inverted) {
				var gte = {}; gte[this.path] = { $gt: max };
				var lte = {}; lte[this.path] = { $lt: min };
				query.$or = [gte, lte];
			} else {
				query[this.path] = { $gte: min, $lte: max };
			}
		}
		return query;
	}
	var value = utils.number(filter.value);
	if (!isNaN(value)) {
		if (filter.mode === &#x27;gt&#x27;) {
			query[this.path] = filter.inverted ? { $lt: value } : { $gt: value };
		}
		else if (filter.mode === &#x27;lt&#x27;) {
			query[this.path] = filter.inverted ? { $gt: value } : { $lt: value };
		}
		else {
			query[this.path] = filter.inverted ? { $ne: value } : value;
		}
	}
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Money.prototype.format" id="apidoc.element.keystone.Field.Types.Money.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Money.prototype.</span>format
        <span class="apidocSignatureSpan">(item, format)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item, format) {
	if (this.currency) {
		try {
			numeral.language(this.currency, require(&#x27;numeral/languages/&#x27; + this.currency));
			numeral.language(this.currency);
		} catch (err) {
			throw new Error(&#x27;FieldType.Money: options.currency failed to load.&#x27;);
		}
	}
	if (format || this._formatString) {
		return (typeof item.get(this.path) === &#x27;number&#x27;) ? numeral(item.get(this.path)).format(format || this._formatString) : &#x27;&#x27;;
	} else {
		return item.get(this.path) || &#x27;&#x27;;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Money.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.Money.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Money.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data, required, item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data, required, item) {
	var value = this.getValueFromData(data);
	if (value === undefined &#x26;&#x26; item &#x26;&#x26; (item.get(this.path) || item.get(this.path) === 0)) {
		return true;
	}
	if (value !== undefined &#x26;&#x26; value !== &#x27;&#x27;) {
		var newValue = utils.number(value);
		return (!isNaN(newValue));
	} else {
		return (required) ? false : true;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Money.prototype.updateItem" id="apidoc.element.keystone.Field.Types.Money.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Money.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {
	var value = this.getValueFromData(data);
	if (value === undefined) {
		return process.nextTick(callback);
	}
	var newValue = utils.number(value);
	if (!isNaN(newValue)) {
		if (newValue !== item.get(this.path)) {
			item.set(this.path, newValue);
		}
	} else if (typeof item.get(this.path) === &#x27;number&#x27;) {
		item.set(this.path, null);
	}
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Money.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Money.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Money.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var value = this.getValueFromData(data);
	var result = value === undefined || typeof value === &#x27;number&#x27; || value === null;
	if (typeof value === &#x27;string&#x27;) {
		if (value === &#x27;&#x27;) {
			result = true;
		} else {
			value = utils.number(value);
			result = !isNaN(value);
		}
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Money.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Money.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Money.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = !!(value || typeof value === &#x27;number&#x27;);
	if (value === undefined &#x26;&#x26; item.get(this.path)) {
		result = true;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Name.prototype" id="apidoc.module.keystone.Field.Types.Name.prototype">module keystone.Field.Types.Name.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Name.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Name.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	if (filter.mode === &#x27;exactly&#x27; &#x26;&#x26; !filter.value) {
		query[this.paths.first] = query[this.paths.last] = filter.inverted ? { $nin: [&#x27;&#x27;, null] } : { $in: [&#x27;&#x27;, null] };
		return query;
	}
	var value = utils.escapeRegExp(filter.value);
	if (filter.mode === &#x27;beginsWith&#x27;) {
		value = &#x27;^&#x27; + value;
	} else if (filter.mode === &#x27;endsWith&#x27;) {
		value = value + &#x27;$&#x27;;
	} else if (filter.mode === &#x27;exactly&#x27;) {
		value = &#x27;^&#x27; + value + &#x27;$&#x27;;
	}
	value = new RegExp(value, filter.caseSensitive ? &#x27;&#x27; : &#x27;i&#x27;);
	if (filter.inverted) {
		query[this.paths.first] = query[this.paths.last] = { $not: value };
	} else {
		var first = {}; first[this.paths.first] = value;
		var last = {}; last[this.paths.last] = value;
		query.$or = [first, last];
	}
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Name.prototype.addToSchema" id="apidoc.element.keystone.Field.Types.Name.prototype.addToSchema">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>addToSchema
        <span class="apidocSignatureSpan">(schema)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addToSchema = function (schema) {
	var paths = this.paths = {
		first: this.path + &#x27;.first&#x27;,
		last: this.path + &#x27;.last&#x27;,
		full: this.path + &#x27;.full&#x27;,
	};

	schema.nested[this.path] = true;
	schema.add({
		first: String,
		last: String,
	}, this.path + &#x27;.&#x27;);

	schema.virtual(paths.full).get(function () {
		return displayName(this.get(paths.first), this.get(paths.last));
	});

	schema.virtual(paths.full).set(function (value) {
		if (typeof value !== &#x27;string&#x27;) {
			this.set(paths.first, undefined);
			this.set(paths.last, undefined);
			return;
		}
		var split = value.split(&#x27; &#x27;);
		this.set(paths.first, split.shift());
		this.set(paths.last, split.join(&#x27; &#x27;) || undefined);
	});

	this.bindUnderscoreMethods();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Name.prototype.format" id="apidoc.element.keystone.Field.Types.Name.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>format
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item) {
	return item.get(this.paths.full);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Name.prototype.getInputFromData" id="apidoc.element.keystone.Field.Types.Name.prototype.getInputFromData">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>getInputFromData
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getInputFromData = function (data) {
	// this.getValueFromData throws an error if we pass name: null
	if (data[this.path] === null) {
		return null;
	}
	var first = this.getValueFromData(data, &#x27;_first&#x27;);
	if (first === undefined) first = this.getValueFromData(data, &#x27;.first&#x27;);
	var last = this.getValueFromData(data, &#x27;_last&#x27;);
	if (last === undefined) last = this.getValueFromData(data, &#x27;.last&#x27;);
	if (first !== undefined || last !== undefined) {
		return {
			first: first,
			last: last,
		};
	}
	return this.getValueFromData(data) || this.getValueFromData(data, &#x27;.full&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	}

	return this.getValueFromData(data);
};


datetime.prototype.validateRequiredInput = function (item, data, callback) {
	var value = this.<span class="apidocCodeKeywordSpan">getInputFromData</span>(data);
	var result = !!value;
	if (value === undefined &#x26;&#x26; item.get(this.path)) {
		result = true;
	}
	utils.defer(callback, result);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Name.prototype.getSortString" id="apidoc.element.keystone.Field.Types.Name.prototype.getSortString">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>getSortString
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getSortString = function (options) {
	if (options.invert) {
		return &#x27;-&#x27; + this.paths.first + &#x27; -&#x27; + this.paths.last;
	}
	return this.paths.first + &#x27; &#x27; + this.paths.last;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			field: field,
			invert: invert,
			path: field.path,
		};
	}).filter(truthy);
	sort.string = sort.paths.map(function (i) {
		if (i.field.getSortString) {
			return i.field.<span class="apidocCodeKeywordSpan">getSortString</span>(i);
		}
		return i.invert ? &#x27;-&#x27; + i.path : i.path;
	}).join(&#x27; &#x27;);
	return sort;
}

module.exports = expandSort;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Name.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.Name.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data, required, item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data, required, item) {
	// Input is valid if none was provided, but the item has data
	if (!(this.path in data || this.paths.first in data || this.paths.last in data || this.paths.full in data) &#x26;&#x26; item &#x26;&#x26; item.get(
this.paths.full)) return true;
	// Input is valid if the field is not required
	if (!required) return true;
	// Otherwise check for valid strings in the provided data,
	// which may be nested or use flattened paths.
	if (_.isObject(data[this.path])) {
		return (data[this.path].full || data[this.path].first || data[this.path].last) ? true : false;
	} else {
		return (data[this.paths.full] || data[this.paths.first] || data[this.paths.last]) ? true : false;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Name.prototype.isModified" id="apidoc.element.keystone.Field.Types.Name.prototype.isModified">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>isModified
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isModified = function (item) {
	return item.isModified(this.paths.first) || item.isModified(this.paths.last);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var modified = false;
		var incomplete = false;
		var values = [];

		autokey.from.forEach(function (ops) {
			if (list.fields[ops.path]) {
				values.push(list.fields[ops.path].format(this, ops.format));
				if (list.fields[ops.path].<span class="apidocCodeKeywordSpan">isModified</span>(this)) {
					modified = true;
				}
				// if source field is neither selected nor modified we don&#x27;t have a way to generate a complete autokey
				else if (!this.isSelected(ops.path)) {
					incomplete = true;
				}
			} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Name.prototype.updateItem" id="apidoc.element.keystone.Field.Types.Name.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {
	var paths = this.paths;
	var value = this.getInputFromData(data);
	if (typeof value === &#x27;string&#x27; || value === null) {
		item.set(paths.full, value);
	} else if (typeof value === &#x27;object&#x27;) {
		if (typeof value.first === &#x27;string&#x27; || value.first === null) {
			item.set(paths.first, value.first);
		}
		if (typeof value.last === &#x27;string&#x27; || value.last === null) {
			item.set(paths.last, value.last);
		}
	}
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Name.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Name.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var value = this.getInputFromData(data);
	var result = value === undefined
		|| value === null
		|| typeof value === &#x27;string&#x27;
		|| (typeof value === &#x27;object&#x27; &#x26;&#x26; (
			typeof value.first === &#x27;string&#x27;
			|| value.first === null
			|| typeof value.last === &#x27;string&#x27;
			|| value.last === null)
		);
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Name.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Name.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Name.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getInputFromData(data);
	var result;
	if (value === null) {
		result = false;
	} else {
		result = (
			typeof value === &#x27;string&#x27; &#x26;&#x26; value.length
			|| typeof value === &#x27;object&#x27; &#x26;&#x26; (
				typeof value.first === &#x27;string&#x27; &#x26;&#x26; value.first.length
				|| typeof value.last === &#x27;string&#x27; &#x26;&#x26; value.last.length)
			|| (item.get(this.paths.full)
				|| item.get(this.paths.first)
				|| item.get(this.paths.last)) &#x26;&#x26; (
					value === undefined
					|| (value.first === undefined
						&#x26;&#x26; value.last === undefined))
			) ? true : false;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Number.prototype" id="apidoc.module.keystone.Field.Types.Number.prototype">module keystone.Field.Types.Number.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Number.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Number.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Number.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	if (filter.mode === &#x27;equals&#x27; &#x26;&#x26; !filter.value) {
		query[this.path] = filter.inverted ? { $nin: [&#x27;&#x27;, null] } : { $in: [&#x27;&#x27;, null] };
		return query;
	}
	if (filter.mode === &#x27;between&#x27;) {
		var min = utils.number(filter.value.min);
		var max = utils.number(filter.value.max);
		if (!isNaN(min) &#x26;&#x26; !isNaN(max)) {
			if (filter.inverted) {
				var gte = {}; gte[this.path] = { $gt: max };
				var lte = {}; lte[this.path] = { $lt: min };
				query.$or = [gte, lte];
			} else {
				query[this.path] = { $gte: min, $lte: max };
			}
		}
		return query;
	}
	var value = utils.number(filter.value);
	if (!isNaN(value)) {
		if (filter.mode === &#x27;gt&#x27;) {
			query[this.path] = filter.inverted ? { $lt: value } : { $gt: value };
		}
		else if (filter.mode === &#x27;lt&#x27;) {
			query[this.path] = filter.inverted ? { $gt: value } : { $lt: value };
		}
		else {
			query[this.path] = filter.inverted ? { $ne: value } : value;
		}
	}
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Number.prototype.format" id="apidoc.element.keystone.Field.Types.Number.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Number.prototype.</span>format
        <span class="apidocSignatureSpan">(item, format)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item, format) {
	var value = item.get(this.path);
	if (format || this.formatString) {
		return (typeof value === &#x27;number&#x27;) ? numeral(value).format(format || this.formatString) : &#x27;&#x27;;
	} else {
		return value || value === 0 ? String(value) : &#x27;&#x27;;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Number.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.Number.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Number.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data, required, item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data, required, item) {
	var value = this.getValueFromData(data);
	if (value === undefined &#x26;&#x26; item &#x26;&#x26; (item.get(this.path) || item.get(this.path) === 0)) {
		return true;
	}
	if (value !== undefined &#x26;&#x26; value !== &#x27;&#x27;) {
		var newValue = utils.number(value);
		return (!isNaN(newValue));
	} else {
		return (required) ? false : true;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Number.prototype.updateItem" id="apidoc.element.keystone.Field.Types.Number.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Number.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {
	var value = this.getValueFromData(data);
	if (value === undefined) {
		return process.nextTick(callback);
	}
	var newValue = utils.number(value);
	if (!isNaN(newValue)) {
		if (newValue !== item.get(this.path)) {
			item.set(this.path, newValue);
		}
	} else if (typeof item.get(this.path) === &#x27;number&#x27;) {
		item.set(this.path, null);
	}
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Number.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Number.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Number.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var value = this.getValueFromData(data);
	var result = value === undefined || typeof value === &#x27;number&#x27; || value === null;
	if (typeof value === &#x27;string&#x27;) {
		if (value === &#x27;&#x27;) {
			result = true;
		} else {
			value = utils.number(value);
			result = !isNaN(value);
		}
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Number.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Number.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Number.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = !!(value || typeof value === &#x27;number&#x27;);
	if (value === undefined &#x26;&#x26; item.get(this.path)) {
		result = true;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.NumberArray.prototype" id="apidoc.module.keystone.Field.Types.NumberArray.prototype">module keystone.Field.Types.NumberArray.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.NumberArray.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.NumberArray.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.NumberArray.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	var presence = filter.presence || &#x27;some&#x27;;
	// Filter empty/non-empty arrays (copied from textarray)
	if (filter.value === undefined
		|| filter.value === null
		|| filter.value === &#x27;&#x27;) {
		// &#x22;At least one element contains nothing&#x22;
		// This isn&#x27;t 100% accurate because this will only return arrays that
		// don&#x27;t have elements, not ones that have empty elements, but it works
		// fine for 99% of the usecase
		query[this.path] = presence === &#x27;some&#x27; ? {
			$size: 0,
		// &#x22;No elements contain nothing&#x22;
		} : {
			$not: {
				$size: 0,
			},
		};
		return query;
	}
	// Filter between two numbers
	if (filter.mode === &#x27;between&#x27;) {
		var min = utils.number(filter.value.min);
		var max = utils.number(filter.value.max);
		if (!isNaN(min) &#x26;&#x26; !isNaN(max)) {
			query[this.path] = {
				$gte: min,
				$lte: max,
			};
			query[this.path] = addPresenceToQuery(presence, query[this.path]);
		}
		return query;
	}
	var value = utils.number(filter.value);
	// Filter greater than, less than and equals
	if (!isNaN(value)) {
		if (filter.mode === &#x27;gt&#x27;) {
			query[this.path] = {
				$gt: value,
			};
		}
		else if (filter.mode === &#x27;lt&#x27;) {
			query[this.path] = {
				$lt: value,
			};
		}
		else {
			query[this.path] = {
				$eq: value,
			};
		}
		query[this.path] = addPresenceToQuery(presence, query[this.path]);
	}
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.NumberArray.prototype.format" id="apidoc.element.keystone.Field.Types.NumberArray.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.NumberArray.prototype.</span>format
        <span class="apidocSignatureSpan">(item, format, separator)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item, format, separator) {
	var value = item.get(this.path);
	if (format || this._formatString) {
		value = value.map(function (n) {
			return numeral(n).format(format || this._formatString);
		});
	}
	return value.join(separator || this.separator);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.NumberArray.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.NumberArray.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.NumberArray.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data, required, item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data, required, item) {
	var value = this.getValueFromData(data);
	if (required) {
		if (value === undefined &#x26;&#x26; item &#x26;&#x26; item.get(this.path) &#x26;&#x26; item.get(this.path).length) {
			return true;
		}
		if (value === undefined || !Array.isArray(value) || (typeof value !== &#x27;string&#x27;) || (typeof value !== &#x27;number&#x27;)) {
			return false;
		}
		if (Array.isArray(value) &#x26;&#x26; !value.length) {
			return false;
		}
	}
	if (typeof value === &#x27;string&#x27;) {
		if (!isValidNumber(value)) {
			return false;
		}
	}
	if (Array.isArray(value)) {
		for (var index = 0; index &#x3c; value.length; index++) {
			if (!isValidNumber(value[index])) {
				return false;
			}
		}
	}
	return (value === undefined || Array.isArray(value) || (typeof value === &#x27;string&#x27;) || (typeof value === &#x27;number&#x27;));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.NumberArray.prototype.updateItem" id="apidoc.element.keystone.Field.Types.NumberArray.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.NumberArray.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {
	var value = this.getValueFromData(data);
	if (value === undefined || value === null || value === &#x27;&#x27;) {
		value = [];
	}
	if (!Array.isArray(value)) {
		value = [value];
	}
	value = value.map(function (num) {
		if (typeof num !== &#x27;number&#x27;) {
			num = utils.number(num);
		}
		return num;
	}).filter(function (num) {
		return !Number.isNaN(num);
	});
	item.set(this.path, value);
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.NumberArray.prototype.validateInput" id="apidoc.element.keystone.Field.Types.NumberArray.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.NumberArray.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var value = this.getValueFromData(data);
	var result = true;
	// Let undefined, empty string and null pass
	if (value !== undefined &#x26;&#x26; value !== &#x27;&#x27; &#x26;&#x26; value !== null) {
		// Coerce a single value to an array
		if (!Array.isArray(value)) {
			value = [value];
		}
		for (var i = 0; i &#x3c; value.length; i++) {
			var thisValue = value[i];
			// If it&#x27;s a string, check if there&#x27;s a number in the string
			if (typeof thisValue === &#x27;string&#x27;) {
				thisValue = utils.number(thisValue);
			}
			// If it&#x27;s not a number or NaN invalidate
			if (typeof thisValue !== &#x27;number&#x27; || Number.isNaN(thisValue)) {
				result = false;
				break;
			}
		}
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.NumberArray.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.NumberArray.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.NumberArray.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = false;
	// If the field is undefined but has a value saved already, validate
	if (value === undefined) {
		if (item.get(this.path) &#x26;&#x26; item.get(this.path).length) {
			result = true;
		}
	}
	// If it&#x27;s a string that&#x27;s not empty, validate
	if (typeof value === &#x27;string&#x27; &#x26;&#x26; value !== &#x27;&#x27;) {
		result = true;
	// If it&#x27;s an array of only numbers and/or numberify-able data, validate
	} else if (Array.isArray(value)) {
		var invalidContent = false;
		for (var i = 0; i &#x3c; value.length; i++) {
			var thisValue = value[i];
			// If it&#x27;s a string, check if there&#x27;s a number in the string
			if (typeof thisValue === &#x27;string&#x27;) {
				thisValue = utils.number(thisValue);
			}
			// If even a single item is not a number or NaN, invalidate
			if (typeof thisValue !== &#x27;number&#x27; || Number.isNaN(thisValue)) {
				invalidContent = true;
				break;
			}
		}
		if (invalidContent === false) {
			result = true;
		}
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Password.prototype" id="apidoc.module.keystone.Field.Types.Password.prototype">module keystone.Field.Types.Password.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Password.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Password.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Password.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	query[this.path] = (filter.exists) ? { $ne: null } : null;
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Password.prototype.addToSchema" id="apidoc.element.keystone.Field.Types.Password.prototype.addToSchema">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Password.prototype.</span>addToSchema
        <span class="apidocSignatureSpan">(schema)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addToSchema = function (schema) {
	var field = this;
	var needs_hashing = &#x27;__&#x27; + field.path + &#x27;_needs_hashing&#x27;;

	this.paths = {
		confirm: this.options.confirmPath || this.path + &#x27;_confirm&#x27;,
		hash: this.options.hashPath || this.path + &#x27;_hash&#x27;,
	};

	schema.path(this.path, _.defaults({
		type: String,
		set: function (newValue) {
			this[needs_hashing] = true;
			return newValue;
		},
	}, this.options));

	schema.virtual(this.paths.hash).set(function (newValue) {
		this.set(field.path, newValue);
		this[needs_hashing] = false;
	});

	schema.pre(&#x27;save&#x27;, function (next) {
		if (!this.isModified(field.path) || !this[needs_hashing]) {
			return next();
		}
		// reset the [needs_hashing] flag so that new values can&#x27;t be hashed more than once
		// (inherited models double up on pre save handlers for password fields)
		this[needs_hashing] = false;
		if (!this.get(field.path)) {
			this.set(field.path, undefined);
			return next();
		}
		var item = this;
		bcrypt.genSalt(field.workFactor, function (err, salt) {
			if (err) {
				return next(err);
			}
			bcrypt.hash(item.get(field.path), salt, function () {}, function (err, hash) {
				if (err) {
					return next(err);
				}
				// override the cleartext password with the hashed one
				item.set(field.path, hash);
				next();
			});
		});
	});
	this.bindUnderscoreMethods();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Password.prototype.compare" id="apidoc.element.keystone.Field.Types.Password.prototype.compare">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Password.prototype.</span>compare
        <span class="apidocSignatureSpan">(item, candidate, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">compare = function (item, candidate, callback) {
	if (typeof callback !== &#x27;function&#x27;) throw new Error(&#x27;Password.compare() requires a callback function.&#x27;);
	var value = item.get(this.path);
	if (!value) return callback(null, false);
	bcrypt.compare(candidate, item.get(this.path), callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			// exclude non-javascript or coffee files in the updates folder
			return (path.extname(i) !== &#x27;.js&#x27; &#x26;&#x26; path.extname(i) !== &#x27;.coffee&#x27;) ? false : path.basename(i, &#
x27;.js&#x27;);
		}).filter(function (i) {
			// exclude falsy values and filenames that without a valid semver
			return i &#x26;&#x26; semver.valid(i.split(&#x27;-&#x27;)[0]);
		}).sort(function (a, b) {
			// exclude anything after a hyphen from the version number
			return semver.<span class="apidocCodeKeywordSpan">compare</span>(a.split(&#x27;-&#x27;)[0], b.split(&#x27;-&#x27;)[0]);
		});

	async.eachSeries(updates, applyUpdate, function (err) {
		if (updateCount || deferCount || skipCount) {
			var status = &#x27;&#x27;;
			if (updateCount) {
				status += &#x27;Successfully applied &#x27; + utils.plural(updateCount, &#x27;* update&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Password.prototype.format" id="apidoc.element.keystone.Field.Types.Password.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Password.prototype.</span>format
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item) {
	if (!item.get(this.path)) return &#x27;&#x27;;
	var len = Math.round(Math.random() * 4) + 6;
	var stars = &#x27;&#x27;;
	for (var i = 0; i &#x3c; len; i++) stars += &#x27;*&#x27;;
	return stars;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Password.prototype.getData" id="apidoc.element.keystone.Field.Types.Password.prototype.getData">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Password.prototype.</span>getData
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getData = function (item) {
	return item.get(this.path) ? true : false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					process.exit(1);
				}
			}
			break;
		case &#x27;module root&#x27;:
			// if relative path is used, resolve it based on the caller&#x27;s path
			if (!isAbsolutePath(value)) {
				var caller = callerId.<span class="apidocCodeKeywordSpan">getData</span>();
				value = path.resolve(path.dirname(caller.filePath), value);
			}
			break;
		case &#x27;app&#x27;:
			this.app = value;
			break;
		case &#x27;mongoose&#x27;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Password.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.Password.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Password.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data, required, item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data, required, item) {
	if (data[this.path] &#x26;&#x26; this.paths.confirm in data) {
		return data[this.path] === data[this.paths.confirm] ? true : false;
	}
	if (data[this.path] || data[this.paths.hash] || (item &#x26;&#x26; item.get(this.path))) return true;
	return required ? false : true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Password.prototype.updateItem" id="apidoc.element.keystone.Field.Types.Password.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Password.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {
	var hashValue = this.getValueFromData(data, &#x27;_hash&#x27;);
	var passwordValue = this.getValueFromData(data);
	if (passwordValue !== undefined) {
		item.set(this.path, passwordValue);
	} else if (hashValue !== undefined) {
		item.set(this.paths.hash, hashValue);
	}
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Password.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Password.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Password.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var detail = &#x27;&#x27;;
	var result = true;
	var min = this.options.min;
	var max = this.options.max || 72;
	var complexity = this.options.complexity;
	var confirmValue = this.getValueFromData(data, &#x27;_confirm&#x27;);
	var passwordValue = this.getValueFromData(data);
	if (confirmValue !== undefined
		&#x26;&#x26; passwordValue !== confirmValue) {
		detail = &#x27;passwords must match\n&#x27;;
	}

	if (min &#x26;&#x26; typeof passwordValue === &#x27;string&#x27; &#x26;&#x26; passwordValue.length &#x3c; min) {
		detail += &#x27;password must be longer than &#x27; + min + &#x27; characters\n&#x27;;
	}

	if (max &#x26;&#x26; typeof passwordValue === &#x27;string&#x27; &#x26;&#x26; passwordValue.length &#x3e; max) {
		detail += &#x27;password must not be longer than &#x27; + max + &#x27; characters\n&#x27;;
	}

	for (var prop in complexity) {
		if (complexity[prop] &#x26;&#x26; typeof passwordValue === &#x27;string&#x27;) {
			var complexityCheck = (regexChunk[prop]).test(passwordValue);
			if (!complexityCheck) {
				detail += detailMsg[prop] + &#x27;\n&#x27;;
			}
		}
	}
	result = detail.length === 0;

	utils.defer(callback, result, detail);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Password.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Password.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Password.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var hashValue = this.getValueFromData(data, &#x27;_hash&#x27;);
	var passwordValue = this.getValueFromData(data);
	var result = hashValue || passwordValue ? true : false;
	if (!result &#x26;&#x26; passwordValue === undefined &#x26;&#x26; hashValue === undefined &#x26;&#x26; item.get(this.path)) result = true;
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Relationship.prototype" id="apidoc.module.keystone.Field.Types.Relationship.prototype">module keystone.Field.Types.Relationship.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Relationship.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Relationship.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	if (!Array.isArray(filter.value)) {
		if (typeof filter.value === &#x27;string&#x27; &#x26;&#x26; filter.value) {
			filter.value = [filter.value];
		} else {
			filter.value = [];
		}
	}
	if (filter.value.length) {
		query[this.path] = (filter.inverted) ? { $nin: filter.value } : { $in: filter.value };
	} else {
		if (this.many) {
			query[this.path] = (filter.inverted) ? { $not: { $size: 0 } } : { $size: 0 };
		} else {
			query[this.path] = (filter.inverted) ? { $ne: null } : null;
		}
	}
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Relationship.prototype.addToSchema" id="apidoc.element.keystone.Field.Types.Relationship.prototype.addToSchema">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>addToSchema
        <span class="apidocSignatureSpan">(schema)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addToSchema = function (schema) {
	var field = this;
	var def = {
		type: this._nativeType,
		ref: this.options.ref,
		index: (this.options.index ? true : false),
		required: (this.options.required ? true : false),
		unique: (this.options.unique ? true : false),
	};
	this.paths = {
		refList: this.options.refListPath || this.path + &#x27;RefList&#x27;,
	};
	schema.path(this.path, this.many ? [def] : def);
	schema.virtual(this.paths.refList).get(function () {
		return keystone.list(field.options.ref);
	});
	this.bindUnderscoreMethods();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Relationship.prototype.format" id="apidoc.element.keystone.Field.Types.Relationship.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>format
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item) {
	var value = item.get(this.path);
	// force the formatted value to be a string - unexpected things happen with ObjectIds.
	return this.many ? value.join(&#x27;, &#x27;) : (value || &#x27;&#x27;) + &#x27;&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Relationship.prototype.getData" id="apidoc.element.keystone.Field.Types.Relationship.prototype.getData">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>getData
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getData = function (item) {
	var value = item.get(this.path);
	if (this.many) {
		return Array.isArray(value) ? value : [];
	} else {
		return value;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					process.exit(1);
				}
			}
			break;
		case &#x27;module root&#x27;:
			// if relative path is used, resolve it based on the caller&#x27;s path
			if (!isAbsolutePath(value)) {
				var caller = callerId.<span class="apidocCodeKeywordSpan">getData</span>();
				value = path.resolve(path.dirname(caller.filePath), value);
			}
			break;
		case &#x27;app&#x27;:
			this.app = value;
			break;
		case &#x27;mongoose&#x27;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Relationship.prototype.getExpandedData" id="apidoc.element.keystone.Field.Types.Relationship.prototype.getExpandedData">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>getExpandedData
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getExpandedData = function (item) {
	var value = item.get(this.path);
	if (this.many) {
		if (!value || !Array.isArray(value)) return [];
		return value.map(expandRelatedItemData.bind(this)).filter(truthy);
	} else {
		return expandRelatedItemData.call(this, value);
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (field.type !== &#x27;relationship&#x27; || !options.expandRelationshipFields) {
				// use the transformFieldValue function to get the data
				data[path] = transformFieldValue(field, item, options);
				return;
			}
			// relationship values should be expanded into separate name and
			// id pairs using the field&#x27;s getExpandedData method.
			var expanded = field.<span class="apidocCodeKeywordSpan">getExpandedData</span>(item);
			if (field.many) {
				// for many-type relationships, ensure the value is an array,
				// and turn it into a list of &#x27;name (id)&#x27; values
				data[path] = (Array.isArray(expanded) ? expanded : []).map(function (i) {
					return i.name ? i.name + &#x27; (&#x27; + i.id + &#x27;)&#x27; : i.id;
				}).join(&#x27;, &#x27;);
			} else if (typeof expanded === &#x27;object&#x27;) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Relationship.prototype.getProperties" id="apidoc.element.keystone.Field.Types.Relationship.prototype.getProperties">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>getProperties
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getProperties = function () {
	var refList = this.refList;
	return {
		refList: {
			singular: refList.singular,
			plural: refList.plural,
			path: refList.path,
			key: refList.key,
		},
	};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Relationship.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.Relationship.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data, required, item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data, required, item) {
	if (!required) return true;
	if (!(this.path in data) &#x26;&#x26; item &#x26;&#x26; ((this.many &#x26;&#x26; item.get(this.path).length) || item.get(this.path))) return true;
	if (typeof data[this.path] === &#x27;string&#x27;) {
		return (data[this.path].trim()) ? true : false;
	} else {
		return (data[this.path]) ? true : false;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Relationship.prototype.updateItem" id="apidoc.element.keystone.Field.Types.Relationship.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {
	if (item.populated(this.path)) {
		throw new Error(&#x27;fieldTypes.relationship.updateItem() Error - You cannot update populated relationships.&#x27;);
	}
	if (this.many) {
		var arr = item.get(this.path);
		var _old = arr.map(function (i) { return String(i); });
		var _new = data[this.path];
		if (!utils.isArray(_new)) {
			_new = String(_new || &#x27;&#x27;).split(&#x27;,&#x27;);
		}
		_new = _.compact(_new);
		// Only update if the lists aren&#x27;t the same
		if (!_.isEqual(_old, _new)) {
			item.set(this.path, _new);
		}
	} else {
		if (data[this.path]) {
			if (data[this.path] !== item.get(this.path)) {
				item.set(this.path, data[this.path]);
			}
		} else if (item.get(this.path)) {
			item.set(this.path, null);
		}
	}
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Relationship.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Relationship.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var value = this.getValueFromData(data);
	var result = false;
	if (value === undefined || value === null || value === &#x27;&#x27;) {
		result = true;
	} else {
		if (this.many) {
			if (!Array.isArray(value) &#x26;&#x26; typeof value === &#x27;string&#x27; &#x26;&#x26; value.length) {
				value = [value];
			}
			if (Array.isArray(value)) {
				result = true;
			}
		} else {
			if (typeof value === &#x27;string&#x27; &#x26;&#x26; value.length) {
				result = true;
			}
			if (typeof value === &#x27;object&#x27; &#x26;&#x26; value.id) {
				result = true;
			}
		}
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Relationship.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Relationship.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Relationship.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = false;
	if (value === undefined) {
		if (this.many) {
			if (item.get(this.path).length) {
				result = true;
			}
		} else {
			if (item.get(this.path)) {
				result = true;
			}
		}
	} else if (this.many) {
		if (!Array.isArray(value) &#x26;&#x26; typeof value === &#x27;string&#x27; &#x26;&#x26; value.length) {
			value = [value];
		}
		if (Array.isArray(value) &#x26;&#x26; value.length) {
			result = true;
		}
	} else {
		if (value) {
			result = true;
		}
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.S3File.prototype" id="apidoc.module.keystone.Field.Types.S3File.prototype">module keystone.Field.Types.S3File.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.S3File.prototype.addToSchema" id="apidoc.element.keystone.Field.Types.S3File.prototype.addToSchema">
        function <span class="apidocSignatureSpan">keystone.Field.Types.S3File.prototype.</span>addToSchema
        <span class="apidocSignatureSpan">(schema)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addToSchema = function (schema) {

	var knox = require(&#x27;knox&#x27;);
	var field = this;

	var paths = this.paths = {
		// fields
		filename: this.path + &#x27;.filename&#x27;,
		originalname: this.path + &#x27;.originalname&#x27;,
		path: this.path + &#x27;.path&#x27;,
		size: this.path + &#x27;.size&#x27;,
		filetype: this.path + &#x27;.filetype&#x27;,
		url: this.path + &#x27;.url&#x27;,
		// virtuals
		exists: this.path + &#x27;.exists&#x27;,
		upload: this.path + &#x27;_upload&#x27;,
		action: this.path + &#x27;_action&#x27;,
	};

	var schemaPaths = this._path.addTo({}, {
		filename: String,
		originalname: String,
		path: String,
		size: Number,
		filetype: String,
		url: String,
	});

	schema.add(schemaPaths);

	var exists = function (item) {
		return (item.get(paths.url) ? true : false);
	};

	// The .exists virtual indicates whether a file is stored
	schema.virtual(paths.exists).get(function () {
		return schemaMethods.exists.apply(this);
	});

	var reset = function (item) {
		item.set(field.path, {
			filename: &#x27;&#x27;,
			originalname: &#x27;&#x27;,
			path: &#x27;&#x27;,
			size: 0,
			filetype: &#x27;&#x27;,
			url: &#x27;&#x27;,
		});
	};

	var schemaMethods = {
		exists: function () {
			return exists(this);
		},
		<span class="apidocCodeCommentSpan">/**
		 * Resets the value of the field
		 *
		 * @api public
		 */
</span>		reset: function () {
			reset(this);
		},
		/**
		 * Deletes the file from S3File and resets the field
		 *
		 * @api public
		 */
		delete: function () {
			try {
				var client = knox.createClient(field.s3config);
				client.deleteFile(this.get(paths.path) + this.get(paths.filename), function (err, res) { return res ? res.resume() : false; }); //
eslint-disable-line handle-callback-err
			} catch (e) {} // eslint-disable-line no-empty
			reset(this);
		},
	};

	_.forEach(schemaMethods, function (fn, key) {
		field.underscoreMethod(key, fn);
	});

	// expose a method on the field to call schema methods
	this.apply = function (item, method) {
		return schemaMethods[method].apply(item, Array.prototype.slice.call(arguments, 2));
	};

	this.bindUnderscoreMethods();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.S3File.prototype.format" id="apidoc.element.keystone.Field.Types.S3File.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.S3File.prototype.</span>format
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item) {
	if (this.hasFormatter()) {
		return this.options.format(item, item[this.path]);
	}
	return item.get(this.paths.url);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.S3File.prototype.generateHeaders" id="apidoc.element.keystone.Field.Types.S3File.prototype.generateHeaders">
        function <span class="apidocSignatureSpan">keystone.Field.Types.S3File.prototype.</span>generateHeaders
        <span class="apidocSignatureSpan">(item, file, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">generateHeaders = function (item, file, callback) {
	var field = this;
	var filetype = file.mimetype || file.type;
	var headers = {
		&#x27;Content-Type&#x27;: filetype,
		&#x27;x-amz-acl&#x27;: &#x27;public-read&#x27;,
	};
	var customHeaders = {};
	var headersOption = {};
	var computedHeaders;
	var defaultHeaders;


	if (_.has(field.s3config, &#x27;default headers&#x27;)) {
		defaultHeaders = field.s3config[&#x27;default headers&#x27;];
		if (_.isArray(defaultHeaders)) {
			_.forEach(defaultHeaders, function (header) {
				var _header = {};
				if (validateHeader(header, callback)) {
					_header[header.name] = header.value;
					customHeaders = assign(customHeaders, _header);
				}
			});
		} else if (_.isObject(defaultHeaders)) {
			customHeaders = assign(customHeaders, defaultHeaders);
		} else {
			return callback(new Error(&#x27;Unsupported Header option: defaults headers must be either an Object or Array &#x27; + JSON.stringify(defaultHeaders
)));
		}
	}

	if (field.options.headers) {
		headersOption = field.options.headers;

		if (_.isFunction(headersOption)) {
			computedHeaders = headersOption.call(field, item, file);

			if (_.isArray(computedHeaders)) {
				_.forEach(computedHeaders, function (header) {
					var _header = {};
					if (validateHeader(header, callback)) {
						_header[header.name] = header.value;
						customHeaders = assign(customHeaders, _header);
					}
				});
			} else if (_.isObject(computedHeaders)) {
				customHeaders = assign(customHeaders, computedHeaders);
			} else {
				return callback(new Error(&#x27;Unsupported Header option: computed headers must be either an Object or Array &#x27; + JSON.stringify(
computedHeaders)));
			}

		} else if (_.isArray(headersOption)) {
			_.forEach(headersOption, function (header) {
				var _header = {};
				if (validateHeader(header, callback)) {
					_header[header.name] = header.value;
					customHeaders = assign(customHeaders, _header);
				}
			});
		} else if (_.isObject(headersOption)) {
			customHeaders = assign(customHeaders, headersOption);
		}
	}

	if (validateHeaders(customHeaders, callback)) {
		headers = assign(headers, customHeaders);
	}

	return headers;

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			path = field.options.path(item, path);
		}

		if (typeof field.options.filename === &#x27;function&#x27;) {
			filename = field.options.filename(item, filename, originalname);
		}

		headers = field.<span class="apidocCodeKeywordSpan">generateHeaders</span>(item, file, callback);

		knox.createClient(field.s3config).putFile(file.path, path + filename, headers, function (err, res) {

			if (err) return callback(err);
			if (res) {
				if (res.statusCode !== 200) {
					return callback(new Error(&#x27;Amazon returned Http Code: &#x27; + res.statusCode));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.S3File.prototype.getRequestHandler" id="apidoc.element.keystone.Field.Types.S3File.prototype.getRequestHandler">
        function <span class="apidocSignatureSpan">keystone.Field.Types.S3File.prototype.</span>getRequestHandler
        <span class="apidocSignatureSpan">(item, req, paths, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getRequestHandler = function (item, req, paths, callback) {

	var field = this;

	if (utils.isFunction(paths)) {
		callback = paths;
		paths = field.paths;
	} else if (!paths) {
		paths = field.paths;
	}

	callback = callback || function () {};

	return function () {

		if (req.body) {
			var action = req.body[paths.action];

			if (/^(delete|reset)$/.test(action)) {
				field.apply(item, action);
			}
		}

		if (req.files &#x26;&#x26; req.files[paths.upload] &#x26;&#x26; req.files[paths.upload].size) {
			return field.uploadFile(item, req.files[paths.upload], true, callback);
		}

		return callback();

	};

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.S3File.prototype.hasFormatter" id="apidoc.element.keystone.Field.Types.S3File.prototype.hasFormatter">
        function <span class="apidocSignatureSpan">keystone.Field.Types.S3File.prototype.</span>hasFormatter
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasFormatter = function () {
	return typeof this.options.format === &#x27;function&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * Formats the field value
 *
 * Delegates to the options.format function if it exists.
 * @api public
 */
localfile.prototype.format = function (item) {
	if (!item.get(this.paths.filename)) return &#x27;&#x27;;
	if (this.<span class="apidocCodeKeywordSpan">hasFormatter</span>()) {
		var file = item.get(this.path);
		file.href = this.href(item);
		return this.options.format.call(this, item, file);
	}
	return this.href(item);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.S3File.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.S3File.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.S3File.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data) { // eslint-disable-line no-unused-vars
	// TODO - how should file field input be validated?
	return true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.S3File.prototype.isModified" id="apidoc.element.keystone.Field.Types.S3File.prototype.isModified">
        function <span class="apidocSignatureSpan">keystone.Field.Types.S3File.prototype.</span>isModified
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isModified = function (item) {
	return item.isModified(this.paths.url);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var modified = false;
		var incomplete = false;
		var values = [];

		autokey.from.forEach(function (ops) {
			if (list.fields[ops.path]) {
				values.push(list.fields[ops.path].format(this, ops.format));
				if (list.fields[ops.path].<span class="apidocCodeKeywordSpan">isModified</span>(this)) {
					modified = true;
				}
				// if source field is neither selected nor modified we don&#x27;t have a way to generate a complete autokey
				else if (!this.isSelected(ops.path)) {
					incomplete = true;
				}
			} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.S3File.prototype.updateItem" id="apidoc.element.keystone.Field.Types.S3File.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.S3File.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) { // eslint-disable-line no-unused-vars
	// TODO - direct updating of data (not via upload)
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.S3File.prototype.uploadFile" id="apidoc.element.keystone.Field.Types.S3File.prototype.uploadFile">
        function <span class="apidocSignatureSpan">keystone.Field.Types.S3File.prototype.</span>uploadFile
        <span class="apidocSignatureSpan">(item, file, update, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">uploadFile = function (item, file, update, callback) {

	var knox = require(&#x27;knox&#x27;);
	var field = this;
	var path = field.options.s3path ? field.options.s3path + &#x27;/&#x27; : &#x27;&#x27;;
	var prefix = field.options.datePrefix ? moment().format(field.options.datePrefix) + &#x27;-&#x27; : &#x27;&#x27;;
	var filename = prefix + file.name;
	var originalname = file.originalname;
	var filetype = file.mimetype || file.type;
	var headers;

	if (typeof update === &#x27;function&#x27;) {
		callback = update;
		update = false;
	}

	if (field.options.allowedTypes &#x26;&#x26; field.options.allowedTypes.indexOf(filetype) === -1) {
		return callback(new Error(&#x27;Unsupported File Type: &#x27; + filetype));
	}

	var doUpload = function () {

		if (typeof field.options.path === &#x27;function&#x27;) {
			path = field.options.path(item, path);
		}

		if (typeof field.options.filename === &#x27;function&#x27;) {
			filename = field.options.filename(item, filename, originalname);
		}

		headers = field.generateHeaders(item, file, callback);

		knox.createClient(field.s3config).putFile(file.path, path + filename, headers, function (err, res) {

			if (err) return callback(err);
			if (res) {
				if (res.statusCode !== 200) {
					return callback(new Error(&#x27;Amazon returned Http Code: &#x27; + res.statusCode));
				} else {
					res.resume();
				}
			}

			var protocol = (field.s3config.protocol &#x26;&#x26; field.s3config.protocol + &#x27;:&#x27;) || &#x27;&#x27;;
			var url = res.req.url.replace(/^https?:/i, protocol).replace(/%25/g, &#x27;%&#x27;);

			var fileData = {
				filename: filename,
				originalname: originalname,
				path: path,
				size: file.size,
				filetype: filetype,
				url: url,
			};

			if (update) {
				item.set(field.path, fileData);
			}

			callback(null, fileData);

		});
	};

	this.callHook(&#x27;pre:upload&#x27;, item, file, function (err) {
		if (err) return callback(err);
		doUpload();
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

			if (/^(delete|reset)$/.test(action)) {
				field.apply(item, action);
			}
		}

		if (req.files &#x26;&#x26; req.files[paths.upload] &#x26;&#x26; req.files[paths.upload].size) {
			return field.<span class="apidocCodeKeywordSpan">uploadFile</span>(item, req.files[paths.upload], true, callback);
		}

		return callback();

	};

};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Select.prototype" id="apidoc.module.keystone.Field.Types.Select.prototype">module keystone.Field.Types.Select.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Select.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Select.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Select.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	if (!Array.isArray(filter.value)) {
		if (filter.value) {
			filter.value = [filter.value];
		} else {
			filter.value = [];
		}
	}
	if (filter.value.length &#x3e; 1) {
		query[this.path] = (filter.inverted) ? { $nin: filter.value } : { $in: filter.value };
	} else if (filter.value.length === 1) {
		query[this.path] = (filter.inverted) ? { $ne: filter.value[0] } : filter.value[0];
	} else {
		query[this.path] = (filter.inverted) ? { $nin: [&#x27;&#x27;, null] } : { $in: [&#x27;&#x27;, null] };
	}
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Select.prototype.addToSchema" id="apidoc.element.keystone.Field.Types.Select.prototype.addToSchema">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Select.prototype.</span>addToSchema
        <span class="apidocSignatureSpan">(schema)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addToSchema = function (schema) {
	var field = this;
	this.paths = {
		data: this.options.dataPath || this.path + &#x27;Data&#x27;,
		label: this.options.labelPath || this.path + &#x27;Label&#x27;,
		options: this.options.optionsPath || this.path + &#x27;Options&#x27;,
		map: this.options.optionsMapPath || this.path + &#x27;OptionsMap&#x27;,
	};
	schema.path(this.path, _.defaults({
		type: this._nativeType,
		enum: this.values,
		set: function (val) {
			return (val === &#x27;&#x27; || val === null || val === false) ? undefined : val;
		},
	}, this.options));
	schema.virtual(this.paths.data).get(function () {
		return field.map[this.get(field.path)];
	});
	schema.virtual(this.paths.label).get(function () {
		return field.labels[this.get(field.path)];
	});
	schema.virtual(this.paths.options).get(function () {
		return field.ops;
	});
	schema.virtual(this.paths.map).get(function () {
		return field.map;
	});
	this.bindUnderscoreMethods();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Select.prototype.cloneMap" id="apidoc.element.keystone.Field.Types.Select.prototype.cloneMap">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Select.prototype.</span>cloneMap
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">cloneMap = function () {
	return utils.optionsMap(this.ops, true);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Select.prototype.cloneOps" id="apidoc.element.keystone.Field.Types.Select.prototype.cloneOps">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Select.prototype.</span>cloneOps
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">cloneOps = function () {
	return _.map(this.ops, _.clone);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Select.prototype.format" id="apidoc.element.keystone.Field.Types.Select.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Select.prototype.</span>format
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item) {
	return this.labels[item.get(this.path)] || &#x27;&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Select.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.Select.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Select.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data, required, item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data, required, item) {
	if (data[this.path]) {
		return (data[this.path] in this.map) ? true : false;
	} else {
		return (!required || (!(this.path in data) &#x26;&#x26; item &#x26;&#x26; item.get(this.path))) ? true : false;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Select.prototype.pluck" id="apidoc.element.keystone.Field.Types.Select.prototype.pluck">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Select.prototype.</span>pluck
        <span class="apidocSignatureSpan">(item, property, _default)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pluck = function (item, property, _default) {
	var option = item.get(this.paths.data);
	return (option) ? option[property] : _default;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Select.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Select.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Select.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var value = this.getValueFromData(data);
	if (typeof value === &#x27;string&#x27; &#x26;&#x26; this.numeric) {
		value = utils.number(value);
	}
	var result = value === undefined || value === null || value === &#x27;&#x27; || (value in this.map) ? true : false;
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Select.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Select.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Select.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = false;
	if (value === undefined) {
		if (item.get(this.path)) {
			result = true;
		}
	} else if (value) {
		if (value !== &#x27;&#x27;) {
			// This is already checkind in validateInput, but it doesn&#x27;t hurt
			// to check again for security
			if (value in this.map) {
				result = true;
			}
		}
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Text.prototype" id="apidoc.module.keystone.Field.Types.Text.prototype">module keystone.Field.Types.Text.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Text.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Text.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Text.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	if (filter.mode === &#x27;exactly&#x27; &#x26;&#x26; !filter.value) {
		query[this.path] = filter.inverted ? { $nin: [&#x27;&#x27;, null] } : { $in: [&#x27;&#x27;, null] };
		return query;
	}
	var value = utils.escapeRegExp(filter.value);
	if (filter.mode === &#x27;beginsWith&#x27;) {
		value = &#x27;^&#x27; + value;
	} else if (filter.mode === &#x27;endsWith&#x27;) {
		value = value + &#x27;$&#x27;;
	} else if (filter.mode === &#x27;exactly&#x27;) {
		value = &#x27;^&#x27; + value + &#x27;$&#x27;;
	}
	value = new RegExp(value, filter.caseSensitive ? &#x27;&#x27; : &#x27;i&#x27;);
	query[this.path] = filter.inverted ? { $not: value } : value;
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Text.prototype.crop" id="apidoc.element.keystone.Field.Types.Text.prototype.crop">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Text.prototype.</span>crop
        <span class="apidocSignatureSpan">(item, length, append, preserveWords)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">crop = function (item, length, append, preserveWords) {
	return utils.cropString(item.get(this.path), length, append, preserveWords);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Text.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Text.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Text.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var max = this.options.max;
	var min = this.options.min;
	var value = this.getValueFromData(data);
	var result = value === undefined || value === null || typeof value === &#x27;string&#x27;;
	if (max &#x26;&#x26; typeof value === &#x27;string&#x27;) {
		result = value.length &#x3c; max;
	}
	if (min &#x26;&#x26; typeof value === &#x27;string&#x27;) {
		result = value.length &#x3e; min;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Text.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Text.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Text.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = !!value;
	if (value === undefined &#x26;&#x26; item.get(this.path)) {
		result = true;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.TextArray.prototype" id="apidoc.module.keystone.Field.Types.TextArray.prototype">module keystone.Field.Types.TextArray.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.TextArray.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.TextArray.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.TextArray.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	var presence = filter.presence || &#x27;some&#x27;;
	// Filter empty/non-empty arrays
	if (!filter.value) {
		// &#x22;At least one element contains nothing&#x22;
		// This isn&#x27;t 100% accurate because this will only return arrays that
		// don&#x27;t have elements, not ones that have empty elements, but it works
		// fine for 99% of the usecase
		query[this.path] = presence === &#x27;some&#x27; ? {
			$size: 0,
		// &#x22;No elements contain nothing&#x22;
		} : {
			$not: {
				$size: 0,
			},
		};
		return query;
	}
	var value = utils.escapeRegExp(filter.value);
	if (filter.mode === &#x27;beginsWith&#x27;) {
		value = &#x27;^&#x27; + value;
	} else if (filter.mode === &#x27;endsWith&#x27;) {
		value = value + &#x27;$&#x27;;
	} else if (filter.mode === &#x27;exactly&#x27;) {
		value = &#x27;^&#x27; + value + &#x27;$&#x27;;
	}
	value = new RegExp(value, filter.caseSensitive ? &#x27;&#x27; : &#x27;i&#x27;);
	if (presence === &#x27;none&#x27;) {
		query[this.path] = addPresenceToQuery(presence, value);
	} else {
		query[this.path] = addPresenceToQuery(presence, {
			$regex: value,
		});
	}
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.TextArray.prototype.format" id="apidoc.element.keystone.Field.Types.TextArray.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.TextArray.prototype.</span>format
        <span class="apidocSignatureSpan">(item, separator)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item, separator) {
	return item.get(this.path).join(separator || this.separator);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.TextArray.prototype.inputIsValid" id="apidoc.element.keystone.Field.Types.TextArray.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.Types.TextArray.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data, required, item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data, required, item) {
	var value = this.getValueFromData(data);
	if (required) {
		if (value === undefined &#x26;&#x26; item &#x26;&#x26; item.get(this.path) &#x26;&#x26; item.get(this.path).length) {
			return true;
		}
		if (value === undefined || !Array.isArray(value) || (typeof value !== &#x27;string&#x27;) || (typeof value !== &#x27;number&#x27;)) {
			return false;
		}
		if (Array.isArray(value) &#x26;&#x26; !value.length) {
			return false;
		}
	}
	return (value === undefined || Array.isArray(value) || (typeof value === &#x27;string&#x27;) || (typeof value === &#x27;number&#x27;));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.TextArray.prototype.updateItem" id="apidoc.element.keystone.Field.Types.TextArray.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.Types.TextArray.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {
	var value = this.getValueFromData(data);
	if (value === undefined || value === null || value === &#x27;&#x27;) {
		value = [];
	}
	if (!Array.isArray(value)) {
		value = [value];
	}
	value = value.map(function (str) {
		if (str &#x26;&#x26; str.toString) {
			str = str.toString();
		}
		return str;
	}).filter(function (str) {
		return (typeof str === &#x27;string&#x27; &#x26;&#x26; str);
	});
	item.set(this.path, value);
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.TextArray.prototype.validateInput" id="apidoc.element.keystone.Field.Types.TextArray.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.TextArray.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var value = this.getValueFromData(data);
	var result = true;
	// If the value is null, undefined or an empty string
	// bail early since updateItem sanitizes that just fine
	if (value !== undefined &#x26;&#x26; value !== null &#x26;&#x26; value !== &#x27;&#x27;) {
		// If the value is not an array, convert it to one
		// e.g. if textarr = &#x27;somestring&#x27; (which is valid)
		if (!Array.isArray(value)) {
			value = [value];
		}
		for (var i = 0; i &#x3c; value.length; i++) {
			var thisValue = value[i];
			// If the current value is not a string and is neither false nor
			// undefined, fail the validation
			if (typeof thisValue !== &#x27;string&#x27;) {
				result = false;
				break;
			}
		}
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.TextArray.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.TextArray.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.TextArray.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = false;
	// If the value is undefined and we have something stored already, validate
	if (value === undefined) {
		if (item.get(this.path) &#x26;&#x26; item.get(this.path).length) {
			result = true;
		}
	}
	// If it&#x27;s a string that&#x27;s not empty, validate
	if (typeof value === &#x27;string&#x27;) {
		if (value !== &#x27;&#x27;) {
			result = true;
		}
	// If it&#x27;s an array of only strings and/or strinigfy-able data, validate
	} else if (Array.isArray(value)) {
		var invalidContent = false;
		for (var i = 0; i &#x3c; value.length; i++) {
			var thisValue = value[i];
			// If even a single item is not a string or an empty string, invalidate
			if (typeof thisValue !== &#x27;string&#x27; || thisValue === &#x27;&#x27;) {
				invalidContent = true;
				break;
			}
		}
		if (invalidContent === false) {
			result = true;
		}
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Textarea.prototype" id="apidoc.module.keystone.Field.Types.Textarea.prototype">module keystone.Field.Types.Textarea.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Textarea.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Textarea.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Textarea.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	if (filter.mode === &#x27;exactly&#x27; &#x26;&#x26; !filter.value) {
		query[this.path] = filter.inverted ? { $nin: [&#x27;&#x27;, null] } : { $in: [&#x27;&#x27;, null] };
		return query;
	}
	var value = utils.escapeRegExp(filter.value);
	if (filter.mode === &#x27;beginsWith&#x27;) {
		value = &#x27;^&#x27; + value;
	} else if (filter.mode === &#x27;endsWith&#x27;) {
		value = value + &#x27;$&#x27;;
	} else if (filter.mode === &#x27;exactly&#x27;) {
		value = &#x27;^&#x27; + value + &#x27;$&#x27;;
	}
	value = new RegExp(value, filter.caseSensitive ? &#x27;&#x27; : &#x27;i&#x27;);
	query[this.path] = filter.inverted ? { $not: value } : value;
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Textarea.prototype.crop" id="apidoc.element.keystone.Field.Types.Textarea.prototype.crop">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Textarea.prototype.</span>crop
        <span class="apidocSignatureSpan">(item, length, append, preserveWords)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">crop = function (item, length, append, preserveWords) {
	return utils.cropString(item.get(this.path), length, append, preserveWords);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Textarea.prototype.format" id="apidoc.element.keystone.Field.Types.Textarea.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Textarea.prototype.</span>format
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item) {
	return utils.textToHTML(item.get(this.path));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Textarea.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Textarea.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Textarea.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var max = this.options.max;
	var min = this.options.min;
	var value = this.getValueFromData(data);
	var result = value === undefined || value === null || typeof value === &#x27;string&#x27;;
	if (max &#x26;&#x26; typeof value === &#x27;string&#x27;) {
		result = value.length &#x3c; max;
	}
	if (min &#x26;&#x26; typeof value === &#x27;string&#x27;) {
		result = value.length &#x3e; min;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Textarea.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Textarea.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Textarea.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = !!value;
	if (value === undefined &#x26;&#x26; item.get(this.path)) {
		result = true;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.Types.Url.prototype" id="apidoc.module.keystone.Field.Types.Url.prototype">module keystone.Field.Types.Url.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Url.prototype.addFilterToQuery" id="apidoc.element.keystone.Field.Types.Url.prototype.addFilterToQuery">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Url.prototype.</span>addFilterToQuery
        <span class="apidocSignatureSpan">(filter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addFilterToQuery = function (filter) {
	var query = {};
	if (filter.mode === &#x27;exactly&#x27; &#x26;&#x26; !filter.value) {
		query[this.path] = filter.inverted ? { $nin: [&#x27;&#x27;, null] } : { $in: [&#x27;&#x27;, null] };
		return query;
	}
	var value = utils.escapeRegExp(filter.value);
	if (filter.mode === &#x27;beginsWith&#x27;) {
		value = &#x27;^&#x27; + value;
	} else if (filter.mode === &#x27;endsWith&#x27;) {
		value = value + &#x27;$&#x27;;
	} else if (filter.mode === &#x27;exactly&#x27;) {
		value = &#x27;^&#x27; + value + &#x27;$&#x27;;
	}
	value = new RegExp(value, filter.caseSensitive ? &#x27;&#x27; : &#x27;i&#x27;);
	query[this.path] = filter.inverted ? { $not: value } : value;
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

function addFiltersToQuery (filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.<span class="apidocCodeKeywordSpan">addFilterToQuery</span>(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}

module.exports = addFiltersToQuery;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Url.prototype.format" id="apidoc.element.keystone.Field.Types.Url.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Url.prototype.</span>format
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item) {
	var url = item.get(this.path) || &#x27;&#x27;;
	if (this.options.format === false) {
		return url;
	} else if (typeof this.options.format === &#x27;function&#x27;) {
		return this.options.format(url);
	} else {
		return removeProtocolPrefix(url);
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Url.prototype.validateInput" id="apidoc.element.keystone.Field.Types.Url.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Url.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	var max = this.options.max;
	var min = this.options.min;
	var value = this.getValueFromData(data);
	var result = value === undefined || value === null || typeof value === &#x27;string&#x27;;
	if (max &#x26;&#x26; typeof value === &#x27;string&#x27;) {
		result = value.length &#x3c; max;
	}
	if (min &#x26;&#x26; typeof value === &#x27;string&#x27;) {
		result = value.length &#x3e; min;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.Types.Url.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.Types.Url.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.Types.Url.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = !!value;
	if (value === undefined &#x26;&#x26; item.get(this.path)) {
		result = true;
	}
	utils.defer(callback, result);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Field.prototype" id="apidoc.module.keystone.Field.prototype">module keystone.Field.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Field.prototype.addToSchema" id="apidoc.element.keystone.Field.prototype.addToSchema">
        function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>addToSchema
        <span class="apidocSignatureSpan">(schema)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addToSchema = function (schema) {
	var ops = (this._nativeType) ? _.defaults({ type: this._nativeType }, this.options) : this.options;
	schema.path(this.path, ops);
	this.bindUnderscoreMethods();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.prototype.bindUnderscoreMethods" id="apidoc.element.keystone.Field.prototype.bindUnderscoreMethods">
        function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>bindUnderscoreMethods
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bindUnderscoreMethods = function () {
	var field = this;
	(this._underscoreMethods || []).concat({ fn: &#x27;updateItem&#x27;, as: &#x27;update&#x27; }).forEach(function (method) {
		if (typeof method === &#x27;string&#x27;) {
			method = { fn: method, as: method };
		}
		if (typeof field[method.fn] !== &#x27;function&#x27;) {
			throw new Error(&#x27;Invalid underscore method (&#x27; + method.fn + &#x27;) applied to &#x27; + field.list.key + &#x27;.&#x27; + field.path + &#x27; (&#x27; + field
.type + &#x27;)&#x27;);
		}
		field.underscoreMethod(method.as, function () {
			var args = [this].concat(Array.prototype.slice.call(arguments));
			return field[method.fn].apply(field, args);
		});
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	});

	// expose a method on the field to call schema methods
	this.apply = function (item, method) {
		return schemaMethods[method].apply(item, Array.prototype.slice.call(arguments, 2));
	};

	this.<span class="apidocCodeKeywordSpan">bindUnderscoreMethods</span>();
};

/**
 * Formats the field value
 */
azurefile.prototype.format = function (item) {
	return item.get(this.paths.url);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.prototype.format" id="apidoc.element.keystone.Field.prototype.format">
        function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>format
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (item) {
	var value = item.get(this.path);
	if (value === undefined) return &#x27;&#x27;;
	return value;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.prototype.getData" id="apidoc.element.keystone.Field.prototype.getData">
        function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>getData
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getData = function (item) {
	return item.get(this.path);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					process.exit(1);
				}
			}
			break;
		case &#x27;module root&#x27;:
			// if relative path is used, resolve it based on the caller&#x27;s path
			if (!isAbsolutePath(value)) {
				var caller = callerId.<span class="apidocCodeKeywordSpan">getData</span>();
				value = path.resolve(path.dirname(caller.filePath), value);
			}
			break;
		case &#x27;app&#x27;:
			this.app = value;
			break;
		case &#x27;mongoose&#x27;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.prototype.getDefaultValue" id="apidoc.element.keystone.Field.prototype.getDefaultValue">
        function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>getDefaultValue
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getDefaultValue = function () {
	return typeof this.options.default !== &#x27;undefined&#x27; ? this.options.default : &#x27;&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

		// Set the field values to their default values when first rendering the
		// form. (If they have a default value, that is)
		var values = {};
		Object.keys(this.props.list.fields).forEach(function (key) {
			var field = _this.props.list.fields[key];
			var FieldComponent = _FieldTypes.Fields[field.type];
			values[field.path] = FieldComponent.<span class="apidocCodeKeywordSpan">getDefaultValue</span>(field);
		});
		return {
			values: values,
			alerts: {}
		};
	},
	componentDidMount: function componentDidMount() {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.prototype.getOptions" id="apidoc.element.keystone.Field.prototype.getOptions">
        function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>getOptions
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getOptions = function () {
	if (!this.__options) {
		this.__options = {};
		var optionKeys = DEFAULT_OPTION_KEYS;
		if (_.isArray(this._properties)) {
			optionKeys = optionKeys.concat(this._properties);
		}
		optionKeys.forEach(function (key) {
			if (this[key]) {
				this.__options[key] = this[key];
			} else if (this.options[key]) {
				this.__options[key] = this.options[key];
			}
		}, this);
		if (this.getProperties) {
			assign(this.__options, this.getProperties());
		}
		this.__options.hasFilterMethod = this.addFilterToQuery ? true : false;
		this.__options.defaultValue = this.getDefaultValue();
	}
	return this.__options;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var forEach = require(&#x27;lodash/forEach&#x27;);

function createKeystoneHash () {
	var hash = crypto.createHash(&#x27;md5&#x27;);
	hash.update(this.version);

	forEach(this.lists, function (list, key) {
		hash.update(JSON.stringify(list.<span class="apidocCodeKeywordSpan">getOptions</span>()));
	});

	return hash.digest(&#x27;hex&#x27;).slice(0, 6);
}

module.exports = createKeystoneHash;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.prototype.getPreSaveWatcher" id="apidoc.element.keystone.Field.prototype.getPreSaveWatcher">
        function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>getPreSaveWatcher
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getPreSaveWatcher = function () {
	var field = this;
	var applyValue;

	if (this.options.watch === true) {
		// watch == true means always apply the value method
		applyValue = function () { return true; };
	} else {
		// if watch is a string, convert it to a list of paths to watch
		if (typeof this.options.watch === &#x27;string&#x27;) {
			this.options.watch = this.options.watch.split(&#x27; &#x27;);
		}
		if (typeof this.options.watch === &#x27;function&#x27;) {
			applyValue = this.options.watch;
		} else if (_.isArray(this.options.watch)) {
			applyValue = function (item) {
				var pass = false;
				field.options.watch.forEach(function (path) {
					if (item.isModified(path)) pass = true;
				});
				return pass;
			};
		} else if (_.isObject(this.options.watch)) {
			applyValue = function (item) {
				var pass = false;
				_.forEach(field.options.watch, function (value, path) {
					if (item.isModified(path) &#x26;&#x26; item.get(path) === value) pass = true;
				});
				return pass;
			};
		}
	}

	if (!applyValue) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Invalid watch value (&#x27; + this.options.watch + &#x27;) provided for &#x27; + this.list.key + &#x27;.&#x27; + this.path + &#x27; (&#x27; + this.type + &#x27;)&#x27;);
		process.exit(1);
	}

	if (typeof this.options.value !== &#x27;function&#x27;) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Watch set with no value method provided for &#x27; + this.list.key + &#x27;.&#x27; + this.path + &#x27; (&#x27; + this.type + &#x27;)&#x27;);
		process.exit(1);
	}

	return function (next) {
		if (!applyValue(this)) {
			return next();
		}
		di(field.options.value).call(this, function (err, val) {
			if (err) {
				console.error(&#x27;\nError: &#x27;
				+ &#x27;Watch set with value method for &#x27; + field.list.key + &#x27;.&#x27; + field.path + &#x27; (&#x27; + field.type + &#x27;) throws error:&#x27; + err);
			} else {
				this.set(field.path, val);
			}
			next();
		}.bind(this));
	};

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.prototype.getSize" id="apidoc.element.keystone.Field.prototype.getSize">
        function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>getSize
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getSize = function () {
	if (!this.__size) {
		var size = this._fixedSize || this.options.size || this.options.width;
		if (size !== &#x27;small&#x27; &#x26;&#x26; size !== &#x27;medium&#x27; &#x26;&#x26; size !== &#x27;large&#x27; &#x26;&#x26; size !== &#x27;full&#x27;) {
			size = this._defaultSize || &#x27;full&#x27;;
		}
		this.__size = size;
	}
	return this.__size;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.prototype.getValueFromData" id="apidoc.element.keystone.Field.prototype.getValueFromData">
        function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>getValueFromData
        <span class="apidocSignatureSpan">(data, subpath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getValueFromData = function (data, subpath) {
	return this._path.get(data, subpath);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
util.inherits(boolean, FieldType);

boolean.prototype.defaults = {
	default: false,
};

boolean.prototype.validateInput = function (data, callback) {
	var value = this.<span class="apidocCodeKeywordSpan">getValueFromData</span>(data);
	var result = true;
	if (value !== undefined
		&#x26;&#x26; value !== null
		&#x26;&#x26; typeof value !== &#x27;string&#x27;
		&#x26;&#x26; typeof value !== &#x27;number&#x27;
		&#x26;&#x26; typeof value !== &#x27;boolean&#x27;) {
		result = false;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.prototype.inputIsValid" id="apidoc.element.keystone.Field.prototype.inputIsValid">
        function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>inputIsValid
        <span class="apidocSignatureSpan">(data, required, item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inputIsValid = function (data, required, item) {
	if (!required) return true;
	var value = this.getValueFromData(data);
	if (value === undefined &#x26;&#x26; item &#x26;&#x26; item.get(this.path)) return true;
	if (typeof data[this.path] === &#x27;string&#x27;) {
		return (data[this.path].trim()) ? true : false;
	} else {
		return (data[this.path]) ? true : false;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.prototype.isModified" id="apidoc.element.keystone.Field.prototype.isModified">
        function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>isModified
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isModified = function (item) {
	return item.isModified(this.path);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var modified = false;
		var incomplete = false;
		var values = [];

		autokey.from.forEach(function (ops) {
			if (list.fields[ops.path]) {
				values.push(list.fields[ops.path].format(this, ops.format));
				if (list.fields[ops.path].<span class="apidocCodeKeywordSpan">isModified</span>(this)) {
					modified = true;
				}
				// if source field is neither selected nor modified we don&#x27;t have a way to generate a complete autokey
				else if (!this.isSelected(ops.path)) {
					incomplete = true;
				}
			} else {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.prototype.underscoreMethod" id="apidoc.element.keystone.Field.prototype.underscoreMethod">
        function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>underscoreMethod
        <span class="apidocSignatureSpan">(path, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">underscoreMethod = function (path, fn) {
	this.list.underscoreMethod(this.path + &#x27;.&#x27; + path, function () {
		return fn.apply(this, arguments);
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
				azure.createBlobService().blobService.deleteBlob(this.get(paths.container), this.get(paths.filename), function () {});
			} catch (e) {} // eslint-disable-line no-empty
			reset(this);
		},
	};

	_.forEach(schemaMethods, function (fn, key) {
		field.<span class="apidocCodeKeywordSpan">underscoreMethod</span>(key, fn);
	});

	// expose a method on the field to call schema methods
	this.apply = function (item, method) {
		return schemaMethods[method].apply(item, Array.prototype.slice.call(arguments, 2));
	};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.prototype.updateItem" id="apidoc.element.keystone.Field.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">updateItem = function (item, data, callback) {
	var value = this.getValueFromData(data);
	// This is a deliberate type coercion so that numbers from forms play nice
	if (value !== undefined &#x26;&#x26; value != item.get(this.path)) { // eslint-disable-line eqeqeq
		item.set(this.path, value);
	}
	process.nextTick(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.prototype.validateInput" id="apidoc.element.keystone.Field.prototype.validateInput">
        function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>validateInput
        <span class="apidocSignatureSpan">(data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateInput = function (data, callback) {
	utils.defer(callback, this.inputIsValid(data));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.<span class="apidocCodeKeywordSpan">validateInput</span>(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Field.prototype.validateRequiredInput" id="apidoc.element.keystone.Field.prototype.validateRequiredInput">
        function <span class="apidocSignatureSpan">keystone.Field.prototype.</span>validateRequiredInput
        <span class="apidocSignatureSpan">(item, data, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateRequiredInput = function (item, data, callback) {
	utils.defer(callback, this.inputIsValid(data, true, item));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.<span class="apidocCodeKeywordSpan">validateRequiredInput</span>(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.FileType" id="apidoc.module.keystone.FileType">module keystone.FileType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.FileType.FileType" id="apidoc.element.keystone.FileType.FileType">
        function <span class="apidocSignatureSpan">keystone.</span>FileType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function file(list, path, options) {
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;upload&#x27;, &#x27;remove&#x27;, &#x27;reset&#x27;];
	this._fixedSize = &#x27;full&#x27;;

	if (!options.storage) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;File fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require storage to be provided.&#x27;);
	}
	this.storage = options.storage;
	file.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.FileType.super_" id="apidoc.element.keystone.FileType.super_">
        function <span class="apidocSignatureSpan">keystone.FileType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.GeoPointType" id="apidoc.module.keystone.GeoPointType">module keystone.GeoPointType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.GeoPointType.GeoPointType" id="apidoc.element.keystone.GeoPointType.GeoPointType">
        function <span class="apidocSignatureSpan">keystone.</span>GeoPointType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function geopoint(list, path, options) {
	this._fixedSize = &#x27;medium&#x27;;
	geopoint.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.GeoPointType.super_" id="apidoc.element.keystone.GeoPointType.super_">
        function <span class="apidocSignatureSpan">keystone.GeoPointType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.HtmlType" id="apidoc.module.keystone.HtmlType">module keystone.HtmlType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.HtmlType.HtmlType" id="apidoc.element.keystone.HtmlType.HtmlType">
        function <span class="apidocSignatureSpan">keystone.</span>HtmlType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function html(list, path, options) {
	this._nativeType = String;
	this._defaultSize = &#x27;full&#x27;;
	this.wysiwyg = options.wysiwyg || false;
	this.height = options.height || 180;
	this._properties = [&#x27;wysiwyg&#x27;, &#x27;height&#x27;];
	html.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.HtmlType.super_" id="apidoc.element.keystone.HtmlType.super_">
        function <span class="apidocSignatureSpan">keystone.HtmlType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.KeyType" id="apidoc.module.keystone.KeyType">module keystone.KeyType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.KeyType.KeyType" id="apidoc.element.keystone.KeyType.KeyType">
        function <span class="apidocSignatureSpan">keystone.</span>KeyType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function key(list, path, options) {
	this._nativeType = String;
	this._defaultSize = &#x27;medium&#x27;;
	this.separator = options.separator || &#x27;-&#x27;;
	key.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.KeyType.super_" id="apidoc.element.keystone.KeyType.super_">
        function <span class="apidocSignatureSpan">keystone.KeyType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Keystone" id="apidoc.module.keystone.Keystone">module keystone.Keystone</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Keystone.Keystone" id="apidoc.element.keystone.Keystone.Keystone">
        function <span class="apidocSignatureSpan">keystone.</span>Keystone
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Keystone = function () {
	grappling.mixin(this).allowHooks(&#x27;pre:static&#x27;, &#x27;pre:bodyparser&#x27;, &#x27;pre:session&#x27;, &#x27;pre:logger&#x27;, &#x27;pre:admin&#x27;, &#x27;pre:routes&#x27;, &#x27;pre:render
&#x27;, &#x27;updates&#x27;, &#x27;signin&#x27;, &#x27;signout&#x27;);
	this.lists = {};
	this.fieldTypes = {};
	this.paths = {};
	this._options = {
		&#x27;name&#x27;: &#x27;Keystone&#x27;,
		&#x27;brand&#x27;: &#x27;Keystone&#x27;,
		&#x27;admin path&#x27;: &#x27;keystone&#x27;,
		&#x27;compress&#x27;: true,
		&#x27;headless&#x27;: false,
		&#x27;logger&#x27;: &#x27;:method :url :status :response-time ms&#x27;,
		&#x27;auto update&#x27;: false,
		&#x27;model prefix&#x27;: null,
		&#x27;module root&#x27;: moduleRoot,
		&#x27;frame guard&#x27;: &#x27;sameorigin&#x27;,
		&#x27;cache admin bundles&#x27;: true,
	};
	this._redirects = {};

	// expose express
	this.express = express;

	// init environment defaults
	this.set(&#x27;env&#x27;, process.env.NODE_ENV || &#x27;development&#x27;);

	this.set(&#x27;port&#x27;, process.env.PORT || process.env.OPENSHIFT_NODEJS_PORT || &#x27;3000&#x27;);
	this.set(&#x27;host&#x27;, process.env.HOST || process.env.IP || process.env.OPENSHIFT_NODEJS_IP || &#x27;0.0.0.0&#x27;);
	this.set(&#x27;listen&#x27;, process.env.LISTEN);

	this.set(&#x27;ssl&#x27;, process.env.SSL);
	this.set(&#x27;ssl port&#x27;, process.env.SSL_PORT || &#x27;3001&#x27;);
	this.set(&#x27;ssl host&#x27;, process.env.SSL_HOST || process.env.SSL_IP);
	this.set(&#x27;ssl key&#x27;, process.env.SSL_KEY);
	this.set(&#x27;ssl cert&#x27;, process.env.SSL_CERT);

	this.set(&#x27;cookie secret&#x27;, process.env.COOKIE_SECRET);
	this.set(&#x27;cookie signin&#x27;, (this.get(&#x27;env&#x27;) === &#x27;development&#x27;) ? true : false);

	this.set(&#x27;embedly api key&#x27;, process.env.EMBEDLY_API_KEY || process.env.EMBEDLY_APIKEY);
	this.set(&#x27;mandrill api key&#x27;, process.env.MANDRILL_API_KEY || process.env.MANDRILL_APIKEY);
	this.set(&#x27;mandrill username&#x27;, process.env.MANDRILL_USERNAME);
	this.set(&#x27;google api key&#x27;, process.env.GOOGLE_BROWSER_KEY);
	this.set(&#x27;google server api key&#x27;, process.env.GOOGLE_SERVER_KEY);
	this.set(&#x27;ga property&#x27;, process.env.GA_PROPERTY);
	this.set(&#x27;ga domain&#x27;, process.env.GA_DOMAIN);
	this.set(&#x27;chartbeat property&#x27;, process.env.CHARTBEAT_PROPERTY);
	this.set(&#x27;chartbeat domain&#x27;, process.env.CHARTBEAT_DOMAIN);
	this.set(&#x27;allowed ip ranges&#x27;, process.env.ALLOWED_IP_RANGES);

	if (process.env.S3_BUCKET &#x26;&#x26; process.env.S3_KEY &#x26;&#x26; process.env.S3_SECRET) {
		this.set(&#x27;s3 config&#x27;, { bucket: process.env.S3_BUCKET, key: process.env.S3_KEY, secret: process.env.S3_SECRET, region: process
.env.S3_REGION });
	}

	if (process.env.AZURE_STORAGE_ACCOUNT &#x26;&#x26; process.env.AZURE_STORAGE_ACCESS_KEY) {
		this.set(&#x27;azurefile config&#x27;, { account: process.env.AZURE_STORAGE_ACCOUNT, key: process.env.AZURE_STORAGE_ACCESS_KEY });
	}

	if (process.env.CLOUDINARY_URL) {
		// process.env.CLOUDINARY_URL is processed by the cloudinary package when this is set
		this.set(&#x27;cloudinary config&#x27;, true);
	}

	// init mongoose
	this.set(&#x27;mongoose&#x27;, require(&#x27;mongoose&#x27;));
	this.mongoose.Promise = require(&#x27;es6-promise&#x27;).Promise;

	// Attach middleware packages, bound to this instance
	this.middleware = {
		api: require(&#x27;./lib/middleware/api&#x27;)(this),
		cors: require(&#x27;./lib/middleware/cors&#x27;)(this),
	};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Keystone.prototype" id="apidoc.module.keystone.Keystone.prototype">module keystone.Keystone.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.applyUpdates" id="apidoc.element.keystone.Keystone.prototype.applyUpdates">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>applyUpdates
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">applyUpdates = function (callback) {
	var self = this;
	self.callHook(&#x27;pre:updates&#x27;, function (err) {
		if (err) return callback(err);
		require(&#x27;./lib/updates&#x27;).apply(function (err) {
			if (err) return callback(err);
			self.callHook(&#x27;post:updates&#x27;, callback);
		});
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

		debug(&#x27;mongo connection open&#x27;);
		mongoConnectionOpen = true;

		var connected = function () {
			if (keystone.get(&#x27;auto update&#x27;)) {
				debug(&#x27;applying auto update&#x27;);
				keystone.<span class="apidocCodeKeywordSpan">applyUpdates</span>(callback);
			} else {
				callback();
			}
		};

		if (keystone.sessionStorePromise) {
			keystone.sessionStorePromise.then(connected);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.closeDatabaseConnection" id="apidoc.element.keystone.Keystone.prototype.closeDatabaseConnection">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>closeDatabaseConnection
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function closeDatabaseConnection(callback) {
	this.mongoose.disconnect(function () {
		debug(&#x27;mongo connection closed&#x27;);
		callback &#x26;&#x26; callback();
	});
	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.createItems" id="apidoc.element.keystone.Keystone.prototype.createItems">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>createItems
        <span class="apidocSignatureSpan">(data, ops, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function createItems(data, ops, callback) {

	var keystone = this;

	var options = {
		verbose: false,
		strict: true,
		refs: null,
	};

	var dashes = &#x27;------------------------------------------------&#x27;;

	if (!_.isObject(data)) {
		throw new Error(&#x27;keystone.createItems() requires a data object as the first argument.&#x27;);
	}

	if (_.isObject(ops)) {
		_.extend(options, ops);
	}

	if (typeof ops === &#x27;function&#x27;) {
		callback = ops;
	}

	var lists = _.keys(data);
	var refs = options.refs || {};
	var stats = {};

	// logger function
	function writeLog (data) {
		console.log(keystone.get(&#x27;name&#x27;) + &#x27;: &#x27; + data);
	}

	async.waterfall([

		// create items
		function (next) {
			async.eachSeries(lists, function (key, doneList) {

				var list = keystone.list(key);
				var relationshipPaths = _.filter(list.fields, { type: &#x27;relationship&#x27; }).map(function (i) { return i.path; });

				if (!list) {
					if (options.strict) {
						return doneList({
							type: &#x27;invalid list&#x27;,
							message: &#x27;List key &#x27; + key + &#x27; is invalid.&#x27;,
						});
					}
					if (options.verbose) {
						writeLog(&#x27;Skipping invalid list: &#x27; + key);
					}
					return doneList();
				}

				if (!refs[list.key]) {
					refs[list.key] = {};
				}

				stats[list.key] = {
					singular: list.singular,
					plural: list.plural,
					created: 0,
					warnings: 0,
				};

				var itemsProcessed = 0;
				var totalItems = data[key].length;

				if (options.verbose) {
					writeLog(dashes);
					writeLog(&#x27;Processing list: &#x27; + key);
					writeLog(&#x27;Items to create: &#x27; + totalItems);
					writeLog(dashes);
				}

				async.eachSeries(data[key], function (data, doneItem) {

					itemsProcessed++;

					// Evaluate function properties to allow generated values (excluding relationships)
					_.keys(data).forEach(function (i) {
						if (typeof data[i] === &#x27;function&#x27; &#x26;&#x26; relationshipPaths.indexOf(i) === -1) {
							data[i] = data[i]();
							if (options.verbose) {
								writeLog(&#x27;Generated dynamic value for [&#x27; + i + &#x27;]: &#x27; + data[i]);
							}
						}
					});

					var doc = data.__doc = new list.model();

					if (data.__ref) {
						refs[list.key][data.__ref] = doc;
					}

					async.each(list.fieldsArray, function (field, doneField) {
						// skip relationship fields on the first pass.
						if (field.type !== &#x27;relationship&#x27;) {
							// TODO: Validate items?
							field.updateItem(doc, data, doneField);
						} else {
							doneField();
						}
					}, function (err) {
						if (!err) {
							if (options.verbose) {
								var documentName = list.getDocumentName(doc);
								writeLog(&#x27;Creating item [&#x27; + itemsProcessed + &#x27; of &#x27; + totalItems + &#x27;] - &#x27; + documentName);
							}

							doc.save(function (err) {
								if (err) {
									err.model = key;
									err.data = data;
									debug(&#x27;error saving &#x27;, key);
								} else {
									stats[list.key].created++;
								}
								doneItem(err);
							});
						} else {
							doneItem(err);
						}
					});
				}, doneList);

			}, next);
		},

		// link items
		function (next) {

			async.each(lists, function (key, doneList) {

				var list = keystone.list(key);
				var relationships = _.filter(list.fields, { type: &#x27;relationship&#x27; });

				if (!list || !relationships.length) {
					return doneList();
				}

				var itemsProcessed = 0;
				var totalItems = data[key].length;

				if (options.verbose) {
					writeLog(dashes);
					writeLog(&#x27;Processing relationships for: &#x27; + key);
					writeLog(&#x27;Items to process: &#x27; + totalItems);
					writeLog(dashes);
				}

				async.each(data[key], function (srcData, doneItem) {

					var doc = srcData.__doc;
					var relationshipsUpdated = 0;

					itemsProcessed++;

					if (options.verbose) {
						var documentName = list.getDocumentName(doc);
						writeLog(&#x27;Processing item [&#x27; + itemsProcessed + &#x27; of &#x27; + totalItems + &#x27;] - &#x27; + documentName);
					}

					async.each(relationships, function (field, doneField) {

						var fieldValue = null;
						var refsLookup = null;

						if (!field.path) {
							writeLog(&#x27;WARNING:  Invalid relationship (undefined list path) [List: &#x27; + key + &#x27; ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
				// auto-wrap create scripts for a friendlier shorthand syntax
				if (_.isObject(update.create)) {
					var items = update.create;
					var ops = update.options || {};
					var background_mode = update.__background__ ? &#x27; (background mode) &#x27; : &#x27;&#x27;;

					update = function (done) {
						keystone.<span class="apidocCodeKeywordSpan">createItems</span>(items, ops, function (err, stats) {
							if (!err) {
								var statsMsg = stats ? stats.message : &#x27;&#x27;;

								console.log(&#x27;\n&#x27; + _dashes_,
									&#x27;\n&#x27; + keystone.get(&#x27;name&#x27;) + &#x27;: Successfully applied update &#x27; + file + background_mode + &#
x27;.&#x27;,
									&#x27;\n&#x27; + statsMsg,
									&#x27;\n&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.createKeystoneHash" id="apidoc.element.keystone.Keystone.prototype.createKeystoneHash">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>createKeystoneHash
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function createKeystoneHash() {
	var hash = crypto.createHash(&#x27;md5&#x27;);
	hash.update(this.version);

	forEach(this.lists, function (list, key) {
		hash.update(JSON.stringify(list.getOptions()));
	});

	return hash.digest(&#x27;hex&#x27;).slice(0, 6);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

		src += &#x27;};\n&#x27;;
	});
	return str(src);
}

module.exports = function createStaticRouter (keystone) {
	var keystoneHash = keystone.<span class="apidocCodeKeywordSpan">createKeystoneHash</span>();
	var writeToDisk = keystone.get(&#x27;cache admin bundles&#x27;);
	var router = express.Router();

	/* Prepare browserify bundles */
	var bundles = {
		fields: browserify({
			stream: buildFieldTypesStream(keystone.fieldTypes),
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.createRouter" id="apidoc.element.keystone.Keystone.prototype.createRouter">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>createRouter
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function createRouter() {
	return express.Router();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.expandPath" id="apidoc.element.keystone.Keystone.prototype.expandPath">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>expandPath
        <span class="apidocSignatureSpan">(pathValue)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">expandPath = function (pathValue) {
	pathValue = (typeof pathValue === &#x27;string&#x27; &#x26;&#x26; pathValue.substr(0, 1) !== path.sep &#x26;&#x26; pathValue.substr(1, 2) !== &#x27;:\\&#x27;)
		? path.join(this.get(&#x27;module root&#x27;), pathValue)
		: pathValue;
	return pathValue;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	if (typeof lessPaths === &#x27;string&#x27;) {
		lessPaths = [lessPaths];
	}

	if (Array.isArray(lessPaths)) {
		lessPaths.forEach(function (path) {
			app.use(require(&#x27;less-middleware&#x27;)(keystone.<span class="apidocCodeKeywordSpan">expandPath</span>(path), lessOptions
));
		});
	}
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.get" id="apidoc.element.keystone.Keystone.prototype.get">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>get
        <span class="apidocSignatureSpan">(key, value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (key, value) {

	if (arguments.length === 1) {
		return this._options[key];
	}

	switch (key) {
		// throw on unsupported options
		case &#x27;email rules&#x27;:
			throw new Error(&#x27;The option &#x22;&#x27; + key + &#x27;&#x22; is no longer supported. See https://github.com/keystonejs/keystone/wiki/0.3.x-to-0.
4.x-Changes&#x27;);
		// handle special settings
		case &#x27;cloudinary config&#x27;:
			var cloudinary = require(&#x27;cloudinary&#x27;);
			if (typeof value === &#x27;string&#x27;) {
				var parts = url.parse(value, true);
				var auth = parts.auth ? parts.auth.split(&#x27;:&#x27;) : [];
				value = {
					cloud_name: parts.host,
					api_key: auth[0],
					api_secret: auth[1],
					private_cdn: parts.pathname != null,
					secure_distribution: parts.pathname &#x26;&#x26; parts.pathname.substring(1),
				};
			}
			cloudinary.config(value);
			value = cloudinary.config();
			break;
		case &#x27;auth&#x27;:
			if (value === true &#x26;&#x26; !this.get(&#x27;session&#x27;)) {
				this.set(&#x27;session&#x27;, true);
			}
			break;
		case &#x27;nav&#x27;:
			this.nav = this.initNav(value);
			break;
		case &#x27;mongo&#x27;:
			if (typeof value !== &#x27;string&#x27;) {
				if (Array.isArray(value) &#x26;&#x26; (value.length === 2 || value.length === 3)) {
					console.log(&#x27;\nWarning: using an array for the `mongo` option has been deprecated.\nPlease use a mongodb connection string,
e.g. mongodb://localhost/db_name instead.\n\n&#x27;
					+ &#x27;Support for arrays as the `mongo` setting will be removed in a future version.&#x27;);
					value = (value.length === 2) ? &#x27;mongodb://&#x27; + value[0] + &#x27;/&#x27; + value[1] : &#x27;mongodb://&#x27; + value[0] + &#x27;:&#x27; + value[2] + &#x27;/&#x27; +
value[1];
				} else {
					console.error(&#x27;\nInvalid Configuration:\nThe `mongo` option must be a mongodb connection string, e.g. mongodb://localhost/db_name\n&#x27;);
					process.exit(1);
				}
			}
			break;
		case &#x27;module root&#x27;:
			// if relative path is used, resolve it based on the caller&#x27;s path
			if (!isAbsolutePath(value)) {
				var caller = callerId.getData();
				value = path.resolve(path.dirname(caller.filePath), value);
			}
			break;
		case &#x27;app&#x27;:
			this.app = value;
			break;
		case &#x27;mongoose&#x27;:
			this.mongoose = value;
			break;
		case &#x27;frame guard&#x27;:
			var validFrameGuardOptions = [&#x27;deny&#x27;, &#x27;sameorigin&#x27;];

			if (value === true) {
				value = &#x27;deny&#x27;;
			}
			if (typeof value === &#x27;string&#x27;) {
				value = value.toLowerCase();
				if (validFrameGuardOptions.indexOf(value) &#x3c; 0) {
					value = false;
				}
			} else if (typeof value !== &#x27;boolean&#x27;) {
				value = false;
			}
			break;
	}

	this._options[key] = value;
	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	this.set(&#x27;ssl&#x27;, process.env.SSL);
	this.set(&#x27;ssl port&#x27;, process.env.SSL_PORT || &#x27;3001&#x27;);
	this.set(&#x27;ssl host&#x27;, process.env.SSL_HOST || process.env.SSL_IP);
	this.set(&#x27;ssl key&#x27;, process.env.SSL_KEY);
	this.set(&#x27;ssl cert&#x27;, process.env.SSL_CERT);

	this.set(&#x27;cookie secret&#x27;, process.env.COOKIE_SECRET);
	this.set(&#x27;cookie signin&#x27;, (this.<span class="apidocCodeKeywordSpan">get</span>(&#x27;env&#x27;) === &#x27;development
&#x27;) ? true : false);

	this.set(&#x27;embedly api key&#x27;, process.env.EMBEDLY_API_KEY || process.env.EMBEDLY_APIKEY);
	this.set(&#x27;mandrill api key&#x27;, process.env.MANDRILL_API_KEY || process.env.MANDRILL_APIKEY);
	this.set(&#x27;mandrill username&#x27;, process.env.MANDRILL_USERNAME);
	this.set(&#x27;google api key&#x27;, process.env.GOOGLE_BROWSER_KEY);
	this.set(&#x27;google server api key&#x27;, process.env.GOOGLE_SERVER_KEY);
	this.set(&#x27;ga property&#x27;, process.env.GA_PROPERTY);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.getOrphanedLists" id="apidoc.element.keystone.Keystone.prototype.getOrphanedLists">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>getOrphanedLists
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getOrphanedLists() {
	if (!this.nav) {
		return [];
	}
	return _.filter(this.lists, function (list, key) {
		if (list.get(&#x27;hidden&#x27;)) return false;
		return (!this.nav.by.list[key]) ? list : false;
	}.bind(this));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.getPath" id="apidoc.element.keystone.Keystone.prototype.getPath">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>getPath
        <span class="apidocSignatureSpan">(key, defaultValue)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getPath = function (key, defaultValue) {
	return this.expandPath(this.get(key) || defaultValue);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
exports.apply = function (callback) {

	var Update = mongoose.model(&#x27;App_Update&#x27;);
	var updateCount = 0;
	var deferCount = 0;
	var skipCount = 0;

	var updatesPath = keystone.<span class="apidocCodeKeywordSpan">getPath</span>(&#x27;updates&#x27;, &#x27;updates&#x27;);

	// logError is used to log errors before the process exits since it is more synchronous than console.error.  Using
	// console.error gets into race condition issues with process.exit, which has higher priority.
	var logError = function () {
		for (var i = 0, len = arguments.length; i &#x3c; len; ++i) {
			process.stderr.write(arguments[i] + &#x27;\n&#x27;);
		}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.import" id="apidoc.element.keystone.Keystone.prototype.import">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>import
        <span class="apidocSignatureSpan">(dirname)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">import = function (dirname) {

	var initialPath = path.join(this.get(&#x27;module root&#x27;), dirname);

	var doImport = function (fromPath) {

		var imported = {};

		fs.readdirSync(fromPath).forEach(function (name) {

			var fsPath = path.join(fromPath, name);
			var info = fs.statSync(fsPath);

			// recur
			if (info.isDirectory()) {
				imported[name] = doImport(fsPath);
			} else {
				// only import files that we can `require`
				var ext = path.extname(name);
				var base = path.basename(name, ext);
				if (require.extensions[ext]) {
					imported[base] = require(fsPath);
				}
			}

		});

		return imported;
	};

	return doImport(initialPath);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
keystone.utils = utils;

/**
 * returns all .js modules (recursively) in the path specified, relative
 * to the module root (where the keystone project is being consumed from).
 *
 * ####Example:
 *     var models = keystone.<span class="apidocCodeKeywordSpan">import</span>(&#x27;models&#x27;);
 */

Keystone.prototype.import = function (dirname) {

	var initialPath = path.join(this.get(&#x27;module root&#x27;), dirname);

	var doImport = function (fromPath) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.importer" id="apidoc.element.keystone.Keystone.prototype.importer">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>importer
        <span class="apidocSignatureSpan">(rel__dirname)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function dispatchImporter(rel__dirname) {

	function importer (from) {
		debug(&#x27;importing &#x27;, from);
		var imported = {};
		var joinPath = function () {
			return &#x27;.&#x27; + path.sep + path.join.apply(path, arguments);
		};

		var fsPath = joinPath(path.relative(process.cwd(), rel__dirname), from);
		fs.readdirSync(fsPath).forEach(function (name) {
			var info = fs.statSync(path.join(fsPath, name));
			debug(&#x27;recur&#x27;);
			if (info.isDirectory()) {
				imported[name] = importer(joinPath(from, name));
			} else {
				// only import files that we can `require`
				var ext = path.extname(name);
				var base = path.basename(name, ext);
				if (require.extensions[ext]) {
					imported[base] = require(path.join(rel__dirname, from, name));
				} else {
					debug(&#x27;cannot require &#x27;, ext);
				}
			}
		});

		return imported;
	}

	return importer;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
* Returns a function that looks in a specified path relative to the current
* directory, and returns all .js modules in it (recursively).
*
* ####Example:
*
*     var importRoutes = keystone.<span class="apidocCodeKeywordSpan">importer</span>(__dirname);
*
*     var routes = {
*         site: importRoutes(&#x27;./site&#x27;),
*         api: importRoutes(&#x27;./api&#x27;)
*     };
*
* @param {String} rel__dirname
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.init" id="apidoc.element.keystone.Keystone.prototype.init">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>init
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function init(options) {
	this.options(options);
	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			self.editor = editor;
			editor.on(&#x27;change&#x27;, self.valueChanged);
			editor.on(&#x27;focus&#x27;, self.focusChanged.bind(self, true));
			editor.on(&#x27;blur&#x27;, self.focusChanged.bind(self, false));
		};

		this._currentValue = this.props.value;
		_tinymce2.default.<span class="apidocCodeKeywordSpan">init</span>(opts);
		if ((0, _evalDependsOn2.default)(this.props.dependsOn, this.props.values)) {
			this.setState({ wysiwygActive: true });
		}
	},
	removeWysiwyg: function removeWysiwyg(state) {
		removeTinyMCEInstance(_tinymce2.default.get(state.id));
		this.setState({ wysiwygActive: false });
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.initDatabaseConfig" id="apidoc.element.keystone.Keystone.prototype.initDatabaseConfig">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>initDatabaseConfig
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function initDatabaseConfig() {
	if (!this.get(&#x27;mongo&#x27;)) {
		var dbName = this.get(&#x27;db name&#x27;)
			|| utils.slug(this.get(&#x27;name&#x27;));
		var dbUrl = process.env.MONGO_URI
			|| process.env.MONGODB_URI
			|| process.env.MONGO_URL
			|| process.env.MONGODB_URL
			|| process.env.MONGOLAB_URI
			|| process.env.MONGOLAB_URL
			|| (process.env.OPENSHIFT_MONGODB_DB_URL
			|| &#x27;mongodb://localhost/&#x27;) + dbName;
		this.set(&#x27;mongo&#x27;, dbUrl);
	}
	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		keystone.app = express();
	}

	var app = keystone.app;
	require(&#x27;./initLetsEncrypt&#x27;)(keystone, app);
	require(&#x27;./initSslRedirect&#x27;)(keystone, app);

	keystone.<span class="apidocCodeKeywordSpan">initDatabaseConfig</span>();
	keystone.initExpressSession(keystone.mongoose);

	require(&#x27;./initTrustProxy&#x27;)(keystone, app);
	require(&#x27;./initViewEngine&#x27;)(keystone, app);
	require(&#x27;./initViewLocals&#x27;)(keystone, app);
	require(&#x27;./bindIPRestrictions&#x27;)(keystone, app);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.initExpressApp" id="apidoc.element.keystone.Keystone.prototype.initExpressApp">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>initExpressApp
        <span class="apidocSignatureSpan">(customApp)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function initExpressApp(customApp) {
	if (this.app) return this;
	this.initDatabaseConfig();
	this.initExpressSession(this.mongoose);
	if (customApp) {
		this.app = customApp;
		require(&#x27;../../server/createApp&#x27;)(this);
	} else {
		this.app = require(&#x27;../../server/createApp&#x27;)(this);
	}
	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			process.exit();
		} else {
			console.log(e.stack || e);
			process.exit(1);
		}
	});

	this.<span class="apidocCodeKeywordSpan">initExpressApp</span>();

	var keystone = this;
	var app = keystone.app;

	this.openDatabaseConnection(function () {

		fireEvent(&#x27;onMount&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.initExpressSession" id="apidoc.element.keystone.Keystone.prototype.initExpressSession">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>initExpressSession
        <span class="apidocSignatureSpan">(mongoose)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function initExpressSession(mongoose) {

	if (this.expressSession) return this;

	var sessionStorePromise;

	// Initialise and validate session options
	if (!this.get(&#x27;cookie secret&#x27;)) {
		console.error(&#x27;\nKeystoneJS Configuration Error:\n\nPlease provide a `cookie secret` value for session encryption.\n&#x27;);
		process.exit(1);
	}
	var sessionOptions = this.get(&#x27;session options&#x27;);

	if (typeof sessionOptions !== &#x27;object&#x27;) {
		sessionOptions = {};
	}
	if (!sessionOptions.key) {
		sessionOptions.key = &#x27;this.sid&#x27;;
	}
	if (!sessionOptions.resave) {
		sessionOptions.resave = false;
	}
	if (!sessionOptions.saveUninitialized) {
		sessionOptions.saveUninitialized = false;
	}
	if (!sessionOptions.secret) {
		sessionOptions.secret = this.get(&#x27;cookie secret&#x27;);
	}

	sessionOptions.cookieParser = cookieParser(this.get(&#x27;cookie secret&#x27;));

	var sessionStore = this.get(&#x27;session store&#x27;);

	if (typeof sessionStore === &#x27;function&#x27;) {
		sessionOptions.store = sessionStore(session);
	} else if (sessionStore) {

		var sessionStoreOptions = this.get(&#x27;session store options&#x27;) || {};

		// Perform any session store specific configuration or exit on an unsupported session store

		if (sessionStore === &#x27;mongo&#x27;) {
			sessionStore = &#x27;connect-mongo&#x27;;
		} else if (sessionStore === &#x27;redis&#x27;) {
			sessionStore = &#x27;connect-redis&#x27;;
		}

		switch (sessionStore) {
			case &#x27;connect-mongo&#x27;:
				debug(&#x27;using connect-mongo session store&#x27;);
				if (process.version.substr(0, 4) === &#x27;v0.1&#x27;) {
					// try to require connect-mongo/es5; if this works, we can
					// assume a new version of connect-mongo, and the es5
					// variant should be used
					try {
						require(&#x27;connect-mongo/es5&#x27;);
						sessionStore = &#x27;connect-mongo/es5&#x27;;
					} catch (e) {
						// if it throws, allow the error to be handled by the
						// normal try/catch process around initialisation
					}
				}
				_.defaults(sessionStoreOptions, {
					collection: &#x27;app_sessions&#x27;,
					mongooseConnection: mongoose.connection,
				});
				break;

			case &#x27;connect-mongostore&#x27;:
				debug(&#x27;using connect-mongostore session store&#x27;);
				_.defaults(sessionStoreOptions, {
					collection: &#x27;app_sessions&#x27;,
				});
				if (!sessionStoreOptions.db) {
					console.error(
						&#x27;\nERROR: connect-mongostore requires `session store options` to be set.&#x27;
						+ &#x27;\n&#x27;
						+ &#x27;\nSee http://thisjs.com/docs/configuration#options-database for details.&#x27;
						+ &#x27;\n&#x27;);
					process.exit(1);
				}
				break;

			case &#x27;connect-redis&#x27;:
				debug(&#x27;using connect-redis session store&#x27;);
				break;

			default:
				console.error(
					&#x27;\nERROR: unsupported session store &#x27; + sessionStore + &#x27;.&#x27;
					+ &#x27;\n&#x27;
					+ &#x27;\nSee http://thisjs.com/docs/configuration#options-database for details.&#x27;
					+ &#x27;\n&#x27;);
				process.exit(1);
				break;
		}

		// Initialize the session store
		try {
			var SessionStore = require(sessionStore)(session);

			sessionStorePromise = new Promise(
				function (resolve, reject) {
					sessionOptions.store = new SessionStore(sessionStoreOptions, resolve);
					sessionOptions.store.on(&#x27;connect&#x27;, resolve);
					sessionOptions.store.on(&#x27;connected&#x27;, resolve);
					sessionOptions.store.on(&#x27;disconnect&#x27;, function () {
						console.error(
							&#x27;\nThere was an error connecting to the &#x27; + sessionStore + &#x27; session store.&#x27;
							+ &#x27;\n&#x27;);
						process.exit(1);
					});
				}
			);
		} catch (e) {
			if (e.code === &#x27;MODULE_NOT_FOUND&#x27;) {
				console.error(
					&#x27;\n&#x27; + e.toString()
					+ &#x27;\nTo use &#x27; + this.get(&#x27;session store&#x27;) + &#x27; as a `session store` option, run:&#x27;
					+ &#x27;\nnpm install &#x27; + sessionStore + &#x27; --save&#x27;
					+ &#x27;\n&#x27;);
				process.exit(1);
			} else {
				throw e;
			}
		}
	}

	// expose initialised session and options
	this.set(&#x27;session options&#x27;, sessionOptions);
	this.expressSession = session(sessionOptions);
	this.sessionStorePromise = sessionStorePromise;

	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	}

	var app = keystone.app;
	require(&#x27;./initLetsEncrypt&#x27;)(keystone, app);
	require(&#x27;./initSslRedirect&#x27;)(keystone, app);

	keystone.initDatabaseConfig();
	keystone.<span class="apidocCodeKeywordSpan">initExpressSession</span>(keystone.mongoose);

	require(&#x27;./initTrustProxy&#x27;)(keystone, app);
	require(&#x27;./initViewEngine&#x27;)(keystone, app);
	require(&#x27;./initViewLocals&#x27;)(keystone, app);
	require(&#x27;./bindIPRestrictions&#x27;)(keystone, app);

	// Compress response bodies
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.initNav" id="apidoc.element.keystone.Keystone.prototype.initNav">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>initNav
        <span class="apidocSignatureSpan">(sections)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function initNav(sections) {
	var keystone = this;

	var nav = {
		sections: [],
		by: {
			list: {},
			section: {},
		},
	};

	if (!sections) {
		sections = {};
		nav.flat = true;
		_.forEach(this.lists, function (list) {
			if (list.get(&#x27;hidden&#x27;)) return;
			sections[list.path] = [list.path];
		});
	}

	_.forEach(sections, function (section, key) {
		if (typeof section === &#x27;string&#x27;) {
			section = [section];
		}
		section = {
			lists: section,
			label: nav.flat ? keystone.list(section[0]).label : utils.keyToLabel(key),
		};
		section.key = key;
		section.lists = _.map(section.lists, function (i) {
			if (typeof i === &#x27;string&#x27;) {
				var list = keystone.list(i);
				if (!list) {
					throw new Error(&#x27;Invalid Keystone Option (nav): list &#x27; + i + &#x27; has not been defined.\n&#x27;);
				}
				if (list.get(&#x27;hidden&#x27;)) {
					throw new Error(&#x27;Invalid Keystone Option (nav): list &#x27; + i + &#x27; is hidden.\n&#x27;);
				}
				nav.by.list[list.key] = section;
				return {
					key: list.key,
					label: list.label,
					path: list.path,
				};
			} else if (_.isObject(i)) {
				if (!_.has(i, &#x27;key&#x27;)) {
					throw new Error(&#x27;Invalid Keystone Option (nav): object &#x27; + i + &#x27; requires a &#x22;key&#x22; property.\n&#x27;);
				}
				i.label = i.label || utils.keyToLabel(key);
				i.path = i.path || utils.keyToPath(key);
				i.external = true;
				nav.by.list[i.key] = section;
				return i;
			}
			throw new Error(&#x27;Invalid Keystone Option (nav): &#x27; + i + &#x27; is in an unrecognized format.\n&#x27;);
		});
		if (section.lists.length) {
			nav.sections.push(section);
			nav.by.section[section.key] = section;
		}
	});

	return nav;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			break;
		case &#x27;auth&#x27;:
			if (value === true &#x26;&#x26; !this.get(&#x27;session&#x27;)) {
				this.set(&#x27;session&#x27;, true);
			}
			break;
		case &#x27;nav&#x27;:
			this.nav = this.<span class="apidocCodeKeywordSpan">initNav</span>(value);
			break;
		case &#x27;mongo&#x27;:
			if (typeof value !== &#x27;string&#x27;) {
				if (Array.isArray(value) &#x26;&#x26; (value.length === 2 || value.length === 3)) {
					console.log(&#x27;\nWarning: using an array for the `mongo` option has been deprecated.\nPlease use a mongodb connection string
, e.g. mongodb://localhost/db_name instead.\n\n&#x27;
					+ &#x27;Support for arrays as the `mongo` setting will be removed in a future version.&#x27;);
					value = (value.length === 2) ? &#x27;mongodb://&#x27; + value[0] + &#x27;/&#x27; + value[1] : &#x27;mongodb://&#x27; + value
[0] + &#x27;:&#x27; + value[2] + &#x27;/&#x27; + value[1];
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.list" id="apidoc.element.keystone.Keystone.prototype.list">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>list
        <span class="apidocSignatureSpan">(key)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function list(key) {
	var result = this.lists[key] || this.lists[this.paths[key]];
	if (!result) throw new ReferenceError(&#x27;Unknown keystone list &#x27; + JSON.stringify(key));
	return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	async.waterfall([

		// create items
		function (next) {
			async.eachSeries(lists, function (key, doneList) {

				var list = keystone.<span class="apidocCodeKeywordSpan">list</span>(key);
				var relationshipPaths = _.filter(list.fields, { type: &#x27;relationship&#x27; }).map(function (i) { return i.path; });

				if (!list) {
					if (options.strict) {
						return doneList({
							type: &#x27;invalid list&#x27;,
							message: &#x27;List key &#x27; + key + &#x27; is invalid.&#x27;,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.openDatabaseConnection" id="apidoc.element.keystone.Keystone.prototype.openDatabaseConnection">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>openDatabaseConnection
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function openDatabaseConnection(callback) {

	var keystone = this;
	var mongoConnectionOpen = false;

	// support replica sets for mongoose
	if (keystone.get(&#x27;mongo replica set&#x27;)) {

		if (keystone.get(&#x27;logger&#x27;)) {
			console.log(&#x27;\nWarning: using the `mongo replica set` option has been deprecated and will be removed in&#x27;
				+ &#x27; a future version.\nInstead set the `mongo` connection string with your host details, e.g.&#x27;
				+ &#x27; mongodb://username:password@host:port,host:port,host:port/database and set any replica set options&#x27;
				+ &#x27; in `mongo options`.\n\nRefer to https://mongodb.github.io/node-mongodb-native/driver-articles/mongoclient.html&#x27;
				+ &#x27; for more details on the connection settings.&#x27;);
		}

		debug(&#x27;setting up mongo replica set&#x27;);
		var replicaData = keystone.get(&#x27;mongo replica set&#x27;);
		var replica = &#x27;&#x27;;

		var credentials = (replicaData.username &#x26;&#x26; replicaData.password) ? replicaData.username + &#x27;:&#x27; + replicaData.password + &#x27;@&#x27; : &#x27;&#x27;;

		replicaData.db.servers.forEach(function (server) {
			replica += &#x27;mongodb://&#x27; + credentials + server.host + &#x27;:&#x27; + server.port + &#x27;/&#x27; + replicaData.db.name + &#x27;,&#x27;;
		});

		var options = {
			auth: { authSource: replicaData.authSource },
			replset: {
				rs_name: replicaData.db.replicaSetOptions.rs_name,
				readPreference: replicaData.db.replicaSetOptions.readPreference,
			},
		};

		debug(&#x27;connecting to replica set&#x27;);
		keystone.mongoose.connect(replica, options);

	} else {
		debug(&#x27;connecting to mongo&#x27;);
		keystone.initDatabaseConfig();
		keystone.mongoose.connect(keystone.get(&#x27;mongo&#x27;), keystone.get(&#x27;mongo options&#x27;));
	}

	keystone.mongoose.connection.on(&#x27;error&#x27;, function (err) {

		// The DB connection has been established previously and this a ValidationError caused by restrictions Mongoose is enforcing on
 the field value
		// We can ignore these here; they&#x27;ll also be picked up by the &#x27;error&#x27; event listener on the model; see /lib/list/register.js
		if (mongoConnectionOpen &#x26;&#x26; err &#x26;&#x26; err.name === &#x27;ValidationError&#x27;) return;

		// Alternatively, the error is legitimate; output it
		console.error(&#x27;------------------------------------------------&#x27;);
		console.error(&#x27;Mongoose connection &#x22;error&#x22; event fired with:&#x27;);
		console.error(err);

		// There&#x27;s been an error establishing the initial connection, ie. Keystone is attempting to start
		if (!mongoConnectionOpen) {
			throw new Error(&#x27;KeystoneJS (&#x27; + keystone.get(&#x27;name&#x27;) + &#x27;) failed to start - Check that you are running `mongod` in a separate
 process.&#x27;);
		}

		// Otherwise rethrow the initial error
		throw err;

	}).once(&#x27;open&#x27;, function () {

		debug(&#x27;mongo connection open&#x27;);
		mongoConnectionOpen = true;

		var connected = function () {
			if (keystone.get(&#x27;auto update&#x27;)) {
				debug(&#x27;applying auto update&#x27;);
				keystone.applyUpdates(callback);
			} else {
				callback();
			}
		};

		if (keystone.sessionStorePromise) {
			keystone.sessionStorePromise.then(connected);
		} else {
			connected();
		}

	});

	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	});

	this.initExpressApp();

	var keystone = this;
	var app = keystone.app;

	this.<span class="apidocCodeKeywordSpan">openDatabaseConnection</span>(function () {

		fireEvent(&#x27;onMount&#x27;);

		var ssl = keystone.get(&#x27;ssl&#x27;);
		var unixSocket = keystone.get(&#x27;unix socket&#x27;);
		var startupMessages = [&#x27;KeystoneJS Started:&#x27;];
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.options" id="apidoc.element.keystone.Keystone.prototype.options">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>options
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">options = function (options) {
	if (!arguments.length) {
		return this._options;
	}
	if (typeof options === &#x27;object&#x27;) {
		var keys = Object.keys(options);
		var i = keys.length;
		var k;
		while (i--) {
			k = keys[i];
			this.set(k, options[k]);
		}
	}
	return this._options;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var initialFields;

		// Inherit default options from parent list if it exists
		if (options &#x26;&#x26; options.inherits) {
			if (options.inherits.options &#x26;&#x26; options.inherits.options.inherits) {
				throw new Error(&#x27;Inherited Lists may not contain any inheritance&#x27;);
			}
			defaultOptions = utils.<span class="apidocCodeKeywordSpan">options</span>(defaultOptions, options.inherits.options);
			if (options.inherits.options.track) {
				options.track = false;
			}
		}

		this.options = utils.options(defaultOptions, options);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.populateRelated" id="apidoc.element.keystone.Keystone.prototype.populateRelated">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>populateRelated
        <span class="apidocSignatureSpan">(docs, relationships, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function populateRelated(docs, relationships, callback) {
	if (Array.isArray(docs)) {
		async.each(docs, function (doc, done) {
			doc.populateRelated(relationships, done);
		}, callback);
	} else if (docs &#x26;&#x26; docs.populateRelated) {
		docs.populateRelated(relationships, callback);
	} else {
		callback();
	}
	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 *
 * @api public
 */

module.exports = function populateRelated (docs, relationships, callback) {
	if (Array.isArray(docs)) {
		async.each(docs, function (doc, done) {
			doc.<span class="apidocCodeKeywordSpan">populateRelated</span>(relationships, done);
		}, callback);
	} else if (docs &#x26;&#x26; docs.populateRelated) {
		docs.populateRelated(relationships, callback);
	} else {
		callback();
	}
	return this;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.prefixModel" id="apidoc.element.keystone.Keystone.prototype.prefixModel">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>prefixModel
        <span class="apidocSignatureSpan">(key)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">prefixModel = function (key) {
	var modelPrefix = this.get(&#x27;model prefix&#x27;);

	if (modelPrefix) {
		key = modelPrefix + &#x27;_&#x27; + key;
	}

	return require(&#x27;mongoose/lib/utils&#x27;).toCollectionName(key);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	function List (key, options) {
		if (!(this instanceof List)) return new List(key, options);
		this.keystone = keystone;

		var defaultOptions = {
			schema: {
				collection: keystone.<span class="apidocCodeKeywordSpan">prefixModel</span>(key),
			},
			noedit: false,
			nocreate: false,
			nodelete: false,
			autocreate: false,
			sortable: false,
			hidden: false,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.redirect" id="apidoc.element.keystone.Keystone.prototype.redirect">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>redirect
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function redirect() {
	if (arguments.length === 1 &#x26;&#x26; utils.isObject(arguments[0])) {
		_.extend(this._redirects, arguments[0]);
	} else if (arguments.length === 2 &#x26;&#x26; typeof arguments[0] === &#x27;string&#x27; &#x26;&#x26; typeof arguments[1] === &#x27;string&#x27;) {
		this._redirects[arguments[0]] = arguments[1];
	}
	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



module.exports = function bindErrorHandlers (keystone, app) {
	if (Object.keys(keystone._redirects).length) {
		app.use(function (req, res, next) {
			if (keystone._redirects[req.path]) {
				res.<span class="apidocCodeKeywordSpan">redirect</span>(keystone._redirects[req.path]);
			} else {
				next();
			}
		});
	}
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.routes" id="apidoc.element.keystone.Keystone.prototype.routes">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>routes
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">routes = function () {
	throw new Error(&#x27;keystone.routes(fn) has been removed, use keystone.set(\&#x27;routes\&#x27;, fn)&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Keystone.prototype.redirect = require(&#x27;./lib/core/redirect&#x27;);
Keystone.prototype.start = require(&#x27;./lib/core/start&#x27;);
Keystone.prototype.wrapHTMLError = require(&#x27;./lib/core/wrapHTMLError&#x27;);
Keystone.prototype.createKeystoneHash = require(&#x27;./lib/core/createKeystoneHash&#x27;);

/* Deprecation / Change warnings for 0.4 */
Keystone.prototype.routes = function () {
	throw new Error(&#x27;keystone.<span class="apidocCodeKeywordSpan">routes</span>(fn) has been removed, use keystone.set(\&#x27;
routes\&#x27;, fn)&#x27;);
};


/**
 * The exports object is an instance of Keystone.
 */
var keystone = module.exports = new Keystone();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.set" id="apidoc.element.keystone.Keystone.prototype.set">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>set
        <span class="apidocSignatureSpan">(key, value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">set = function (key, value) {

	if (arguments.length === 1) {
		return this._options[key];
	}

	switch (key) {
		// throw on unsupported options
		case &#x27;email rules&#x27;:
			throw new Error(&#x27;The option &#x22;&#x27; + key + &#x27;&#x22; is no longer supported. See https://github.com/keystonejs/keystone/wiki/0.3.x-to-0.
4.x-Changes&#x27;);
		// handle special settings
		case &#x27;cloudinary config&#x27;:
			var cloudinary = require(&#x27;cloudinary&#x27;);
			if (typeof value === &#x27;string&#x27;) {
				var parts = url.parse(value, true);
				var auth = parts.auth ? parts.auth.split(&#x27;:&#x27;) : [];
				value = {
					cloud_name: parts.host,
					api_key: auth[0],
					api_secret: auth[1],
					private_cdn: parts.pathname != null,
					secure_distribution: parts.pathname &#x26;&#x26; parts.pathname.substring(1),
				};
			}
			cloudinary.config(value);
			value = cloudinary.config();
			break;
		case &#x27;auth&#x27;:
			if (value === true &#x26;&#x26; !this.get(&#x27;session&#x27;)) {
				this.set(&#x27;session&#x27;, true);
			}
			break;
		case &#x27;nav&#x27;:
			this.nav = this.initNav(value);
			break;
		case &#x27;mongo&#x27;:
			if (typeof value !== &#x27;string&#x27;) {
				if (Array.isArray(value) &#x26;&#x26; (value.length === 2 || value.length === 3)) {
					console.log(&#x27;\nWarning: using an array for the `mongo` option has been deprecated.\nPlease use a mongodb connection string,
e.g. mongodb://localhost/db_name instead.\n\n&#x27;
					+ &#x27;Support for arrays as the `mongo` setting will be removed in a future version.&#x27;);
					value = (value.length === 2) ? &#x27;mongodb://&#x27; + value[0] + &#x27;/&#x27; + value[1] : &#x27;mongodb://&#x27; + value[0] + &#x27;:&#x27; + value[2] + &#x27;/&#x27; +
value[1];
				} else {
					console.error(&#x27;\nInvalid Configuration:\nThe `mongo` option must be a mongodb connection string, e.g. mongodb://localhost/db_name\n&#x27;);
					process.exit(1);
				}
			}
			break;
		case &#x27;module root&#x27;:
			// if relative path is used, resolve it based on the caller&#x27;s path
			if (!isAbsolutePath(value)) {
				var caller = callerId.getData();
				value = path.resolve(path.dirname(caller.filePath), value);
			}
			break;
		case &#x27;app&#x27;:
			this.app = value;
			break;
		case &#x27;mongoose&#x27;:
			this.mongoose = value;
			break;
		case &#x27;frame guard&#x27;:
			var validFrameGuardOptions = [&#x27;deny&#x27;, &#x27;sameorigin&#x27;];

			if (value === true) {
				value = &#x27;deny&#x27;;
			}
			if (typeof value === &#x27;string&#x27;) {
				value = value.toLowerCase();
				if (validFrameGuardOptions.indexOf(value) &#x3c; 0) {
					value = false;
				}
			} else if (typeof value !== &#x27;boolean&#x27;) {
				value = false;
			}
			break;
	}

	this._options[key] = value;
	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Alternatively, to include Keystone in an existing project or start from scratch (without Yeoman), specify `keystone: &#x22;^0.3.
9&#x22;` in the `dependencies` array of your `package.json` file, and run `npm install` from your terminal.

Then read through the [Documentation](http://keystonejs.com/docs) and the [Example Projects](http://keystonejs.com/examples) to
understand how to use it.

### Configuration

Config variables can be passed in an object to the `keystone.init` method, or can be set any time before `keystone.start` is called
 using `keystone.<span class="apidocCodeKeywordSpan">set</span>(key, value)`. This allows for a more flexible order of execution
 (e.g. if you refer to Lists in your routes, you can set the routes after configuring your Lists, as in the example above).

See the [KeystoneJS configuration documentation](http://keystonejs.com/docs/configuration) for details and examples of the available
 configuration options.

### Database field types

Keystone builds on the basic data types provided by mongo and allows you to easily add rich, functional fields to your application
&#x27;s models.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.start" id="apidoc.element.keystone.Keystone.prototype.start">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>start
        <span class="apidocSignatureSpan">(events)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function start(events) {

	if (typeof events === &#x27;function&#x27;) {
		events = { onStart: events };
	}
	if (!events) events = {};

	function fireEvent (name) {
		if (typeof events[name] === &#x27;function&#x27;) {
			events[name]();
		}
	}

	process.on(&#x27;uncaughtException&#x27;, function (e) {
		if (e.code === &#x27;EADDRINUSE&#x27;) {
			console.log(dashes
				+ keystone.get(&#x27;name&#x27;) + &#x27; failed to start: address already in use\n&#x27;
				+ &#x27;Please check you are not already running a server on the specified port.\n&#x27;);
			process.exit();
		} else {
			console.log(e.stack || e);
			process.exit(1);
		}
	});

	this.initExpressApp();

	var keystone = this;
	var app = keystone.app;

	this.openDatabaseConnection(function () {

		fireEvent(&#x27;onMount&#x27;);

		var ssl = keystone.get(&#x27;ssl&#x27;);
		var unixSocket = keystone.get(&#x27;unix socket&#x27;);
		var startupMessages = [&#x27;KeystoneJS Started:&#x27;];

		async.parallel([
			// HTTP Server
			function (done) {
				if (ssl === &#x27;only&#x27; || unixSocket) return done();
				require(&#x27;../../server/startHTTPServer&#x27;)(keystone, app, function (err, msg) {
					fireEvent(&#x27;onHttpServerCreated&#x27;);
					startupMessages.push(msg);
					done(err);
				});
			},
			// HTTPS Server
			function (done) {
				if (!ssl || unixSocket) return done();
				require(&#x27;../../server/startSecureServer&#x27;)(keystone, app, function () {
					fireEvent(&#x27;onHttpsServerCreated&#x27;);
				}, function (err, msg) {
					startupMessages.push(msg);
					done(err);
				});
			},
			// Unix Socket
			function (done) {
				if (!unixSocket) return done();
				require(&#x27;../../server/startSocketServer&#x27;)(keystone, app, function (err, msg) {
					fireEvent(&#x27;onSocketServerCreated&#x27;);
					startupMessages.push(msg);
					done(err);
				});
			},
		], function serversStarted (err, messages) {
			if (keystone.get(&#x27;logger&#x27;)) {
				console.log(dashes + startupMessages.join(&#x27;\n&#x27;) + dashes);
			}
			fireEvent(&#x27;onStart&#x27;);
		});
	});

	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.wrapHTMLError" id="apidoc.element.keystone.Keystone.prototype.wrapHTMLError">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.</span>wrapHTMLError
        <span class="apidocSignatureSpan">(title, err)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function wrapHTMLError(title, err) {
	return &#x27;&#x3c;html&#x3e;&#x3c;head&#x3e;&#x3c;meta charset=\&#x27;utf-8\&#x27;&#x3e;&#x3c;title&#x3e;Error&#x3c;/title&#x3e;&#x27;
	+ &#x27;&#x3c;link rel=\&#x27;stylesheet\&#x27; href=\&#x27;/&#x27; + this.get(&#x27;admin path&#x27;) + &#x27;/styles/error.css\&#x27;&#x3e;&#x27;
	+ &#x27;&#x3c;/head&#x3e;&#x3c;body&#x3e;&#x3c;div class=\&#x27;error\&#x27;&#x3e;&#x3c;h1 class=\&#x27;error-title\&#x27;&#x3e;&#x27; + title + &#x27;&#x3c;/h1&#x3e;&#x27;
	+ &#x27;&#x3c;div class=&#x22;error-message&#x22;&#x3e;&#x27; + (err || &#x27;&#x27;) + &#x27;&#x3c;/div&#x3e;&#x3c;/div&#x3e;&#x3c;/body&#x3e;&#x3c;/html&#x3e;&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
module.exports = function bindErrorHandlers (keystone, app) {

	// Handle 404 (no route matched) errors
	var default404Handler = function (req, res) {
		if (req.headers.accept === &#x27;application/json&#x27;) {
			return res.status(404).json({ error: &#x27;not found&#x27; });
		}
		res.status(404).send(keystone.<span class="apidocCodeKeywordSpan">wrapHTMLError</span>(&#x27;Sorry, no page could be found at
this address (404)&#x27;));
	};

	app.use(function (req, res, next) {
		var err404 = keystone.get(&#x27;404&#x27;);
		if (err404) {
			try {
				if (typeof err404 === &#x27;function&#x27;) {
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Keystone.prototype.console" id="apidoc.module.keystone.Keystone.prototype.console">module keystone.Keystone.prototype.console</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Keystone.prototype.console.err" id="apidoc.element.keystone.Keystone.prototype.console.err">
        function <span class="apidocSignatureSpan">keystone.Keystone.prototype.console.</span>err
        <span class="apidocSignatureSpan">(type, msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">err = function (type, msg) {
	if (keystone.get(&#x27;logger&#x27;)) {
		var dashes = &#x27;\n------------------------------------------------\n&#x27;;
		console.log(dashes + &#x27;KeystoneJS: &#x27; + type + &#x27;:\n\n&#x27; + msg + dashes);
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.List" id="apidoc.module.keystone.List">module keystone.List</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.List.List" id="apidoc.element.keystone.List.List">
        function <span class="apidocSignatureSpan">keystone.</span>List
        <span class="apidocSignatureSpan">(key, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function List(key, options) {
		if (!(this instanceof List)) return new List(key, options);
		this.keystone = keystone;

		var defaultOptions = {
			schema: {
				collection: keystone.prefixModel(key),
			},
			noedit: false,
			nocreate: false,
			nodelete: false,
			autocreate: false,
			sortable: false,
			hidden: false,
			track: false,
			inherits: false,
			perPage: 100,
			searchFields: &#x27;__name__&#x27;,
			searchUsesTextIndex: false,
			defaultSort: &#x27;__default__&#x27;,
			defaultColumns: &#x27;__name__&#x27;,
		};

		// initialFields values are initialised on demand by the getter
		var initialFields;

		// Inherit default options from parent list if it exists
		if (options &#x26;&#x26; options.inherits) {
			if (options.inherits.options &#x26;&#x26; options.inherits.options.inherits) {
				throw new Error(&#x27;Inherited Lists may not contain any inheritance&#x27;);
			}
			defaultOptions = utils.options(defaultOptions, options.inherits.options);
			if (options.inherits.options.track) {
				options.track = false;
			}
		}

		this.options = utils.options(defaultOptions, options);

		// init properties
		this.key = key;
		this.path = this.get(&#x27;path&#x27;) || utils.keyToPath(key, true);
		this.schema = new keystone.mongoose.Schema({}, this.options.schema);
		this.schemaFields = [];
		this.uiElements = [];
		this.underscoreMethods = {};
		this.fields = {};
		this.fieldsArray = [];
		this.fieldTypes = {};
		this.relationshipFields = [];
		this.relationships = {};
		this.mappings = {
			name: null,
			createdBy: null,
			createdOn: null,
			modifiedBy: null,
			modifiedOn: null,
		};

		var self = this;

		// init mappings
		_.forEach(this.options.map, function (val, key) { self.map(key, val); });

		// define property getters
		Object.defineProperty(this, &#x27;label&#x27;, { get: function () {
			return this.get(&#x27;label&#x27;) || this.set(&#x27;label&#x27;, utils.plural(utils.keyToLabel(key)));
		} });
		Object.defineProperty(this, &#x27;singular&#x27;, { get: function () {
			return this.get(&#x27;singular&#x27;) || this.set(&#x27;singular&#x27;, utils.singular(this.label));
		} });
		Object.defineProperty(this, &#x27;plural&#x27;, { get: function () {
			return this.get(&#x27;plural&#x27;) || this.set(&#x27;plural&#x27;, utils.plural(this.singular));
		} });
		Object.defineProperty(this, &#x27;namePath&#x27;, { get: function () {
			return this.mappings.name || &#x27;_id&#x27;;
		} });
		Object.defineProperty(this, &#x27;nameField&#x27;, { get: function () {
			return this.fields[this.mappings.name];
		} });
		Object.defineProperty(this, &#x27;nameIsVirtual&#x27;, { get: function () {
			return this.model.schema.virtuals[this.mappings.name] ? true : false;
		} });
		Object.defineProperty(this, &#x27;nameFieldIsFormHeader&#x27;, { get: function () {
			return (this.fields[this.mappings.name] &#x26;&#x26; this.fields[this.mappings.name].type === &#x27;text&#x27;) ? !this.fields[this.mappings.name
].noedit : false;
		} });
		Object.defineProperty(this, &#x27;nameIsInitial&#x27;, { get: function () {
			return (this.fields[this.mappings.name] &#x26;&#x26; this.fields[this.mappings.name].options.initial === undefined);
		} });
		Object.defineProperty(this, &#x27;initialFields&#x27;, { get: function () {
			return initialFields || (initialFields = _.filter(this.fields, function (i) { return i.initial; }));
		} });
		if (this.get(&#x27;inherits&#x27;)) {
			var parentFields = this.get(&#x27;inherits&#x27;).schemaFields;
			this.add.apply(this, parentFields);
		}
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.List.prototype" id="apidoc.module.keystone.List.prototype">module keystone.List.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.List.prototype.add" id="apidoc.element.keystone.List.prototype.add">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>add
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function add() {
	var add = function (obj, prefix) {
		prefix = prefix || &#x27;&#x27;;
		var keys = Object.keys(obj);
		for (var i = 0; i &#x3c; keys.length; ++i) {
			var key = keys[i];
			if (!obj[key]) {
				throw new Error(
					&#x27;Invalid value for schema path `&#x27; + prefix + key + &#x27;` in `&#x27; + this.key + &#x27;`.\n&#x27;
					+ &#x27;Did you misspell the field type?\n&#x27;
				);
			}
			if (utils.isObject(obj[key]) &#x26;&#x26; (!obj[key].constructor || obj[key].constructor.name === &#x27;Object&#x27;) &#x26;&#x26; (!obj[key].type || obj[key
].type.type)) {
				if (Object.keys(obj[key]).length) {
					// nested object, e.g. { last: { name: String }}
					// matches logic in mongoose/Schema:add
					this.schema.nested[prefix + key] = true;
					add(obj[key], prefix + key + &#x27;.&#x27;);
				} else {
					addField(prefix + key, obj[key]); // mixed type field
				}
			} else {
				addField(prefix + key, obj[key]);
			}
		}
	}.bind(this);

	var addField = function (path, options) {
		if (this.isReserved(path)) {
			throw new Error(&#x27;Path &#x27; + path + &#x27; on list &#x27; + this.key + &#x27; is a reserved path&#x27;);
		}
		this.uiElements.push({
			type: &#x27;field&#x27;,
			field: this.field(path, options),
		});
	}.bind(this);

	var args = Array.prototype.slice.call(arguments);
	var self = this;

	_.forEach(args, function (def) {
		self.schemaFields.push(def);
		if (typeof def === &#x27;string&#x27;) {
			if (def === &#x27;&#x3e;&#x3e;&#x3e;&#x27;) {
				self.uiElements.push({
					type: &#x27;indent&#x27;,
				});
			} else if (def === &#x27;&#x3c;&#x3c;&#x3c;&#x27;) {
				self.uiElements.push({
					type: &#x27;outdent&#x27;,
				});
			} else {
				self.uiElements.push({
					type: &#x27;heading&#x27;,
					heading: def,
					options: {},
				});
			}
		} else {
			if (def.heading &#x26;&#x26; typeof def.heading === &#x27;string&#x27;) {
				self.uiElements.push({
					type: &#x27;heading&#x27;,
					heading: def.heading,
					options: def,
				});
			} else {
				add(def);
			}
		}
	});

	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @api public
 */

Page.prototype.add = function (fields) {

	// TODO: nested paths
	if (!utils.isObject(fields)) {
		throw new Error(&#x27;keystone.content.Page.<span class="apidocCodeKeywordSpan">add</span>() Error: fields must be an object.&#
x27;);
	}

	var self = this;

	_.forEach(fields, function (options, path) {

		if (typeof options === &#x27;function&#x27;) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.addFiltersToQuery" id="apidoc.element.keystone.List.prototype.addFiltersToQuery">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>addFiltersToQuery
        <span class="apidocSignatureSpan">(filters)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function addFiltersToQuery(filters) {
	var fields = Object.keys(this.fields);
	var query = {};
	fields.forEach(function (path) {
		var field = this.fields[path];
		if (!field.addFilterToQuery || !filters[field.path]) return;
		combineQueries(query, field.addFilterToQuery(filters[field.path]));
	}, this);

	debug(&#x27;Adding filters to query, returned:&#x27;, query);
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.addSearchToQuery" id="apidoc.element.keystone.List.prototype.addSearchToQuery">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>addSearchToQuery
        <span class="apidocSignatureSpan">(searchString)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function addSearchToQuery(searchString) {
	searchString = String(searchString || &#x27;&#x27;).trim();
	var query = {};
	var searchFilters = [];
	if (!searchString) return query;

	if (this.options.searchUsesTextIndex) {
		debug(&#x27;Using text search index for value: &#x22;&#x27; + searchString + &#x27;&#x22;&#x27;);
		searchFilters.push({
			$text: {
				$search: searchString,
			},
		});

		if (this.autokey) {
			var strictAutokeyFilter = {};
			var autokeyRegExp = new RegExp(&#x27;^&#x27; + utils.escapeRegExp(searchString));
			strictAutokeyFilter[this.autokey.path] = autokeyRegExp;
			searchFilters.push(strictAutokeyFilter);
		}
	} else {
		debug(&#x27;Using regular expression search for value: &#x22;&#x27; + searchString + &#x27;&#x22;&#x27;);
		var searchRegExp = new RegExp(utils.escapeRegExp(searchString), &#x27;i&#x27;);
		searchFilters = this.searchFields.map(function (i) {
			if (i.field &#x26;&#x26; i.field.type === &#x27;name&#x27;) {
				return getNameFilter(i.field, searchString);
			} else {
				return getStringFilter(i.path, searchRegExp);
			}
		}, this);

		if (this.autokey) {
			var autokeyFilter = {};
			autokeyFilter[this.autokey.path] = searchRegExp;
			searchFilters.push(autokeyFilter);
		}
	}

	if (utils.isValidObjectId(searchString)) {
		searchFilters.push({
			_id: searchString,
		});
	}

	if (searchFilters.length &#x3e; 1) {
		query.$or = searchFilters;
	} else if (searchFilters.length) {
		assign(query, searchFilters[0]);
	}

	debug(&#x27;Built search query for value: &#x22;&#x27; + searchString + &#x27;&#x22;&#x27;, query);
	return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.apiForGet" id="apidoc.element.keystone.List.prototype.apiForGet">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>apiForGet
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function apiForGet(options) {
	var idParam = options.id || &#x27;id&#x27;;
	var List = this;
	return function (req, res) {
		var id = req.params[idParam];
		var query = List.model.findById(id);
		if (typeof options.query === &#x27;function&#x27;) {
			var result = options.query(query, req);
			if (result === false) return;
		} else if (typeof options.query === &#x27;object&#x27;) {
			query.where(options.query);
		}
		query.exec(function (err, item) {
			if (err) return res.status(500).json({ err: &#x27;database error&#x27;, detail: err });
			if (!item) return res.status(404).json({ err: &#x27;not found&#x27;, id: id });
			if (options.transform) {
				item = options.transform(item, req, res);
				if (item === false) return;
			}
			return res.json({
				data: item,
			});
		});
	};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...






/*
# List.<span class="apidocCodeKeywordSpan">apiForGet</span>(options)

Returns JSON API middleware for a GET /:id endpoint

Supports the following options:

### `id` (string)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.automap" id="apidoc.element.keystone.List.prototype.automap">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>automap
        <span class="apidocSignatureSpan">(field)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function automap(field) {
	if ((field.path in this.mappings) &#x26;&#x26; !this.mappings[field.path]) {
		this.map(field.path, field.path);
	}
	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.buildSearchTextIndex" id="apidoc.element.keystone.List.prototype.buildSearchTextIndex">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>buildSearchTextIndex
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function buildSearchTextIndex() {
	var idxDef = {};

	for (var i = 0; i &#x3c; this.searchFields.length; i++) {
		var sf = this.searchFields[i];
		if (!sf.path || !sf.field) continue;

		// TODO: Allow fields to define their own `getTextIndex` method, so that
		// each type can define the right options for their schema. This is unlikely
		// to behave as expected for fields that aren&#x27;t simple strings or names
		// until that has been done. Should error if the field type doesn&#x27;t support
		// text indexing, as the list has been misconfigured.

		// Does the field have a single path or does it use nested values (like &#x27;name&#x27;)
		if (sf.field.paths) {
			var nFields = sf.field.paths;
			var nKeys = Object.keys(nFields);
			for (var n = 0; n &#x3c; nKeys.length; n++) {
				idxDef[nFields[nKeys[n]]] = &#x27;text&#x27;;
			}
		}
		else if (sf.field.path) {
			idxDef[sf.field.path] = &#x27;text&#x27;;
		}
	}

	// debug(&#x27;text index for \&#x27;&#x27; + this.key + &#x27;\&#x27;:&#x27;, idxDef);
	return Object.keys(idxDef).length &#x3e; 0 ? idxDef : false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * ensureIndexes() call or the connection error listener.
 * Or at least that&#x27;s what was happening for me (mongoose v3.8.40, mongodb v1.4.38)..
 */
function ensureTextIndex (callback) {
	var list = this;
	var collection = list.model.collection;

	var textIndex = list.<span class="apidocCodeKeywordSpan">buildSearchTextIndex</span>();
	var fieldsHash = Math.abs(hashString(Object.keys(textIndex).sort().join(&#x27;;&#x27;)));
	var indexNamePrefix = &#x27;keystone_searchFields_textIndex_&#x27;;
	var newIndexName = indexNamePrefix + fieldsHash;

	// We use this later to create a new index if needed
	var createNewIndex = function () {
		collection.createIndex(textIndex, { name: newIndexName }, function (result) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.declaresTextIndex" id="apidoc.element.keystone.List.prototype.declaresTextIndex">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>declaresTextIndex
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function declaresTextIndex() {
	var indexes = this.schema.indexes();

	for (var i = 0; i &#x3c; indexes.length; i++) {
		var fields = indexes[i][0];
		var fieldNames = Object.keys(fields);

		for (var h = 0; h &#x3c; fieldNames.length; h++) {
			var val = fields[fieldNames[h]];
			if (typeof val === &#x27;string&#x27; &#x26;&#x26; val.toLowerCase() === &#x27;text&#x27;) return true;
		}
	}
	return false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	/* Apply list inheritance */
	if (this.get(&#x27;inherits&#x27;)) {
		this.model = this.get(&#x27;inherits&#x27;).model.discriminator(this.key, this.schema);
	} else {
		this.model = keystone.mongoose.model(this.key, this.schema);
	}
	/* Setup search text index */
	if (this.options.searchUsesTextIndex &#x26;&#x26; !this.<span class="apidocCodeKeywordSpan">declaresTextIndex</span>()) {
		// If the list is configured to use a text index for search and the list
		// doesn&#x27;t explicitly define one, create (or update) one of our own
		this.ensureTextIndex(function () {
			debug(&#x27;this.ensureTextIndex() done for \&#x27;&#x27; + list.key + &#x27;\&#x27;&#x27;);
		});
	}
	/* Register the list and its field types on the Keystone instance */
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.ensureTextIndex" id="apidoc.element.keystone.List.prototype.ensureTextIndex">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>ensureTextIndex
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function ensureTextIndex(callback) {
	var list = this;
	var collection = list.model.collection;

	var textIndex = list.buildSearchTextIndex();
	var fieldsHash = Math.abs(hashString(Object.keys(textIndex).sort().join(&#x27;;&#x27;)));
	var indexNamePrefix = &#x27;keystone_searchFields_textIndex_&#x27;;
	var newIndexName = indexNamePrefix + fieldsHash;

	// We use this later to create a new index if needed
	var createNewIndex = function () {
		collection.createIndex(textIndex, { name: newIndexName }, function (result) {
			debug(&#x27;collection.createIndex() result for \&#x27;&#x27; + list.key + &#x27;\:&#x27;, result);
			return callback();
		});
	};

	collection.getIndexes(function (err, indexes) {
		if (err) {
			if (err.code === 26) {
				// if the database doesn&#x27;t exist, we&#x27;ll get error code 26 &#x22;no database&#x22; here
				// that&#x27;s fine, we just default the indexes object so the new text index
				// gets created when the database is connected.
				indexes = {};
			} else {
				// otherwise, we&#x27;ve had an unexpected error, so we throw it
				throw err;
			}
		}
		var indexNames = Object.keys(indexes);

		// Search though the
		for (var i = 0; i &#x3c; indexNames.length; i++) {
			var existingIndexName = indexNames[i];
			var isText = false;

			// Check we&#x27;re dealing with a text index
			for (var h = 0; h &#x3c; indexes[existingIndexName].length; h++) {
				var column = indexes[existingIndexName][h];
				if (column[1] === &#x27;text&#x27;) isText = isText || true;
			}

			// Skip non-text indexes
			if (!isText) continue;

			// Already exists with correct def
			if (existingIndexName === newIndexName) {
				debug(&#x27;Existing text index \&#x27;&#x27; + existingIndexName + &#x27;\&#x27; already matches the searchFields for \&#x27;&#x27; + list.key + &#x27;\&#x27;&#x27;);
				return;
			}

			// Exists but hash (def) doesn&#x27;t match
			// Check for &#x27;searchFields_text_index&#x27; for backwards compatibility
			if (existingIndexName.slice(0, indexNamePrefix.length) === indexNamePrefix || existingIndexName === &#x27;searchFields_text_index&#x27;) {
				debug(&#x27;Existing text index \&#x27;&#x27; + existingIndexName + &#x27;\&#x27; doesn\&#x27;t match the searchFields for \&#x27;&#x27; + list.key + &#x27;\&#x27; and will be
 recreated as\&#x27;&#x27; + newIndexName + &#x27;\&#x27;&#x27;);

				collection.dropIndex(existingIndexName, function (result) {
					debug(&#x27;collection.dropIndex() result for \&#x27;&#x27; + list.key + &#x27;\:&#x27;, result);
					createNewIndex();
				});
				return;
			}

			// It&#x27;s a text index but not one of ours; nothing we can do
			console.error(&#x27;&#x27;
				+ &#x27;list.ensureTextIndex() failed to update the existing text index \&#x27;&#x27; + existingIndexName + &#x27;\&#x27; for the \&#x27;&#x27; + list.key + &#x27;\&#x27;
list.\n&#x27;
				+ &#x27;The existing index wasn\&#x27;t automatically created by ensureTextIndex() so will not be replaced.\n&#x27;
				+ &#x27;This may lead to unexpected behaviour when performing text searches on the this list.&#x27;
			);
			return;
		}

		// No text indexes found at all; create ours now
		debug(&#x27;No existing text index found in \&#x27;&#x27; + list.key + &#x27;\&#x27;; Creating ours now&#x27;);
		createNewIndex();
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					createNewIndex();
				});
				return;
			}

			// It&#x27;s a text index but not one of ours; nothing we can do
			console.error(&#x27;&#x27;
				+ &#x27;list.<span class="apidocCodeKeywordSpan">ensureTextIndex</span>() failed to update the existing text index \&#x27;&#
x27; + existingIndexName + &#x27;\&#x27; for the \&#x27;&#x27; + list.key + &#x27;\&#x27; list.\n&#x27;
				+ &#x27;The existing index wasn\&#x27;t automatically created by ensureTextIndex() so will not be replaced.\n&#x27;
				+ &#x27;This may lead to unexpected behaviour when performing text searches on the this list.&#x27;
			);
			return;
		}

		// No text indexes found at all; create ours now
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.expandColumns" id="apidoc.element.keystone.List.prototype.expandColumns">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>expandColumns
        <span class="apidocSignatureSpan">(cols)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function expandColumns(cols) {
	if (typeof cols === &#x27;string&#x27;) {
		cols = cols.split(&#x27;,&#x27;);
	}
	if (!Array.isArray(cols)) {
		throw new Error(&#x27;List.expandColumns: cols must be an array.&#x27;);
	}
	var list = this;
	var expanded = [];
	var nameCol = false;
	var getCol = function (def) {
		if (def.path === &#x27;__name__&#x27;) {
			def.path = list.namePath;
		}
		var field = list.fields[def.path];
		var col = null;
		if (field) {
			col = {
				field: field,
				path: field.path,
				type: field.type,
				label: def.label || field.label,
			};
			if (col.type === &#x27;relationship&#x27;) {
				col.refList = col.field.refList;
				if (col.refList) {
					col.refPath = def.subpath || col.refList.namePath;
					col.subField = col.refList.fields[col.refPath];
					col.populate = { path: col.field.path, subpath: col.refPath };
				}
				if (!def.label &#x26;&#x26; def.subpath) {
					col.label = field.label + &#x27;: &#x27; + (col.subField ? col.subField.label : utils.keyToLabel(def.subpath));
				}
			}
		} else if (list.model.schema.paths[def.path] || list.model.schema.virtuals[def.path]) {
			// column refers to a path in the schema
			// TODO: this needs to handle sophisticated types, including arrays, nested Schemas, and mixed types
			col = {
				path: def.path,
				label: def.label || utils.keyToLabel(def.path),
			};
		}
		if (col) {
			col.width = def.width;
			if (col.path === list.namePath) {
				col.isName = true;
				nameCol = col;
			}
			if (field &#x26;&#x26; field.col) {
				_.extend(col, field.col);
			}
		}
		return col;
	};
	for (var i = 0; i &#x3c; cols.length; i++) {
		var def = {};
		if (typeof cols[i] === &#x27;string&#x27;) {
			var parts = cols[i].trim().split(&#x27;|&#x27;);
			def.width = parts[1] || false;
			parts = parts[0].split(&#x27;:&#x27;);
			def.path = parts[0];
			def.subpath = parts[1];
		}
		if (!utils.isObject(def) || !def.path) {
			throw new Error(&#x27;List.expandColumns: column definition must contain a path.&#x27;);
		}
		var col = getCol(def);
		if (col) {
			expanded.push(col);
		}
	}
	if (!nameCol) {
		nameCol = getCol({ path: list.namePath });
		if (nameCol) {
			expanded.unshift(nameCol);
		}
	}
	return expanded;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		},
	});

	// Default Column Fields
	Object.defineProperty(List.prototype, &#x27;defaultColumns&#x27;, {
		get: function () {
			if (!this._defaultColumns) {
				this._defaultColumns = this.<span class="apidocCodeKeywordSpan">expandColumns</span>(this.get(&#x27;defaultColumns&#x27;));
			}
			return this._defaultColumns;
		}, set: function (value) {
			this.set(&#x27;defaultColumns&#x27;, value);
			delete this._defaultColumns;
		},
	});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.expandPaths" id="apidoc.element.keystone.List.prototype.expandPaths">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>expandPaths
        <span class="apidocSignatureSpan">(paths)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function expandPaths(paths) {
	return listToArray(paths).map(function (path) {
		if (path === &#x27;__name__&#x27;) {
			path = this.mappings.name;
		}
		return {
			path: path,
			field: this.fields[path],
		};
	}, this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	// TODO: Protect dynamic properties from being accessed until the List
	// has been registered (otherwise, incomplete schema could be cached)

	// Search Fields
	Object.defineProperty(List.prototype, &#x27;searchFields&#x27;, {
		get: function () {
			if (!this._searchFields) {
				this._searchFields = this.<span class="apidocCodeKeywordSpan">expandPaths</span>(this.get(&#x27;searchFields&#x27;));
			}
			return this._searchFields;
		}, set: function (value) {
			this.set(&#x27;searchFields&#x27;, value);
			delete this._searchFields;
		},
	});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.expandSort" id="apidoc.element.keystone.List.prototype.expandSort">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>expandSort
        <span class="apidocSignatureSpan">(input)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function expandSort(input) {
	var fields = this.fields;
	var sort = {
		rawInput: input || this.defaultSort,
		isDefaultSort: false,
	};
	sort.input = sort.rawInput;
	if (sort.input === &#x27;__default__&#x27;) {
		sort.isDefaultSort = true;
		sort.input = this.sortable ? &#x27;sortOrder&#x27; : this.namePath;
	}
	sort.paths = listToArray(sort.input).map(function (path) {
		var invert = false;
		if (path.charAt(0) === &#x27;-&#x27;) {
			invert = true;
			path = path.substr(1);
		}
		var field = fields[path];
		if (!field) {
			return;
		}
		return {
			field: field,
			invert: invert,
			path: field.path,
		};
	}).filter(truthy);
	sort.string = sort.paths.map(function (i) {
		if (i.field.getSortString) {
			return i.field.getSortString(i);
		}
		return i.invert ? &#x27;-&#x27; + i.path : i.path;
	}).join(&#x27; &#x27;);
	return sort;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.field" id="apidoc.element.keystone.List.prototype.field">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>field
        <span class="apidocSignatureSpan">(path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function field(path, options) {
	var Field = this.keystone.Field;
	if (arguments.length === 1) {
		return this.fields[path];
	}
	if (typeof options === &#x27;function&#x27;) {
		options = { type: options };
	}
	if (this.get(&#x27;noedit&#x27;)) {
		options.noedit = true;
	}
	if (!options.note &#x26;&#x26; this.get(&#x27;notes&#x27;)) {
		options.note = this.get(&#x27;notes&#x27;)[path];
	}
	if (typeof options.type !== &#x27;function&#x27;) {
		throw new Error(&#x27;Fields must be specified with a type function&#x27;);
	}
	if (!(options.type.prototype instanceof Field)) {
		// Convert native field types to their default Keystone counterpart
		if (options.type === String) {
			options.type = Field.Types.Text;
		} else if (options.type === Number) {
			options.type = Field.Types.Number;
		} else if (options.type === Boolean) {
			options.type = Field.Types.Boolean;
		} else if (options.type === Date) {
			options.type = Field.Types.Datetime;
		} else {
			throw new Error(&#x27;Unrecognised field constructor: &#x27; + options.type);
		}
	}

	// Note the presence of this field type for client-side script optimisation
	this.fieldTypes[options.type.name] = options.type.properName;

	// Wysiwyg HTML fields are handled as a special case so we can include TinyMCE as required
	if (options.type.name === &#x27;html&#x27; &#x26;&#x26; options.wysiwyg) {
		this.fieldTypes.wysiwyg = true;
	}

	var field = new options.type(this, path, options);
	this.fields[path] = field;
	this.fieldsArray.push(field);
	if (field.type === &#x27;relationship&#x27;) {
		this.relationshipFields.push(field);
	}
	return field;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	var addField = function (path, options) {
		if (this.isReserved(path)) {
			throw new Error(&#x27;Path &#x27; + path + &#x27; on list &#x27; + this.key + &#x27; is a reserved path&#x27;);
		}
		this.uiElements.push({
			type: &#x27;field&#x27;,
			field: this.<span class="apidocCodeKeywordSpan">field</span>(path, options),
		});
	}.bind(this);

	var args = Array.prototype.slice.call(arguments);
	var self = this;

	_.forEach(args, function (def) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.get" id="apidoc.element.keystone.List.prototype.get">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>get
        <span class="apidocSignatureSpan">(key, value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function set(key, value) {
	if (arguments.length === 1) {
		return this.options[key];
	}
	this.options[key] = value;
	return value;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	this.set(&#x27;ssl&#x27;, process.env.SSL);
	this.set(&#x27;ssl port&#x27;, process.env.SSL_PORT || &#x27;3001&#x27;);
	this.set(&#x27;ssl host&#x27;, process.env.SSL_HOST || process.env.SSL_IP);
	this.set(&#x27;ssl key&#x27;, process.env.SSL_KEY);
	this.set(&#x27;ssl cert&#x27;, process.env.SSL_CERT);

	this.set(&#x27;cookie secret&#x27;, process.env.COOKIE_SECRET);
	this.set(&#x27;cookie signin&#x27;, (this.<span class="apidocCodeKeywordSpan">get</span>(&#x27;env&#x27;) === &#x27;development
&#x27;) ? true : false);

	this.set(&#x27;embedly api key&#x27;, process.env.EMBEDLY_API_KEY || process.env.EMBEDLY_APIKEY);
	this.set(&#x27;mandrill api key&#x27;, process.env.MANDRILL_API_KEY || process.env.MANDRILL_APIKEY);
	this.set(&#x27;mandrill username&#x27;, process.env.MANDRILL_USERNAME);
	this.set(&#x27;google api key&#x27;, process.env.GOOGLE_BROWSER_KEY);
	this.set(&#x27;google server api key&#x27;, process.env.GOOGLE_SERVER_KEY);
	this.set(&#x27;ga property&#x27;, process.env.GA_PROPERTY);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.getAdminURL" id="apidoc.element.keystone.List.prototype.getAdminURL">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>getAdminURL
        <span class="apidocSignatureSpan">(item)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getAdminURL(item) {
	return &#x27;/&#x27; + this.keystone.get(&#x27;admin path&#x27;) + &#x27;/&#x27; + this.path + (item ? &#x27;/&#x27; + item.id : &#x27;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



/**
 * Gets the Admin URL to view the list (or an item if provided)
 *
 * Example:
 *     var listURL = list.<span class="apidocCodeKeywordSpan">getAdminURL</span>()
 *     var itemURL = list.getAdminURL(item)
 *
 * @param {Object} item
 */
function getAdminURL (item) {
	return &#x27;/&#x27; + this.keystone.get(&#x27;admin path&#x27;) + &#x27;/&#x27; + this.path + (item ? &#x27;/&#x27; + item.id : &#
x27;&#x27;);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.getCSVData" id="apidoc.element.keystone.List.prototype.getCSVData">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>getCSVData
        <span class="apidocSignatureSpan">(item, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getCSVData(item, options) {
	if (!options) {
		options = {};
	}
	options.fields;
	if (options.fields === undefined) {
		options.fields = Object.keys(this.options.fields);
	}
	var data = {
		id: String(item.id),
	};
	if (this.autokey) {
		data[this.autokey.path] = item.get(this.autokey.path);
	}
	if (options.fields) {
		if (typeof options.fields === &#x27;string&#x27;) {
			options.fields = listToArray(options.fields);
		}
		if (!Array.isArray(options.fields)) {
			throw new Error(&#x27;List.getCSV: options.fields must be undefined, a string, or an array.&#x27;);
		}
		options.fields.forEach(function (path) {
			var field = this.fields[path];
			if (!field) {
				// if the path isn&#x27;t actually a field, just add the value from
				// that path in the mongoose document.
				data[path] = item.get(path);
				return;
			}
			if (field.type !== &#x27;relationship&#x27; || !options.expandRelationshipFields) {
				// use the transformFieldValue function to get the data
				data[path] = transformFieldValue(field, item, options);
				return;
			}
			// relationship values should be expanded into separate name and
			// id pairs using the field&#x27;s getExpandedData method.
			var expanded = field.getExpandedData(item);
			if (field.many) {
				// for many-type relationships, ensure the value is an array,
				// and turn it into a list of &#x27;name (id)&#x27; values
				data[path] = (Array.isArray(expanded) ? expanded : []).map(function (i) {
					return i.name ? i.name + &#x27; (&#x27; + i.id + &#x27;)&#x27; : i.id;
				}).join(&#x27;, &#x27;);
			} else if (typeof expanded === &#x27;object&#x27;) {
				// for single-type relationships, add two columns to the data
				data[path] = expanded.name;
				data[path + &#x27;Id&#x27;] = expanded.id;
			}
		}, this);
	}
	if (typeof item.getCSVData === &#x27;function&#x27;) {
		var ext = item.getCSVData(data, options);
		if (typeof ext === &#x27;object&#x27;) {
			_.forOwn(ext, function (value, key) {
				if (value === undefined) {
					delete data[key];
				} else {
					data[key] = value;
				}
			});
		}
	}
	// Copy each value into the return structure, flattening arrays into lists and
	// flattening objects into a column per property (one level only)
	var rtn = {};
	_.forOwn(data, function (value, prop) {
		if (Array.isArray(value)) {
			// Array values are serialised to JSON, this should be an edge-case catch
			// for data coming raw from the item; array-type fields will already have
			// been stringified by the field.format method.
			rtn[prop] = JSON.stringify(value);
		} else if (typeof value === &#x27;object&#x27;) {
			// For object values, we loop through each key and add it to its own column
			// in the csv. Complex values are serialised to JSON.
			_.forOwn(value, function (v, i) {
				var suffix = i.substr(0, 1).toUpperCase() + i.substr(1);
				rtn[prop + suffix] = (typeof v === &#x27;object&#x27;) ? JSON.stringify(v) : v;
			});
		} else {
			rtn[prop] = value;
		}
	});

	return rtn;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
				// for single-type relationships, add two columns to the data
				data[path] = expanded.name;
				data[path + &#x27;Id&#x27;] = expanded.id;
			}
		}, this);
	}
	if (typeof item.getCSVData === &#x27;function&#x27;) {
		var ext = item.<span class="apidocCodeKeywordSpan">getCSVData</span>(data, options);
		if (typeof ext === &#x27;object&#x27;) {
			_.forOwn(ext, function (value, key) {
				if (value === undefined) {
					delete data[key];
				} else {
					data[key] = value;
				}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.getData" id="apidoc.element.keystone.List.prototype.getData">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>getData
        <span class="apidocSignatureSpan">(item, fields, expandRelationshipFields)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getData(item, fields, expandRelationshipFields) {
	var data = {
		id: item.id,
		name: this.getDocumentName(item),
	};
	if (this.autokey) {
		data[this.autokey.path] = item.get(this.autokey.path);
	}
	if (this.options.sortable) {
		data.sortOrder = item.sortOrder;
	}
	if (fields === undefined) {
		fields = Object.keys(this.fields);
	}
	if (fields) {
		if (!Array.isArray(fields)) {
			throw new Error(&#x27;List.getData: fields must be undefined, a string, or an array.&#x27;);
		}
		data.fields = {};
		fields.forEach(function (path) {
			var field = this.fields[path];
			if (field) {
				if (field.type === &#x27;relationship&#x27; &#x26;&#x26; expandRelationshipFields) {
					data.fields[path] = field.getExpandedData(item);
				} else {
					data.fields[path] = field.getData(item);
				}
			} else {
				data.fields[path] = item.get(path);
			}
		}, this);
	}
	return data;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					process.exit(1);
				}
			}
			break;
		case &#x27;module root&#x27;:
			// if relative path is used, resolve it based on the caller&#x27;s path
			if (!isAbsolutePath(value)) {
				var caller = callerId.<span class="apidocCodeKeywordSpan">getData</span>();
				value = path.resolve(path.dirname(caller.filePath), value);
			}
			break;
		case &#x27;app&#x27;:
			this.app = value;
			break;
		case &#x27;mongoose&#x27;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.getDocumentName" id="apidoc.element.keystone.List.prototype.getDocumentName">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>getDocumentName
        <span class="apidocSignatureSpan">(doc, escape)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getDocumentName(doc, escape) {
	// console.log(&#x27;getting document name for &#x27; + doc.id, &#x27;nameField: &#x27; + this.nameField, &#x27;namePath: &#x27; + this.namePath);
	// console.log(&#x27;raw name value: &#x27;, doc.get(this.namePath));
	// if (this.nameField) console.log(&#x27;formatted name value: &#x27;, this.nameField.format(doc));
	var name = String(this.nameField ? this.nameField.format(doc) : doc.get(this.namePath));
	return (escape) ? utils.encodeHTMLEntities(name) : name;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
							field.updateItem(doc, data, doneField);
						} else {
							doneField();
						}
					}, function (err) {
						if (!err) {
							if (options.verbose) {
								var documentName = list.<span class="apidocCodeKeywordSpan">getDocumentName</span>(doc);
								writeLog(&#x27;Creating item [&#x27; + itemsProcessed + &#x27; of &#x27; + totalItems + &#x27;] - &#x27; + documentName);
							}

							doc.save(function (err) {
								if (err) {
									err.model = key;
									err.data = data;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.getOptions" id="apidoc.element.keystone.List.prototype.getOptions">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>getOptions
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getOptions() {
	var ops = {
		autocreate: this.options.autocreate,
		autokey: this.autokey,
		defaultColumns: this.options.defaultColumns,
		defaultSort: this.options.defaultSort,
		fields: {},
		hidden: this.options.hidden,
		initialFields: _.map(this.initialFields, &#x27;path&#x27;),
		key: this.key,
		label: this.label,
		nameField: this.nameField ? this.nameField.getOptions() : null,
		nameFieldIsFormHeader: this.nameFieldIsFormHeader,
		nameIsInitial: this.nameIsInitial,
		nameIsVirtual: this.nameIsVirtual,
		namePath: this.namePath,
		nocreate: this.options.nocreate,
		nodelete: this.options.nodelete,
		noedit: this.options.noedit,
		path: this.path,
		perPage: this.options.perPage,
		plural: this.plural,
		searchFields: this.options.searchFields,
		singular: this.singular,
		sortable: this.options.sortable,
		sortContext: this.options.sortContext,
		track: this.options.track,
		tracking: this.tracking,
		relationships: this.relationships,
		uiElements: [],
	};
	_.forEach(this.uiElements, function (el) {
		switch (el.type) {
			// TODO: handle indentation
			case &#x27;field&#x27;:
				// add the field options by path
				ops.fields[el.field.path] = el.field.getOptions();
				// don&#x27;t output hidden fields
				if (el.field.hidden) {
					return;
				}
				// add the field to the elements array
				ops.uiElements.push({
					type: &#x27;field&#x27;,
					field: el.field.path,
				});
				break;
			case &#x27;heading&#x27;:
				ops.uiElements.push({
					type: &#x27;heading&#x27;,
					content: el.heading,
					options: el.options,
				});
				break;
		}
	});
	return ops;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var forEach = require(&#x27;lodash/forEach&#x27;);

function createKeystoneHash () {
	var hash = crypto.createHash(&#x27;md5&#x27;);
	hash.update(this.version);

	forEach(this.lists, function (list, key) {
		hash.update(JSON.stringify(list.<span class="apidocCodeKeywordSpan">getOptions</span>()));
	});

	return hash.digest(&#x27;hex&#x27;).slice(0, 6);
}

module.exports = createKeystoneHash;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.getPages" id="apidoc.element.keystone.List.prototype.getPages">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>getPages
        <span class="apidocSignatureSpan">(options, maxPages)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getPages(options, maxPages) {
	var surround = Math.floor(maxPages / 2);
	var firstPage = maxPages ? Math.max(1, options.currentPage - surround) : 1;
	var padRight = Math.max(((options.currentPage - surround) - 1) * -1, 0);
	var lastPage = maxPages ? Math.min(options.totalPages, options.currentPage + surround + padRight) : options.totalPages;
	var padLeft = Math.max(((options.currentPage + surround) - lastPage), 0);
	options.pages = [];
	firstPage = Math.max(Math.min(firstPage, firstPage - padLeft), 1);
	for (var i = firstPage; i &#x3c;= lastPage; i++) {
		options.pages.push(i);
	}
	if (firstPage !== 1) {
		options.pages.shift();
		options.pages.unshift(&#x27;...&#x27;);
	}
	if (lastPage !== Number(options.totalPages)) {
		options.pages.pop();
		options.pages.push(&#x27;...&#x27;);
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					totalPages: totalPages,
					pages: [],
					previous: (currentPage &#x3e; 1) ? (currentPage - 1) : false,
					next: (currentPage &#x3c; totalPages) ? (currentPage + 1) : false,
					first: skip + 1,
					last: skip + results.length,
				};
				list.<span class="apidocCodeKeywordSpan">getPages</span>(rtn, maxPages);
				callback(err, rtn);
			});
		});

	};

	if (callback) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.getSearchFilters" id="apidoc.element.keystone.List.prototype.getSearchFilters">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>getSearchFilters
        <span class="apidocSignatureSpan">(search, add)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getSearchFilters(search, add) {
	var filters = {};
	var list = this;

	search = String(search || &#x27;&#x27;).trim();

	if (search.length) {
		// Use the text index the behaviour is enabled by the list schema
		// Usually, when searchUsesTextIndex is true, list.register() will maintain an index using ensureTextIndex()
		// However, it&#x27;s possible for searchUsesTextIndex to be true while there is an existing text index on the collection that *isn
&#x27;t* described in the list schema
		// If this occurs, an error will be reported when list.register() is called and the existing index will not be replaced, meaning
 it will be used here
		if (this.options.searchUsesTextIndex) {
			filters.$text = { $search: search };
		}
		else {
			var searchFilter;
			var searchParts = search.split(&#x27; &#x27;);
			var searchRx = new RegExp(utils.escapeRegExp(search), &#x27;i&#x27;);
			var splitSearchRx = new RegExp((searchParts.length &#x3e; 1) ? _.map(searchParts, utils.escapeRegExp).join(&#x27;|&#x27;) : search, &#x27;i&#x27;);
			var searchFields = this.get(&#x27;searchFields&#x27;);
			var searchFilters = [];
			var searchIdField = utils.isValidObjectId(search);

			if (typeof searchFields === &#x27;string&#x27;) {
				searchFields = searchFields.split(&#x27;,&#x27;);
			}

			searchFields.forEach(function (path) {
				path = path.trim();

				if (path === &#x27;__name__&#x27;) {
					path = list.mappings.name;
				}

				var field = list.fields[path];

				if (field &#x26;&#x26; field.type === &#x27;name&#x27;) {
					var first = {};
					first[field.paths.first] = splitSearchRx;
					var last = {};
					last[field.paths.last] = splitSearchRx;
					searchFilter = {};
					searchFilter.$or = [first, last];
					searchFilters.push(searchFilter);
				} else {
					searchFilter = {};
					searchFilter[path] = searchRx;
					searchFilters.push(searchFilter);
				}
			});

			if (list.autokey) {
				searchFilter = {};
				searchFilter[list.autokey.path] = searchRx;
				searchFilters.push(searchFilter);
			}

			if (searchIdField) {
				searchFilter = {};
				searchFilter._id = search;
				searchFilters.push(searchFilter);
			}

			if (searchFilters.length &#x3e; 1) {
				filters.$or = searchFilters;
			} else if (searchFilters.length) {
				filters = searchFilters[0];
			}
		}
	}

	if (add) {
		_.forEach(add, function (filter) {
			var cond;
			var path = filter.key;
			var value = filter.value;

			switch (filter.field.type) {
				case &#x27;boolean&#x27;:
					if (!value || value === &#x27;false&#x27;) {
						filters[path] = { $ne: true };
					} else {
						filters[path] = true;
					}
					break;

				case &#x27;localfile&#x27;:
				case &#x27;cloudinaryimage&#x27;:
				case &#x27;cloudinaryimages&#x27;:
				case &#x27;s3file&#x27;:
				case &#x27;name&#x27;:
				case &#x27;password&#x27;:
					// TODO
					break;

				case &#x27;location&#x27;:
					_.forEach([&#x27;street1&#x27;, &#x27;suburb&#x27;, &#x27;state&#x27;, &#x27;postcode&#x27;, &#x27;country&#x27;], function (pathKey, i) {
						var value = filter.value[i];
						if (value) {
							filters[filter.field.paths[pathKey]] = new RegExp(utils.escapeRegExp(value), &#x27;i&#x27;);
						}
					});
					break;

				case &#x27;relationship&#x27;:
					if (value) {
						if (filter.field.many) {
							filters[path] = (filter.inverse) ? { $nin: [value] } : { $in: [value] };
						} else {
							filters[path] = (filter.inverse) ? { $ne: value } : value;
						}
					} else {
						if (filter.field.many) {
							filters[path] = (filter.inverse) ? { $not: { $size: 0 } } : { $size: 0 };
						} else {
							filters[path] = (filter.inverse) ? { $ne: null } : null;
						}
					}
					break;

				case &#x27;select&#x27;:
					if (filter.value) {
						filters[path] = (filter.inverse) ? { $ne: value } : value;
					} else {
						filters[path] = (filter.inverse) ? { $nin: [&#x27;&#x27;, null] } : { $in: [&#x27;&#x27;, null] };
					}
					break;

				case &#x27;number&#x27;:
				case &#x27;money&#x27;:
					if (filter.operator === &#x27;bt&#x27;) {
						value = [
							utils.number(value[0]),
							utils.number(value[1]),
						];
						if (!isNaN(value[0]) &#x26;&#x26; !isNaN(value[1])) {
							filters[path] = {
								$gte: value[0],
								$lte: value[1],
							};
						}
						else {
							filters[path] = null;
						}
					} else {
						value = utils.number(value);
						if (!isNaN(value)) {
							if (fil ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * Also accepts a filters object from `processFilters()`, any of which may
 * override the search string.
 *
 * NOTE: This function is deprecated in favor of List.prototype.addSearchToQuery
 * and will be removed in a later version.
 *
 * Example:
 *     list.<span class="apidocCodeKeywordSpan">getSearchFilters</span>(&#x27;jed&#x27;) // returns { name: /jed/i }
 *
 * @param {String} query
 * @param {Object} additional filters
 */
function getSearchFilters (search, add) {
	var filters = {};
	var list = this;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.getUniqueValue" id="apidoc.element.keystone.List.prototype.getUniqueValue">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>getUniqueValue
        <span class="apidocSignatureSpan">(path, generator, limit, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getUniqueValue(path, generator, limit, callback) {
	var model = this.model;
	var count = 0;
	var value;
	if (typeof limit === &#x27;function&#x27;) {
		callback = limit;
		limit = 10;
	}
	if (Array.isArray(generator)) {
		var fn = generator[0];
		var args = generator.slice(1);
		generator = function () {
			return fn.apply(this, args);
		};
	}
	var check = function () {
		if (count++ &#x3e; 10) {
			return callback(undefined, undefined);
		}
		value = generator();
		model.count().where(path, value).exec(function (err, matches) {
			if (err) return callback(err);
			if (matches) return check();
			callback(undefined, value);
		});
	};
	check();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.isReserved" id="apidoc.element.keystone.List.prototype.isReserved">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>isReserved
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function isReserved(path) {
	return reservedPaths.indexOf(path) &#x3e;= 0;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			} else {
				addField(prefix + key, obj[key]);
			}
		}
	}.bind(this);

	var addField = function (path, options) {
		if (this.<span class="apidocCodeKeywordSpan">isReserved</span>(path)) {
			throw new Error(&#x27;Path &#x27; + path + &#x27; on list &#x27; + this.key + &#x27; is a reserved path&#x27;);
		}
		this.uiElements.push({
			type: &#x27;field&#x27;,
			field: this.field(path, options),
		});
	}.bind(this);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.map" id="apidoc.element.keystone.List.prototype.map">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>map
        <span class="apidocSignatureSpan">(field, path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function map(field, path) {
	if (path) {
		this.mappings[field] = path;
	}
	return this.mappings[field];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			modifiedBy: null,
			modifiedOn: null,
		};

		var self = this;

		// init mappings
		_.forEach(this.options.map, function (val, key) { self.<span class="apidocCodeKeywordSpan">map</span>(key, val); });

		// define property getters
		Object.defineProperty(this, &#x27;label&#x27;, { get: function () {
			return this.get(&#x27;label&#x27;) || this.set(&#x27;label&#x27;, utils.plural(utils.keyToLabel(key)));
		} });
		Object.defineProperty(this, &#x27;singular&#x27;, { get: function () {
			return this.get(&#x27;singular&#x27;) || this.set(&#x27;singular&#x27;, utils.singular(this.label));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.paginate" id="apidoc.element.keystone.List.prototype.paginate">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>paginate
        <span class="apidocSignatureSpan">(options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function paginate(options, callback) {
	var list = this;
	var model = this.model;

	options = options || {};

	var query = model.find(options.filters, options.optionalExpression);
	var countQuery = model.find(options.filters);

	query._original_exec = query.exec;
	query._original_sort = query.sort;
	query._original_select = query.select;

	var currentPage = Number(options.page) || 1;
	var resultsPerPage = Number(options.perPage) || 50;
	var maxPages = Number(options.maxPages) || 10;
	var skip = (currentPage - 1) * resultsPerPage;

	list.pagination = { maxPages: maxPages };

	// as of mongoose 3.7.x, we need to defer sorting and field selection
	// until after the count has been executed

	query.select = function () {
		options.select = arguments[0];
		return query;
	};

	query.sort = function () {
		options.sort = arguments[0];
		return query;
	};

	query.exec = function (callback) {
		countQuery.count(function (err, count) {
			if (err) callback(err);

			query.find().limit(resultsPerPage).skip(skip);

			// apply the select and sort options before calling exec
			if (options.select) {
				query._original_select(options.select);
			}

			if (options.sort) {
				query._original_sort(options.sort);
			}

			query._original_exec(function (err, results) {
				if (err) return callback(err);
				var totalPages = Math.ceil(count / resultsPerPage);
				var rtn = {
					total: count,
					results: results,
					currentPage: currentPage,
					totalPages: totalPages,
					pages: [],
					previous: (currentPage &#x3e; 1) ? (currentPage - 1) : false,
					next: (currentPage &#x3c; totalPages) ? (currentPage + 1) : false,
					first: skip + 1,
					last: skip + results.length,
				};
				list.getPages(rtn, maxPages);
				callback(err, rtn);
			});
		});

	};

	if (callback) {
		return query(callback);
	} else {
		return query;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



/**
* Gets a special Query object that will paginate documents in the list
*
* Example:
*     list.<span class="apidocCodeKeywordSpan">paginate</span>({
*         page: 1,
*         perPage: 100,
*         maxPages: 10
*     }).exec(function(err, results) {
*         // do something
*     });
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.processFilters" id="apidoc.element.keystone.List.prototype.processFilters">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>processFilters
        <span class="apidocSignatureSpan">(q)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function processFilters(q) {
	var list = this;
	var filters = {};
	queryfilterlib.QueryFilters.create(q).getFilters().forEach(function (filter) {
		filter.path = filter.key; // alias for b/c
		filter.field = list.fields[filter.key];
		filters[filter.path] = filter;
	});
	return filters;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var FN_ARGS = /^function\s*[^\(]*\(\s*([^\)]*)\)/m;

module.exports = function (req, res) {

	var baby = require(&#x27;babyparse&#x27;);
	var keystone = req.keystone;

	var filters = req.list.<span class="apidocCodeKeywordSpan">processFilters</span>(req.query.q);
	var queryFilters = req.list.getSearchFilters(req.query.search, filters);
	var relFields = [];

	_.forEach(req.list.fields, function (field) {
		if (field.type === &#x27;relationship&#x27;) {
			relFields.push(field.path);
		}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.register" id="apidoc.element.keystone.List.prototype.register">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>register
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function register() {
	var keystone = this.keystone;
	var list = this;
	<span class="apidocCodeCommentSpan">/* Handle deprecated options */
</span>	if (this.schema.methods.toCSV) {
		console.warn(this.key + &#x27; Warning: List.schema.methods.toCSV support has been removed from KeystoneJS.\nPlease use getCSVData
instead (see the 0.3 -&#x3e; 4.0 Upgrade Guide)\n&#x27;);
	}
	/* Apply Plugins */
	if (this.get(&#x27;sortable&#x27;)) {
		schemaPlugins.sortable.apply(this);
	}
	if (this.get(&#x27;autokey&#x27;)) {
		schemaPlugins.autokey.apply(this);
	}
	if (this.get(&#x27;track&#x27;)) {
		schemaPlugins.track.apply(this);
	}
	if (this.get(&#x27;history&#x27;)) {
		schemaPlugins.history.apply(this);
	}
	this.schema.virtual(&#x27;list&#x27;).get(function () {
		return list;
	});
	/* Add common methods to the schema */
	if (Object.keys(this.relationships).length) {
		this.schema.methods.getRelated = schemaPlugins.methods.getRelated;
		this.schema.methods.populateRelated = schemaPlugins.methods.populateRelated;
		if (!this.schema.options.toObject) this.schema.options.toObject = {};
		this.schema.options.toObject.transform = schemaPlugins.options.transform;
	}
	this.schema.virtual(&#x27;_&#x27;).get(function () {
		if (!this.__methods) {
			this.__methods = utils.bindMethods(list.underscoreMethods, this);
		}
		return this.__methods;
	});
	this.schema.method(&#x27;getUpdateHandler&#x27;, function (req, res, ops) {
		return new UpdateHandler(list, this, req, res, ops);
	});
	/* Apply list inheritance */
	if (this.get(&#x27;inherits&#x27;)) {
		this.model = this.get(&#x27;inherits&#x27;).model.discriminator(this.key, this.schema);
	} else {
		this.model = keystone.mongoose.model(this.key, this.schema);
	}
	/* Setup search text index */
	if (this.options.searchUsesTextIndex &#x26;&#x26; !this.declaresTextIndex()) {
		// If the list is configured to use a text index for search and the list
		// doesn&#x27;t explicitly define one, create (or update) one of our own
		this.ensureTextIndex(function () {
			debug(&#x27;this.ensureTextIndex() done for \&#x27;&#x27; + list.key + &#x27;\&#x27;&#x27;);
		});
	}
	/* Register the list and its field types on the Keystone instance */
	keystone.lists[this.key] = this;
	keystone.paths[this.path] = this.key;
	assign(keystone.fieldTypes, this.fieldTypes);
	/* Add listeners for model events */
	// see http://mongoosejs.com/docs/api.html#model_Model
	this.model.on(&#x27;index&#x27;, function (err) {
		if (err) console.error(&#x27;Mongoose model \&#x27;index\&#x27; event fired on \&#x27;&#x27; + list.key + &#x27;\&#x27; with error:\n&#x27;, err.message, err.stack);
	});
	this.model.on(&#x27;index-single-start&#x27;, function (index) {
		debug(&#x27;Mongoose model \&#x27;index-single-start\&#x27; event fired on \&#x27;&#x27; + list.key + &#x27;\&#x27; for index:\n&#x27;, index);
	});
	this.model.on(&#x27;index-single-done&#x27;, function (err, index) {
		if (err) console.error(&#x27;Mongoose model \&#x27;index-single-done\&#x27; event fired on \&#x27;&#x27; + list.key + &#x27;\&#x27; for index:\n&#x27;, index, &#x27;\nWith
 error:\n&#x27;, err.message, err.stack);
		else debug(&#x27;Mongoose model \&#x27;index-single-done\&#x27; event fired on \&#x27;&#x27; + list.key + &#x27;\&#x27; for index:\n&#x27;, index);
	});
	this.model.on(&#x27;error&#x27;, function (err) {
		if (err) console.error(&#x27;Mongoose model \&#x27;error\&#x27; event fired on \&#x27;&#x27; + list.key + &#x27;\&#x27; with error:\n&#x27;, err.message, err.stack);
	});
	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/**
* Registers the page with Keystone.
*
* ####Example:
*
* 		var homePage = new keystone.content.Page(&#x27;home&#x27;);
* 		// ...
* 		homePage.<span class="apidocCodeKeywordSpan">register</span>();
*
* 		// later...
* 		var homePage = keystone.content.page(&#x27;home&#x27;);
*
* @api public
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.relationship" id="apidoc.element.keystone.List.prototype.relationship">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>relationship
        <span class="apidocSignatureSpan">(def)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function relationship(def) {
	var keystone = this.keystone;
	if (arguments.length &#x3e; 1) {
		for (var i = 0; i &#x3c; arguments.length; i++) {
			this.relationship(arguments[i]);
		}
		return this;
	}
	if (typeof def === &#x27;string&#x27;) {
		def = { ref: def };
	}
	if (!def.ref) {
		throw new Error(&#x27;List Relationships must be specified with an object containing ref (&#x27; + this.key + &#x27;)&#x27;);
	}
	if (!def.refPath) {
		def.refPath = utils.downcase(this.key);
	}
	if (!def.path) {
		def.path = utils.keyToProperty(def.ref, true);
	}
	Object.defineProperty(def, &#x27;refList&#x27;, {
		get: function () {
			return keystone.list(def.ref);
		},
	});
	Object.defineProperty(def, &#x27;isValid&#x27;, {
		get: function () {
			return keystone.list(def.ref) ? true : false;
		},
	});
	this.relationships[def.path] = def;
	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/**
 * Registers relationships to this list defined on others
 */
function relationship (def) {
	var keystone = this.keystone;
	if (arguments.length &#x3e; 1) {
		for (var i = 0; i &#x3c; arguments.length; i++) {
			this.<span class="apidocCodeKeywordSpan">relationship</span>(arguments[i]);
		}
		return this;
	}
	if (typeof def === &#x27;string&#x27;) {
		def = { ref: def };
	}
	if (!def.ref) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.selectColumns" id="apidoc.element.keystone.List.prototype.selectColumns">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>selectColumns
        <span class="apidocSignatureSpan">(q, cols)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function selectColumns(q, cols) {
	// Populate relationship columns
	var select = [];
	var populate = {};
	var path;
	cols.forEach(function (col) {
		select.push(col.path);
		if (col.populate) {
			if (!populate[col.populate.path]) {
				populate[col.populate.path] = [];
			}
			populate[col.populate.path].push(col.populate.subpath);
		}
	});
	q.select(select.join(&#x27; &#x27;));
	for (path in populate) {
		if (populate.hasOwnProperty(path)) {
			q.populate(path, populate[path].join(&#x27; &#x27;));
		}
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.set" id="apidoc.element.keystone.List.prototype.set">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>set
        <span class="apidocSignatureSpan">(key, value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function set(key, value) {
	if (arguments.length === 1) {
		return this.options[key];
	}
	this.options[key] = value;
	return value;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Alternatively, to include Keystone in an existing project or start from scratch (without Yeoman), specify `keystone: &#x22;^0.3.
9&#x22;` in the `dependencies` array of your `package.json` file, and run `npm install` from your terminal.

Then read through the [Documentation](http://keystonejs.com/docs) and the [Example Projects](http://keystonejs.com/examples) to
understand how to use it.

### Configuration

Config variables can be passed in an object to the `keystone.init` method, or can be set any time before `keystone.start` is called
 using `keystone.<span class="apidocCodeKeywordSpan">set</span>(key, value)`. This allows for a more flexible order of execution
 (e.g. if you refer to Lists in your routes, you can set the routes after configuring your Lists, as in the example above).

See the [KeystoneJS configuration documentation](http://keystonejs.com/docs/configuration) for details and examples of the available
 configuration options.

### Database field types

Keystone builds on the basic data types provided by mongo and allows you to easily add rich, functional fields to your application
&#x27;s models.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.underscoreMethod" id="apidoc.element.keystone.List.prototype.underscoreMethod">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>underscoreMethod
        <span class="apidocSignatureSpan">(path, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function underscoreMethod(path, fn) {
	var target = this.underscoreMethods;
	path = path.split(&#x27;.&#x27;);
	var last = path.pop();
	path.forEach(function (part) {
		if (!target[part]) target[part] = {};
		target = target[part];
	});
	target[last] = fn;
	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
				azure.createBlobService().blobService.deleteBlob(this.get(paths.container), this.get(paths.filename), function () {});
			} catch (e) {} // eslint-disable-line no-empty
			reset(this);
		},
	};

	_.forEach(schemaMethods, function (fn, key) {
		field.<span class="apidocCodeKeywordSpan">underscoreMethod</span>(key, fn);
	});

	// expose a method on the field to call schema methods
	this.apply = function (item, method) {
		return schemaMethods[method].apply(item, Array.prototype.slice.call(arguments, 2));
	};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.List.prototype.updateItem" id="apidoc.element.keystone.List.prototype.updateItem">
        function <span class="apidocSignatureSpan">keystone.List.prototype.</span>updateItem
        <span class="apidocSignatureSpan">(item, data, options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function updateItem(item, data, options, callback) {
	<span class="apidocCodeCommentSpan">/* Process arguments and options */
</span>	if (typeof options === &#x27;function&#x27;) {
		callback = options;
		options = {};
	}
	if (!options) {
		options = {};
	}

	// update fields with noedit: true set if fields have been explicitly
	// provided, or if the ignoreNoEdit option is true
	var ignoreNoEdit = !!(options.fields || options.ignoreNoEdit);

	// fields defaults to all the fields in the list
	var fields = options.fields || this.fieldsArray;
	// fields can be a list or array of field paths or Field instances
	fields = listToArray(fields).map(function (field) {
		// TODO: Check that field is an instance of Field
		return (typeof field === &#x27;string&#x27;) ? this.fields[field] : field;
	}, this);
	// check for invalid fields
	if (fields.indexOf(undefined) &#x3e;= 0) {
		return callback({
			error: &#x27;invalid configuration&#x27;,
			detail: &#x27;Invalid path specified in fields to update [&#x27; + options.fields + &#x27;] for list &#x27; + this.key,
		});
	}

	// Strip out noedit fields
	if (!ignoreNoEdit) {
		fields = fields.filter(function (i) {
			return !i.noedit;
		});
	}

	// you can optionally require fields that aren&#x27;t required in the schema
	// note that if fields are required in the schema, they will always be checked
	//
	// this option supports the backwards compatible { path: true } format, or a
	// list or array of field paths to validate
	var requiredFields = options.required;
	var requiredFieldPaths = {};
	if (typeof requiredFields === &#x27;string&#x27;) {
		requiredFields = listToArray(requiredFields);
	}
	if (Array.isArray(requiredFields)) {
		requiredFields.forEach(function (path) {
			requiredFieldPaths[path] = true;
		});
	} else if (typeof requiredFields === &#x27;object&#x27;) {
		requiredFieldPaths = requiredFields;
	}

	/* Field Validation */
	// TODO: If a field is required but not specified in the provided fields array
	// we should explicitly include it in the set of fields to validate
	var validationErrors = {};
	function doFieldValidation (field, done) {
		// Note; we don&#x27;t pass back validation errors to the callback, because we don&#x27;t
		// want to break the async loop before all the fields have been validated.
		field.validateInput(data, function (valid, detail) {
			if (!valid) {
				addValidationError(options, validationErrors, field, &#x27;invalid&#x27;, detail);
				done();
			} else {
				if ((field.required || requiredFieldPaths[field.path])
					&#x26;&#x26; (!field.dependsOn || evalDependsOn(field.dependsOn, data)))
				{
					field.validateRequiredInput(item, data, function (valid, detail) {
						if (!valid) {
							addValidationError(options, validationErrors, field, &#x27;required&#x27;, detail);
						}
						done();
					});
				} else {
					done();
				}
			}
		});
	}

	/* Field Updates */
	var updateErrors = {};
	function doFieldUpdate (field, done) {
		var callback = function (err) {
			// Note; we don&#x27;t pass back errors to the callback, because we don&#x27;t want
			// to break the async loop before all the fields have been updated.
			if (err) {
				addFieldUpdateError(updateErrors, field, err);
			}
			done();
		};
		// all fields have (item, data) as the first two arguments
		var updateArgs = [item, data];
		// some fields support an optional third argument: files
		if (field.updateItem.length &#x3e; 3) {
			updateArgs.push(options.files);
		}
		// callback is always the last argument
		updateArgs.push(callback);
		// call field.updateItem with the arguments
		field.updateItem.apply(field, updateArgs);
	}

	/* Track plugin support */
	// If the track plugin is enabled for the list, it looks for ._req_user to
	// detect the user that performed the updated. Default it to the user
	// specified in the options.
	if (options.user) {
		item._req_user = options.user;
	}

	/* Flow control */
	async.series([
		/* Process validation */
		function (doneValidation) {
			async.each(fields, doFieldValidation, function () {
				if (Object.keys(validationErrors).length) {
					return doneValidation({
						error: &#x27;validation errors&#x27;,
						detail: validationErrors,
					});
				}
				doneValidation();
			});
		},
		/* Apply updates to ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.<span class="apidocCodeKeywordSpan">updateItem</span>(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.LocalFileType" id="apidoc.module.keystone.LocalFileType">module keystone.LocalFileType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.LocalFileType.LocalFileType" id="apidoc.element.keystone.LocalFileType.LocalFileType">
        function <span class="apidocSignatureSpan">keystone.</span>LocalFileType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function localfile(list, path, options) {

	throw new Error(&#x27;The LocalFile field type has been removed. Please use File instead.&#x27;
		+ &#x27;\n\nSee https://github.com/keystonejs/keystone/wiki/File-Fields-Upgrade-Guide\n&#x27;);

	<span class="apidocCodeCommentSpan">/*

	grappling.mixin(this).allowHooks(&#x27;move&#x27;);
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;uploadFile&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this.autoCleanup = options.autoCleanup || false;

	if (options.overwrite !== false) {
		options.overwrite = true;
	}

	localfile.super_.call(this, list, path, options);

	// validate destination dir
	if (!options.dest) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;localfile fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require the &#x22;dest&#x22; option to be set.&#x27;);
	}
	// Allow hook into before and after
	if (options.pre &#x26;&#x26; options.pre.move) {
		this.pre(&#x27;move&#x27;, options.pre.move);
	}

	if (options.post &#x26;&#x26; options.post.move) {
		this.post(&#x27;move&#x27;, options.post.move);
	}

	*/
</span>
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.LocalFilesType" id="apidoc.module.keystone.LocalFilesType">module keystone.LocalFilesType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.LocalFilesType.LocalFilesType" id="apidoc.element.keystone.LocalFilesType.LocalFilesType">
        function <span class="apidocSignatureSpan">keystone.</span>LocalFilesType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function localfiles(list, path, options) {

	throw new Error(&#x27;The LocalFiles field type has been removed. Please use File instead.&#x27;
		+ &#x27;\n\nSee https://github.com/keystonejs/keystone/wiki/File-Fields-Upgrade-Guide\n&#x27;);

	<span class="apidocCodeCommentSpan">/*
	grappling.mixin(this).allowHooks(&#x27;move&#x27;);
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;uploadFiles&#x27;];
	this._fixedSize = &#x27;full&#x27;;

	// TODO: implement filtering, usage disabled for now
	options.nofilter = true;

	// TODO: implement initial form, usage disabled for now
	if (options.initial) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;localfiles fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) do not currently support being used as initial fields.\n&#x27;);
	}

	if (options.overwrite !== false) {
		options.overwrite = true;
	}

	localfiles.super_.call(this, list, path, options);

	// validate destination dir
	if (!options.dest) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;localfiles fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require the &#x22;dest&#x22; option to be set.&#x27;);
	}

	// Allow hook into before and after
	if (options.pre &#x26;&#x26; options.pre.move) {
		this.pre(&#x27;move&#x27;, options.pre.move);
	}

	if (options.post &#x26;&#x26; options.post.move) {
		this.post(&#x27;move&#x27;, options.post.move);
	}
	*/
</span>}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.LocationType" id="apidoc.module.keystone.LocationType">module keystone.LocationType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.LocationType.LocationType" id="apidoc.element.keystone.LocationType.LocationType">
        function <span class="apidocSignatureSpan">keystone.</span>LocationType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function location(list, path, options) {

	this._underscoreMethods = [&#x27;format&#x27;, &#x27;googleLookup&#x27;, &#x27;kmFrom&#x27;, &#x27;milesFrom&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	this._properties = [&#x27;enableMapsAPI&#x27;];
	this.enableMapsAPI = (options.enableImprove === true || (options.enableImprove !== false &#x26;&#x26; keystone.get(&#x27;google server api key
&#x27;))) ? true : false;

	// Throw on invalid options in 4.0 (remove for 5.0)
	if (&#x27;geocodeGoogle&#x27; in options) {
		throw new Error(&#x27;The geocodeGoogle option for Location fields has been renamed to enableImprove&#x27;);
	}

	if (!options.defaults) {
		options.defaults = {};
	}

	if (options.required) {
		if (Array.isArray(options.required)) {
			// required can be specified as an array of paths
			this.requiredPaths = options.required;
		} else if (typeof options.required === &#x27;string&#x27;) {
			// or it can be specified as a comma-delimited list
			this.requiredPaths = options.required.replace(/,/g, &#x27; &#x27;).split(/\s+/);
		}
		// options.required should always be simplified to a boolean
		options.required = true;
	}

	// default this.requiredPaths
	if (!this.requiredPaths) {
		this.requiredPaths = [&#x27;street1&#x27;, &#x27;suburb&#x27;];
	}

	location.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.LocationType.super_" id="apidoc.element.keystone.LocationType.super_">
        function <span class="apidocSignatureSpan">keystone.LocationType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.MarkdownType" id="apidoc.module.keystone.MarkdownType">module keystone.MarkdownType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.MarkdownType.MarkdownType" id="apidoc.element.keystone.MarkdownType.MarkdownType">
        function <span class="apidocSignatureSpan">keystone.</span>MarkdownType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function markdown(list, path, options) {
	this._defaultSize = &#x27;full&#x27;;

	this.toolbarOptions = options.toolbarOptions || {};
	this.markedOptions = options.markedOptions || {};
	this.height = options.height || 90;
	this.wysiwyg = (&#x27;wysiwyg&#x27; in options) ? options.wysiwyg : true;

	this._properties = [&#x27;wysiwyg&#x27;, &#x27;height&#x27;, &#x27;toolbarOptions&#x27;];
	markdown.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.MarkdownType.super_" id="apidoc.element.keystone.MarkdownType.super_">
        function <span class="apidocSignatureSpan">keystone.MarkdownType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.MoneyType" id="apidoc.module.keystone.MoneyType">module keystone.MoneyType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.MoneyType.MoneyType" id="apidoc.element.keystone.MoneyType.MoneyType">
        function <span class="apidocSignatureSpan">keystone.</span>MoneyType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function money(list, path, options) {
	this.currency = options.currency;
	this._nativeType = Number;
	this._underscoreMethods = [&#x27;format&#x27;];
	this._properties = [&#x27;currency&#x27;];
	this._fixedSize = &#x27;small&#x27;;
	this._formatString = (options.format === false) ? false : (options.format || &#x27;$0,0.00&#x27;);
	if (this._formatString &#x26;&#x26; typeof this._formatString !== &#x27;string&#x27;) {
		throw new Error(&#x27;FieldType.Money: options.format must be a string.&#x27;);
	}
	money.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.MoneyType.super_" id="apidoc.element.keystone.MoneyType.super_">
        function <span class="apidocSignatureSpan">keystone.MoneyType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.NameType" id="apidoc.module.keystone.NameType">module keystone.NameType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.NameType.NameType" id="apidoc.element.keystone.NameType.NameType">
        function <span class="apidocSignatureSpan">keystone.</span>NameType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function name(list, path, options) {
	this._fixedSize = &#x27;full&#x27;;
	options.default = { first: &#x27;&#x27;, last: &#x27;&#x27; };
	name.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.NameType.super_" id="apidoc.element.keystone.NameType.super_">
        function <span class="apidocSignatureSpan">keystone.NameType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.NumberArrayType" id="apidoc.module.keystone.NumberArrayType">module keystone.NumberArrayType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.NumberArrayType.NumberArrayType" id="apidoc.element.keystone.NumberArrayType.NumberArrayType">
        function <span class="apidocSignatureSpan">keystone.</span>NumberArrayType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function numberarray(list, path, options) {
	this._nativeType = [Number];
	this._underscoreMethods = [&#x27;format&#x27;];
	this._formatString = (options.format === false) ? false : (options.format || &#x27;0,0[.][000000000000]&#x27;);
	this._defaultSize = &#x27;small&#x27;;
	if (this._formatString &#x26;&#x26; typeof this._formatString !== &#x27;string&#x27;) {
		throw new Error(&#x27;FieldType.NumberArray: options.format must be a string.&#x27;);
	}
	this.separator = options.separator || &#x27; | &#x27;;
	numberarray.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.NumberArrayType.super_" id="apidoc.element.keystone.NumberArrayType.super_">
        function <span class="apidocSignatureSpan">keystone.NumberArrayType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.NumberType" id="apidoc.module.keystone.NumberType">module keystone.NumberType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.NumberType.NumberType" id="apidoc.element.keystone.NumberType.NumberType">
        function <span class="apidocSignatureSpan">keystone.</span>NumberType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function number(list, path, options) {
	this._nativeType = Number;
	this._fixedSize = &#x27;small&#x27;;
	this._underscoreMethods = [&#x27;format&#x27;];
	this.formatString = (options.format === false) ? false : (options.format || &#x27;0,0[.][000000000000]&#x27;);
	if (this.formatString &#x26;&#x26; typeof this.formatString !== &#x27;string&#x27;) {
		throw new Error(&#x27;FieldType.Number: options.format must be a string.&#x27;);
	}
	number.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.NumberType.super_" id="apidoc.element.keystone.NumberType.super_">
        function <span class="apidocSignatureSpan">keystone.NumberType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.PasswordType" id="apidoc.module.keystone.PasswordType">module keystone.PasswordType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.PasswordType.PasswordType" id="apidoc.element.keystone.PasswordType.PasswordType">
        function <span class="apidocSignatureSpan">keystone.</span>PasswordType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function password(list, path, options) {
	this.options = options;
	this._nativeType = String;
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;compare&#x27;];
	this._fixedSize = &#x27;full&#x27;;
	// You can&#x27;t sort on password fields
	options.nosort = true;
	this.workFactor = options.workFactor || 10;
	password.super_.call(this, list, path, options);
	for (var key in this.options.complexity) {
		if ({}.hasOwnProperty.call(this.options.complexity, key)) {
			if (key in regexChunk !== key in this.options.complexity) {
				throw new Error(&#x27;FieldType.Password: options.complexity - option does not exist.&#x27;);
			}
			if (typeof this.options.complexity[key] !== &#x27;boolean&#x27;) {
				throw new Error(&#x27;FieldType.Password: options.complexity - Value must be boolean.&#x27;);
			}
		}
	}
	if (this.options.max &#x3c;= this.options.min) {
		throw new Error(&#x27;FieldType.Password: options - min must be set at a lower value than max.&#x27;);
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.PasswordType.super_" id="apidoc.element.keystone.PasswordType.super_">
        function <span class="apidocSignatureSpan">keystone.PasswordType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.RelationshipType" id="apidoc.module.keystone.RelationshipType">module keystone.RelationshipType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.RelationshipType.RelationshipType" id="apidoc.element.keystone.RelationshipType.RelationshipType">
        function <span class="apidocSignatureSpan">keystone.</span>RelationshipType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function relationship(list, path, options) {
	this.many = (options.many) ? true : false;
	this.filters = options.filters;
	this.createInline = (options.createInline) ? true : false;
	this._defaultSize = &#x27;full&#x27;;
	this._nativeType = keystone.mongoose.Schema.Types.ObjectId;
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;getExpandedData&#x27;];
	this._properties = [&#x27;isValid&#x27;, &#x27;many&#x27;, &#x27;filters&#x27;, &#x27;createInline&#x27;];
	relationship.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.RelationshipType.super_" id="apidoc.element.keystone.RelationshipType.super_">
        function <span class="apidocSignatureSpan">keystone.RelationshipType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.S3FileType" id="apidoc.module.keystone.S3FileType">module keystone.S3FileType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.S3FileType.S3FileType" id="apidoc.element.keystone.S3FileType.S3FileType">
        function <span class="apidocSignatureSpan">keystone.</span>S3FileType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function s3file(list, path, options) {

	throw new Error(&#x27;The S3File field type has been removed. Please use File instead.&#x27;
		+ &#x27;\n\nSee https://github.com/keystonejs/keystone/wiki/File-Fields-Upgrade-Guide\n&#x27;);

	<span class="apidocCodeCommentSpan">/*
	grappling.mixin(this).allowHooks(&#x27;pre:upload&#x27;);

	this._underscoreMethods = [&#x27;format&#x27;, &#x27;uploadFile&#x27;];
	this._fixedSize = &#x27;full&#x27;;

	// TODO: implement filtering, usage disabled for now
	options.nofilter = true;

	// TODO: implement initial form, usage disabled for now
	if (options.initial) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;S3File fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) do not currently support being used as initial fields.\n&#x27;);
	}

	s3file.super_.call(this, list, path, options);

	// validate s3 config (has to happen after super_.call)
	if (!this.s3config) {
		throw new Error(&#x27;Invalid Configuration\n\n&#x27;
			+ &#x27;S3File fields (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) require the &#x22;s3 config&#x22; option to be set.\n\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/configuration/#services-amazons3 for more information.\n&#x27;);
	}

	// Could be more pre- hooks, just upload for now
	if (options.pre &#x26;&#x26; options.pre.upload) {
		this.pre(&#x27;upload&#x27;, options.pre.upload);
	}
	*/
</span>
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.SelectType" id="apidoc.module.keystone.SelectType">module keystone.SelectType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.SelectType.SelectType" id="apidoc.element.keystone.SelectType.SelectType">
        function <span class="apidocSignatureSpan">keystone.</span>SelectType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function select(list, path, options) {
	this.ui = options.ui || &#x27;select&#x27;;
	this.numeric = options.numeric ? true : false;
	this._nativeType = (options.numeric) ? Number : String;
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;pluck&#x27;];
	this._properties = [&#x27;ops&#x27;, &#x27;numeric&#x27;];
	if (typeof options.options === &#x27;string&#x27;) {
		options.options = options.options.split(&#x27;,&#x27;);
	}
	if (!Array.isArray(options.options)) {
		throw new Error(&#x27;Select fields require an options array.&#x27;);
	}
	this.ops = options.options.map(function (i) {
		var op = typeof i === &#x27;string&#x27; ? { value: i.trim(), label: utils.keyToLabel(i) } : i;
		if (!_.isObject(op)) {
			op = { label: &#x27;&#x27; + i, value: &#x27;&#x27; + i };
		}
		if (options.numeric &#x26;&#x26; !_.isNumber(op.value)) {
			op.value = Number(op.value);
		}
		return op;
	});
	// undefined options.emptyOption defaults to true
	if (options.emptyOption === undefined) {
		options.emptyOption = true;
	}
	// ensure this.emptyOption is a boolean
	this.emptyOption = !!options.emptyOption;
	// cached maps for options, labels and values
	this.map = utils.optionsMap(this.ops);
	this.labels = utils.optionsMap(this.ops, &#x27;label&#x27;);
	this.values = _.map(this.ops, &#x27;value&#x27;);
	select.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.SelectType.super_" id="apidoc.element.keystone.SelectType.super_">
        function <span class="apidocSignatureSpan">keystone.SelectType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Storage" id="apidoc.module.keystone.Storage">module keystone.Storage</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Storage.Storage" id="apidoc.element.keystone.Storage.Storage">
        function <span class="apidocSignatureSpan">keystone.</span>Storage
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Storage(options) {
	// we&#x27;re going to mutate options so get a clean copy of it
	options = assign({}, options);

	var AdapterType = options.adapter;
	delete options.adapter;

	if (typeof AdapterType !== &#x27;function&#x27;) {
		throw new Error(&#x27;Invalid Storage Adapter\n&#x27;
			+ &#x27;The storage adapter specified is not a function. Did you &#x27;
			+ &#x27;require the right package?\n&#x27;);
	}

	debug(&#x27;Initialising Storage with adapter &#x27; + AdapterType.name);

	// ensure the adapter compatibilityLevel of the adapter matches
	if (AdapterType.compatibilityLevel !== ADAPTER_COMPATIBILITY_LEVEL) {
		throw new Error(&#x27;Incompatible Storage Adapter\n&#x27;
			+ &#x27;The storage adapter specified (&#x27; + AdapterType.name + &#x27;) &#x27;
			+ &#x27;does not match the compatibility level required for this &#x27;
			+ &#x27;version of Keystone.\n&#x27;);
	}

	// assign ensures the default schema constant isn&#x27;t exposed as a property
	var schemaFields = assign({}, SCHEMA_FIELD_DEFAULTS, AdapterType.SCHEMA_FIELD_DEFAULTS, options.schema);
	delete options.schema;

	// Copy requested fields into local schema.
	var schema = this.schema = {};
	for (var path in schemaFields) {
		if (!schemaFields[path]) continue;

		var type = AdapterType.SCHEMA_TYPES[path] || SCHEMA_TYPES[path];
		if (!type) throw Error(&#x27;Unknown type for requested schema field &#x27; + path);
		schema[path] = type;
	}

	// ensure Storage schema features are supported by the Adapter
	if (schema.url &#x26;&#x26; typeof AdapterType.prototype.getFileURL !== &#x27;function&#x27;) {
		throw Error(&#x27;URL schema field is not supported by the &#x27; + AdapterType.name + &#x27; adapter&#x27;);
	}

	// create the adapter
	this.adapter = new AdapterType(options, schema);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Storage.contentHashFilename" id="apidoc.element.keystone.Storage.contentHashFilename">
        function <span class="apidocSignatureSpan">keystone.Storage.</span>contentHashFilename
        <span class="apidocSignatureSpan">(file, i, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">contentHashFilename = function (file, i, callback) {
	var hash = crypto.createHash(&#x27;sha1&#x27;);
	var calledCallback = false;
	fs.createReadStream(file.path)
		.on(&#x27;error&#x27;, function (err) {
			// I&#x27;m worried that on(&#x27;error&#x27;) might fire after on(&#x27;readable&#x27;)
			// happens.
			if (calledCallback) return;
			calledCallback = true;
			callback(err);
		})
		.pipe(hash);

	hash.on(&#x27;readable&#x27;, function () {
		var data = hash.read();
		if (data == null) return;

		if (calledCallback) return;
		calledCallback = true;
		// Data is a node Buffer.
		callback(null, filenameFromBuffer(data, file.extension));
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Storage.originalFilename" id="apidoc.element.keystone.Storage.originalFilename">
        function <span class="apidocSignatureSpan">keystone.Storage.</span>originalFilename
        <span class="apidocSignatureSpan">(file)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">originalFilename = function (file) {
	return file.originalname;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Storage.randomFilename" id="apidoc.element.keystone.Storage.randomFilename">
        function <span class="apidocSignatureSpan">keystone.Storage.</span>randomFilename
        <span class="apidocSignatureSpan">(file, i, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">randomFilename = function (file, i, callback) {
	crypto.randomBytes(16, function (err, data) {
		if (err) return callback(err);
		return callback(null, filenameFromBuffer(data, file.extension));
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Storage.Adapters" id="apidoc.module.keystone.Storage.Adapters">module keystone.Storage.Adapters</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Storage.Adapters.FS" id="apidoc.element.keystone.Storage.Adapters.FS">
        function <span class="apidocSignatureSpan">keystone.Storage.Adapters.</span>FS
        <span class="apidocSignatureSpan">(options, schema)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function FSAdapter(options, schema) {
	if (!schema.filename) throw Error(&#x27;Cannot use FSAdapter without storing filename&#x27;);

	this.options = assign({}, DEFAULT_OPTIONS, options.fs);
	debug(&#x27;Initialising FS Adapter with options&#x27;, this.options);

	this.options.generateFilename = ensureCallback(this.options.generateFilename);
	ensurePath(this.options.path);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Storage.Adapters.FS.prototype" id="apidoc.module.keystone.Storage.Adapters.FS.prototype">module keystone.Storage.Adapters.FS.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Storage.Adapters.FS.prototype.fileExists" id="apidoc.element.keystone.Storage.Adapters.FS.prototype.fileExists">
        function <span class="apidocSignatureSpan">keystone.Storage.Adapters.FS.prototype.</span>fileExists
        <span class="apidocSignatureSpan">(filename, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">fileExists = function (filename, callback) {
	var path = this.pathForFile(filename);
	debug(&#x27;Checking for file at path %s&#x27;, filename);
	// Returns (err, bool) to the callback based on whether or not the file
	// already exists. Used if whenExists: &#x27;error&#x27; or &#x27;retry&#x27; in the options
	fs.stat(path, function (err, stats) {
		if (err &#x26;&#x26; err.code === &#x27;ENOENT&#x27;) {
			// File does not exist
			callback(null, false);
		} else if (err) {
			// Other error getting file info
			callback(err);
		} else if (stats.isFile()) {
			// File does exist
			callback(null, true);
		} else {
			// Object at path is not a file
			callback(Error(&#x27;Invalid save destination - dest is not a file&#x27;));
		}
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Storage.Adapters.FS.prototype.getFileURL" id="apidoc.element.keystone.Storage.Adapters.FS.prototype.getFileURL">
        function <span class="apidocSignatureSpan">keystone.Storage.Adapters.FS.prototype.</span>getFileURL
        <span class="apidocSignatureSpan">(file)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getFileURL = function (file) {
	var publicPath = this.options.publicPath;
	if (!publicPath) return null; // No URL.

	return url.resolve(publicPath, file.filename);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Storage.Adapters.FS.prototype.getFilename" id="apidoc.element.keystone.Storage.Adapters.FS.prototype.getFilename">
        function <span class="apidocSignatureSpan">keystone.Storage.Adapters.FS.prototype.</span>getFilename
        <span class="apidocSignatureSpan">(file, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getFilename = function (file, callback) {
	var self = this;
	switch (self.options.whenExists) {
		case &#x27;overwrite&#x27;:
			self.options.generateFilename(file, 0, callback);
			break;
		case &#x27;error&#x27;:
			self.options.generateFilename(file, 0, function (err, filename) {
				if (err) return callback(err);
				self.fileExists(filename, function (err, result) {
					if (err) return callback(err);
					if (result === true) return callback(Error(&#x27;File already exists&#x27;));
					callback(null, filename);
				});
			});
			break;
		case &#x27;retry&#x27;:
			self.retryFilename(0, file, callback);
			break;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

		return _react2.default.createElement(
			&#x27;div&#x27;,
			null,
			this.hasImage() ? _react2.default.createElement(
				_FileChangeMessage2.default,
				null,
				this.<span class="apidocCodeKeywordSpan">getFilename</span>()
			) : null,
			showChangeMessage &#x26;&#x26; this.renderChangeMessage()
		);
	},
	renderChangeMessage: function renderChangeMessage() {
		if (this.state.userSelectedFile) {
			return _react2.default.createElement(
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Storage.Adapters.FS.prototype.pathForFile" id="apidoc.element.keystone.Storage.Adapters.FS.prototype.pathForFile">
        function <span class="apidocSignatureSpan">keystone.Storage.Adapters.FS.prototype.</span>pathForFile
        <span class="apidocSignatureSpan">(filename)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pathForFile = function (filename) {
	return path.resolve(this.options.path, sanitize(filename));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Storage.Adapters.FS.prototype.removeFile" id="apidoc.element.keystone.Storage.Adapters.FS.prototype.removeFile">
        function <span class="apidocSignatureSpan">keystone.Storage.Adapters.FS.prototype.</span>removeFile
        <span class="apidocSignatureSpan">(file, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeFile = function (file, callback) {
	debug(&#x27;Removing file&#x27;, file);
	fs.unlink(this.pathForFile(file.filename), function (err) {
		if (err &#x26;&#x26; err.code === &#x27;ENOENT&#x27;) {
			// The file doesn&#x27;t exist.
			console.warn(&#x27;Attempted to remove a non-existant file&#x27;);
			return callback();
		}

		callback(err);
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

/**
 * Deletes the stored file and resets the field value
 */
// TODO: Should we accept a callback here? Seems like a good idea.
file.prototype.remove = function (item) {
	this.storage.<span class="apidocCodeKeywordSpan">removeFile</span>(item.get(this.path));
	this.reset();
};

/**
 * Formats the field value
 */
file.prototype.format = function (item) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Storage.Adapters.FS.prototype.retryFilename" id="apidoc.element.keystone.Storage.Adapters.FS.prototype.retryFilename">
        function <span class="apidocSignatureSpan">keystone.Storage.Adapters.FS.prototype.</span>retryFilename
        <span class="apidocSignatureSpan">(attempt, file, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">retryFilename = function (attempt, file, callback) {
	var self = this;
	if (attempt &#x3e; self.options.retryAttempts) {
		return callback(Error(&#x27;Unique filename could not be generated; Maximum attempts exceeded&#x27;));
	}
	self.options.generateFilename(file, attempt, function (err, filename) {
		if (err) return callback(err);
		self.fileExists(filename, function (err, exists) {
			if (err) return callback(err);
			if (exists) return self.retryFilename(attempt + 1, file, callback);
			callback(null, filename);
		});
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Storage.Adapters.FS.prototype.uploadFile" id="apidoc.element.keystone.Storage.Adapters.FS.prototype.uploadFile">
        function <span class="apidocSignatureSpan">keystone.Storage.Adapters.FS.prototype.</span>uploadFile
        <span class="apidocSignatureSpan">(file, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">uploadFile = function (file, callback) {
	debug(&#x27;Uploading file&#x27;, file);
	var options = this.options;
	this.getFilename(file, function (err, filename) {
		if (err) return callback(err);
		filename = sanitize(filename);
		debug(&#x27;Uploading file with filename: %s&#x27;, filename);
		var uploadPath = path.resolve(options.path, filename);
		fs.move(file.path, uploadPath, function (err) {
			if (err) return callback(err);

			// TODO: Chmod the file.

			var data = {
				filename: filename,
				size: file.size,
				mimetype: file.mimetype,
				path: options.path,
				originalname: file.originalname,
			};
			debug(&#x27;Uploaded file, returning data&#x27;, data);
			callback(null, data);
		});
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

			if (/^(delete|reset)$/.test(action)) {
				field.apply(item, action);
			}
		}

		if (req.files &#x26;&#x26; req.files[paths.upload] &#x26;&#x26; req.files[paths.upload].size) {
			return field.<span class="apidocCodeKeywordSpan">uploadFile</span>(item, req.files[paths.upload], true, callback);
		}

		return callback();

	};

};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.Storage.prototype" id="apidoc.module.keystone.Storage.prototype">module keystone.Storage.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.Storage.prototype.removeFile" id="apidoc.element.keystone.Storage.prototype.removeFile">
        function <span class="apidocSignatureSpan">keystone.Storage.prototype.</span>removeFile
        <span class="apidocSignatureSpan">(value, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeFile = function (value, callback) {
	this.adapter.removeFile(value, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

/**
 * Deletes the stored file and resets the field value
 */
// TODO: Should we accept a callback here? Seems like a good idea.
file.prototype.remove = function (item) {
	this.storage.<span class="apidocCodeKeywordSpan">removeFile</span>(item.get(this.path));
	this.reset();
};

/**
 * Formats the field value
 */
file.prototype.format = function (item) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.Storage.prototype.uploadFile" id="apidoc.element.keystone.Storage.prototype.uploadFile">
        function <span class="apidocSignatureSpan">keystone.Storage.prototype.</span>uploadFile
        <span class="apidocSignatureSpan">(file, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">uploadFile = function (file, callback) {
	var self = this;

	// Ensure a file object has been provided
	if (!file) return callback(Error(&#x27;Cannot upload file - No file object provided&#x27;));

	// The path to the file is required
	if (!file.path) return callback(Error(&#x27;Cannot upload file - No source path&#x27;));

	normalizeFile(file, this.schema, function (err, file) {
		if (err) return callback(err);
		self.adapter.uploadFile(file, function (err, result) {
			if (err) return callback(err);
			if (self.schema.url &#x26;&#x26; self.adapter.getFileURL) {
				result.url = self.adapter.getFileURL(result);
			}
			callback(null, result);
		});
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

			if (/^(delete|reset)$/.test(action)) {
				field.apply(item, action);
			}
		}

		if (req.files &#x26;&#x26; req.files[paths.upload] &#x26;&#x26; req.files[paths.upload].size) {
			return field.<span class="apidocCodeKeywordSpan">uploadFile</span>(item, req.files[paths.upload], true, callback);
		}

		return callback();

	};

};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.TextArrayType" id="apidoc.module.keystone.TextArrayType">module keystone.TextArrayType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.TextArrayType.TextArrayType" id="apidoc.element.keystone.TextArrayType.TextArrayType">
        function <span class="apidocSignatureSpan">keystone.</span>TextArrayType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function textarray(list, path, options) {
	this._nativeType = [String];
	this._underscoreMethods = [&#x27;format&#x27;];
	this.separator = options.separator || &#x27; | &#x27;;
	textarray.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.TextArrayType.super_" id="apidoc.element.keystone.TextArrayType.super_">
        function <span class="apidocSignatureSpan">keystone.TextArrayType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.TextType" id="apidoc.module.keystone.TextType">module keystone.TextType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.TextType.TextType" id="apidoc.element.keystone.TextType.TextType">
        function <span class="apidocSignatureSpan">keystone.</span>TextType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function text(list, path, options) {
	this.options = options;
	this._nativeType = String;
	this._properties = [&#x27;monospace&#x27;];
	this._underscoreMethods = [&#x27;crop&#x27;];
	text.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.TextType.super_" id="apidoc.element.keystone.TextType.super_">
        function <span class="apidocSignatureSpan">keystone.TextType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.TextareaType" id="apidoc.module.keystone.TextareaType">module keystone.TextareaType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.TextareaType.TextareaType" id="apidoc.element.keystone.TextareaType.TextareaType">
        function <span class="apidocSignatureSpan">keystone.</span>TextareaType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function textarea(list, path, options) {
	this._nativeType = String;
	this._underscoreMethods = [&#x27;format&#x27;, &#x27;crop&#x27;];
	this.height = options.height || 90;
	this.multiline = true;
	this._properties = [&#x27;height&#x27;, &#x27;multiline&#x27;];
	textarea.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.TextareaType.super_" id="apidoc.element.keystone.TextareaType.super_">
        function <span class="apidocSignatureSpan">keystone.TextareaType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.UrlType" id="apidoc.module.keystone.UrlType">module keystone.UrlType</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.UrlType.UrlType" id="apidoc.element.keystone.UrlType.UrlType">
        function <span class="apidocSignatureSpan">keystone.</span>UrlType
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function url(list, path, options) {
	this._nativeType = String;
	this._underscoreMethods = [&#x27;format&#x27;];
	url.super_.call(this, list, path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.UrlType.super_" id="apidoc.element.keystone.UrlType.super_">
        function <span class="apidocSignatureSpan">keystone.UrlType.</span>super_
        <span class="apidocSignatureSpan">(list, path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Field(list, path, options) {

	// Set field properties and options
	this.list = list;
	this._path = new Path(path);
	this.path = path;

	this.type = this.constructor.name;
	this.options = _.defaults({}, options, this.defaults);
	this.label = options.label || utils.keyToLabel(this.path);
	this.typeDescription = options.typeDescription || this.typeDescription || this.type;

	this.list.automap(this);

	// Warn on required fields that aren&#x27;t initial
	if (this.options.required
		&#x26;&#x26; this.options.initial === undefined
		&#x26;&#x26; this.options.default === undefined
		&#x26;&#x26; !this.options.value
		&#x26;&#x26; !this.list.get(&#x27;nocreate&#x27;)
		&#x26;&#x26; this.path !== this.list.mappings.name
	) {
		console.error(&#x27;\nError: Invalid Configuration\n\n&#x27;
		+ &#x27;Field (&#x27; + list.key + &#x27;.&#x27; + path + &#x27;) is required but not initial, and has no default or generated value.\n&#x27;
		+ &#x27;Please provide a default, remove the required setting, or set initial: false to override this error.\n&#x27;);
		process.exit(1);
	}

	// if dependsOn and required, set required to a function for validation
	if (this.options.dependsOn &#x26;&#x26; this.options.required === true) {
		var opts = this.options;
		this.options.required = function () {
			// `this` refers to the validating document
			debug(&#x27;validate dependsOn required&#x27;, evalDependsOn(opts.dependsOn, this.toObject()));
			return evalDependsOn(opts.dependsOn, this.toObject());
		};
	}

	// Add the field to the schema
	this.addToSchema(this.list.schema);

	// Add pre-save handler to the list if this field watches others
	if (this.options.watch) {
		this.list.schema.pre(&#x27;save&#x27;, this.getPreSaveWatcher());
	}

	// Convert notes from markdown to html
	var note = null;
	Object.defineProperty(this, &#x27;note&#x27;, {
		get: function () {
			return (note === null) ? (note = (this.options.note) ? marked(this.options.note) : &#x27;&#x27;) : note;
		},
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.View" id="apidoc.module.keystone.View">module keystone.View</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.View.View" id="apidoc.element.keystone.View.View">
        function <span class="apidocSignatureSpan">keystone.</span>View
        <span class="apidocSignatureSpan">(req, res)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function View(req, res) {

	if (!req || req.constructor.name !== &#x27;IncomingMessage&#x27;) {
		throw new Error(&#x27;Keystone.View Error: Express request object is required.&#x27;);
	}

	if (!res || res.constructor.name !== &#x27;ServerResponse&#x27;) {
		throw new Error(&#x27;Keystone.View Error: Express response object is required.&#x27;);
	}

	this.req = req;
	this.res = res;

	this.initQueue = [];	// executed first in series
	this.actionQueue = [];	// executed second in parallel, if optional conditions are met
	this.queryQueue = [];	// executed third in parallel
	this.renderQueue = [];	// executed fourth in parallel

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.View.prototype" id="apidoc.module.keystone.View.prototype">module keystone.View.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.View.prototype.on" id="apidoc.element.keystone.View.prototype.on">
        function <span class="apidocSignatureSpan">keystone.View.prototype.</span>on
        <span class="apidocSignatureSpan">(on)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">on = function (on) {

	var req = this.req;
	var callback = arguments[1];

	if (typeof on === &#x27;function&#x27;) {

		<span class="apidocCodeCommentSpan">/* If the first argument is a function that returns truthy then add the second
		 * argument to the action queue
		 *
		 * Example:
		 *
		 *     view.on(function() {
		 *             var thing = true;
		 *             return thing;
		 *         },
		 *         function(next) {
		 *             console.log(&#x27;thing is true!&#x27;);
		 *             next();
		 *         }
		 *     );
		 */
</span>
		if (on()) {
			this.actionQueue.push(callback);
		}

	} else if (utils.isObject(on)) {

		/* Do certain actions depending on information in the response object.
		 *
		 * Example:
		 *
		 *     view.on({ &#x27;user.name.first&#x27;: &#x27;Admin&#x27; }, function(next) {
		 *         console.log(&#x27;Hello Admin!&#x27;);
		 *         next();
		 *     });
		 */

		var check = function (value, path) {
			var ctx = req;
			var parts = path.split(&#x27;.&#x27;);
			for (var i = 0; i &#x3c; parts.length - 1; i++) {
				if (!ctx[parts[i]]) {
					return false;
				}
				ctx = ctx[parts[i]];
			}
			path = _.last(parts);
			return (value === true &#x26;&#x26; path in ctx) ? true : (ctx[path] === value);
		};

		if (_.every(on, check)) {
			this.actionQueue.push(callback);
		}

	} else if (on === &#x27;get&#x27; || on === &#x27;post&#x27; || on === &#x27;put&#x27; || on === &#x27;delete&#x27;) {

		/* Handle HTTP verbs
		 *
		 * Example:
		 *     view.on(&#x27;get&#x27;, function(next) {
		 *         console.log(&#x27;GOT!&#x27;);
		 *         next();
		 *     });
		 */
		if (req.method !== on.toUpperCase()) {
			return this;
		}

		if (arguments.length === 3) {

			/* on a POST and PUT requests search the req.body for a matching value
			 * on every other request search the query.
			 *
			 * Example:
			 *     view.on(&#x27;post&#x27;, { action: &#x27;theAction&#x27; }, function(next) {
			 *         // respond to the action
			 *         next();
			 *     });
			 *
			 * Example:
			 *     view.on(&#x27;get&#x27;, { page: 2 }, function(next) {
			 *         // do something specifically on ?page=2
			 *         next();
			 *     });
			 */

			callback = arguments[2];

			var values = {};
			if (utils.isString(arguments[1])) {
				values[arguments[1]] = true;
			} else {
				values = arguments[1];
			}

			var ctx = (on === &#x27;post&#x27; || on === &#x27;put&#x27;) ? req.body : req.query;

			if (!_.every(values || {}, function (value, path) {
				return (value === true &#x26;&#x26; path in ctx) ? true : (ctx[path] === value);
			})) {
				return this;
			}

		}

		this.actionQueue.push(callback);

	} else if (on === &#x27;init&#x27;) {

		/* Init events are always fired in series, before any other actions
		 *
		 * Example:
		 *     view.on(&#x27;init&#x27;, function (next) {
		 *         // do something before any actions or queries have run
		 *     });
		 */

		this.initQueue.push(callback);

	} else if (on === &#x27;render&#x27;) {

		/* Render events are always fired last in parallel, after any other actions
		 *
		 * Example:
		 *     view.on(&#x27;render&#x27;, function (next) {
		 *         // do something after init, action and query middleware has run
		 *     });
		 */

		this.renderQueue.push(callback);

	}

	// TODO: Should throw if we didn&#x27;t recognise the first argument!

	return this;

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		// Initialize the session store
		try {
			var SessionStore = require(sessionStore)(session);

			sessionStorePromise = new Promise(
				function (resolve, reject) {
					sessionOptions.store = new SessionStore(sessionStoreOptions, resolve);
					sessionOptions.store.<span class="apidocCodeKeywordSpan">on</span>(&#x27;connect&#x27;, resolve);
					sessionOptions.store.on(&#x27;connected&#x27;, resolve);
					sessionOptions.store.on(&#x27;disconnect&#x27;, function () {
						console.error(
							&#x27;\nThere was an error connecting to the &#x27; + sessionStore + &#x27; session store.&#x27;
							+ &#x27;\n&#x27;);
						process.exit(1);
					});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.View.prototype.query" id="apidoc.element.keystone.View.prototype.query">
        function <span class="apidocSignatureSpan">keystone.View.prototype.</span>query
        <span class="apidocSignatureSpan">(key, query, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">query = function (key, query, options) {

	var locals = this.res.locals;
	var parts = key.split(&#x27;.&#x27;);
	var chain = new QueryCallbacks(options);

	key = parts.pop();

	for (var i = 0; i &#x3c; parts.length; i++) {
		if (!locals[parts[i]]) {
			locals[parts[i]] = {};
		}
		locals = locals[parts[i]];
	}

	this.queryQueue.push(function (next) {
		query.exec(function (err, results) {

			locals[key] = results;
			var callbacks = chain.callbacks;

			if (err) {
				if (&#x27;err&#x27; in callbacks) {
					<span class="apidocCodeCommentSpan">/* Will pass errors into the err callback
					 *
					 * Example:
					 *     view.query(&#x27;books&#x27;, keystone.list(&#x27;Book&#x27;))
					 *         .err(function (err, next) {
					 *             console.log(&#x27;ERROR: &#x27;, err);
					 *             next();
					 *         });
					 */
</span>					return callbacks.err(err, next);
				}
			} else {
				if ((!results || (utils.isArray(results) &#x26;&#x26; !results.length)) &#x26;&#x26; &#x27;none&#x27; in callbacks) {
					/* If there are no results view.query().none will be called
					 *
					 * Example:
					 *     view.query(&#x27;books&#x27;, keystone.list(&#x27;Book&#x27;).model.find())
					 *         .none(function (next) {
					 *             console.log(&#x27;no results&#x27;);
					 *             next();
					 *         });
					 */
					return callbacks.none(next);
				} else if (&#x27;then&#x27; in callbacks) {
					if (utils.isFunction(callbacks.then)) {
						return callbacks.then(err, results, next);
					} else {
						return keystone.populateRelated(results, callbacks.then, next);
					}
				}
			}

			return next(err);

		});
	});

	return chain;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
module.exports = function apiForGet (options) {
	var idParam = options.id || &#x27;id&#x27;;
	var List = this;
	return function (req, res) {
		var id = req.params[idParam];
		var query = List.model.findById(id);
		if (typeof options.query === &#x27;function&#x27;) {
			var result = options.<span class="apidocCodeKeywordSpan">query</span>(query, req);
			if (result === false) return;
		} else if (typeof options.query === &#x27;object&#x27;) {
			query.where(options.query);
		}
		query.exec(function (err, item) {
			if (err) return res.status(500).json({ err: &#x27;database error&#x27;, detail: err });
			if (!item) return res.status(404).json({ err: &#x27;not found&#x27;, id: id });
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.View.prototype.render" id="apidoc.element.keystone.View.prototype.render">
        function <span class="apidocSignatureSpan">keystone.View.prototype.</span>render
        <span class="apidocSignatureSpan">(renderFn, locals, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">render = function (renderFn, locals, callback) {

	var req = this.req;
	var res = this.res;

	if (typeof renderFn === &#x27;string&#x27;) {
		var viewPath = renderFn;
		renderFn = function () {
			if (typeof locals === &#x27;function&#x27;) {
				locals = locals();
			}
			this.res.render(viewPath, locals, callback);
		}.bind(this);
	}

	if (typeof renderFn !== &#x27;function&#x27;) {
		throw new Error(&#x27;Keystone.View.render() renderFn must be a templatePath (string) or a function.&#x27;);
	}

	// Add actions, queries &#x26; renderQueue to the end of the initQueue
	this.initQueue.push.apply(this.initQueue, this.actionQueue);
	this.initQueue.push.apply(this.initQueue, this.queryQueue);

	var preRenderQueue = [];

	// Add Keystone&#x27;s global pre(&#x27;render&#x27;) queue
	keystone.getMiddleware(&#x27;pre:render&#x27;).forEach(function (fn) {
		preRenderQueue.push(function (next) {
			fn(req, res, next);
		});
	});

	this.initQueue.push(preRenderQueue);
	this.initQueue.push(this.renderQueue);

	async.eachSeries(this.initQueue, function (i, next) {
		if (Array.isArray(i)) {
			// process nested arrays in parallel
			async.parallel(i, next);
		} else if (typeof i === &#x27;function&#x27;) {
			// process single methods in series
			i(next);
		} else {
			throw new Error(&#x27;Keystone.View.render() events must be functions.&#x27;);
		}
	}, function (err) {
		renderFn(err, req, res);
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			try {
				if (typeof err404 === &#x27;function&#x27;) {
					return err404(req, res, next);
				} else if (typeof err404 === &#x27;string&#x27;) {
					if (req.headers.accept === &#x27;application/json&#x27;) {
						return res.status(404).json({ error: &#x27;not found&#x27; });
					}
					return res.status(404).<span class="apidocCodeKeywordSpan">render</span>(err404);
				} else {
					if (keystone.get(&#x27;logger&#x27;)) {
						console.log(dashes + &#x27;Error handling 404 (not found): Invalid type (&#x27; + (typeof err404) + &#x27;) for 404 setting
.&#x27; + dashes);
					}
					return default404Handler(req, res, next);
				}
			} catch (e) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.cloudinary" id="apidoc.module.keystone.cloudinary">module keystone.cloudinary</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.cloudinary.autocomplete" id="apidoc.element.keystone.cloudinary.autocomplete">
        function <span class="apidocSignatureSpan">keystone.cloudinary.</span>autocomplete
        <span class="apidocSignatureSpan">(req, res)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">autocomplete = function (req, res) {
		var cloudinary = require(&#x27;cloudinary&#x27;);
		var max = req.query.max || 10;
		var prefix = req.query.prefix || &#x27;&#x27;;
		var next = req.query.next || null;

		cloudinary.api.resources(function (result) {
			if (result.error) {
				res.json({ error: { message: result.error.message } });
			} else {
				res.json({
					next: result.next_cursor,
					items: result.resources,
				});
			}
		}, {
			type: &#x27;upload&#x27;,
			prefix: prefix,
			max_results: max,
			next_cursor: next,
		});
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.cloudinary.get" id="apidoc.element.keystone.cloudinary.get">
        function <span class="apidocSignatureSpan">keystone.cloudinary.</span>get
        <span class="apidocSignatureSpan">(req, res)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (req, res) {
		var cloudinary = require(&#x27;cloudinary&#x27;);
		cloudinary.api.resource(req.query.id, function (result) {
			if (result.error) {
				res.json({ error: { message: result.error.message } });
			} else {
				res.json({ item: result });
			}
		});
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	this.set(&#x27;ssl&#x27;, process.env.SSL);
	this.set(&#x27;ssl port&#x27;, process.env.SSL_PORT || &#x27;3001&#x27;);
	this.set(&#x27;ssl host&#x27;, process.env.SSL_HOST || process.env.SSL_IP);
	this.set(&#x27;ssl key&#x27;, process.env.SSL_KEY);
	this.set(&#x27;ssl cert&#x27;, process.env.SSL_CERT);

	this.set(&#x27;cookie secret&#x27;, process.env.COOKIE_SECRET);
	this.set(&#x27;cookie signin&#x27;, (this.<span class="apidocCodeKeywordSpan">get</span>(&#x27;env&#x27;) === &#x27;development
&#x27;) ? true : false);

	this.set(&#x27;embedly api key&#x27;, process.env.EMBEDLY_API_KEY || process.env.EMBEDLY_APIKEY);
	this.set(&#x27;mandrill api key&#x27;, process.env.MANDRILL_API_KEY || process.env.MANDRILL_APIKEY);
	this.set(&#x27;mandrill username&#x27;, process.env.MANDRILL_USERNAME);
	this.set(&#x27;google api key&#x27;, process.env.GOOGLE_BROWSER_KEY);
	this.set(&#x27;google server api key&#x27;, process.env.GOOGLE_SERVER_KEY);
	this.set(&#x27;ga property&#x27;, process.env.GA_PROPERTY);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.cloudinary.upload" id="apidoc.element.keystone.cloudinary.upload">
        function <span class="apidocSignatureSpan">keystone.cloudinary.</span>upload
        <span class="apidocSignatureSpan">(req, res)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">upload = function (req, res) {
		var cloudinary = require(&#x27;cloudinary&#x27;);
		var keystone = req.keystone;

		if (req.files &#x26;&#x26; req.files.file) {
			var options = {};

			if (keystone.get(&#x27;wysiwyg cloudinary images filenameAsPublicID&#x27;)) {
				options.public_id = req.files.file.originalname.substring(0, req.files.file.originalname.lastIndexOf(&#x27;.&#x27;));
			}

			cloudinary.uploader.upload(req.files.file.path, function (result) {
				var sendResult = function () {
					if (result.error) {
						res.send({ error: { message: result.error.message } });
					} else {
						res.send({ image: { url: (keystone.get(&#x27;cloudinary secure&#x27;) === true) ? result.secure_url : result.url } });
					}
				};

				// TinyMCE upload plugin uses the iframe transport technique
				// so the response type must be text/html
				res.format({
					html: sendResult,
					json: sendResult,
				});
			}, options);
		} else {
			res.json({ error: { message: &#x27;No image selected&#x27; } });
		}
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		if (req.files &#x26;&#x26; req.files.file) {
			var options = {};

			if (keystone.get(&#x27;wysiwyg cloudinary images filenameAsPublicID&#x27;)) {
				options.public_id = req.files.file.originalname.substring(0, req.files.file.originalname.lastIndexOf(&#x27;.&#x27;));
			}

			cloudinary.uploader.<span class="apidocCodeKeywordSpan">upload</span>(req.files.file.path, function (result) {
				var sendResult = function () {
					if (result.error) {
						res.send({ error: { message: result.error.message } });
					} else {
						res.send({ image: { url: (keystone.get(&#x27;cloudinary secure&#x27;) === true) ? result.secure_url : result.url } });
					}
				};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.color" id="apidoc.module.keystone.color">module keystone.color</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.color.blend" id="apidoc.element.keystone.color.blend">
        function <span class="apidocSignatureSpan">keystone.color.</span>blend
        <span class="apidocSignatureSpan">(color1, color2, percent)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function blend(color1, color2, percent) {
	const decimalFraction = percent / 100;
	const hex1 = validateHex(color1);
	const hex2 = validateHex(color2);

	// 1.
	const f = parseInt(hex1, 16);
	const t = parseInt(hex2, 16);

	const R1 = f &#x3e;&#x3e; 16;
	const G1 = f &#x3e;&#x3e; 8 &#x26; 0x00FF;
	const B1 = f &#x26; 0x0000FF;

	const R2 = t &#x3e;&#x3e; 16;
	const G2 = t &#x3e;&#x3e; 8 &#x26; 0x00FF;
	const B2 = t &#x26; 0x0000FF;

	// 2.
	return &#x27;#&#x27; + (0x1000000
		+ (Math.round((R2 - R1) * decimalFraction) + R1) * 0x10000
		+ (Math.round((G2 - G1) * decimalFraction) + G1) * 0x100
		+ (Math.round((B2 - B1) * decimalFraction) + B1)).toString(16).slice(1);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.color.darken" id="apidoc.element.keystone.color.darken">
        function <span class="apidocSignatureSpan">keystone.color.</span>darken
        <span class="apidocSignatureSpan">(color, percent)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function darken(color, percent) {
	return shade(color, percent * -1);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.color.fade" id="apidoc.element.keystone.color.fade">
        function <span class="apidocSignatureSpan">keystone.color.</span>fade
        <span class="apidocSignatureSpan">(color, opacity = 100)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function fade(color, opacity = 100) {
	const decimalFraction = opacity / 100;
	const hex = validateHex(color);

	// 1.
	const r = parseInt(hex.substring(0, 2), 16);
	const g = parseInt(hex.substring(2, 4), 16);
	const b = parseInt(hex.substring(4, 6), 16);

	// 2.
	const result = &#x27;rgba(&#x27;
		+ r + &#x27;,&#x27;
		+ g + &#x27;,&#x27;
		+ b + &#x27;,&#x27;
		+ decimalFraction
		+ &#x27;)&#x27;;

	return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.color.lighten" id="apidoc.element.keystone.color.lighten">
        function <span class="apidocSignatureSpan">keystone.color.</span>lighten
        <span class="apidocSignatureSpan">(color, percent)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function shade(color, percent) {
	const decimalFraction = percent / 100;
	const hex = validateHex(color);

	// 1.
	let f = parseInt(hex, 16);
	let t = decimalFraction &#x3c; 0 ? 0 : 255;
	let p = decimalFraction &#x3c; 0 ? decimalFraction * -1 : decimalFraction;

	const R = f &#x3e;&#x3e; 16;
	const G = f &#x3e;&#x3e; 8 &#x26; 0x00FF;
	const B = f &#x26; 0x0000FF;

	// 2.
	return &#x27;#&#x27; + (0x1000000
		+ (Math.round((t - R) * p) + R) * 0x10000
		+ (Math.round((t - G) * p) + G) * 0x100
		+ (Math.round((t - B) * p) + B)).toString(16).slice(1);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.csrf" id="apidoc.module.keystone.csrf">module keystone.csrf</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.csrf.createSecret" id="apidoc.element.keystone.csrf.createSecret">
        function <span class="apidocSignatureSpan">keystone.csrf.</span>createSecret
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createSecret = function () {
	return crypto.pseudoRandomBytes(exports.SECRET_LENGTH).toString(&#x27;base64&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

exports.createSecret = function () {
	return crypto.pseudoRandomBytes(exports.SECRET_LENGTH).toString(&#x27;base64&#x27;);
};

exports.getSecret = function (req) {
	return req.session[exports.SECRET_KEY] || (req.session[exports.SECRET_KEY] = exports.<span class="apidocCodeKeywordSpan">createSecret
</span>());
};

exports.createToken = function (req) {
	return tokenize(utils.randomString(exports.SECRET_LENGTH), exports.getSecret(req));
};

exports.getToken = function (req, res) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.csrf.createToken" id="apidoc.element.keystone.csrf.createToken">
        function <span class="apidocSignatureSpan">keystone.csrf.</span>createToken
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createToken = function (req) {
	return tokenize(utils.randomString(exports.SECRET_LENGTH), exports.getSecret(req));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

exports.createToken = function (req) {
	return tokenize(utils.randomString(exports.SECRET_LENGTH), exports.getSecret(req));
};

exports.getToken = function (req, res) {
	res.locals[exports.LOCAL_VALUE] = res.locals[exports.LOCAL_VALUE] || exports.<span class="apidocCodeKeywordSpan">createToken</span
>(req);
	res.cookie(exports.XSRF_COOKIE_KEY, res.locals[exports.LOCAL_VALUE]);
	return res.locals[exports.LOCAL_VALUE];
};

exports.requestToken = function (req) {
	if (req.body &#x26;&#x26; req.body[exports.TOKEN_KEY]) {
		return req.body[exports.TOKEN_KEY];
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.csrf.getSecret" id="apidoc.element.keystone.csrf.getSecret">
        function <span class="apidocSignatureSpan">keystone.csrf.</span>getSecret
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getSecret = function (req) {
	return req.session[exports.SECRET_KEY] || (req.session[exports.SECRET_KEY] = exports.createSecret());
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

exports.getSecret = function (req) {
	return req.session[exports.SECRET_KEY] || (req.session[exports.SECRET_KEY] = exports.createSecret());
};

exports.createToken = function (req) {
	return tokenize(utils.randomString(exports.SECRET_LENGTH), exports.<span class="apidocCodeKeywordSpan">getSecret</span>(req));
};

exports.getToken = function (req, res) {
	res.locals[exports.LOCAL_VALUE] = res.locals[exports.LOCAL_VALUE] || exports.createToken(req);
	res.cookie(exports.XSRF_COOKIE_KEY, res.locals[exports.LOCAL_VALUE]);
	return res.locals[exports.LOCAL_VALUE];
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.csrf.getToken" id="apidoc.element.keystone.csrf.getToken">
        function <span class="apidocSignatureSpan">keystone.csrf.</span>getToken
        <span class="apidocSignatureSpan">(req, res)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getToken = function (req, res) {
	res.locals[exports.LOCAL_VALUE] = res.locals[exports.LOCAL_VALUE] || exports.createToken(req);
	res.cookie(exports.XSRF_COOKIE_KEY, res.locals[exports.LOCAL_VALUE]);
	return res.locals[exports.LOCAL_VALUE];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		)
	);
};

exports.middleware = {
	init: function (req, res, next) {
		res.locals[exports.LOCAL_KEY] = exports.LOCAL_VALUE;
		exports.<span class="apidocCodeKeywordSpan">getToken</span>(req, res);
		next();
	},
	validate: function (req, res, next) {
		// Allow environment variable to disable check
		if (DISABLE_CSRF) return next();
		// Bail on safe methods
		if (req.method === &#x27;GET&#x27; || req.method === &#x27;HEAD&#x27; || req.method === &#x27;OPTIONS&#x27;) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.csrf.requestToken" id="apidoc.element.keystone.csrf.requestToken">
        function <span class="apidocSignatureSpan">keystone.csrf.</span>requestToken
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">requestToken = function (req) {
	if (req.body &#x26;&#x26; req.body[exports.TOKEN_KEY]) {
		return req.body[exports.TOKEN_KEY];
	} else if (req.query &#x26;&#x26; req.query[exports.TOKEN_KEY]) {
		return req.query[exports.TOKEN_KEY];
	} else if (req.headers &#x26;&#x26; req.headers[exports.XSRF_HEADER_KEY]) {
		return req.headers[exports.XSRF_HEADER_KEY];
	} else if (req.headers &#x26;&#x26; req.headers[exports.CSRF_HEADER_KEY]) {
		return req.headers[exports.CSRF_HEADER_KEY];
	} else if (req.cookies &#x26;&#x26; req.cookies[exports.XSRF_COOKIE_KEY]) {
		return req.cookies[exports.XSRF_COOKIE_KEY];
	}
	return &#x27;&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	return &#x27;&#x27;;
};

exports.validate = function (req, token) {
	// Allow environment variable to disable check
	if (DISABLE_CSRF) return true;
	if (arguments.length === 1) {
		token = exports.<span class="apidocCodeKeywordSpan">requestToken</span>(req);
	}
	if (typeof token !== &#x27;string&#x27;) {
		return false;
	}
	return scmp(
		token,
		tokenize(
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.csrf.validate" id="apidoc.element.keystone.csrf.validate">
        function <span class="apidocSignatureSpan">keystone.csrf.</span>validate
        <span class="apidocSignatureSpan">(req, token)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validate = function (req, token) {
	// Allow environment variable to disable check
	if (DISABLE_CSRF) return true;
	if (arguments.length === 1) {
		token = exports.requestToken(req);
	}
	if (typeof token !== &#x27;string&#x27;) {
		return false;
	}
	return scmp(
		token,
		tokenize(
			token.slice(0, exports.SECRET_LENGTH),
			req.session[exports.SECRET_KEY]
		)
	);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		// Allow environment variable to disable check
		if (DISABLE_CSRF) return next();
		// Bail on safe methods
		if (req.method === &#x27;GET&#x27; || req.method === &#x27;HEAD&#x27; || req.method === &#x27;OPTIONS&#x27;) {
			return next();
		}
		// Validate token
		if (exports.<span class="apidocCodeKeywordSpan">validate</span>(req)) {
			next();
		} else {
			res.statusCode = 403;
			next(new Error(&#x27;CSRF token mismatch&#x27;));
		}
	},
};
...</pre></li>
    </ul>




















</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.css" id="apidoc.module.keystone.css">module keystone.css</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.css.borderBottomRadius" id="apidoc.element.keystone.css.borderBottomRadius">
        function <span class="apidocSignatureSpan">keystone.css.</span>borderBottomRadius
        <span class="apidocSignatureSpan">(radius)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function borderBottomRadius(radius) {
	return {
		borderBottomLeftRadius: radius,
		borderBottomRightRadius: radius,
	};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.css.borderLeftRadius" id="apidoc.element.keystone.css.borderLeftRadius">
        function <span class="apidocSignatureSpan">keystone.css.</span>borderLeftRadius
        <span class="apidocSignatureSpan">(radius)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function borderLeftRadius(radius) {
	return {
		borderBottomLeftRadius: radius,
		borderTopLeftRadius: radius,
	};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.css.borderRightRadius" id="apidoc.element.keystone.css.borderRightRadius">
        function <span class="apidocSignatureSpan">keystone.css.</span>borderRightRadius
        <span class="apidocSignatureSpan">(radius)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function borderRightRadius(radius) {
	return {
		borderBottomRightRadius: radius,
		borderTopRightRadius: radius,
	};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.css.borderTopRadius" id="apidoc.element.keystone.css.borderTopRadius">
        function <span class="apidocSignatureSpan">keystone.css.</span>borderTopRadius
        <span class="apidocSignatureSpan">(radius)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function borderTopRadius(radius) {
	return {
		borderTopLeftRadius: radius,
		borderTopRightRadius: radius,
	};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.css.gradientHorizontal" id="apidoc.element.keystone.css.gradientHorizontal">
        function <span class="apidocSignatureSpan">keystone.css.</span>gradientHorizontal
        <span class="apidocSignatureSpan">(top, bottom, base)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function gradientHorizontal(top, bottom, base) {
	return linearGradient(&#x27;to right&#x27;, top, bottom, base);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.css.gradientVertical" id="apidoc.element.keystone.css.gradientVertical">
        function <span class="apidocSignatureSpan">keystone.css.</span>gradientVertical
        <span class="apidocSignatureSpan">(top, bottom, base)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function gradientVertical(top, bottom, base) {
	return linearGradient(&#x27;to bottom&#x27;, top, bottom, base);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.express" id="apidoc.module.keystone.express">module keystone.express</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.express.express" id="apidoc.element.keystone.express.express">
        function <span class="apidocSignatureSpan">keystone.</span>express
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function createApplication() {
  var app = function(req, res, next) {
    app.handle(req, res, next);
  };

  mixin(app, EventEmitter.prototype, false);
  mixin(app, proto, false);

  app.request = { __proto__: req, app: app };
  app.response = { __proto__: res, app: app };
  app.init();
  return app;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route" id="apidoc.element.keystone.express.Route">
        function <span class="apidocSignatureSpan">keystone.express.</span>Route
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Route(path) {
  this.path = path;
  this.stack = [];

  debug(&#x27;new %s&#x27;, path);

  // route handlers for various http methods
  this.methods = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router" id="apidoc.element.keystone.express.Router">
        function <span class="apidocSignatureSpan">keystone.express.</span>Router
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Router = function (options) {
  var opts = options || {};

  function router(req, res, next) {
    router.handle(req, res, next);
  }

  // mixin Router class functions
  router.__proto__ = proto;

  router.params = {};
  router._params = [];
  router.caseSensitive = opts.caseSensitive;
  router.mergeParams = opts.mergeParams;
  router.strict = opts.strict;
  router.stack = [];

  return router;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	});

	// Configure application routes
	var appRouter = keystone.get(&#x27;routes&#x27;);
	if (typeof appRouter === &#x27;function&#x27;) {
		if (appRouter.length === 3) {
			// new:
			//    var myRouter = new express.<span class="apidocCodeKeywordSpan">Router</span>();
			//    myRouter.get(&#x27;/&#x27;, (req, res) =&#x3e; res.send(&#x27;hello world&#x27;));
			//    keystone.set(&#x27;routes&#x27;, myRouter);
			app.use(appRouter);
		} else {
			// old:
			//    var initRoutes = function (app) {
			//      app.get(&#x27;/&#x27;, (req, res) =&#x3e; res.send(&#x27;hello world&#x27;));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.query" id="apidoc.element.keystone.express.query">
        function <span class="apidocSignatureSpan">keystone.express.</span>query
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function query(options) {
  var opts = Object.create(options || null);
  var queryparse = qs.parse;

  if (typeof options === &#x27;function&#x27;) {
    queryparse = options;
    opts = undefined;
  }

  if (opts !== undefined &#x26;&#x26; opts.allowPrototypes === undefined) {
    // back-compat for qs module
    opts.allowPrototypes = true;
  }

  return function query(req, res, next){
    if (!req.query) {
      var val = parseUrl(req).query;
      req.query = queryparse(val, opts);
    }

    next();
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
module.exports = function apiForGet (options) {
	var idParam = options.id || &#x27;id&#x27;;
	var List = this;
	return function (req, res) {
		var id = req.params[idParam];
		var query = List.model.findById(id);
		if (typeof options.query === &#x27;function&#x27;) {
			var result = options.<span class="apidocCodeKeywordSpan">query</span>(query, req);
			if (result === false) return;
		} else if (typeof options.query === &#x27;object&#x27;) {
			query.where(options.query);
		}
		query.exec(function (err, item) {
			if (err) return res.status(500).json({ err: &#x27;database error&#x27;, detail: err });
			if (!item) return res.status(404).json({ err: &#x27;not found&#x27;, id: id });
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.static" id="apidoc.element.keystone.express.static">
        function <span class="apidocSignatureSpan">keystone.express.</span>static
        <span class="apidocSignatureSpan">(root, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function serveStatic(root, options) {
  if (!root) {
    throw new TypeError(&#x27;root path required&#x27;)
  }

  if (typeof root !== &#x27;string&#x27;) {
    throw new TypeError(&#x27;root path must be a string&#x27;)
  }

  // copy options object
  var opts = Object.create(options || null)

  // fall-though
  var fallthrough = opts.fallthrough !== false

  // default redirect
  var redirect = opts.redirect !== false

  // headers listener
  var setHeaders = opts.setHeaders

  if (setHeaders &#x26;&#x26; typeof setHeaders !== &#x27;function&#x27;) {
    throw new TypeError(&#x27;option setHeaders must be function&#x27;)
  }

  // setup options for send
  opts.maxage = opts.maxage || opts.maxAge || 0
  opts.root = resolve(root)

  // construct directory listener
  var onDirectory = redirect
    ? createRedirectDirectoryListener()
    : createNotFoundDirectoryListener()

  return function serveStatic (req, res, next) {
    if (req.method !== &#x27;GET&#x27; &#x26;&#x26; req.method !== &#x27;HEAD&#x27;) {
      if (fallthrough) {
        return next()
      }

      // method not allowed
      res.statusCode = 405
      res.setHeader(&#x27;Allow&#x27;, &#x27;GET, HEAD&#x27;)
      res.setHeader(&#x27;Content-Length&#x27;, &#x27;0&#x27;)
      res.end()
      return
    }

    var forwardError = !fallthrough
    var originalUrl = parseUrl.original(req)
    var path = parseUrl(req).pathname

    // make sure redirect occurs at mount
    if (path === &#x27;/&#x27; &#x26;&#x26; originalUrl.pathname.substr(-1) !== &#x27;/&#x27;) {
      path = &#x27;&#x27;
    }

    // create send stream
    var stream = send(req, path, opts)

    // add directory handler
    stream.on(&#x27;directory&#x27;, onDirectory)

    // add headers listener
    if (setHeaders) {
      stream.on(&#x27;headers&#x27;, setHeaders)
    }

    // add file listener for fallthrough
    if (fallthrough) {
      stream.on(&#x27;file&#x27;, function onFile () {
        // once file is determined, always forward error
        forwardError = true
      })
    }

    // forward errors
    stream.on(&#x27;error&#x27;, function error (err) {
      if (forwardError || !(err.statusCode &#x3c; 500)) {
        next(err)
        return
      }

      next()
    })

    // pipe
    stream.pipe(res)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	if (typeof staticPaths === &#x27;string&#x27;) {
		staticPaths = [staticPaths];
	}

	if (Array.isArray(staticPaths)) {
		staticPaths.forEach(function (value) {
			app.use(express.<span class="apidocCodeKeywordSpan">static</span>(keystone.expandPath(value), staticOptions));
		});
	}
};
...</pre></li>
    </ul>








</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.express.Route" id="apidoc.module.keystone.express.Route">module keystone.express.Route</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.express.Route.Route" id="apidoc.element.keystone.express.Route.Route">
        function <span class="apidocSignatureSpan">keystone.express.</span>Route
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Route(path) {
  this.path = path;
  this.stack = [];

  debug(&#x27;new %s&#x27;, path);

  // route handlers for various http methods
  this.methods = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.express.Route.prototype" id="apidoc.module.keystone.express.Route.prototype">module keystone.express.Route.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype._handles_method" id="apidoc.element.keystone.express.Route.prototype._handles_method">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>_handles_method
        <span class="apidocSignatureSpan">(method)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function _handles_method(method) {
  if (this.methods._all) {
    return true;
  }

  var name = method.toLowerCase();

  if (name === &#x27;head&#x27; &#x26;&#x26; !this.methods[&#x27;head&#x27;]) {
    name = &#x27;get&#x27;;
  }

  return Boolean(this.methods[name]);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype._options" id="apidoc.element.keystone.express.Route.prototype._options">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>_options
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function _options() {
  var methods = Object.keys(this.methods);

  // append automatic head
  if (this.methods.get &#x26;&#x26; !this.methods.head) {
    methods.push(&#x27;head&#x27;);
  }

  for (var i = 0; i &#x3c; methods.length; i++) {
    // make upper case
    methods[i] = methods[i].toUpperCase();
  }

  return methods;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.acl" id="apidoc.element.keystone.express.Route.prototype.acl">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>acl
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">acl = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.all" id="apidoc.element.keystone.express.Route.prototype.all">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>all
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function all() {
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.all() requires callback functions but got a &#x27; + type;
      throw new TypeError(msg);
    }

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = undefined;

    this.methods._all = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*   * `res.apiResponse(data)`
*   * `res.apiError(key, err, msg, code)`
*   * `res.apiNotFound(err, msg)`
*   * `res.apiNotAllowed(err, msg)`
*
* ####Example:
*
*     app.<span class="apidocCodeKeywordSpan">all</span>(&#x27;/api*&#x27;, keystone.middleware.api);
*
* @param {app.request} req
* @param {app.response} res
* @param {function} next
* @api public
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.bind" id="apidoc.element.keystone.express.Route.prototype.bind">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>bind
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bind = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	constructor() {
		super();
		bindFunctions.call(this, [&#x27;handleClick&#x27;, &#x27;handleOther&#x27;]);
	}
*/
module.exports = function bindFunctions (functions) {
	functions.forEach(f =&#x3e; (this[f] = this[f].<span class="apidocCodeKeywordSpan">bind</span>(this)));
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.checkout" id="apidoc.element.keystone.express.Route.prototype.checkout">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>checkout
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">checkout = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.connect" id="apidoc.element.keystone.express.Route.prototype.connect">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>connect
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connect = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			replset: {
				rs_name: replicaData.db.replicaSetOptions.rs_name,
				readPreference: replicaData.db.replicaSetOptions.readPreference,
			},
		};

		debug(&#x27;connecting to replica set&#x27;);
		keystone.mongoose.<span class="apidocCodeKeywordSpan">connect</span>(replica, options);

	} else {
		debug(&#x27;connecting to mongo&#x27;);
		keystone.initDatabaseConfig();
		keystone.mongoose.connect(keystone.get(&#x27;mongo&#x27;), keystone.get(&#x27;mongo options&#x27;));
	}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.copy" id="apidoc.element.keystone.express.Route.prototype.copy">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>copy
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">copy = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.delete" id="apidoc.element.keystone.express.Route.prototype.delete">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>delete
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">delete = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.dispatch" id="apidoc.element.keystone.express.Route.prototype.dispatch">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>dispatch
        <span class="apidocSignatureSpan">(req, res, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function dispatch(req, res, done) {
  var idx = 0;
  var stack = this.stack;
  if (stack.length === 0) {
    return done();
  }

  var method = req.method.toLowerCase();
  if (method === &#x27;head&#x27; &#x26;&#x26; !this.methods[&#x27;head&#x27;]) {
    method = &#x27;get&#x27;;
  }

  req.route = this;

  next();

  function next(err) {
    if (err &#x26;&#x26; err === &#x27;route&#x27;) {
      return done();
    }

    var layer = stack[idx++];
    if (!layer) {
      return done(err);
    }

    if (layer.method &#x26;&#x26; layer.method !== method) {
      return next(err);
    }

    if (err) {
      layer.handle_error(err, req, res, next);
    } else {
      layer.handle_request(req, res, next);
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.get" id="apidoc.element.keystone.express.Route.prototype.get">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>get
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	this.set(&#x27;ssl&#x27;, process.env.SSL);
	this.set(&#x27;ssl port&#x27;, process.env.SSL_PORT || &#x27;3001&#x27;);
	this.set(&#x27;ssl host&#x27;, process.env.SSL_HOST || process.env.SSL_IP);
	this.set(&#x27;ssl key&#x27;, process.env.SSL_KEY);
	this.set(&#x27;ssl cert&#x27;, process.env.SSL_CERT);

	this.set(&#x27;cookie secret&#x27;, process.env.COOKIE_SECRET);
	this.set(&#x27;cookie signin&#x27;, (this.<span class="apidocCodeKeywordSpan">get</span>(&#x27;env&#x27;) === &#x27;development
&#x27;) ? true : false);

	this.set(&#x27;embedly api key&#x27;, process.env.EMBEDLY_API_KEY || process.env.EMBEDLY_APIKEY);
	this.set(&#x27;mandrill api key&#x27;, process.env.MANDRILL_API_KEY || process.env.MANDRILL_APIKEY);
	this.set(&#x27;mandrill username&#x27;, process.env.MANDRILL_USERNAME);
	this.set(&#x27;google api key&#x27;, process.env.GOOGLE_BROWSER_KEY);
	this.set(&#x27;google server api key&#x27;, process.env.GOOGLE_SERVER_KEY);
	this.set(&#x27;ga property&#x27;, process.env.GA_PROPERTY);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.head" id="apidoc.element.keystone.express.Route.prototype.head">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>head
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">head = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.link" id="apidoc.element.keystone.express.Route.prototype.link">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>link
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">link = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.lock" id="apidoc.element.keystone.express.Route.prototype.lock">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>lock
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">lock = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.m-search" id="apidoc.element.keystone.express.Route.prototype.m-search">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>m-search
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">m-search = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.merge" id="apidoc.element.keystone.express.Route.prototype.merge">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>merge
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">merge = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.mkactivity" id="apidoc.element.keystone.express.Route.prototype.mkactivity">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>mkactivity
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mkactivity = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.mkcalendar" id="apidoc.element.keystone.express.Route.prototype.mkcalendar">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>mkcalendar
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mkcalendar = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.mkcol" id="apidoc.element.keystone.express.Route.prototype.mkcol">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>mkcol
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mkcol = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.move" id="apidoc.element.keystone.express.Route.prototype.move">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>move
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">move = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	var doMove = function (callback) {

		if (typeof field.options.filename === &#x27;function&#x27;) {
			filename = field.options.filename(item, file);
		}

		fs.<span class="apidocCodeKeywordSpan">move</span>(file.path, path.join(field.options.dest, filename), { clobber: field.options
.overwrite }, function (err) {

			if (err) return callback(err);

			var fileData = {
				filename: filename,
				originalname: file.originalname,
				path: field.options.dest,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.notify" id="apidoc.element.keystone.express.Route.prototype.notify">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>notify
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">notify = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.options" id="apidoc.element.keystone.express.Route.prototype.options">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>options
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">options = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var initialFields;

		// Inherit default options from parent list if it exists
		if (options &#x26;&#x26; options.inherits) {
			if (options.inherits.options &#x26;&#x26; options.inherits.options.inherits) {
				throw new Error(&#x27;Inherited Lists may not contain any inheritance&#x27;);
			}
			defaultOptions = utils.<span class="apidocCodeKeywordSpan">options</span>(defaultOptions, options.inherits.options);
			if (options.inherits.options.track) {
				options.track = false;
			}
		}

		this.options = utils.options(defaultOptions, options);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.patch" id="apidoc.element.keystone.express.Route.prototype.patch">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>patch
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">patch = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.post" id="apidoc.element.keystone.express.Route.prototype.post">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>post
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">post = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	// Init API request helpers
	router.use(&#x27;/api&#x27;, require(&#x27;../middleware/apiError&#x27;));
	router.use(&#x27;/api&#x27;, require(&#x27;../middleware/logError&#x27;));

	// #1: Session API
	// TODO: this should respect keystone auth options
	router.get(&#x27;/api/session&#x27;, require(&#x27;../api/session/get&#x27;));
	router.<span class="apidocCodeKeywordSpan">post</span>(&#x27;/api/session/signin&#x27;, require(&#x27;../api/session/signin&#x27
;));
	router.post(&#x27;/api/session/signout&#x27;, require(&#x27;../api/session/signout&#x27;));

	// #2: Session Routes
	// Bind auth middleware (generic or custom) to * routes, allowing
	// access to the generic signin page if generic auth is used
	if (keystone.get(&#x27;auth&#x27;) === true) {
		// TODO: poor separation of concerns; settings should be defaulted elsewhere
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.propfind" id="apidoc.element.keystone.express.Route.prototype.propfind">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>propfind
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">propfind = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.proppatch" id="apidoc.element.keystone.express.Route.prototype.proppatch">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>proppatch
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">proppatch = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.purge" id="apidoc.element.keystone.express.Route.prototype.purge">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>purge
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">purge = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.put" id="apidoc.element.keystone.express.Route.prototype.put">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>put
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">put = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.rebind" id="apidoc.element.keystone.express.Route.prototype.rebind">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>rebind
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rebind = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.report" id="apidoc.element.keystone.express.Route.prototype.report">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>report
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">report = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.search" id="apidoc.element.keystone.express.Route.prototype.search">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>search
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">search = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.subscribe" id="apidoc.element.keystone.express.Route.prototype.subscribe">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>subscribe
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">subscribe = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.trace" id="apidoc.element.keystone.express.Route.prototype.trace">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>trace
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">trace = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		},

	], function (err) {

		if (err) {
			console.error(err);
			if (&#x27;stack&#x27; in err) {
				console.<span class="apidocCodeKeywordSpan">trace</span>(err.stack);
			}
			return callback &#x26;&#x26; callback(err);
		}

		var msg = &#x27;\nSuccessfully created:\n&#x27;;
		_.forEach(stats, function (list) {
			msg += &#x27;\n*   &#x27; + utils.plural(list.created, &#x27;* &#x27; + list.singular, &#x27;* &#x27; + list.plural);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.unbind" id="apidoc.element.keystone.express.Route.prototype.unbind">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>unbind
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unbind = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.unlink" id="apidoc.element.keystone.express.Route.prototype.unlink">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>unlink
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unlink = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var fs = require(&#x27;fs&#x27;);

module.exports = function (keystone, app, callback) {

	var unixSocket = keystone.get(&#x27;unix socket&#x27;);
	var message = keystone.get(&#x27;name&#x27;) + &#x27; is ready on &#x27; + unixSocket;

	fs.<span class="apidocCodeKeywordSpan">unlink</span>(unixSocket, function () {
		// we expect err if the file is new so don&#x27;t capture the argument
		keystone.httpServer = app.listen(unixSocket, function (err) {
			callback(err, message);
		});
		fs.chmod(unixSocket, 0x777);
	});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.unlock" id="apidoc.element.keystone.express.Route.prototype.unlock">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>unlock
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unlock = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Route.prototype.unsubscribe" id="apidoc.element.keystone.express.Route.prototype.unsubscribe">
        function <span class="apidocSignatureSpan">keystone.express.Route.prototype.</span>unsubscribe
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unsubscribe = function (){
  var handles = flatten(slice.call(arguments));

  for (var i = 0; i &#x3c; handles.length; i++) {
    var handle = handles[i];

    if (typeof handle !== &#x27;function&#x27;) {
      var type = toString.call(handle);
      var msg = &#x27;Route.&#x27; + method + &#x27;() requires callback functions but got a &#x27; + type;
      throw new Error(msg);
    }

    debug(&#x27;%s %s&#x27;, method, this.path);

    var layer = Layer(&#x27;/&#x27;, {}, handle);
    layer.method = method;

    this.methods[method] = true;
    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.express.Router" id="apidoc.module.keystone.express.Router">module keystone.express.Router</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.express.Router.Router" id="apidoc.element.keystone.express.Router.Router">
        function <span class="apidocSignatureSpan">keystone.express.</span>Router
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Router = function (options) {
  var opts = options || {};

  function router(req, res, next) {
    router.handle(req, res, next);
  }

  // mixin Router class functions
  router.__proto__ = proto;

  router.params = {};
  router._params = [];
  router.caseSensitive = opts.caseSensitive;
  router.mergeParams = opts.mergeParams;
  router.strict = opts.strict;
  router.stack = [];

  return router;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	});

	// Configure application routes
	var appRouter = keystone.get(&#x27;routes&#x27;);
	if (typeof appRouter === &#x27;function&#x27;) {
		if (appRouter.length === 3) {
			// new:
			//    var myRouter = new express.<span class="apidocCodeKeywordSpan">Router</span>();
			//    myRouter.get(&#x27;/&#x27;, (req, res) =&#x3e; res.send(&#x27;hello world&#x27;));
			//    keystone.set(&#x27;routes&#x27;, myRouter);
			app.use(appRouter);
		} else {
			// old:
			//    var initRoutes = function (app) {
			//      app.get(&#x27;/&#x27;, (req, res) =&#x3e; res.send(&#x27;hello world&#x27;));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.acl" id="apidoc.element.keystone.express.Router.acl">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>acl
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">acl = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.all" id="apidoc.element.keystone.express.Router.all">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>all
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">all = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*   * `res.apiResponse(data)`
*   * `res.apiError(key, err, msg, code)`
*   * `res.apiNotFound(err, msg)`
*   * `res.apiNotAllowed(err, msg)`
*
* ####Example:
*
*     app.<span class="apidocCodeKeywordSpan">all</span>(&#x27;/api*&#x27;, keystone.middleware.api);
*
* @param {app.request} req
* @param {app.response} res
* @param {function} next
* @api public
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.bind" id="apidoc.element.keystone.express.Router.bind">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>bind
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bind = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	constructor() {
		super();
		bindFunctions.call(this, [&#x27;handleClick&#x27;, &#x27;handleOther&#x27;]);
	}
*/
module.exports = function bindFunctions (functions) {
	functions.forEach(f =&#x3e; (this[f] = this[f].<span class="apidocCodeKeywordSpan">bind</span>(this)));
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.checkout" id="apidoc.element.keystone.express.Router.checkout">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>checkout
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">checkout = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.connect" id="apidoc.element.keystone.express.Router.connect">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>connect
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connect = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			replset: {
				rs_name: replicaData.db.replicaSetOptions.rs_name,
				readPreference: replicaData.db.replicaSetOptions.readPreference,
			},
		};

		debug(&#x27;connecting to replica set&#x27;);
		keystone.mongoose.<span class="apidocCodeKeywordSpan">connect</span>(replica, options);

	} else {
		debug(&#x27;connecting to mongo&#x27;);
		keystone.initDatabaseConfig();
		keystone.mongoose.connect(keystone.get(&#x27;mongo&#x27;), keystone.get(&#x27;mongo options&#x27;));
	}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.copy" id="apidoc.element.keystone.express.Router.copy">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>copy
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">copy = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.delete" id="apidoc.element.keystone.express.Router.delete">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>delete
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">delete = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.get" id="apidoc.element.keystone.express.Router.get">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>get
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	this.set(&#x27;ssl&#x27;, process.env.SSL);
	this.set(&#x27;ssl port&#x27;, process.env.SSL_PORT || &#x27;3001&#x27;);
	this.set(&#x27;ssl host&#x27;, process.env.SSL_HOST || process.env.SSL_IP);
	this.set(&#x27;ssl key&#x27;, process.env.SSL_KEY);
	this.set(&#x27;ssl cert&#x27;, process.env.SSL_CERT);

	this.set(&#x27;cookie secret&#x27;, process.env.COOKIE_SECRET);
	this.set(&#x27;cookie signin&#x27;, (this.<span class="apidocCodeKeywordSpan">get</span>(&#x27;env&#x27;) === &#x27;development
&#x27;) ? true : false);

	this.set(&#x27;embedly api key&#x27;, process.env.EMBEDLY_API_KEY || process.env.EMBEDLY_APIKEY);
	this.set(&#x27;mandrill api key&#x27;, process.env.MANDRILL_API_KEY || process.env.MANDRILL_APIKEY);
	this.set(&#x27;mandrill username&#x27;, process.env.MANDRILL_USERNAME);
	this.set(&#x27;google api key&#x27;, process.env.GOOGLE_BROWSER_KEY);
	this.set(&#x27;google server api key&#x27;, process.env.GOOGLE_SERVER_KEY);
	this.set(&#x27;ga property&#x27;, process.env.GA_PROPERTY);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.handle" id="apidoc.element.keystone.express.Router.handle">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>handle
        <span class="apidocSignatureSpan">(req, res, out)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function handle(req, res, out) {
  var self = this;

  debug(&#x27;dispatching %s %s&#x27;, req.method, req.url);

  var search = 1 + req.url.indexOf(&#x27;?&#x27;);
  var pathlength = search ? search - 1 : req.url.length;
  var fqdn = req.url[0] !== &#x27;/&#x27; &#x26;&#x26; 1 + req.url.substr(0, pathlength).indexOf(&#x27;://&#x27;);
  var protohost = fqdn ? req.url.substr(0, req.url.indexOf(&#x27;/&#x27;, 2 + fqdn)) : &#x27;&#x27;;
  var idx = 0;
  var removed = &#x27;&#x27;;
  var slashAdded = false;
  var paramcalled = {};

  // store options for OPTIONS request
  // only used if OPTIONS request
  var options = [];

  // middleware and routes
  var stack = self.stack;

  // manage inter-router variables
  var parentParams = req.params;
  var parentUrl = req.baseUrl || &#x27;&#x27;;
  var done = restore(out, req, &#x27;baseUrl&#x27;, &#x27;next&#x27;, &#x27;params&#x27;);

  // setup next layer
  req.next = next;

  // for options requests, respond with a default if nothing else responds
  if (req.method === &#x27;OPTIONS&#x27;) {
    done = wrap(done, function(old, err) {
      if (err || options.length === 0) return old(err);
      sendOptionsResponse(res, options, old);
    });
  }

  // setup basic req values
  req.baseUrl = parentUrl;
  req.originalUrl = req.originalUrl || req.url;

  next();

  function next(err) {
    var layerError = err === &#x27;route&#x27;
      ? null
      : err;

    // remove added slash
    if (slashAdded) {
      req.url = req.url.substr(1);
      slashAdded = false;
    }

    // restore altered req.url
    if (removed.length !== 0) {
      req.baseUrl = parentUrl;
      req.url = protohost + removed + req.url.substr(protohost.length);
      removed = &#x27;&#x27;;
    }

    // no more matching layers
    if (idx &#x3e;= stack.length) {
      setImmediate(done, layerError);
      return;
    }

    // get pathname of request
    var path = getPathname(req);

    if (path == null) {
      return done(layerError);
    }

    // find next matching layer
    var layer;
    var match;
    var route;

    while (match !== true &#x26;&#x26; idx &#x3c; stack.length) {
      layer = stack[idx++];
      match = matchLayer(layer, path);
      route = layer.route;

      if (typeof match !== &#x27;boolean&#x27;) {
        // hold on to layerError
        layerError = layerError || match;
      }

      if (match !== true) {
        continue;
      }

      if (!route) {
        // process non-route handlers normally
        continue;
      }

      if (layerError) {
        // routes do not match with a pending error
        match = false;
        continue;
      }

      var method = req.method;
      var has_method = route._handles_method(method);

      // build up automatic options response
      if (!has_method &#x26;&#x26; method === &#x27;OPTIONS&#x27;) {
        appendMethods(options, route._options());
      }

      // don&#x27;t even bother matching route
      if (!has_method &#x26;&#x26; method !== &#x27;HEAD&#x27;) {
        match = false;
        continue;
      }
    }

    // no match
    if (match !== true) {
      return done(layerError);
    }

    // store route for dispatch on change
    if (route) {
      req.route = route;
    }

    // Capture one-time layer values
    req.params = self.mergeParams
      ? mergeParams(layer.params, parentParams)
      : layer.params;
    var layerPath = layer.path;

    // this should be done for the layer
    self.process_params(layer, paramcalled, req, res, function (err) {
      if (err) {
        return next(layerError || err);
      }

      if (route) {
        return layer.handle_request(req, res, next);
      }

      trim_prefix(layer, layerError, layerPath, path);
    });
  }

  function trim_prefix(layer, layerError, layerPath, path) {
    var c = path[layerPath.length];
    if (c &#x26;&#x26; &#x27;/&#x27; !== c &#x26;&#x26; &#x27;.&#x27; !== c) return next(layerError);

     // Trim off the part of the url that matches the route
     // middleware (.use stuff) needs to have the path stripped
    if (layerPath.length !== 0) {
      debug(&#x27;trim prefix (%s) from url %s&#x27;, layerPath, req.url);
      removed = layerPath;
      req.url = protohost + req.url.substr(protohost.length + removed.length);

      // Ensure leading slash
      if (!fqdn &#x26;&#x26; req.url[0] !== &#x27;/&#x27;) {
        req.url = &#x27; ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.head" id="apidoc.element.keystone.express.Router.head">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>head
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">head = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.link" id="apidoc.element.keystone.express.Router.link">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>link
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">link = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.lock" id="apidoc.element.keystone.express.Router.lock">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>lock
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">lock = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.m-search" id="apidoc.element.keystone.express.Router.m-search">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>m-search
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">m-search = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.merge" id="apidoc.element.keystone.express.Router.merge">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>merge
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">merge = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.mkactivity" id="apidoc.element.keystone.express.Router.mkactivity">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>mkactivity
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mkactivity = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.mkcalendar" id="apidoc.element.keystone.express.Router.mkcalendar">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>mkcalendar
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mkcalendar = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.mkcol" id="apidoc.element.keystone.express.Router.mkcol">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>mkcol
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mkcol = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.move" id="apidoc.element.keystone.express.Router.move">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>move
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">move = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	var doMove = function (callback) {

		if (typeof field.options.filename === &#x27;function&#x27;) {
			filename = field.options.filename(item, file);
		}

		fs.<span class="apidocCodeKeywordSpan">move</span>(file.path, path.join(field.options.dest, filename), { clobber: field.options
.overwrite }, function (err) {

			if (err) return callback(err);

			var fileData = {
				filename: filename,
				originalname: file.originalname,
				path: field.options.dest,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.notify" id="apidoc.element.keystone.express.Router.notify">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>notify
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">notify = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.options" id="apidoc.element.keystone.express.Router.options">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>options
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">options = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var initialFields;

		// Inherit default options from parent list if it exists
		if (options &#x26;&#x26; options.inherits) {
			if (options.inherits.options &#x26;&#x26; options.inherits.options.inherits) {
				throw new Error(&#x27;Inherited Lists may not contain any inheritance&#x27;);
			}
			defaultOptions = utils.<span class="apidocCodeKeywordSpan">options</span>(defaultOptions, options.inherits.options);
			if (options.inherits.options.track) {
				options.track = false;
			}
		}

		this.options = utils.options(defaultOptions, options);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.param" id="apidoc.element.keystone.express.Router.param">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>param
        <span class="apidocSignatureSpan">(name, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function param(name, fn) {
  // param logic
  if (typeof name === &#x27;function&#x27;) {
    deprecate(&#x27;router.param(fn): Refactor to use path params&#x27;);
    this._params.push(name);
    return;
  }

  // apply param functions
  var params = this._params;
  var len = params.length;
  var ret;

  if (name[0] === &#x27;:&#x27;) {
    deprecate(&#x27;router.param(&#x27; + JSON.stringify(name) + &#x27;, fn): Use router.param(&#x27; + JSON.stringify(name.substr(1)) + &#x27;, fn) instead
&#x27;);
    name = name.substr(1);
  }

  for (var i = 0; i &#x3c; len; ++i) {
    if (ret = params[i](name, fn)) {
      fn = ret;
    }
  }

  // ensure we end up with a
  // middleware function
  if (&#x27;function&#x27; !== typeof fn) {
    throw new Error(&#x27;invalid param() call for &#x27; + name + &#x27;, got &#x27; + fn);
  }

  (this.params[name] = this.params[name] || []).push(fn);
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.patch" id="apidoc.element.keystone.express.Router.patch">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>patch
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">patch = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.post" id="apidoc.element.keystone.express.Router.post">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>post
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">post = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	// Init API request helpers
	router.use(&#x27;/api&#x27;, require(&#x27;../middleware/apiError&#x27;));
	router.use(&#x27;/api&#x27;, require(&#x27;../middleware/logError&#x27;));

	// #1: Session API
	// TODO: this should respect keystone auth options
	router.get(&#x27;/api/session&#x27;, require(&#x27;../api/session/get&#x27;));
	router.<span class="apidocCodeKeywordSpan">post</span>(&#x27;/api/session/signin&#x27;, require(&#x27;../api/session/signin&#x27
;));
	router.post(&#x27;/api/session/signout&#x27;, require(&#x27;../api/session/signout&#x27;));

	// #2: Session Routes
	// Bind auth middleware (generic or custom) to * routes, allowing
	// access to the generic signin page if generic auth is used
	if (keystone.get(&#x27;auth&#x27;) === true) {
		// TODO: poor separation of concerns; settings should be defaulted elsewhere
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.process_params" id="apidoc.element.keystone.express.Router.process_params">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>process_params
        <span class="apidocSignatureSpan">(layer, called, req, res, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function process_params(layer, called, req, res, done) {
  var params = this.params;

  // captured parameters from the layer, keys and values
  var keys = layer.keys;

  // fast track
  if (!keys || keys.length === 0) {
    return done();
  }

  var i = 0;
  var name;
  var paramIndex = 0;
  var key;
  var paramVal;
  var paramCallbacks;
  var paramCalled;

  // process params in order
  // param callbacks can be async
  function param(err) {
    if (err) {
      return done(err);
    }

    if (i &#x3e;= keys.length ) {
      return done();
    }

    paramIndex = 0;
    key = keys[i++];

    if (!key) {
      return done();
    }

    name = key.name;
    paramVal = req.params[name];
    paramCallbacks = params[name];
    paramCalled = called[name];

    if (paramVal === undefined || !paramCallbacks) {
      return param();
    }

    // param previously called with same value or error occurred
    if (paramCalled &#x26;&#x26; (paramCalled.match === paramVal
      || (paramCalled.error &#x26;&#x26; paramCalled.error !== &#x27;route&#x27;))) {
      // restore value
      req.params[name] = paramCalled.value;

      // next param
      return param(paramCalled.error);
    }

    called[name] = paramCalled = {
      error: null,
      match: paramVal,
      value: paramVal
    };

    paramCallback();
  }

  // single param callbacks
  function paramCallback(err) {
    var fn = paramCallbacks[paramIndex++];

    // store updated value
    paramCalled.value = req.params[key.name];

    if (err) {
      // store error
      paramCalled.error = err;
      param(err);
      return;
    }

    if (!fn) return param();

    try {
      fn(req, res, paramCallback, paramVal, key.name);
    } catch (e) {
      paramCallback(e);
    }
  }

  param();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.propfind" id="apidoc.element.keystone.express.Router.propfind">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>propfind
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">propfind = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.proppatch" id="apidoc.element.keystone.express.Router.proppatch">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>proppatch
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">proppatch = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.purge" id="apidoc.element.keystone.express.Router.purge">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>purge
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">purge = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.put" id="apidoc.element.keystone.express.Router.put">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>put
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">put = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.rebind" id="apidoc.element.keystone.express.Router.rebind">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>rebind
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rebind = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.report" id="apidoc.element.keystone.express.Router.report">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>report
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">report = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.route" id="apidoc.element.keystone.express.Router.route">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>route
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function route(path) {
  var route = new Route(path);

  var layer = new Layer(path, {
    sensitive: this.caseSensitive,
    strict: this.strict,
    end: true
  }, route.dispatch.bind(route));

  layer.route = route;

  this.stack.push(layer);
  return route;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.search" id="apidoc.element.keystone.express.Router.search">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>search
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">search = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.subscribe" id="apidoc.element.keystone.express.Router.subscribe">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>subscribe
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">subscribe = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.trace" id="apidoc.element.keystone.express.Router.trace">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>trace
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">trace = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		},

	], function (err) {

		if (err) {
			console.error(err);
			if (&#x27;stack&#x27; in err) {
				console.<span class="apidocCodeKeywordSpan">trace</span>(err.stack);
			}
			return callback &#x26;&#x26; callback(err);
		}

		var msg = &#x27;\nSuccessfully created:\n&#x27;;
		_.forEach(stats, function (list) {
			msg += &#x27;\n*   &#x27; + utils.plural(list.created, &#x27;* &#x27; + list.singular, &#x27;* &#x27; + list.plural);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.unbind" id="apidoc.element.keystone.express.Router.unbind">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>unbind
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unbind = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.unlink" id="apidoc.element.keystone.express.Router.unlink">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>unlink
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unlink = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var fs = require(&#x27;fs&#x27;);

module.exports = function (keystone, app, callback) {

	var unixSocket = keystone.get(&#x27;unix socket&#x27;);
	var message = keystone.get(&#x27;name&#x27;) + &#x27; is ready on &#x27; + unixSocket;

	fs.<span class="apidocCodeKeywordSpan">unlink</span>(unixSocket, function () {
		// we expect err if the file is new so don&#x27;t capture the argument
		keystone.httpServer = app.listen(unixSocket, function (err) {
			callback(err, message);
		});
		fs.chmod(unixSocket, 0x777);
	});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.unlock" id="apidoc.element.keystone.express.Router.unlock">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>unlock
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unlock = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.unsubscribe" id="apidoc.element.keystone.express.Router.unsubscribe">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>unsubscribe
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unsubscribe = function (path){
  var route = this.route(path)
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.Router.use" id="apidoc.element.keystone.express.Router.use">
        function <span class="apidocSignatureSpan">keystone.express.Router.</span>use
        <span class="apidocSignatureSpan">(fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function use(fn) {
  var offset = 0;
  var path = &#x27;/&#x27;;

  // default path to &#x27;/&#x27;
  // disambiguate router.use([fn])
  if (typeof fn !== &#x27;function&#x27;) {
    var arg = fn;

    while (Array.isArray(arg) &#x26;&#x26; arg.length !== 0) {
      arg = arg[0];
    }

    // first arg is the path
    if (typeof arg !== &#x27;function&#x27;) {
      offset = 1;
      path = fn;
    }
  }

  var callbacks = flatten(slice.call(arguments, offset));

  if (callbacks.length === 0) {
    throw new TypeError(&#x27;Router.use() requires middleware functions&#x27;);
  }

  for (var i = 0; i &#x3c; callbacks.length; i++) {
    var fn = callbacks[i];

    if (typeof fn !== &#x27;function&#x27;) {
      throw new TypeError(&#x27;Router.use() requires middleware function but got a &#x27; + gettype(fn));
    }

    // add the middleware
    debug(&#x27;use %s %s&#x27;, path, fn.name || &#x27;&#x3c;anonymous&#x3e;&#x27;);

    var layer = new Layer(path, {
      sensitive: this.caseSensitive,
      strict: false,
      end: false
    }, fn);

    layer.route = undefined;

    this.stack.push(layer);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

module.exports = function bindIPRestrictions (keystone, app) {
	// Set up body options and cookie parser
	var bodyParserParams = {};
	if (keystone.get(&#x27;file limit&#x27;)) {
		bodyParserParams.limit = keystone.get(&#x27;file limit&#x27;);
	}
	app.<span class="apidocCodeKeywordSpan">use</span>(bodyParser.json(bodyParserParams));
	bodyParserParams.extended = true;
	app.use(bodyParser.urlencoded(bodyParserParams));
	app.use(multer({
		includeEmptyFields: true,
	}));
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.express.application" id="apidoc.module.keystone.express.application">module keystone.express.application</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.express.application.acl" id="apidoc.element.keystone.express.application.acl">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>acl
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">acl = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.all" id="apidoc.element.keystone.express.application.all">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>all
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function all(path) {
  this.lazyrouter();

  var route = this._router.route(path);
  var args = slice.call(arguments, 1);

  for (var i = 0; i &#x3c; methods.length; i++) {
    route[methods[i]].apply(route, args);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*   * `res.apiResponse(data)`
*   * `res.apiError(key, err, msg, code)`
*   * `res.apiNotFound(err, msg)`
*   * `res.apiNotAllowed(err, msg)`
*
* ####Example:
*
*     app.<span class="apidocCodeKeywordSpan">all</span>(&#x27;/api*&#x27;, keystone.middleware.api);
*
* @param {app.request} req
* @param {app.response} res
* @param {function} next
* @api public
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.bind" id="apidoc.element.keystone.express.application.bind">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>bind
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bind = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	constructor() {
		super();
		bindFunctions.call(this, [&#x27;handleClick&#x27;, &#x27;handleOther&#x27;]);
	}
*/
module.exports = function bindFunctions (functions) {
	functions.forEach(f =&#x3e; (this[f] = this[f].<span class="apidocCodeKeywordSpan">bind</span>(this)));
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.checkout" id="apidoc.element.keystone.express.application.checkout">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>checkout
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">checkout = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.connect" id="apidoc.element.keystone.express.application.connect">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>connect
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connect = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			replset: {
				rs_name: replicaData.db.replicaSetOptions.rs_name,
				readPreference: replicaData.db.replicaSetOptions.readPreference,
			},
		};

		debug(&#x27;connecting to replica set&#x27;);
		keystone.mongoose.<span class="apidocCodeKeywordSpan">connect</span>(replica, options);

	} else {
		debug(&#x27;connecting to mongo&#x27;);
		keystone.initDatabaseConfig();
		keystone.mongoose.connect(keystone.get(&#x27;mongo&#x27;), keystone.get(&#x27;mongo options&#x27;));
	}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.copy" id="apidoc.element.keystone.express.application.copy">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>copy
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">copy = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.defaultConfiguration" id="apidoc.element.keystone.express.application.defaultConfiguration">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>defaultConfiguration
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function defaultConfiguration() {
  var env = process.env.NODE_ENV || &#x27;development&#x27;;

  // default settings
  this.enable(&#x27;x-powered-by&#x27;);
  this.set(&#x27;etag&#x27;, &#x27;weak&#x27;);
  this.set(&#x27;env&#x27;, env);
  this.set(&#x27;query parser&#x27;, &#x27;extended&#x27;);
  this.set(&#x27;subdomain offset&#x27;, 2);
  this.set(&#x27;trust proxy&#x27;, false);

  // trust proxy inherit back-compat
  Object.defineProperty(this.settings, trustProxyDefaultSymbol, {
    configurable: true,
    value: true
  });

  debug(&#x27;booting in %s mode&#x27;, env);

  this.on(&#x27;mount&#x27;, function onmount(parent) {
    // inherit trust proxy
    if (this.settings[trustProxyDefaultSymbol] === true
      &#x26;&#x26; typeof parent.settings[&#x27;trust proxy fn&#x27;] === &#x27;function&#x27;) {
      delete this.settings[&#x27;trust proxy&#x27;];
      delete this.settings[&#x27;trust proxy fn&#x27;];
    }

    // inherit protos
    this.request.__proto__ = parent.request;
    this.response.__proto__ = parent.response;
    this.engines.__proto__ = parent.engines;
    this.settings.__proto__ = parent.settings;
  });

  // setup locals
  this.locals = Object.create(null);

  // top-most app is mounted at /
  this.mountpath = &#x27;/&#x27;;

  // default locals
  this.locals.settings = this.settings;

  // default configuration
  this.set(&#x27;view&#x27;, View);
  this.set(&#x27;views&#x27;, resolve(&#x27;views&#x27;));
  this.set(&#x27;jsonp callback name&#x27;, &#x27;callback&#x27;);

  if (env === &#x27;production&#x27;) {
    this.enable(&#x27;view cache&#x27;);
  }

  Object.defineProperty(this, &#x27;router&#x27;, {
    get: function() {
      throw new Error(&#x27;\&#x27;app.router\&#x27; is deprecated!\nPlease see the 3.x to 4.x migration guide for details on how to update your
 app.&#x27;);
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.del" id="apidoc.element.keystone.express.application.del">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>del
        <span class="apidocSignatureSpan">(arg0)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">del = function (arg0) {
&#x22;use strict&#x22;
log.call(deprecate, message, site)
return fn.apply(this, arguments)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.delete" id="apidoc.element.keystone.express.application.delete">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>delete
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">delete = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.disable" id="apidoc.element.keystone.express.application.disable">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>disable
        <span class="apidocSignatureSpan">(setting)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function disable(setting) {
  return this.set(setting, false);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...


module.exports = function initTrustProxy (keystone, app) {
	// Process &#x27;X-Forwarded-For&#x27; request header
	if (keystone.get(&#x27;trust proxy&#x27;) === true) {
		app.enable(&#x27;trust proxy&#x27;);
	} else {
		app.<span class="apidocCodeKeywordSpan">disable</span>(&#x27;trust proxy&#x27;);
	}
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.disabled" id="apidoc.element.keystone.express.application.disabled">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>disabled
        <span class="apidocSignatureSpan">(setting)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function disabled(setting) {
  return !this.set(setting);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.enable" id="apidoc.element.keystone.express.application.enable">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>enable
        <span class="apidocSignatureSpan">(setting)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function enable(setting) {
  return this.set(setting, true);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...




module.exports = function initTrustProxy (keystone, app) {
	// Process &#x27;X-Forwarded-For&#x27; request header
	if (keystone.get(&#x27;trust proxy&#x27;) === true) {
		app.<span class="apidocCodeKeywordSpan">enable</span>(&#x27;trust proxy&#x27;);
	} else {
		app.disable(&#x27;trust proxy&#x27;);
	}
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.enabled" id="apidoc.element.keystone.express.application.enabled">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>enabled
        <span class="apidocSignatureSpan">(setting)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function enabled(setting) {
  return Boolean(this.set(setting));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.engine" id="apidoc.element.keystone.express.application.engine">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>engine
        <span class="apidocSignatureSpan">(ext, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function engine(ext, fn) {
  if (typeof fn !== &#x27;function&#x27;) {
    throw new Error(&#x27;callback function required&#x27;);
  }

  // get file extension
  var extension = ext[0] !== &#x27;.&#x27;
    ? &#x27;.&#x27; + ext
    : ext;

  // store engine
  this.engines[extension] = fn;

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...


var path = require(&#x27;path&#x27;);

module.exports = function initViewEngine (keystone, app) {
	// Allow usage of custom view engines
	if (keystone.get(&#x27;custom engine&#x27;)) {
		app.<span class="apidocCodeKeywordSpan">engine</span>(keystone.get(&#x27;view engine&#x27;), keystone.get(&#x27;custom engine&#
x27;));
	}

	// Set location of view templates and view engine
	app.set(&#x27;views&#x27;, keystone.getPath(&#x27;views&#x27;) || path.sep + &#x27;views&#x27;);
	app.set(&#x27;view engine&#x27;, keystone.get(&#x27;view engine&#x27;));

	var customView = keystone.get(&#x27;view&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.get" id="apidoc.element.keystone.express.application.get">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>get
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	this.set(&#x27;ssl&#x27;, process.env.SSL);
	this.set(&#x27;ssl port&#x27;, process.env.SSL_PORT || &#x27;3001&#x27;);
	this.set(&#x27;ssl host&#x27;, process.env.SSL_HOST || process.env.SSL_IP);
	this.set(&#x27;ssl key&#x27;, process.env.SSL_KEY);
	this.set(&#x27;ssl cert&#x27;, process.env.SSL_CERT);

	this.set(&#x27;cookie secret&#x27;, process.env.COOKIE_SECRET);
	this.set(&#x27;cookie signin&#x27;, (this.<span class="apidocCodeKeywordSpan">get</span>(&#x27;env&#x27;) === &#x27;development
&#x27;) ? true : false);

	this.set(&#x27;embedly api key&#x27;, process.env.EMBEDLY_API_KEY || process.env.EMBEDLY_APIKEY);
	this.set(&#x27;mandrill api key&#x27;, process.env.MANDRILL_API_KEY || process.env.MANDRILL_APIKEY);
	this.set(&#x27;mandrill username&#x27;, process.env.MANDRILL_USERNAME);
	this.set(&#x27;google api key&#x27;, process.env.GOOGLE_BROWSER_KEY);
	this.set(&#x27;google server api key&#x27;, process.env.GOOGLE_SERVER_KEY);
	this.set(&#x27;ga property&#x27;, process.env.GA_PROPERTY);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.handle" id="apidoc.element.keystone.express.application.handle">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>handle
        <span class="apidocSignatureSpan">(req, res, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function handle(req, res, callback) {
  var router = this._router;

  // final handler
  var done = callback || finalhandler(req, res, {
    env: this.get(&#x27;env&#x27;),
    onerror: logerror.bind(this)
  });

  // no routes
  if (!router) {
    debug(&#x27;no routes defined on app&#x27;);
    done();
    return;
  }

  router.handle(req, res, done);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.head" id="apidoc.element.keystone.express.application.head">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>head
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">head = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.init" id="apidoc.element.keystone.express.application.init">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>init
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function init() {
  this.cache = {};
  this.engines = {};
  this.settings = {};

  this.defaultConfiguration();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			self.editor = editor;
			editor.on(&#x27;change&#x27;, self.valueChanged);
			editor.on(&#x27;focus&#x27;, self.focusChanged.bind(self, true));
			editor.on(&#x27;blur&#x27;, self.focusChanged.bind(self, false));
		};

		this._currentValue = this.props.value;
		_tinymce2.default.<span class="apidocCodeKeywordSpan">init</span>(opts);
		if ((0, _evalDependsOn2.default)(this.props.dependsOn, this.props.values)) {
			this.setState({ wysiwygActive: true });
		}
	},
	removeWysiwyg: function removeWysiwyg(state) {
		removeTinyMCEInstance(_tinymce2.default.get(state.id));
		this.setState({ wysiwygActive: false });
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.lazyrouter" id="apidoc.element.keystone.express.application.lazyrouter">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>lazyrouter
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function lazyrouter() {
  if (!this._router) {
    this._router = new Router({
      caseSensitive: this.enabled(&#x27;case sensitive routing&#x27;),
      strict: this.enabled(&#x27;strict routing&#x27;)
    });

    this._router.use(query(this.get(&#x27;query parser fn&#x27;)));
    this._router.use(middleware.init(this));
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.link" id="apidoc.element.keystone.express.application.link">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>link
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">link = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.listen" id="apidoc.element.keystone.express.application.listen">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>listen
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function listen() {
  var server = http.createServer(this);
  return server.listen.apply(server, arguments);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	var host = keystone.get(&#x27;host&#x27;);
	var port = keystone.get(&#x27;port&#x27;);
	var forceSsl = (keystone.get(&#x27;ssl&#x27;) === &#x27;force&#x27;);

	keystone.httpServer = http
	.createServer(app)
	.<span class="apidocCodeKeywordSpan">listen</span>(port, host, function ready (err) {
		if (err) { return callback(err); }

		var message = keystone.get(&#x27;name&#x27;) + &#x27; is ready on &#x27;
		+ &#x27;http://&#x27; + host + &#x27;:&#x27; + port
		+ (forceSsl ? &#x27; (SSL redirect)&#x27; : &#x27;&#x27;);
		callback(null, message);
	});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.lock" id="apidoc.element.keystone.express.application.lock">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>lock
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">lock = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.m-search" id="apidoc.element.keystone.express.application.m-search">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>m-search
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">m-search = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.merge" id="apidoc.element.keystone.express.application.merge">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>merge
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">merge = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.mkactivity" id="apidoc.element.keystone.express.application.mkactivity">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>mkactivity
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mkactivity = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.mkcalendar" id="apidoc.element.keystone.express.application.mkcalendar">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>mkcalendar
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mkcalendar = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.mkcol" id="apidoc.element.keystone.express.application.mkcol">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>mkcol
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mkcol = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.move" id="apidoc.element.keystone.express.application.move">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>move
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">move = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	var doMove = function (callback) {

		if (typeof field.options.filename === &#x27;function&#x27;) {
			filename = field.options.filename(item, file);
		}

		fs.<span class="apidocCodeKeywordSpan">move</span>(file.path, path.join(field.options.dest, filename), { clobber: field.options
.overwrite }, function (err) {

			if (err) return callback(err);

			var fileData = {
				filename: filename,
				originalname: file.originalname,
				path: field.options.dest,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.notify" id="apidoc.element.keystone.express.application.notify">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>notify
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">notify = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.options" id="apidoc.element.keystone.express.application.options">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>options
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">options = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var initialFields;

		// Inherit default options from parent list if it exists
		if (options &#x26;&#x26; options.inherits) {
			if (options.inherits.options &#x26;&#x26; options.inherits.options.inherits) {
				throw new Error(&#x27;Inherited Lists may not contain any inheritance&#x27;);
			}
			defaultOptions = utils.<span class="apidocCodeKeywordSpan">options</span>(defaultOptions, options.inherits.options);
			if (options.inherits.options.track) {
				options.track = false;
			}
		}

		this.options = utils.options(defaultOptions, options);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.param" id="apidoc.element.keystone.express.application.param">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>param
        <span class="apidocSignatureSpan">(name, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function param(name, fn) {
  this.lazyrouter();

  if (Array.isArray(name)) {
    for (var i = 0; i &#x3c; name.length; i++) {
      this.param(name[i], fn);
    }

    return this;
  }

  this._router.param(name, fn);

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.patch" id="apidoc.element.keystone.express.application.patch">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>patch
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">patch = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.path" id="apidoc.element.keystone.express.application.path">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>path
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function path() {
  return this.parent
    ? this.parent.path() + this.mountpath
    : &#x27;&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
util.inherits(geopoint, FieldType);

/**
 * Registers the field on the List&#x27;s Mongoose Schema.
 * Adds a 2dsphere indexed lat/lng pair
 */
geopoint.prototype.addToSchema = function (schema) {
	schema.<span class="apidocCodeKeywordSpan">path</span>(this.path, _.defaults({ type: [Number], index: &#x27;2dsphere&#x27; }, this
.options));
	this.bindUnderscoreMethods();
};

/**
 * Gets the field&#x27;s data from an Item, as used by the React components
 */
geopoint.prototype.getData = function (item) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.post" id="apidoc.element.keystone.express.application.post">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>post
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">post = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	// Init API request helpers
	router.use(&#x27;/api&#x27;, require(&#x27;../middleware/apiError&#x27;));
	router.use(&#x27;/api&#x27;, require(&#x27;../middleware/logError&#x27;));

	// #1: Session API
	// TODO: this should respect keystone auth options
	router.get(&#x27;/api/session&#x27;, require(&#x27;../api/session/get&#x27;));
	router.<span class="apidocCodeKeywordSpan">post</span>(&#x27;/api/session/signin&#x27;, require(&#x27;../api/session/signin&#x27
;));
	router.post(&#x27;/api/session/signout&#x27;, require(&#x27;../api/session/signout&#x27;));

	// #2: Session Routes
	// Bind auth middleware (generic or custom) to * routes, allowing
	// access to the generic signin page if generic auth is used
	if (keystone.get(&#x27;auth&#x27;) === true) {
		// TODO: poor separation of concerns; settings should be defaulted elsewhere
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.propfind" id="apidoc.element.keystone.express.application.propfind">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>propfind
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">propfind = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.proppatch" id="apidoc.element.keystone.express.application.proppatch">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>proppatch
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">proppatch = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.purge" id="apidoc.element.keystone.express.application.purge">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>purge
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">purge = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.put" id="apidoc.element.keystone.express.application.put">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>put
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">put = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.rebind" id="apidoc.element.keystone.express.application.rebind">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>rebind
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rebind = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.render" id="apidoc.element.keystone.express.application.render">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>render
        <span class="apidocSignatureSpan">(name, options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function render(name, options, callback) {
  var cache = this.cache;
  var done = callback;
  var engines = this.engines;
  var opts = options;
  var renderOptions = {};
  var view;

  // support callback function as second arg
  if (typeof options === &#x27;function&#x27;) {
    done = options;
    opts = {};
  }

  // merge app.locals
  merge(renderOptions, this.locals);

  // merge options._locals
  if (opts._locals) {
    merge(renderOptions, opts._locals);
  }

  // merge options
  merge(renderOptions, opts);

  // set .cache unless explicitly provided
  if (renderOptions.cache == null) {
    renderOptions.cache = this.enabled(&#x27;view cache&#x27;);
  }

  // primed cache
  if (renderOptions.cache) {
    view = cache[name];
  }

  // view
  if (!view) {
    var View = this.get(&#x27;view&#x27;);

    view = new View(name, {
      defaultEngine: this.get(&#x27;view engine&#x27;),
      root: this.get(&#x27;views&#x27;),
      engines: engines
    });

    if (!view.path) {
      var dirs = Array.isArray(view.root) &#x26;&#x26; view.root.length &#x3e; 1
        ? &#x27;directories &#x22;&#x27; + view.root.slice(0, -1).join(&#x27;&#x22;, &#x22;&#x27;) + &#x27;&#x22; or &#x22;&#x27; + view.root[view.root.length - 1] + &#x27;&#x22;&#x27;
        : &#x27;directory &#x22;&#x27; + view.root + &#x27;&#x22;&#x27;
      var err = new Error(&#x27;Failed to lookup view &#x22;&#x27; + name + &#x27;&#x22; in views &#x27; + dirs);
      err.view = view;
      return done(err);
    }

    // prime the cache
    if (renderOptions.cache) {
      cache[name] = view;
    }
  }

  // render
  tryRender(view, renderOptions, done);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			try {
				if (typeof err404 === &#x27;function&#x27;) {
					return err404(req, res, next);
				} else if (typeof err404 === &#x27;string&#x27;) {
					if (req.headers.accept === &#x27;application/json&#x27;) {
						return res.status(404).json({ error: &#x27;not found&#x27; });
					}
					return res.status(404).<span class="apidocCodeKeywordSpan">render</span>(err404);
				} else {
					if (keystone.get(&#x27;logger&#x27;)) {
						console.log(dashes + &#x27;Error handling 404 (not found): Invalid type (&#x27; + (typeof err404) + &#x27;) for 404 setting
.&#x27; + dashes);
					}
					return default404Handler(req, res, next);
				}
			} catch (e) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.report" id="apidoc.element.keystone.express.application.report">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>report
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">report = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.route" id="apidoc.element.keystone.express.application.route">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>route
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function route(path) {
  this.lazyrouter();
  return this._router.route(path);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.search" id="apidoc.element.keystone.express.application.search">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>search
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">search = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.set" id="apidoc.element.keystone.express.application.set">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>set
        <span class="apidocSignatureSpan">(setting, val)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function set(setting, val) {
  if (arguments.length === 1) {
    // app.get(setting)
    return this.settings[setting];
  }

  debug(&#x27;set &#x22;%s&#x22; to %o&#x27;, setting, val);

  // set value
  this.settings[setting] = val;

  // trigger matched settings
  switch (setting) {
    case &#x27;etag&#x27;:
      this.set(&#x27;etag fn&#x27;, compileETag(val));
      break;
    case &#x27;query parser&#x27;:
      this.set(&#x27;query parser fn&#x27;, compileQueryParser(val));
      break;
    case &#x27;trust proxy&#x27;:
      this.set(&#x27;trust proxy fn&#x27;, compileTrust(val));

      // trust proxy inherit back-compat
      Object.defineProperty(this.settings, trustProxyDefaultSymbol, {
        configurable: true,
        value: false
      });

      break;
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Alternatively, to include Keystone in an existing project or start from scratch (without Yeoman), specify `keystone: &#x22;^0.3.
9&#x22;` in the `dependencies` array of your `package.json` file, and run `npm install` from your terminal.

Then read through the [Documentation](http://keystonejs.com/docs) and the [Example Projects](http://keystonejs.com/examples) to
understand how to use it.

### Configuration

Config variables can be passed in an object to the `keystone.init` method, or can be set any time before `keystone.start` is called
 using `keystone.<span class="apidocCodeKeywordSpan">set</span>(key, value)`. This allows for a more flexible order of execution
 (e.g. if you refer to Lists in your routes, you can set the routes after configuring your Lists, as in the example above).

See the [KeystoneJS configuration documentation](http://keystonejs.com/docs/configuration) for details and examples of the available
 configuration options.

### Database field types

Keystone builds on the basic data types provided by mongo and allows you to easily add rich, functional fields to your application
&#x27;s models.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.subscribe" id="apidoc.element.keystone.express.application.subscribe">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>subscribe
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">subscribe = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.trace" id="apidoc.element.keystone.express.application.trace">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>trace
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">trace = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		},

	], function (err) {

		if (err) {
			console.error(err);
			if (&#x27;stack&#x27; in err) {
				console.<span class="apidocCodeKeywordSpan">trace</span>(err.stack);
			}
			return callback &#x26;&#x26; callback(err);
		}

		var msg = &#x27;\nSuccessfully created:\n&#x27;;
		_.forEach(stats, function (list) {
			msg += &#x27;\n*   &#x27; + utils.plural(list.created, &#x27;* &#x27; + list.singular, &#x27;* &#x27; + list.plural);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.unbind" id="apidoc.element.keystone.express.application.unbind">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>unbind
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unbind = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.unlink" id="apidoc.element.keystone.express.application.unlink">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>unlink
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unlink = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var fs = require(&#x27;fs&#x27;);

module.exports = function (keystone, app, callback) {

	var unixSocket = keystone.get(&#x27;unix socket&#x27;);
	var message = keystone.get(&#x27;name&#x27;) + &#x27; is ready on &#x27; + unixSocket;

	fs.<span class="apidocCodeKeywordSpan">unlink</span>(unixSocket, function () {
		// we expect err if the file is new so don&#x27;t capture the argument
		keystone.httpServer = app.listen(unixSocket, function (err) {
			callback(err, message);
		});
		fs.chmod(unixSocket, 0x777);
	});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.unlock" id="apidoc.element.keystone.express.application.unlock">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>unlock
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unlock = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.unsubscribe" id="apidoc.element.keystone.express.application.unsubscribe">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>unsubscribe
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unsubscribe = function (path){
  if (method === &#x27;get&#x27; &#x26;&#x26; arguments.length === 1) {
    // app.get(setting)
    return this.set(path);
  }

  this.lazyrouter();

  var route = this._router.route(path);
  route[method].apply(route, slice.call(arguments, 1));
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.application.use" id="apidoc.element.keystone.express.application.use">
        function <span class="apidocSignatureSpan">keystone.express.application.</span>use
        <span class="apidocSignatureSpan">(fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function use(fn) {
  var offset = 0;
  var path = &#x27;/&#x27;;

  // default path to &#x27;/&#x27;
  // disambiguate app.use([fn])
  if (typeof fn !== &#x27;function&#x27;) {
    var arg = fn;

    while (Array.isArray(arg) &#x26;&#x26; arg.length !== 0) {
      arg = arg[0];
    }

    // first arg is the path
    if (typeof arg !== &#x27;function&#x27;) {
      offset = 1;
      path = fn;
    }
  }

  var fns = flatten(slice.call(arguments, offset));

  if (fns.length === 0) {
    throw new TypeError(&#x27;app.use() requires middleware functions&#x27;);
  }

  // setup router
  this.lazyrouter();
  var router = this._router;

  fns.forEach(function (fn) {
    // non-express app
    if (!fn || !fn.handle || !fn.set) {
      return router.use(path, fn);
    }

    debug(&#x27;.use app under %s&#x27;, path);
    fn.mountpath = path;
    fn.parent = this;

    // restore .app property on req and res
    router.use(path, function mounted_app(req, res, next) {
      var orig = req.app;
      fn.handle(req, res, function (err) {
        req.__proto__ = orig.request;
        res.__proto__ = orig.response;
        next(err);
      });
    });

    // mounted an app
    fn.emit(&#x27;mount&#x27;, this);
  }, this);

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

module.exports = function bindIPRestrictions (keystone, app) {
	// Set up body options and cookie parser
	var bodyParserParams = {};
	if (keystone.get(&#x27;file limit&#x27;)) {
		bodyParserParams.limit = keystone.get(&#x27;file limit&#x27;);
	}
	app.<span class="apidocCodeKeywordSpan">use</span>(bodyParser.json(bodyParserParams));
	bodyParserParams.extended = true;
	app.use(bodyParser.urlencoded(bodyParserParams));
	app.use(multer({
		includeEmptyFields: true,
	}));
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.express.request" id="apidoc.module.keystone.express.request">module keystone.express.request</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.express.request.accepts" id="apidoc.element.keystone.express.request.accepts">
        function <span class="apidocSignatureSpan">keystone.express.request.</span>accepts
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">accepts = function (){
  var accept = accepts(this);
  return accept.types.apply(accept, arguments);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.request.acceptsCharset" id="apidoc.element.keystone.express.request.acceptsCharset">
        function <span class="apidocSignatureSpan">keystone.express.request.</span>acceptsCharset
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">acceptsCharset = function () {
&#x22;use strict&#x22;
log.call(deprecate, message, site)
return fn.apply(this, arguments)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.request.acceptsCharsets" id="apidoc.element.keystone.express.request.acceptsCharsets">
        function <span class="apidocSignatureSpan">keystone.express.request.</span>acceptsCharsets
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">acceptsCharsets = function (){
  var accept = accepts(this);
  return accept.charsets.apply(accept, arguments);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.request.acceptsEncoding" id="apidoc.element.keystone.express.request.acceptsEncoding">
        function <span class="apidocSignatureSpan">keystone.express.request.</span>acceptsEncoding
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">acceptsEncoding = function () {
&#x22;use strict&#x22;
log.call(deprecate, message, site)
return fn.apply(this, arguments)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.request.acceptsEncodings" id="apidoc.element.keystone.express.request.acceptsEncodings">
        function <span class="apidocSignatureSpan">keystone.express.request.</span>acceptsEncodings
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">acceptsEncodings = function (){
  var accept = accepts(this);
  return accept.encodings.apply(accept, arguments);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.request.acceptsLanguage" id="apidoc.element.keystone.express.request.acceptsLanguage">
        function <span class="apidocSignatureSpan">keystone.express.request.</span>acceptsLanguage
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">acceptsLanguage = function () {
&#x22;use strict&#x22;
log.call(deprecate, message, site)
return fn.apply(this, arguments)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.request.acceptsLanguages" id="apidoc.element.keystone.express.request.acceptsLanguages">
        function <span class="apidocSignatureSpan">keystone.express.request.</span>acceptsLanguages
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">acceptsLanguages = function (){
  var accept = accepts(this);
  return accept.languages.apply(accept, arguments);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.request.get" id="apidoc.element.keystone.express.request.get">
        function <span class="apidocSignatureSpan">keystone.express.request.</span>get
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function header(name) {
  if (!name) {
    throw new TypeError(&#x27;name argument is required to req.get&#x27;);
  }

  if (typeof name !== &#x27;string&#x27;) {
    throw new TypeError(&#x27;name must be a string to req.get&#x27;);
  }

  var lc = name.toLowerCase();

  switch (lc) {
    case &#x27;referer&#x27;:
    case &#x27;referrer&#x27;:
      return this.headers.referrer
        || this.headers.referer;
    default:
      return this.headers[lc];
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	this.set(&#x27;ssl&#x27;, process.env.SSL);
	this.set(&#x27;ssl port&#x27;, process.env.SSL_PORT || &#x27;3001&#x27;);
	this.set(&#x27;ssl host&#x27;, process.env.SSL_HOST || process.env.SSL_IP);
	this.set(&#x27;ssl key&#x27;, process.env.SSL_KEY);
	this.set(&#x27;ssl cert&#x27;, process.env.SSL_CERT);

	this.set(&#x27;cookie secret&#x27;, process.env.COOKIE_SECRET);
	this.set(&#x27;cookie signin&#x27;, (this.<span class="apidocCodeKeywordSpan">get</span>(&#x27;env&#x27;) === &#x27;development
&#x27;) ? true : false);

	this.set(&#x27;embedly api key&#x27;, process.env.EMBEDLY_API_KEY || process.env.EMBEDLY_APIKEY);
	this.set(&#x27;mandrill api key&#x27;, process.env.MANDRILL_API_KEY || process.env.MANDRILL_APIKEY);
	this.set(&#x27;mandrill username&#x27;, process.env.MANDRILL_USERNAME);
	this.set(&#x27;google api key&#x27;, process.env.GOOGLE_BROWSER_KEY);
	this.set(&#x27;google server api key&#x27;, process.env.GOOGLE_SERVER_KEY);
	this.set(&#x27;ga property&#x27;, process.env.GA_PROPERTY);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.request.header" id="apidoc.element.keystone.express.request.header">
        function <span class="apidocSignatureSpan">keystone.express.request.</span>header
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function header(name) {
  if (!name) {
    throw new TypeError(&#x27;name argument is required to req.get&#x27;);
  }

  if (typeof name !== &#x27;string&#x27;) {
    throw new TypeError(&#x27;name must be a string to req.get&#x27;);
  }

  var lc = name.toLowerCase();

  switch (lc) {
    case &#x27;referer&#x27;:
    case &#x27;referrer&#x27;:
      return this.headers.referrer
        || this.headers.referer;
    default:
      return this.headers[lc];
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// passed as middeware to the express app.

module.exports = function (keystone) {
	return function cors (req, res, next) {

		var origin = keystone.get(&#x27;cors allow origin&#x27;);
		if (origin) {
			res.<span class="apidocCodeKeywordSpan">header</span>(&#x27;Access-Control-Allow-Origin&#x27;, origin === true ? &#x27;*&#x27
; : origin);
		}

		if (keystone.get(&#x27;cors allow methods&#x27;) !== false) {
			res.header(&#x27;Access-Control-Allow-Methods&#x27;, keystone.get(&#x27;cors allow methods&#x27;) || &#x27;GET,PUT,POST,DELETE
,OPTIONS&#x27;);
		}
		if (keystone.get(&#x27;cors allow headers&#x27;) !== false) {
			res.header(&#x27;Access-Control-Allow-Headers&#x27;, keystone.get(&#x27;cors allow headers&#x27;) || &#x27;Content-Type, Authorization
&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.request.is" id="apidoc.element.keystone.express.request.is">
        function <span class="apidocSignatureSpan">keystone.express.request.</span>is
        <span class="apidocSignatureSpan">(types)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function is(types) {
  var arr = types;

  // support flattened arguments
  if (!Array.isArray(types)) {
    arr = new Array(arguments.length);
    for (var i = 0; i &#x3c; arr.length; i++) {
      arr[i] = arguments[i];
    }
  }

  return typeis(this, arr);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					instance.setFullscreen(true);
				});
			}

			editor.append(editorHeader);

			// Wrap the textarea
			if (container.<span class="apidocCodeKeywordSpan">is</span>(&#x27;textarea&#x27;)) {
				container.before(editor);
				textarea = container;
				textarea.addClass(&#x27;md-input&#x27;);
				editor.append(textarea);
			} else {
				var rawContent = typeof toMarkdown == &#x27;function&#x27; ? toMarkdown(container.html()) : container.html(),
				    currentContent = $.trim(rawContent);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.request.param" id="apidoc.element.keystone.express.request.param">
        function <span class="apidocSignatureSpan">keystone.express.request.</span>param
        <span class="apidocSignatureSpan">(name, defaultValue)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function param(name, defaultValue) {
  var params = this.params || {};
  var body = this.body || {};
  var query = this.query || {};

  var args = arguments.length === 1
    ? &#x27;name&#x27;
    : &#x27;name, default&#x27;;
  deprecate(&#x27;req.param(&#x27; + args + &#x27;): Use req.params, req.body, or req.query instead&#x27;);

  if (null != params[name] &#x26;&#x26; params.hasOwnProperty(name)) return params[name];
  if (null != body[name]) return body[name];
  if (null != query[name]) return query[name];

  return defaultValue;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.request.range" id="apidoc.element.keystone.express.request.range">
        function <span class="apidocSignatureSpan">keystone.express.request.</span>range
        <span class="apidocSignatureSpan">(size, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function range(size, options) {
  var range = this.get(&#x27;Range&#x27;);
  if (!range) return;
  return parseRange(size, range, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.express.response" id="apidoc.module.keystone.express.response">module keystone.express.response</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.express.response.append" id="apidoc.element.keystone.express.response.append">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>append
        <span class="apidocSignatureSpan">(field, val)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function append(field, val) {
  var prev = this.get(field);
  var value = val;

  if (prev) {
    // concat the new and prev vals
    value = Array.isArray(prev) ? prev.concat(val)
      : Array.isArray(val) ? [prev].concat(val)
      : [prev, val];
  }

  return this.set(field, value);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
						buttonContainer.attr(&#x27;data-toggle&#x27;, &#x27;button&#x27;);
					}
					buttonIconContainer = $(&#x27;&#x3c;span/&#x3e;&#x27;);
					buttonIconContainer.addClass(buttonIcon);
					buttonIconContainer.prependTo(buttonContainer);

					// Attach the button object
					btnGroupContainer.<span class="apidocCodeKeywordSpan">append</span>(buttonContainer);

					// Register handler and callback
					handler.push(buttonHandler);
					callback.push(button.callback);
				}

				// Attach the button group into container dom
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.attachment" id="apidoc.element.keystone.express.response.attachment">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>attachment
        <span class="apidocSignatureSpan">(filename)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function attachment(filename) {
  if (filename) {
    this.type(extname(filename));
  }

  this.set(&#x27;Content-Disposition&#x27;, contentDisposition(filename));

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	}
	query.exec(function (err, results) {

		if (err) return res.status(500).json(err);

		var sendCSV = function (data) {

			res.<span class="apidocCodeKeywordSpan">attachment</span>(req.list.path + &#x27;-&#x27; + moment().format(&#x27;YYYYMMDD-HHMMSS
&#x27;) + &#x27;.csv&#x27;);
			res.setHeader(&#x27;Content-Type&#x27;, &#x27;application/octet-stream&#x27;);

			var content = baby.unparse(data, {
				delimiter: keystone.get(&#x27;csv field delimiter&#x27;) || &#x27;,&#x27;,
			});

			res.end(content, &#x27;utf-8&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.clearCookie" id="apidoc.element.keystone.express.response.clearCookie">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>clearCookie
        <span class="apidocSignatureSpan">(name, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function clearCookie(name, options) {
  var opts = merge({ expires: new Date(1), path: &#x27;/&#x27; }, options);

  return this.cookie(name, &#x27;&#x27;, opts);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.contentType" id="apidoc.element.keystone.express.response.contentType">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>contentType
        <span class="apidocSignatureSpan">(type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function contentType(type) {
  var ct = type.indexOf(&#x27;/&#x27;) === -1
    ? mime.lookup(type)
    : type;

  return this.set(&#x27;Content-Type&#x27;, ct);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.cookie" id="apidoc.element.keystone.express.response.cookie">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>cookie
        <span class="apidocSignatureSpan">(name, value, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">cookie = function (name, value, options) {
  var opts = merge({}, options);
  var secret = this.req.secret;
  var signed = opts.signed;

  if (signed &#x26;&#x26; !secret) {
    throw new Error(&#x27;cookieParser(&#x22;secret&#x22;) required for signed cookies&#x27;);
  }

  var val = typeof value === &#x27;object&#x27;
    ? &#x27;j:&#x27; + JSON.stringify(value)
    : String(value);

  if (signed) {
    val = &#x27;s:&#x27; + sign(val, secret);
  }

  if (&#x27;maxAge&#x27; in opts) {
    opts.expires = new Date(Date.now() + opts.maxAge);
    opts.maxAge /= 1000;
  }

  if (opts.path == null) {
    opts.path = &#x27;/&#x27;;
  }

  this.append(&#x27;Set-Cookie&#x27;, cookie.serialize(name, String(val), opts));

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

exports.createToken = function (req) {
	return tokenize(utils.randomString(exports.SECRET_LENGTH), exports.getSecret(req));
};

exports.getToken = function (req, res) {
	res.locals[exports.LOCAL_VALUE] = res.locals[exports.LOCAL_VALUE] || exports.createToken(req);
	res.<span class="apidocCodeKeywordSpan">cookie</span>(exports.XSRF_COOKIE_KEY, res.locals[exports.LOCAL_VALUE]);
	return res.locals[exports.LOCAL_VALUE];
};

exports.requestToken = function (req) {
	if (req.body &#x26;&#x26; req.body[exports.TOKEN_KEY]) {
		return req.body[exports.TOKEN_KEY];
	} else if (req.query &#x26;&#x26; req.query[exports.TOKEN_KEY]) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.download" id="apidoc.element.keystone.express.response.download">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>download
        <span class="apidocSignatureSpan">(path, filename, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function download(path, filename, callback) {
  var done = callback;
  var name = filename;

  // support function as second arg
  if (typeof filename === &#x27;function&#x27;) {
    done = filename;
    name = null;
  }

  // set Content-Disposition when file is sent
  var headers = {
    &#x27;Content-Disposition&#x27;: contentDisposition(name || path)
  };

  // Resolve the full path for sendFile
  var fullPath = resolve(path);

  return this.sendFile(fullPath, { headers: headers }, done);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.format" id="apidoc.element.keystone.express.response.format">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>format
        <span class="apidocSignatureSpan">(obj)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">format = function (obj){
  var req = this.req;
  var next = req.next;

  var fn = obj.default;
  if (fn) delete obj.default;
  var keys = Object.keys(obj);

  var key = keys.length &#x3e; 0
    ? req.accepts(keys)
    : false;

  this.vary(&#x22;Accept&#x22;);

  if (key) {
    this.set(&#x27;Content-Type&#x27;, normalizeType(key).value);
    obj[key](req, this, next);
  } else if (fn) {
    fn();
  } else {
    var err = new Error(&#x27;Not Acceptable&#x27;);
    err.status = err.statusCode = 406;
    err.types = normalizeTypes(keys).map(function(o){ return o.value });
    next(err);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var value = item.get(field.path);
		if (transform.length === 1) {
			return value[transform[0]];
		} else {
			return _.pick(value, transform);
		}
	}
	return field.<span class="apidocCodeKeywordSpan">format</span>(item);
}

/**
 * Gets the data from an Item ready to be serialised to CSV for download
 */

function getCSVData (item, options) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.get" id="apidoc.element.keystone.express.response.get">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>get
        <span class="apidocSignatureSpan">(field)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (field){
  return this.getHeader(field);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	this.set(&#x27;ssl&#x27;, process.env.SSL);
	this.set(&#x27;ssl port&#x27;, process.env.SSL_PORT || &#x27;3001&#x27;);
	this.set(&#x27;ssl host&#x27;, process.env.SSL_HOST || process.env.SSL_IP);
	this.set(&#x27;ssl key&#x27;, process.env.SSL_KEY);
	this.set(&#x27;ssl cert&#x27;, process.env.SSL_CERT);

	this.set(&#x27;cookie secret&#x27;, process.env.COOKIE_SECRET);
	this.set(&#x27;cookie signin&#x27;, (this.<span class="apidocCodeKeywordSpan">get</span>(&#x27;env&#x27;) === &#x27;development
&#x27;) ? true : false);

	this.set(&#x27;embedly api key&#x27;, process.env.EMBEDLY_API_KEY || process.env.EMBEDLY_APIKEY);
	this.set(&#x27;mandrill api key&#x27;, process.env.MANDRILL_API_KEY || process.env.MANDRILL_APIKEY);
	this.set(&#x27;mandrill username&#x27;, process.env.MANDRILL_USERNAME);
	this.set(&#x27;google api key&#x27;, process.env.GOOGLE_BROWSER_KEY);
	this.set(&#x27;google server api key&#x27;, process.env.GOOGLE_SERVER_KEY);
	this.set(&#x27;ga property&#x27;, process.env.GA_PROPERTY);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.header" id="apidoc.element.keystone.express.response.header">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>header
        <span class="apidocSignatureSpan">(field, val)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function header(field, val) {
  if (arguments.length === 2) {
    var value = Array.isArray(val)
      ? val.map(String)
      : String(val);

    // add charset to content-type
    if (field.toLowerCase() === &#x27;content-type&#x27; &#x26;&#x26; !charsetRegExp.test(value)) {
      var charset = mime.charsets.lookup(value.split(&#x27;;&#x27;)[0]);
      if (charset) value += &#x27;; charset=&#x27; + charset.toLowerCase();
    }

    this.setHeader(field, value);
  } else {
    for (var key in field) {
      this.set(key, field[key]);
    }
  }
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// passed as middeware to the express app.

module.exports = function (keystone) {
	return function cors (req, res, next) {

		var origin = keystone.get(&#x27;cors allow origin&#x27;);
		if (origin) {
			res.<span class="apidocCodeKeywordSpan">header</span>(&#x27;Access-Control-Allow-Origin&#x27;, origin === true ? &#x27;*&#x27
; : origin);
		}

		if (keystone.get(&#x27;cors allow methods&#x27;) !== false) {
			res.header(&#x27;Access-Control-Allow-Methods&#x27;, keystone.get(&#x27;cors allow methods&#x27;) || &#x27;GET,PUT,POST,DELETE
,OPTIONS&#x27;);
		}
		if (keystone.get(&#x27;cors allow headers&#x27;) !== false) {
			res.header(&#x27;Access-Control-Allow-Headers&#x27;, keystone.get(&#x27;cors allow headers&#x27;) || &#x27;Content-Type, Authorization
&#x27;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.json" id="apidoc.element.keystone.express.response.json">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>json
        <span class="apidocSignatureSpan">(obj)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function json(obj) {
  var val = obj;

  // allow status / body
  if (arguments.length === 2) {
    // res.json(body, status) backwards compat
    if (typeof arguments[1] === &#x27;number&#x27;) {
      deprecate(&#x27;res.json(obj, status): Use res.status(status).json(obj) instead&#x27;);
      this.statusCode = arguments[1];
    } else {
      deprecate(&#x27;res.json(status, obj): Use res.status(status).json(obj) instead&#x27;);
      this.statusCode = arguments[0];
      val = arguments[1];
    }
  }

  // settings
  var app = this.app;
  var replacer = app.get(&#x27;json replacer&#x27;);
  var spaces = app.get(&#x27;json spaces&#x27;);
  var body = stringify(val, replacer, spaces);

  // content-type
  if (!this.get(&#x27;Content-Type&#x27;)) {
    this.set(&#x27;Content-Type&#x27;, &#x27;application/json&#x27;);
  }

  return this.send(body);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

module.exports = function bindIPRestrictions (keystone, app) {
	// Set up body options and cookie parser
	var bodyParserParams = {};
	if (keystone.get(&#x27;file limit&#x27;)) {
		bodyParserParams.limit = keystone.get(&#x27;file limit&#x27;);
	}
	app.use(bodyParser.<span class="apidocCodeKeywordSpan">json</span>(bodyParserParams));
	bodyParserParams.extended = true;
	app.use(bodyParser.urlencoded(bodyParserParams));
	app.use(multer({
		includeEmptyFields: true,
	}));
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.jsonp" id="apidoc.element.keystone.express.response.jsonp">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>jsonp
        <span class="apidocSignatureSpan">(obj)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function jsonp(obj) {
  var val = obj;

  // allow status / body
  if (arguments.length === 2) {
    // res.json(body, status) backwards compat
    if (typeof arguments[1] === &#x27;number&#x27;) {
      deprecate(&#x27;res.jsonp(obj, status): Use res.status(status).json(obj) instead&#x27;);
      this.statusCode = arguments[1];
    } else {
      deprecate(&#x27;res.jsonp(status, obj): Use res.status(status).jsonp(obj) instead&#x27;);
      this.statusCode = arguments[0];
      val = arguments[1];
    }
  }

  // settings
  var app = this.app;
  var replacer = app.get(&#x27;json replacer&#x27;);
  var spaces = app.get(&#x27;json spaces&#x27;);
  var body = stringify(val, replacer, spaces);
  var callback = this.req.query[app.get(&#x27;jsonp callback name&#x27;)];

  // content-type
  if (!this.get(&#x27;Content-Type&#x27;)) {
    this.set(&#x27;X-Content-Type-Options&#x27;, &#x27;nosniff&#x27;);
    this.set(&#x27;Content-Type&#x27;, &#x27;application/json&#x27;);
  }

  // fixup callback
  if (Array.isArray(callback)) {
    callback = callback[0];
  }

  // jsonp
  if (typeof callback === &#x27;string&#x27; &#x26;&#x26; callback.length !== 0) {
    this.charset = &#x27;utf-8&#x27;;
    this.set(&#x27;X-Content-Type-Options&#x27;, &#x27;nosniff&#x27;);
    this.set(&#x27;Content-Type&#x27;, &#x27;text/javascript&#x27;);

    // restrict callback charset
    callback = callback.replace(/[^\[\]\w$.]/g, &#x27;&#x27;);

    // replace chars not allowed in JavaScript that are in JSON
    body = body
      .replace(/\u2028/g, &#x27;\\u2028&#x27;)
      .replace(/\u2029/g, &#x27;\\u2029&#x27;);

    // the /**/ is a specific security mitigation for &#x22;Rosetta Flash JSONP abuse&#x22;
    // the typeof check is just to reduce client error noise
    body = &#x27;/**/ typeof &#x27; + callback + &#x27; === \&#x27;function\&#x27; &#x26;&#x26; &#x27; + callback + &#x27;(&#x27; + body + &#x27;);&#x27;;
  }

  return this.send(body);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// passed as middeware to the express app.

module.exports = function (keystone) {
	return function initAPI (req, res, next) {

		res.apiResponse = function (data) {
			if (req.query.callback) {
				res.<span class="apidocCodeKeywordSpan">jsonp</span>(data);
			} else {
				res.json(data);
			}
		};

		res.apiError = function (key, err, msg, code) {
			msg = msg || &#x27;Error&#x27;;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.links" id="apidoc.element.keystone.express.response.links">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>links
        <span class="apidocSignatureSpan">(links)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">links = function (links){
  var link = this.get(&#x27;Link&#x27;) || &#x27;&#x27;;
  if (link) link += &#x27;, &#x27;;
  return this.set(&#x27;Link&#x27;, link + Object.keys(links).map(function(rel){
    return &#x27;&#x3c;&#x27; + links[rel] + &#x27;&#x3e;; rel=&#x22;&#x27; + rel + &#x27;&#x22;&#x27;;
  }).join(&#x27;, &#x27;));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.location" id="apidoc.element.keystone.express.response.location">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>location
        <span class="apidocSignatureSpan">(url)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function location(url) {
  var loc = url;

  // &#x22;back&#x22; is an alias for the referrer
  if (url === &#x27;back&#x27;) {
    loc = this.req.get(&#x27;Referrer&#x27;) || &#x27;/&#x27;;
  }

  // set location
  return this.set(&#x27;Location&#x27;, encodeUrl(loc));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.redirect" id="apidoc.element.keystone.express.response.redirect">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>redirect
        <span class="apidocSignatureSpan">(url)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function redirect(url) {
  var address = url;
  var body;
  var status = 302;

  // allow status / url
  if (arguments.length === 2) {
    if (typeof arguments[0] === &#x27;number&#x27;) {
      status = arguments[0];
      address = arguments[1];
    } else {
      deprecate(&#x27;res.redirect(url, status): Use res.redirect(status, url) instead&#x27;);
      status = arguments[1];
    }
  }

  // Set location header
  address = this.location(address).get(&#x27;Location&#x27;);

  // Support text/{plain,html} by default
  this.format({
    text: function(){
      body = statusCodes[status] + &#x27;. Redirecting to &#x27; + address;
    },

    html: function(){
      var u = escapeHtml(address);
      body = &#x27;&#x3c;p&#x3e;&#x27; + statusCodes[status] + &#x27;. Redirecting to &#x3c;a href=&#x22;&#x27; + u + &#x27;&#x22;&#x3e;&#x27; + u + &#x27;&#x3c;/a&#x3e;&#x3c;/p&#x3e;&#x27;;
    },

    default: function(){
      body = &#x27;&#x27;;
    }
  });

  // Respond
  this.statusCode = status;
  this.set(&#x27;Content-Length&#x27;, Buffer.byteLength(body));

  if (this.req.method === &#x27;HEAD&#x27;) {
    this.end();
  } else {
    this.end(body);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



module.exports = function bindErrorHandlers (keystone, app) {
	if (Object.keys(keystone._redirects).length) {
		app.use(function (req, res, next) {
			if (keystone._redirects[req.path]) {
				res.<span class="apidocCodeKeywordSpan">redirect</span>(keystone._redirects[req.path]);
			} else {
				next();
			}
		});
	}
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.render" id="apidoc.element.keystone.express.response.render">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>render
        <span class="apidocSignatureSpan">(view, options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function render(view, options, callback) {
  var app = this.req.app;
  var done = callback;
  var opts = options || {};
  var req = this.req;
  var self = this;

  // support callback function as second arg
  if (typeof options === &#x27;function&#x27;) {
    done = options;
    opts = {};
  }

  // merge res.locals
  opts._locals = self.locals;

  // default callback to respond
  done = done || function (err, str) {
    if (err) return req.next(err);
    self.send(str);
  };

  // render
  app.render(view, opts, done);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			try {
				if (typeof err404 === &#x27;function&#x27;) {
					return err404(req, res, next);
				} else if (typeof err404 === &#x27;string&#x27;) {
					if (req.headers.accept === &#x27;application/json&#x27;) {
						return res.status(404).json({ error: &#x27;not found&#x27; });
					}
					return res.status(404).<span class="apidocCodeKeywordSpan">render</span>(err404);
				} else {
					if (keystone.get(&#x27;logger&#x27;)) {
						console.log(dashes + &#x27;Error handling 404 (not found): Invalid type (&#x27; + (typeof err404) + &#x27;) for 404 setting
.&#x27; + dashes);
					}
					return default404Handler(req, res, next);
				}
			} catch (e) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.send" id="apidoc.element.keystone.express.response.send">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>send
        <span class="apidocSignatureSpan">(body)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function send(body) {
  var chunk = body;
  var encoding;
  var len;
  var req = this.req;
  var type;

  // settings
  var app = this.app;

  // allow status / body
  if (arguments.length === 2) {
    // res.send(body, status) backwards compat
    if (typeof arguments[0] !== &#x27;number&#x27; &#x26;&#x26; typeof arguments[1] === &#x27;number&#x27;) {
      deprecate(&#x27;res.send(body, status): Use res.status(status).send(body) instead&#x27;);
      this.statusCode = arguments[1];
    } else {
      deprecate(&#x27;res.send(status, body): Use res.status(status).send(body) instead&#x27;);
      this.statusCode = arguments[0];
      chunk = arguments[1];
    }
  }

  // disambiguate res.send(status) and res.send(status, num)
  if (typeof chunk === &#x27;number&#x27; &#x26;&#x26; arguments.length === 1) {
    // res.send(status) will set status message as text string
    if (!this.get(&#x27;Content-Type&#x27;)) {
      this.type(&#x27;txt&#x27;);
    }

    deprecate(&#x27;res.send(status): Use res.sendStatus(status) instead&#x27;);
    this.statusCode = chunk;
    chunk = statusCodes[chunk];
  }

  switch (typeof chunk) {
    // string defaulting to html
    case &#x27;string&#x27;:
      if (!this.get(&#x27;Content-Type&#x27;)) {
        this.type(&#x27;html&#x27;);
      }
      break;
    case &#x27;boolean&#x27;:
    case &#x27;number&#x27;:
    case &#x27;object&#x27;:
      if (chunk === null) {
        chunk = &#x27;&#x27;;
      } else if (Buffer.isBuffer(chunk)) {
        if (!this.get(&#x27;Content-Type&#x27;)) {
          this.type(&#x27;bin&#x27;);
        }
      } else {
        return this.json(chunk);
      }
      break;
  }

  // write strings in utf-8
  if (typeof chunk === &#x27;string&#x27;) {
    encoding = &#x27;utf8&#x27;;
    type = this.get(&#x27;Content-Type&#x27;);

    // reflect this in content-type
    if (typeof type === &#x27;string&#x27;) {
      this.set(&#x27;Content-Type&#x27;, setCharset(type, &#x27;utf-8&#x27;));
    }
  }

  // populate Content-Length
  if (chunk !== undefined) {
    if (!Buffer.isBuffer(chunk)) {
      // convert chunk to Buffer; saves later double conversions
      chunk = new Buffer(chunk, encoding);
      encoding = undefined;
    }

    len = chunk.length;
    this.set(&#x27;Content-Length&#x27;, len);
  }

  // populate ETag
  var etag;
  var generateETag = len !== undefined &#x26;&#x26; app.get(&#x27;etag fn&#x27;);
  if (typeof generateETag === &#x27;function&#x27; &#x26;&#x26; !this.get(&#x27;ETag&#x27;)) {
    if ((etag = generateETag(chunk, encoding))) {
      this.set(&#x27;ETag&#x27;, etag);
    }
  }

  // freshness
  if (req.fresh) this.statusCode = 304;

  // strip irrelevant headers
  if (204 === this.statusCode || 304 === this.statusCode) {
    this.removeHeader(&#x27;Content-Type&#x27;);
    this.removeHeader(&#x27;Content-Length&#x27;);
    this.removeHeader(&#x27;Transfer-Encoding&#x27;);
    chunk = &#x27;&#x27;;
  }

  if (req.method === &#x27;HEAD&#x27;) {
    // skip body for HEAD
    this.end();
  } else {
    // respond
    this.end(chunk, encoding);
  }

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	var email = new KeystoneEmail(templateName, options);

	// Make email.send backwards compatible with old argument signature
	var send = email.send;
	email.send = function () {
		var args = [arguments[0]];
		if (typeof arguments[1] === &#x27;function&#x27;) {
			// map .<span class="apidocCodeKeywordSpan">send</span>(options, callback) =&#x3e; .send(locals, options, callback)
			// TOOD: Deprecate this call signature
			args.push(arguments[0]);
			args.push(arguments[1]);
		} else {
			// map .send(locals options, callback) =&#x3e; .send(locals, options, callback)
			args.push(arguments[1]);
			args.push(arguments[2]);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.sendFile" id="apidoc.element.keystone.express.response.sendFile">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>sendFile
        <span class="apidocSignatureSpan">(path, options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function sendFile(path, options, callback) {
  var done = callback;
  var req = this.req;
  var res = this;
  var next = req.next;
  var opts = options || {};

  if (!path) {
    throw new TypeError(&#x27;path argument is required to res.sendFile&#x27;);
  }

  // support function as second arg
  if (typeof options === &#x27;function&#x27;) {
    done = options;
    opts = {};
  }

  if (!opts.root &#x26;&#x26; !isAbsolute(path)) {
    throw new TypeError(&#x27;path must be absolute or specify root to res.sendFile&#x27;);
  }

  // create file stream
  var pathname = encodeURI(path);
  var file = send(req, pathname, opts);

  // transfer
  sendfile(res, file, opts, function (err) {
    if (done) return done(err);
    if (err &#x26;&#x26; err.code === &#x27;EISDIR&#x27;) return next();

    // next() all but write errors
    if (err &#x26;&#x26; err.code !== &#x27;ECONNABORTED&#x27; &#x26;&#x26; err.syscall !== &#x27;write&#x27;) {
      next(err);
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.sendStatus" id="apidoc.element.keystone.express.response.sendStatus">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>sendStatus
        <span class="apidocSignatureSpan">(statusCode)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function sendStatus(statusCode) {
  var body = statusCodes[statusCode] || String(statusCode);

  this.statusCode = statusCode;
  this.type(&#x27;txt&#x27;);

  return this.send(body);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.sendfile" id="apidoc.element.keystone.express.response.sendfile">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>sendfile
        <span class="apidocSignatureSpan">(arg0, arg1, arg2)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendfile = function (arg0, arg1, arg2) {
&#x22;use strict&#x22;
log.call(deprecate, message, site)
return fn.apply(this, arguments)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.set" id="apidoc.element.keystone.express.response.set">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>set
        <span class="apidocSignatureSpan">(field, val)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function header(field, val) {
  if (arguments.length === 2) {
    var value = Array.isArray(val)
      ? val.map(String)
      : String(val);

    // add charset to content-type
    if (field.toLowerCase() === &#x27;content-type&#x27; &#x26;&#x26; !charsetRegExp.test(value)) {
      var charset = mime.charsets.lookup(value.split(&#x27;;&#x27;)[0]);
      if (charset) value += &#x27;; charset=&#x27; + charset.toLowerCase();
    }

    this.setHeader(field, value);
  } else {
    for (var key in field) {
      this.set(key, field[key]);
    }
  }
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Alternatively, to include Keystone in an existing project or start from scratch (without Yeoman), specify `keystone: &#x22;^0.3.
9&#x22;` in the `dependencies` array of your `package.json` file, and run `npm install` from your terminal.

Then read through the [Documentation](http://keystonejs.com/docs) and the [Example Projects](http://keystonejs.com/examples) to
understand how to use it.

### Configuration

Config variables can be passed in an object to the `keystone.init` method, or can be set any time before `keystone.start` is called
 using `keystone.<span class="apidocCodeKeywordSpan">set</span>(key, value)`. This allows for a more flexible order of execution
 (e.g. if you refer to Lists in your routes, you can set the routes after configuring your Lists, as in the example above).

See the [KeystoneJS configuration documentation](http://keystonejs.com/docs/configuration) for details and examples of the available
 configuration options.

### Database field types

Keystone builds on the basic data types provided by mongo and allows you to easily add rich, functional fields to your application
&#x27;s models.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.status" id="apidoc.element.keystone.express.response.status">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>status
        <span class="apidocSignatureSpan">(code)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function status(code) {
  this.statusCode = code;
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var utils = require(&#x27;keystone-utils&#x27;);

module.exports = function bindErrorHandlers (keystone, app) {

	// Handle 404 (no route matched) errors
	var default404Handler = function (req, res) {
		if (req.headers.accept === &#x27;application/json&#x27;) {
			return res.<span class="apidocCodeKeywordSpan">status</span>(404).json({ error: &#x27;not found&#x27; });
		}
		res.status(404).send(keystone.wrapHTMLError(&#x27;Sorry, no page could be found at this address (404)&#x27;));
	};

	app.use(function (req, res, next) {
		var err404 = keystone.get(&#x27;404&#x27;);
		if (err404) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.type" id="apidoc.element.keystone.express.response.type">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>type
        <span class="apidocSignatureSpan">(type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function contentType(type) {
  var ct = type.indexOf(&#x27;/&#x27;) === -1
    ? mime.lookup(type)
    : type;

  return this.set(&#x27;Content-Type&#x27;, ct);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

			else {
				throw new Error(&#x27;keystone.content.page.add() Error: Unrecognised field constructor: &#x27; + options.type);
			}

		}

		self.fields[path] = new options.<span class="apidocCodeKeywordSpan">type</span>(path, options);

	});

	return this;

};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.express.response.vary" id="apidoc.element.keystone.express.response.vary">
        function <span class="apidocSignatureSpan">keystone.express.response.</span>vary
        <span class="apidocSignatureSpan">(field)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">vary = function (field){
  // checks for back-compat
  if (!field || (Array.isArray(field) &#x26;&#x26; !field.length)) {
    deprecate(&#x27;res.vary(): Provide a field name&#x27;);
    return this;
  }

  vary(this, field);

  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.html" id="apidoc.module.keystone.html">module keystone.html</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.html.html" id="apidoc.element.keystone.html.html">
        function <span class="apidocSignatureSpan">keystone.</span>html
        <span class="apidocSignatureSpan">(path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function html(path, options) {
	html.super_.call(path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			// Wrap the textarea
			if (container.is(&#x27;textarea&#x27;)) {
				container.before(editor);
				textarea = container;
				textarea.addClass(&#x27;md-input&#x27;);
				editor.append(textarea);
			} else {
				var rawContent = typeof toMarkdown == &#x27;function&#x27; ? toMarkdown(container.<span class="apidocCodeKeywordSpan">html</
span>()) : container.html(),
				    currentContent = $.trim(rawContent);

				// This is some arbitrary content that could be edited
				textarea = $(&#x27;&#x3c;textarea/&#x3e;&#x27;, {
					&#x27;class&#x27;: &#x27;md-input&#x27;,
					&#x27;val&#x27;: currentContent
				});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.html.super_" id="apidoc.element.keystone.html.super_">
        function <span class="apidocSignatureSpan">keystone.html.</span>super_
        <span class="apidocSignatureSpan">(path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">super_ = function (path, options) { // eslint-disable-line no-unused-vars
	// TODO
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.middleware" id="apidoc.module.keystone.middleware">module keystone.middleware</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.middleware.api" id="apidoc.element.keystone.middleware.api">
        function <span class="apidocSignatureSpan">keystone.middleware.</span>api
        <span class="apidocSignatureSpan">(req, res, next)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function initAPI(req, res, next) {

		res.apiResponse = function (data) {
			if (req.query.callback) {
				res.jsonp(data);
			} else {
				res.json(data);
			}
		};

		res.apiError = function (key, err, msg, code) {
			msg = msg || &#x27;Error&#x27;;
			key = key || &#x27;unknown error&#x27;;
			msg += &#x27; (&#x27; + key + &#x27;)&#x27;;
			if (keystone.get(&#x27;logger&#x27;)) {
				console.log(msg + (err ? &#x27;:&#x27; : &#x27;&#x27;));
				if (err) {
					console.log(err);
				}
			}
			res.status(code || 500);
			res.apiResponse({ error: key || &#x27;error&#x27;, detail: err });
		};

		res.apiNotFound = function (err, msg) {
			res.apiError(&#x27;data not found&#x27;, err, msg || &#x27;not found&#x27;, 404);
		};

		res.apiNotAllowed = function (err, msg) {
			res.apiError(&#x27;access not allowed&#x27;, err, msg || &#x27;not allowed&#x27;, 403);
		};

		next();
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.middleware.cors" id="apidoc.element.keystone.middleware.cors">
        function <span class="apidocSignatureSpan">keystone.middleware.</span>cors
        <span class="apidocSignatureSpan">(req, res, next)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function cors(req, res, next) {

		var origin = keystone.get(&#x27;cors allow origin&#x27;);
		if (origin) {
			res.header(&#x27;Access-Control-Allow-Origin&#x27;, origin === true ? &#x27;*&#x27; : origin);
		}

		if (keystone.get(&#x27;cors allow methods&#x27;) !== false) {
			res.header(&#x27;Access-Control-Allow-Methods&#x27;, keystone.get(&#x27;cors allow methods&#x27;) || &#x27;GET,PUT,POST,DELETE,OPTIONS&#x27;);
		}
		if (keystone.get(&#x27;cors allow headers&#x27;) !== false) {
			res.header(&#x27;Access-Control-Allow-Headers&#x27;, keystone.get(&#x27;cors allow headers&#x27;) || &#x27;Content-Type, Authorization&#x27;);
		}

		next();
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.options" id="apidoc.module.keystone.options">module keystone.options</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.options.options" id="apidoc.element.keystone.options.options">
        function <span class="apidocSignatureSpan">keystone.</span>options
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">options = function (options) {
	if (!arguments.length) {
		return this._options;
	}
	if (typeof options === &#x27;object&#x27;) {
		var keys = Object.keys(options);
		var i = keys.length;
		var k;
		while (i--) {
			k = keys[i];
			this.set(k, options[k]);
		}
	}
	return this._options;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var initialFields;

		// Inherit default options from parent list if it exists
		if (options &#x26;&#x26; options.inherits) {
			if (options.inherits.options &#x26;&#x26; options.inherits.options.inherits) {
				throw new Error(&#x27;Inherited Lists may not contain any inheritance&#x27;);
			}
			defaultOptions = utils.<span class="apidocCodeKeywordSpan">options</span>(defaultOptions, options.inherits.options);
			if (options.inherits.options.track) {
				options.track = false;
			}
		}

		this.options = utils.options(defaultOptions, options);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.options.expandPath" id="apidoc.element.keystone.options.expandPath">
        function <span class="apidocSignatureSpan">keystone.options.</span>expandPath
        <span class="apidocSignatureSpan">(pathValue)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">expandPath = function (pathValue) {
	pathValue = (typeof pathValue === &#x27;string&#x27; &#x26;&#x26; pathValue.substr(0, 1) !== path.sep &#x26;&#x26; pathValue.substr(1, 2) !== &#x27;:\\&#x27;)
		? path.join(this.get(&#x27;module root&#x27;), pathValue)
		: pathValue;
	return pathValue;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	if (typeof lessPaths === &#x27;string&#x27;) {
		lessPaths = [lessPaths];
	}

	if (Array.isArray(lessPaths)) {
		lessPaths.forEach(function (path) {
			app.use(require(&#x27;less-middleware&#x27;)(keystone.<span class="apidocCodeKeywordSpan">expandPath</span>(path), lessOptions
));
		});
	}
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.options.get" id="apidoc.element.keystone.options.get">
        function <span class="apidocSignatureSpan">keystone.options.</span>get
        <span class="apidocSignatureSpan">(key, value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (key, value) {

	if (arguments.length === 1) {
		return this._options[key];
	}

	switch (key) {
		// throw on unsupported options
		case &#x27;email rules&#x27;:
			throw new Error(&#x27;The option &#x22;&#x27; + key + &#x27;&#x22; is no longer supported. See https://github.com/keystonejs/keystone/wiki/0.3.x-to-0.
4.x-Changes&#x27;);
		// handle special settings
		case &#x27;cloudinary config&#x27;:
			var cloudinary = require(&#x27;cloudinary&#x27;);
			if (typeof value === &#x27;string&#x27;) {
				var parts = url.parse(value, true);
				var auth = parts.auth ? parts.auth.split(&#x27;:&#x27;) : [];
				value = {
					cloud_name: parts.host,
					api_key: auth[0],
					api_secret: auth[1],
					private_cdn: parts.pathname != null,
					secure_distribution: parts.pathname &#x26;&#x26; parts.pathname.substring(1),
				};
			}
			cloudinary.config(value);
			value = cloudinary.config();
			break;
		case &#x27;auth&#x27;:
			if (value === true &#x26;&#x26; !this.get(&#x27;session&#x27;)) {
				this.set(&#x27;session&#x27;, true);
			}
			break;
		case &#x27;nav&#x27;:
			this.nav = this.initNav(value);
			break;
		case &#x27;mongo&#x27;:
			if (typeof value !== &#x27;string&#x27;) {
				if (Array.isArray(value) &#x26;&#x26; (value.length === 2 || value.length === 3)) {
					console.log(&#x27;\nWarning: using an array for the `mongo` option has been deprecated.\nPlease use a mongodb connection string,
e.g. mongodb://localhost/db_name instead.\n\n&#x27;
					+ &#x27;Support for arrays as the `mongo` setting will be removed in a future version.&#x27;);
					value = (value.length === 2) ? &#x27;mongodb://&#x27; + value[0] + &#x27;/&#x27; + value[1] : &#x27;mongodb://&#x27; + value[0] + &#x27;:&#x27; + value[2] + &#x27;/&#x27; +
value[1];
				} else {
					console.error(&#x27;\nInvalid Configuration:\nThe `mongo` option must be a mongodb connection string, e.g. mongodb://localhost/db_name\n&#x27;);
					process.exit(1);
				}
			}
			break;
		case &#x27;module root&#x27;:
			// if relative path is used, resolve it based on the caller&#x27;s path
			if (!isAbsolutePath(value)) {
				var caller = callerId.getData();
				value = path.resolve(path.dirname(caller.filePath), value);
			}
			break;
		case &#x27;app&#x27;:
			this.app = value;
			break;
		case &#x27;mongoose&#x27;:
			this.mongoose = value;
			break;
		case &#x27;frame guard&#x27;:
			var validFrameGuardOptions = [&#x27;deny&#x27;, &#x27;sameorigin&#x27;];

			if (value === true) {
				value = &#x27;deny&#x27;;
			}
			if (typeof value === &#x27;string&#x27;) {
				value = value.toLowerCase();
				if (validFrameGuardOptions.indexOf(value) &#x3c; 0) {
					value = false;
				}
			} else if (typeof value !== &#x27;boolean&#x27;) {
				value = false;
			}
			break;
	}

	this._options[key] = value;
	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	this.set(&#x27;ssl&#x27;, process.env.SSL);
	this.set(&#x27;ssl port&#x27;, process.env.SSL_PORT || &#x27;3001&#x27;);
	this.set(&#x27;ssl host&#x27;, process.env.SSL_HOST || process.env.SSL_IP);
	this.set(&#x27;ssl key&#x27;, process.env.SSL_KEY);
	this.set(&#x27;ssl cert&#x27;, process.env.SSL_CERT);

	this.set(&#x27;cookie secret&#x27;, process.env.COOKIE_SECRET);
	this.set(&#x27;cookie signin&#x27;, (this.<span class="apidocCodeKeywordSpan">get</span>(&#x27;env&#x27;) === &#x27;development
&#x27;) ? true : false);

	this.set(&#x27;embedly api key&#x27;, process.env.EMBEDLY_API_KEY || process.env.EMBEDLY_APIKEY);
	this.set(&#x27;mandrill api key&#x27;, process.env.MANDRILL_API_KEY || process.env.MANDRILL_APIKEY);
	this.set(&#x27;mandrill username&#x27;, process.env.MANDRILL_USERNAME);
	this.set(&#x27;google api key&#x27;, process.env.GOOGLE_BROWSER_KEY);
	this.set(&#x27;google server api key&#x27;, process.env.GOOGLE_SERVER_KEY);
	this.set(&#x27;ga property&#x27;, process.env.GA_PROPERTY);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.options.getPath" id="apidoc.element.keystone.options.getPath">
        function <span class="apidocSignatureSpan">keystone.options.</span>getPath
        <span class="apidocSignatureSpan">(key, defaultValue)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getPath = function (key, defaultValue) {
	return this.expandPath(this.get(key) || defaultValue);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
exports.apply = function (callback) {

	var Update = mongoose.model(&#x27;App_Update&#x27;);
	var updateCount = 0;
	var deferCount = 0;
	var skipCount = 0;

	var updatesPath = keystone.<span class="apidocCodeKeywordSpan">getPath</span>(&#x27;updates&#x27;, &#x27;updates&#x27;);

	// logError is used to log errors before the process exits since it is more synchronous than console.error.  Using
	// console.error gets into race condition issues with process.exit, which has higher priority.
	var logError = function () {
		for (var i = 0, len = arguments.length; i &#x3c; len; ++i) {
			process.stderr.write(arguments[i] + &#x27;\n&#x27;);
		}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.options.set" id="apidoc.element.keystone.options.set">
        function <span class="apidocSignatureSpan">keystone.options.</span>set
        <span class="apidocSignatureSpan">(key, value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">set = function (key, value) {

	if (arguments.length === 1) {
		return this._options[key];
	}

	switch (key) {
		// throw on unsupported options
		case &#x27;email rules&#x27;:
			throw new Error(&#x27;The option &#x22;&#x27; + key + &#x27;&#x22; is no longer supported. See https://github.com/keystonejs/keystone/wiki/0.3.x-to-0.
4.x-Changes&#x27;);
		// handle special settings
		case &#x27;cloudinary config&#x27;:
			var cloudinary = require(&#x27;cloudinary&#x27;);
			if (typeof value === &#x27;string&#x27;) {
				var parts = url.parse(value, true);
				var auth = parts.auth ? parts.auth.split(&#x27;:&#x27;) : [];
				value = {
					cloud_name: parts.host,
					api_key: auth[0],
					api_secret: auth[1],
					private_cdn: parts.pathname != null,
					secure_distribution: parts.pathname &#x26;&#x26; parts.pathname.substring(1),
				};
			}
			cloudinary.config(value);
			value = cloudinary.config();
			break;
		case &#x27;auth&#x27;:
			if (value === true &#x26;&#x26; !this.get(&#x27;session&#x27;)) {
				this.set(&#x27;session&#x27;, true);
			}
			break;
		case &#x27;nav&#x27;:
			this.nav = this.initNav(value);
			break;
		case &#x27;mongo&#x27;:
			if (typeof value !== &#x27;string&#x27;) {
				if (Array.isArray(value) &#x26;&#x26; (value.length === 2 || value.length === 3)) {
					console.log(&#x27;\nWarning: using an array for the `mongo` option has been deprecated.\nPlease use a mongodb connection string,
e.g. mongodb://localhost/db_name instead.\n\n&#x27;
					+ &#x27;Support for arrays as the `mongo` setting will be removed in a future version.&#x27;);
					value = (value.length === 2) ? &#x27;mongodb://&#x27; + value[0] + &#x27;/&#x27; + value[1] : &#x27;mongodb://&#x27; + value[0] + &#x27;:&#x27; + value[2] + &#x27;/&#x27; +
value[1];
				} else {
					console.error(&#x27;\nInvalid Configuration:\nThe `mongo` option must be a mongodb connection string, e.g. mongodb://localhost/db_name\n&#x27;);
					process.exit(1);
				}
			}
			break;
		case &#x27;module root&#x27;:
			// if relative path is used, resolve it based on the caller&#x27;s path
			if (!isAbsolutePath(value)) {
				var caller = callerId.getData();
				value = path.resolve(path.dirname(caller.filePath), value);
			}
			break;
		case &#x27;app&#x27;:
			this.app = value;
			break;
		case &#x27;mongoose&#x27;:
			this.mongoose = value;
			break;
		case &#x27;frame guard&#x27;:
			var validFrameGuardOptions = [&#x27;deny&#x27;, &#x27;sameorigin&#x27;];

			if (value === true) {
				value = &#x27;deny&#x27;;
			}
			if (typeof value === &#x27;string&#x27;) {
				value = value.toLowerCase();
				if (validFrameGuardOptions.indexOf(value) &#x3c; 0) {
					value = false;
				}
			} else if (typeof value !== &#x27;boolean&#x27;) {
				value = false;
			}
			break;
	}

	this._options[key] = value;
	return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Alternatively, to include Keystone in an existing project or start from scratch (without Yeoman), specify `keystone: &#x22;^0.3.
9&#x22;` in the `dependencies` array of your `package.json` file, and run `npm install` from your terminal.

Then read through the [Documentation](http://keystonejs.com/docs) and the [Example Projects](http://keystonejs.com/examples) to
understand how to use it.

### Configuration

Config variables can be passed in an object to the `keystone.init` method, or can be set any time before `keystone.start` is called
 using `keystone.<span class="apidocCodeKeywordSpan">set</span>(key, value)`. This allows for a more flexible order of execution
 (e.g. if you refer to Lists in your routes, you can set the routes after configuring your Lists, as in the example above).

See the [KeystoneJS configuration documentation](http://keystonejs.com/docs/configuration) for details and examples of the available
 configuration options.

### Database field types

Keystone builds on the basic data types provided by mongo and allows you to easily add rich, functional fields to your application
&#x27;s models.
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.page" id="apidoc.module.keystone.page">module keystone.page</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.page.page" id="apidoc.element.keystone.page.page">
        function <span class="apidocSignatureSpan">keystone.</span>page
        <span class="apidocSignatureSpan">(key, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Page(key, options) {

	if (!(this instanceof Page)) {
		return new Page(key, options);
	}

	this.options = assign({}, options);
	this.key = key;
	this.fields = {};

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * ####Example:
 *
 * 		var homePage = new keystone.content.Page(&#x27;home&#x27;);
 * 		// ...
 * 		homePage.register();
 *
 * 		// later...
 * 		var homePage = keystone.content.<span class="apidocCodeKeywordSpan">page</span>(&#x27;home&#x27;);
 *
 * @api public
 */

Page.prototype.register = function () {
	return keystone.content.page(this.key, this);
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.page.prototype" id="apidoc.module.keystone.page.prototype">module keystone.page.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.page.prototype.add" id="apidoc.element.keystone.page.prototype.add">
        function <span class="apidocSignatureSpan">keystone.page.prototype.</span>add
        <span class="apidocSignatureSpan">(fields)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">add = function (fields) {

	// TODO: nested paths
	if (!utils.isObject(fields)) {
		throw new Error(&#x27;keystone.content.Page.add() Error: fields must be an object.&#x27;);
	}

	var self = this;

	_.forEach(fields, function (options, path) {

		if (typeof options === &#x27;function&#x27;) {
			options = { type: options };
		}

		if (typeof options.type !== &#x27;function&#x27;) {
			throw new Error(&#x27;keystone.content.page.add() Error: Page fields must be specified with a type function&#x27;);
		}

		if (options.type.prototype.__proto__ !== Type.prototype) { // eslint-disable-line no-proto

			// Convert native field types to their default Keystone counterpart

			if (options.type === String) {
				options.type = keystone.content.Types.Text;
			}

			// TODO: More types
			// else if (options.type == Number)
			// 	options.type = Field.Types.Number;
			// else if (options.type == Boolean)
			// 	options.type = Field.Types.Boolean;
			// else if (options.type == Date)
			// 	options.type = Field.Types.Datetime;

			else {
				throw new Error(&#x27;keystone.content.page.add() Error: Unrecognised field constructor: &#x27; + options.type);
			}

		}

		self.fields[path] = new options.type(path, options);

	});

	return this;

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @api public
 */

Page.prototype.add = function (fields) {

	// TODO: nested paths
	if (!utils.isObject(fields)) {
		throw new Error(&#x27;keystone.content.Page.<span class="apidocCodeKeywordSpan">add</span>() Error: fields must be an object.&#
x27;);
	}

	var self = this;

	_.forEach(fields, function (options, path) {

		if (typeof options === &#x27;function&#x27;) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.page.prototype.clean" id="apidoc.element.keystone.page.prototype.clean">
        function <span class="apidocSignatureSpan">keystone.page.prototype.</span>clean
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">clean = function (data) {

	if (typeof data !== &#x27;object&#x27;) {
		data = {};
	}

	// TODO: implement schema

	return data;

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.page.prototype.get" id="apidoc.element.keystone.page.prototype.get">
        function <span class="apidocSignatureSpan">keystone.page.prototype.</span>get
        <span class="apidocSignatureSpan">(key)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (key) {
	if (!key) {
		throw new Error(&#x27;keystone.content.Paget.get() Error: must be provided with a key to get a value.&#x27;);
	}

	if (!this.options.hasOwnProperty(key)) {
		return null;
	}

	return this.options[key];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	this.set(&#x27;ssl&#x27;, process.env.SSL);
	this.set(&#x27;ssl port&#x27;, process.env.SSL_PORT || &#x27;3001&#x27;);
	this.set(&#x27;ssl host&#x27;, process.env.SSL_HOST || process.env.SSL_IP);
	this.set(&#x27;ssl key&#x27;, process.env.SSL_KEY);
	this.set(&#x27;ssl cert&#x27;, process.env.SSL_CERT);

	this.set(&#x27;cookie secret&#x27;, process.env.COOKIE_SECRET);
	this.set(&#x27;cookie signin&#x27;, (this.<span class="apidocCodeKeywordSpan">get</span>(&#x27;env&#x27;) === &#x27;development
&#x27;) ? true : false);

	this.set(&#x27;embedly api key&#x27;, process.env.EMBEDLY_API_KEY || process.env.EMBEDLY_APIKEY);
	this.set(&#x27;mandrill api key&#x27;, process.env.MANDRILL_API_KEY || process.env.MANDRILL_APIKEY);
	this.set(&#x27;mandrill username&#x27;, process.env.MANDRILL_USERNAME);
	this.set(&#x27;google api key&#x27;, process.env.GOOGLE_BROWSER_KEY);
	this.set(&#x27;google server api key&#x27;, process.env.GOOGLE_SERVER_KEY);
	this.set(&#x27;ga property&#x27;, process.env.GA_PROPERTY);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.page.prototype.populate" id="apidoc.element.keystone.page.prototype.populate">
        function <span class="apidocSignatureSpan">keystone.page.prototype.</span>populate
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">populate = function (data) {

	if (typeof data !== &#x27;object&#x27;) {
		data = {};
	}

	// TODO: implement schema

	return data;

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			}
			populate[col.populate.path].push(col.populate.subpath);
		}
	});
	q.select(select.join(&#x27; &#x27;));
	for (path in populate) {
		if (populate.hasOwnProperty(path)) {
			q.<span class="apidocCodeKeywordSpan">populate</span>(path, populate[path].join(&#x27; &#x27;));
		}
	}
}

module.exports = selectColumns;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.page.prototype.register" id="apidoc.element.keystone.page.prototype.register">
        function <span class="apidocSignatureSpan">keystone.page.prototype.</span>register
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">register = function () {
	return keystone.content.page(this.key, this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/**
* Registers the page with Keystone.
*
* ####Example:
*
* 		var homePage = new keystone.content.Page(&#x27;home&#x27;);
* 		// ...
* 		homePage.<span class="apidocCodeKeywordSpan">register</span>();
*
* 		// later...
* 		var homePage = keystone.content.page(&#x27;home&#x27;);
*
* @api public
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.page.prototype.set" id="apidoc.element.keystone.page.prototype.set">
        function <span class="apidocSignatureSpan">keystone.page.prototype.</span>set
        <span class="apidocSignatureSpan">(key, value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">set = function (key, value) {

	if (!key) {
		throw new Error(&#x27;keystone.content.Page.set() Error: must be provided with a key to set a value.&#x27;);
	}

	value = value || null;
	this.options[key] = value;
	return value;

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Alternatively, to include Keystone in an existing project or start from scratch (without Yeoman), specify `keystone: &#x22;^0.3.
9&#x22;` in the `dependencies` array of your `package.json` file, and run `npm install` from your terminal.

Then read through the [Documentation](http://keystonejs.com/docs) and the [Example Projects](http://keystonejs.com/examples) to
understand how to use it.

### Configuration

Config variables can be passed in an object to the `keystone.init` method, or can be set any time before `keystone.start` is called
 using `keystone.<span class="apidocCodeKeywordSpan">set</span>(key, value)`. This allows for a more flexible order of execution
 (e.g. if you refer to Lists in your routes, you can set the routes after configuring your Lists, as in the example above).

See the [KeystoneJS configuration documentation](http://keystonejs.com/docs/configuration) for details and examples of the available
 configuration options.

### Database field types

Keystone builds on the basic data types provided by mongo and allows you to easily add rich, functional fields to your application
&#x27;s models.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.page.prototype.validate" id="apidoc.element.keystone.page.prototype.validate">
        function <span class="apidocSignatureSpan">keystone.page.prototype.</span>validate
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validate = function (data) {

	if (typeof data !== &#x27;object&#x27;) {
		data = {};
	}

	// TODO: implement schema

	return data;

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		// Allow environment variable to disable check
		if (DISABLE_CSRF) return next();
		// Bail on safe methods
		if (req.method === &#x27;GET&#x27; || req.method === &#x27;HEAD&#x27; || req.method === &#x27;OPTIONS&#x27;) {
			return next();
		}
		// Validate token
		if (exports.<span class="apidocCodeKeywordSpan">validate</span>(req)) {
			next();
		} else {
			res.statusCode = 403;
			next(new Error(&#x27;CSRF token mismatch&#x27;));
		}
	},
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.s3" id="apidoc.module.keystone.s3">module keystone.s3</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.s3.upload" id="apidoc.element.keystone.s3.upload">
        function <span class="apidocSignatureSpan">keystone.s3.</span>upload
        <span class="apidocSignatureSpan">(req, res)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">upload = function (req, res) {
		var knox = require(&#x27;knox&#x27;);
		var keystone = req.keystone;
		var Types = keystone.Field.Types;

		if (!keystone.security.csrf.validate(req, req.body.authenticity_token)) {
			return res.status(403).send({ error: { message: &#x27;invalid csrf&#x27; } });
		}

		if (req.files &#x26;&#x26; req.files.file) {

			var s3Config = keystone.get(&#x27;s3 config&#x27;);

			var file = req.files.file;
			var path = s3Config.s3path ? s3Config.s3path + &#x27;/&#x27; : &#x27;&#x27;;

			var headers = Types.S3File.prototype.generateHeaders.call({ s3config: s3Config, options: {} }, null, file);

			var s3Client = knox.createClient(s3Config);

			s3Client.putFile(file.path, path + file.name, headers, function (err, s3Response) {
				var sendResult = function () {
					if (err) {
						return res.send({ error: { message: err.message } });
					}

					if (s3Response) {
						if (s3Response.statusCode !== 200) {
							return res.send({ error: { message: &#x27;Amazon returned Http Code: &#x27; + s3Response.statusCode } });
						} else {
							var region = &#x27;s3&#x27;;
							if (s3Config.region &#x26;&#x26; s3Config.region !== &#x27;us-east-1&#x27;) {
								region = &#x27;s3-&#x27; + s3Config.region;
							}
							return res.send({ image: { url: &#x27;https://&#x27; + region + &#x27;.amazonaws.com/&#x27; + s3Config.bucket + &#x27;/&#x27; + file.name } });
						}
					}
				};

				res.format({
					html: sendResult,
					json: sendResult,
				});
			});

		} else {
			res.json({ error: { message: &#x27;No image selected&#x27; } });
		}
	}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		if (req.files &#x26;&#x26; req.files.file) {
			var options = {};

			if (keystone.get(&#x27;wysiwyg cloudinary images filenameAsPublicID&#x27;)) {
				options.public_id = req.files.file.originalname.substring(0, req.files.file.originalname.lastIndexOf(&#x27;.&#x27;));
			}

			cloudinary.uploader.<span class="apidocCodeKeywordSpan">upload</span>(req.files.file.path, function (result) {
				var sendResult = function () {
					if (result.error) {
						res.send({ error: { message: result.error.message } });
					} else {
						res.send({ image: { url: (keystone.get(&#x27;cloudinary secure&#x27;) === true) ? result.secure_url : result.url } });
					}
				};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.schemaPlugins" id="apidoc.module.keystone.schemaPlugins">module keystone.schemaPlugins</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.schemaPlugins.autokey" id="apidoc.element.keystone.schemaPlugins.autokey">
        function <span class="apidocSignatureSpan">keystone.schemaPlugins.</span>autokey
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function autokey() {

	var autokey = this.autokey = _.clone(this.get(&#x27;autokey&#x27;));
	var def = {};
	var list = this;

	if (!autokey.from) {
		var fromMsg = &#x27;Invalid List Option (autokey) for &#x27; + list.key + &#x27; (from is required)\n&#x27;;
		throw new Error(fromMsg);
	}
	if (!autokey.path) {
		var pathMsg = &#x27;Invalid List Option (autokey) for &#x27; + list.key + &#x27; (path is required)\n&#x27;;
		throw new Error(pathMsg);
	}

	if (typeof autokey.from === &#x27;string&#x27;) {
		autokey.from = autokey.from.split(&#x27; &#x27;);
	}

	autokey.from = autokey.from.map(function (i) {
		i = i.split(&#x27;:&#x27;);
		return { path: i[0], format: i[1] };
	});

	def[autokey.path] = {
		type: String,
		index: true,
	};

	if (autokey.unique) {
		def[autokey.path].index = { unique: true };
	}

	this.schema.add(def);

	var getUniqueKey = function (doc, src, callback) {

		var q = list.model.find().where(autokey.path, src);

		if (_.isObject(autokey.unique)) {
			_.forEach(autokey.unique, function (k, v) {
				if (typeof v === &#x27;string&#x27; &#x26;&#x26; v.charAt(0) === &#x27;:&#x27;) {
					q.where(k, doc.get(v.substr(1)));
				} else {
					q.where(k, v);
				}
			});
		}

		q.exec(function (err, results) {
			if (err) {
				callback(err);
			// deliberate use of implicit type coercion with == because doc.id may need to become a String
			} else if (results.length &#x26;&#x26; (results.length &#x3e; 1 || results[0].id != doc.id)) { // eslint-disable-line eqeqeq
				var inc = src.match(/^(.+)\-(\d+)$/);
				if (inc &#x26;&#x26; inc.length === 3) {
					src = inc[1];
					inc = &#x27;-&#x27; + ((inc[2] * 1) + 1);
				} else {
					inc = &#x27;-1&#x27;;
				}
				return getUniqueKey(doc, src + inc, callback);
			} else {
				doc.set(autokey.path, src);
				return callback();
			}
		});
	};

	this.schema.pre(&#x27;save&#x27;, function (next) {

		var modified = false;
		var incomplete = false;
		var values = [];

		autokey.from.forEach(function (ops) {
			if (list.fields[ops.path]) {
				values.push(list.fields[ops.path].format(this, ops.format));
				if (list.fields[ops.path].isModified(this)) {
					modified = true;
				}
				// if source field is neither selected nor modified we don&#x27;t have a way to generate a complete autokey
				else if (!this.isSelected(ops.path)) {
					incomplete = true;
				}
			} else {
				values.push(this.get(ops.path));
				// virtual paths are always assumed to have changed, except &#x27;id&#x27;
				if (ops.path !== &#x27;id&#x27; &#x26;&#x26; list.schema.pathType(ops.path) === &#x27;virtual&#x27; || this.isModified(ops.path)) {
					modified = true;
				}
			}
		}, this);

		// if source fields are not completely selected or set, skip generation unless told to ignore the condition
		if (incomplete &#x26;&#x26; !autokey.ingoreIncompleteSource) {
			return next();
		}

		// if has a value and is unmodified or fixed, don&#x27;t update it
		if ((!modified || autokey.fixed) &#x26;&#x26; (this.get(autokey.path) || !this.isSelected(autokey.path))) {
			return next();
		}
		var newKey = utils.slug(values.join(&#x27; &#x27;), null, { locale: autokey.locale }) || this.id;
		if (autokey.unique) {
			return getUniqueKey(this, newKey, next);
		} else {
			this.set(autokey.path, newKey);
			return next();
		}

	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.schemaPlugins.history" id="apidoc.element.keystone.schemaPlugins.history">
        function <span class="apidocSignatureSpan">keystone.schemaPlugins.</span>history
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function history() {

	var list = this;

	// If model already exists for a &#x27;_revisions&#x27; in an inherited model, log a warning but skip creating the new model (inherited _revisions
 model will be used).
	var collectionName = getHistoryModelName(list);
	if (list.get(&#x27;inherits&#x27;)
		&#x26;&#x26; collectionName.indexOf(historyModelSuffix, collectionName.length - historyModelSuffix.length) !== -1
		&#x26;&#x26; keystone.mongoose.models[collectionName]) {
		console.log(&#x27;List/model already exists for &#x27; + collectionName + &#x27;.\nWon\&#x27;t re-create, keystone continuing.&#x27;);
		return;
	}

	var userModel = keystone.get(&#x27;user model&#x27;);

	var HistoryModel = list.HistoryModel = getHistoryModel(this, userModel);

	list.schema.add({
		__rev: Number,
	});

	list.schema.pre(&#x27;save&#x27;, function (next) {
		this.__rev = (typeof this.__rev === &#x27;number&#x27;) ? this.__rev + 1 : 1;

		var data = this.toObject();
		delete data._id;
		delete data.__v;
		delete data.__rev;

		var doc = {
			i: this.id,
			t: Date.now(),
			o: this.isNew ? &#x27;c&#x27; : &#x27;u&#x27;,
			c: [],
			d: data,
		};

		for (var path in list.fields) {
			if (this.isModified(path)) {
				doc.c.push(path);
			}
		}

		if (list.autokey) {
			if (this.isModified(list.autokey.path)) {
				doc.c.push(list.autokey.path);
			}
		}

		if (userModel &#x26;&#x26; this._req_user) {
			doc.u = this._req_user;
		}

		new HistoryModel(doc).save(next);
	});

	list.schema.pre(&#x27;remove&#x27;, function (next) {
		var data = this.toObject();
		data.__v = undefined;

		var doc = {
			t: Date.now(),
			o: &#x27;d&#x27;,
			d: data,
		};

		if (userModel &#x26;&#x26; this._req_user) {
			doc.u = this._req_user;
		}

		new HistoryModel(doc).save(next);
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.schemaPlugins.sortable" id="apidoc.element.keystone.schemaPlugins.sortable">
        function <span class="apidocSignatureSpan">keystone.schemaPlugins.</span>sortable
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function sortable() {

	var list = this;

	this.add({
		sortOrder: { type: Number, index: true, hidden: true },
	});

	this.schema.pre(&#x27;save&#x27;, function (next) {

		if (typeof this.sortOrder === &#x27;number&#x27;) {
			return next();
		}

		var item = this;

		var addLast = function (done) {
			list.model.findOne().sort(&#x27;-sortOrder&#x27;).exec(function (err, max) { // eslint-disable-line no-unused-vars, handle-callback-err
				item.sortOrder = (max &#x26;&#x26; max.sortOrder) ? max.sortOrder + 1 : 1;
				done();
			});
		};

		if (list.get(&#x27;sortable&#x27;) === &#x27;unshift&#x27;) {
			list.model.where(&#x27;sortOrder&#x27;)
				.setOptions({ multi: true })
				.update(
					{ $inc: { sortOrder: 1 } },
					function (err) {
						if (err) {
							console.log(&#x27;err&#x27;, err);
							return addLast(next);
						}
						item.sortOrder = 1;
						next();
					}
				);
		} else {
			addLast(next);
		}
	});

	this.schema.statics.reorderItems = function reorderItems (id, prevOrder, newOrder, cb) {

		prevOrder = parseFloat(prevOrder);
		newOrder = parseFloat(newOrder);

		var whichWay = (newOrder &#x3e; prevOrder) ? -1 : 1;
		var gte = (newOrder &#x3e; prevOrder) ? prevOrder + 1 : newOrder;
		var lte = (newOrder &#x3e; prevOrder) ? newOrder : prevOrder - 1;
		return list.model
			.where(&#x27;sortOrder&#x27;)
			.gte(gte)
			.lte(lte)
			.setOptions({ multi: true })
			.update({ $inc: { sortOrder: whichWay } }, function (err) {
				if (err) {
					console.log(&#x27;err&#x27;, err);
				}
				list.model.findOneAndUpdate({ _id: id }, { sortOrder: newOrder }).exec(cb);
			});
	};

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.schemaPlugins.track" id="apidoc.element.keystone.schemaPlugins.track">
        function <span class="apidocSignatureSpan">keystone.schemaPlugins.</span>track
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function track() {

	var list = this;
	var options = list.get(&#x27;track&#x27;);
	var userModel = keystone.get(&#x27;user model&#x27;);

	if (!options) {
		// if the track setting is falsy, bail
		return;
	}

	var defaultOptions = {
		createdAt: false,
		createdBy: false,
		updatedAt: false,
		updatedBy: false,
	};
	var fields = {};

	// ensure track is a boolean or an object
	if (!_.isBoolean(options) &#x26;&#x26; !_.isObject(options)) {
		throw new Error(&#x27;Invalid List &#x22;track&#x22; option for &#x27; + list.key + &#x27;\n&#x27;
			+ &#x27;&#x22;track&#x22; must be a boolean or an object.\n\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/database/#lists-options for more information.&#x27;);
	}

	if (_.isBoolean(options)) {
		// shorthand: { track: true } sets all tracked fields to true
		options = {
			createdAt: true,
			createdBy: true,
			updatedAt: true,
			updatedBy: true,
		};
	}

	// if all track fields are set to false, then there&#x27;s nothing to track
	if (!options.createdAt &#x26;&#x26; !options.createdBy &#x26;&#x26; !options.updatedAt &#x26;&#x26; !options.updatedBy) {
		return;
	}

	// merge user options with default options
	options = _.extend({}, defaultOptions, options);

	// validate option fields
	_.forEach(options, function (value, key) {

		var fieldName;

		// make sure the key isn&#x27;t already defined as a field
		if (_.has(list.fields, key)) {
			throw new Error(&#x27;Invalid List &#x22;track&#x22; option for &#x27; + list.key + &#x27;\n&#x27;
				+ &#x27;&#x22;&#x27; + key + &#x27;&#x22; is already defined in the Schema.&#x27;);
		}

		// make sure it&#x27;s a valid track option field
		if (_.has(defaultOptions, key)) {

			// make sure the option field value is either a boolean or a string
			if (!_.isBoolean(value) &#x26;&#x26; typeof value !== &#x27;string&#x27;) {
				throw new Error(&#x27;Invalid List &#x22;track&#x22; option for &#x27; + list.key + &#x27;\n&#x27;
					+ &#x27;&#x22;&#x27; + key + &#x27;&#x22; must be a boolean or a string.\n\n&#x27;
					+ &#x27;See http://keystonejs.com/docs/database/#lists-options for more information.&#x27;);
			}

			if (value) {
				// determine
				fieldName = value === true ? key : value;
				options[key] = fieldName;
				list.map(key, fieldName);

				switch (key) {
					case &#x27;createdAt&#x27;:
					case &#x27;updatedAt&#x27;:
						fields[fieldName] = { type: Date, noedit: true, collapse: true, index: true };
						break;

					case &#x27;createdBy&#x27;:
					case &#x27;updatedBy&#x27;:
						fields[fieldName] = { type: Types.Relationship, ref: userModel, noedit: true, collapse: true, index: true };
						break;
				}
			}
		} else {
			throw new Error(&#x27;Invalid List &#x22;track&#x22; option for &#x27; + list.key + &#x27;\n&#x27;
				+ &#x27;valid field options are &#x22;createdAt&#x22;, &#x22;createdBy&#x22;, &#x22;updatedAt&#x22;, an &#x22;updatedBy&#x22;.\n\n&#x27;
				+ &#x27;See http://keystonejs.com/docs/database/#lists-options for more information.&#x27;);
		}

	});

	// add track fields to schema
	list.add(&#x27;Meta&#x27;, fields);

	list.tracking = options;

	// add the pre-save schema plugin
	list.schema.pre(&#x27;save&#x27;, function (next) {

		var now = new Date();

		// set createdAt/createdBy on new docs
		if (this.isNew) {
			if (options.createdAt &#x26;&#x26; !this.get(options.createdAt)) {
				this.set(options.createdAt, now);
			}
			if (options.createdBy &#x26;&#x26; this._req_user &#x26;&#x26; !this.get(options.createdBy)) {
				this.set(options.createdBy, this._req_user._id);
			}
		}

		// set updatedAt/updatedBy when doc is modified
		if (this.isNew || this.isModified()) {
			if (options.updatedAt) {
				this.set(options.updatedAt, now);
			}
			if (options.updatedBy &#x26;&#x26; this._req_user) {
				this.set(options.updatedBy, this._req_user._id);
			}
		}

		next();

	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>






</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.session" id="apidoc.module.keystone.session">module keystone.session</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.session.keystoneAuth" id="apidoc.element.keystone.session.keystoneAuth">
        function <span class="apidocSignatureSpan">keystone.session.</span>keystoneAuth
        <span class="apidocSignatureSpan">(req, res, next)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">keystoneAuth = function (req, res, next) {
	if (!req.user || !req.user.canAccessKeystone) {
		if (req.headers.accept === &#x27;application/json&#x27;) {
			return req.user
				? res.status(403).json({ error: &#x27;not authorised&#x27; })
				: res.status(401).json({ error: &#x27;not signed in&#x27; });
		}
		var regex = new RegExp(&#x27;^\/&#x27; + keystone.get(&#x27;admin path&#x27;) + &#x27;\/?$&#x27;, &#x27;i&#x27;);
		var from = regex.test(req.originalUrl) ? &#x27;&#x27; : &#x27;?from=&#x27; + req.originalUrl;
		return res.redirect(keystone.get(&#x27;signin url&#x27;) + from);
	}
	next();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.session.persist" id="apidoc.element.keystone.session.persist">
        function <span class="apidocSignatureSpan">keystone.session.</span>persist
        <span class="apidocSignatureSpan">(req, res, next)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">persist = function (req, res, next) {
	var User = keystone.list(keystone.get(&#x27;user model&#x27;));
	if (!req.session) {
		console.error(&#x27;\nKeystoneJS Runtime Error:\n\napp must have session middleware installed. Try adding &#x22;express-session&#x22; to your
 express instance.\n&#x27;);
		process.exit(1);
	}
	if (keystone.get(&#x27;cookie signin&#x27;) &#x26;&#x26; !req.session.userId &#x26;&#x26; req.signedCookies[&#x27;keystone.uid&#x27;] &#x26;&#x26; req.signedCookies[&#x27;keystone.uid
&#x27;].indexOf(&#x27;:&#x27;) &#x3e; 0) {
		exports.signin(req.signedCookies[&#x27;keystone.uid&#x27;], req, res, function () {
			next();
		}, function (err) {
			var cookieOpts = _.defaults({}, keystone.get(&#x27;cookie signin options&#x27;), {
				signed: true,
				httpOnly: true,
			});
			// Force the cookie to expire!
			cookieOpts.maxAge = 0;
			res.clearCookie(&#x27;keystone.uid&#x27;, cookieOpts);
			req.user = null;
			next();
		});
	} else if (req.session.userId) {
		User.model.findById(req.session.userId).exec(function (err, user) {
			if (err) return next(err);
			req.user = user;
			next();
		});
	} else {
		next();
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.session.signin" id="apidoc.element.keystone.session.signin">
        function <span class="apidocSignatureSpan">keystone.session.</span>signin
        <span class="apidocSignatureSpan">(lookup, req, res, onSuccess, onFail)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">signin = function (lookup, req, res, onSuccess, onFail) {
	keystone.callHook({}, &#x27;pre:signin&#x27;, function (err) {
		if (err) {
			return onFail(err);
		}
		doSignin(lookup, req, res, onSuccess, onFail);
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.session.signinWithUser" id="apidoc.element.keystone.session.signinWithUser">
        function <span class="apidocSignatureSpan">keystone.session.</span>signinWithUser
        <span class="apidocSignatureSpan">(user, req, res, onSuccess)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function signinWithUser(user, req, res, onSuccess) {
	if (arguments.length &#x3c; 4) {
		throw new Error(&#x27;keystone.session.signinWithUser requires user, req and res objects, and an onSuccess callback.&#x27;);
	}
	if (typeof user !== &#x27;object&#x27;) {
		throw new Error(&#x27;keystone.session.signinWithUser requires user to be an object.&#x27;);
	}
	if (typeof req !== &#x27;object&#x27;) {
		throw new Error(&#x27;keystone.session.signinWithUser requires req to be an object.&#x27;);
	}
	if (typeof res !== &#x27;object&#x27;) {
		throw new Error(&#x27;keystone.session.signinWithUser requires res to be an object.&#x27;);
	}
	if (typeof onSuccess !== &#x27;function&#x27;) {
		throw new Error(&#x27;keystone.session.signinWithUser requires onSuccess to be a function.&#x27;);
	}
	req.session.regenerate(function () {
		req.user = user;
		req.session.userId = user.id;
		// if the user has a password set, store a persistence cookie to resume sessions
		if (keystone.get(&#x27;cookie signin&#x27;) &#x26;&#x26; user.password) {
			var userToken = user.id + &#x27;:&#x27; + hash(user.password);
			var cookieOpts = _.defaults({}, keystone.get(&#x27;cookie signin options&#x27;), {
				signed: true,
				httpOnly: true,
				maxAge: 10 * 24 * 60 * 60,
			});
			res.cookie(&#x27;keystone.uid&#x27;, userToken, cookieOpts);
		}
		onSuccess(user);
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.session.signout" id="apidoc.element.keystone.session.signout">
        function <span class="apidocSignatureSpan">keystone.session.</span>signout
        <span class="apidocSignatureSpan">(req, res, next)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">signout = function (req, res, next) {
	keystone.callHook(req.user, &#x27;pre:signout&#x27;, function (err) {
		if (err) {
			console.log(&#x22;An error occurred in signout &#x27;pre&#x27; middleware&#x22;, err);
		}
		var cookieOpts = _.defaults({}, keystone.get(&#x27;cookie signin options&#x27;), {
			signed: true,
			httpOnly: true,
		});
		// Force the cookie to expire!
		cookieOpts.maxAge = 0;
		res.clearCookie(&#x27;keystone.uid&#x27;, cookieOpts);
		req.user = null;
		req.session.regenerate(function (err) {
			if (err) {
				return next(err);
			}
			keystone.callHook({}, &#x27;post:signout&#x27;, function (err) {
				if (err) {
					console.log(&#x22;An error occurred in signout &#x27;post&#x27; middleware&#x22;, err);
				}
				next();
			});
		});
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



var session = require(&#x27;../../../lib/session&#x27;);

module.exports = function SignoutRoute (req, res) {
	var keystone = req.keystone;
	session.<span class="apidocCodeKeywordSpan">signout</span>(req, res, function () {
		// After logging out, the user will be redirected to /signin?signedout
		// It shows a bar on top of the sign in panel saying &#x22;You have been signed out&#x22;.
		if (typeof keystone.get(&#x27;signout redirect&#x27;) === &#x27;string&#x27;) {
			return res.redirect(keystone.get(&#x27;signout redirect&#x27;));
		} else if (typeof keystone.get(&#x27;signout redirect&#x27;) === &#x27;function&#x27;) {
			return keystone.get(&#x27;signout redirect&#x27;)(req, res);
		} else {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.text" id="apidoc.module.keystone.text">module keystone.text</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.text.text" id="apidoc.element.keystone.text.text">
        function <span class="apidocSignatureSpan">keystone.</span>text
        <span class="apidocSignatureSpan">(path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function text(path, options) {
	text.super_.call(path, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					    btnClass = button.btnClass ? button.btnClass : &#x27;md-editor__btn&#x27;,
					    tabIndex = button.tabIndex ? button.tabIndex : &#x27;-1&#x27;,
					    hotkey = typeof button.hotkey !== &#x27;undefined&#x27; ? button.hotkey : &#x27;&#x27;,
					    hotkeyCaption = typeof jQuery.hotkeys !== &#x27;undefined&#x27; &#x26;&#x26; hotkey !== &#x27;&#x27; ? &#x27; (&#x27; +
hotkey + &#x27;)&#x27; : &#x27;&#x27;;

					// Construct the button object
					buttonContainer = $(&#x27;&#x3c;button&#x3e;&#x3c;/button&#x3e;&#x27;);
					buttonContainer.<span class="apidocCodeKeywordSpan">text</span>(&#x27; &#x27; + this.__localize(btnText)).addClass(&#x27;md
-editor__btn&#x27;).addClass(btnClass);
					if (btnClass.match(/md-editor__btn\--(primary|success|info|warning|danger|link)/)) {
						buttonContainer.removeClass(&#x27;md-editor__btn&#x27;);
					}
					buttonContainer.attr({
						&#x27;type&#x27;: &#x27;button&#x27;,
						&#x27;title&#x27;: this.__localize(button.title) + hotkeyCaption,
						&#x27;tabindex&#x27;: tabIndex,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.text.super_" id="apidoc.element.keystone.text.super_">
        function <span class="apidocSignatureSpan">keystone.text.</span>super_
        <span class="apidocSignatureSpan">(path, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">super_ = function (path, options) { // eslint-disable-line no-unused-vars
	// TODO
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.updateHandler" id="apidoc.module.keystone.updateHandler">module keystone.updateHandler</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.updateHandler.updateHandler" id="apidoc.element.keystone.updateHandler.updateHandler">
        function <span class="apidocSignatureSpan">keystone.</span>updateHandler
        <span class="apidocSignatureSpan">(list, item, req, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function UpdateHandler(list, item, req, options) {
	this.list = list;
	this.item = item;
	this.req = req;
	if (arguments.length === 5) {
		// old signature; set options to the last argument
		options = arguments[4];
	}
	this.options = options || {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.updateHandler.prototype" id="apidoc.module.keystone.updateHandler.prototype">module keystone.updateHandler.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.updateHandler.prototype.process" id="apidoc.element.keystone.updateHandler.prototype.process">
        function <span class="apidocSignatureSpan">keystone.updateHandler.prototype.</span>process
        <span class="apidocSignatureSpan">(data, options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">process = function (data, options, callback) {

	// options is not required
	if (typeof options === &#x27;function&#x27;) {
		callback = options;
		options = {};
	}

	var item = this.item;
	var list = this.list;
	var req = this.req;
	options = assign({}, this.options, options);

	// pass the user from the request by default
	if (!options.user) {
		options.user = req &#x26;&#x26; req.user;
	}

	// pass the uploaded files object from the request by default
	if (!options.files) {
		options.files = req &#x26;&#x26; req.files;
	}

	function flashErrors (err) {
		var errorMessage = options.errorMessage || &#x27;There was a problem saving your changes&#x27;;
		// Detect Keystone validation errors
		if (err.error === &#x27;validation errors&#x27;) {
			if (options.flashErrors === true || options.flashErrors === &#x27;validation&#x27;) {
				req.flash(&#x27;error&#x27;, {
					type: &#x27;ValidationError&#x27;,
					title: errorMessage,
					// TODO: Apply custom invalidMessages / requiredMessages
					list: _.map(err.detail, &#x27;error&#x27;),
				});
			}
		}
		// Detect Mongoose validation errors
		else if (err.name === &#x27;ValidationError&#x27;) {
			if (options.flashErrors === true || options.flashErrors === &#x27;validation&#x27;) {
				req.flash(&#x27;error&#x27;, {
					type: &#x27;ValidationError&#x27;,
					title: errorMessage,
					list: _.map(err.errors, &#x27;message&#x27;),
				});
			}
		}
		// Detect Keystone field update errors
		else if (err.error === &#x27;field errors&#x27;) {
			if (options.flashErrors === true || options.flashErrors === &#x27;update&#x27;) {
				req.flash(&#x27;error&#x27;, {
					type: &#x27;UpdateError&#x27;,
					title: errorMessage,
					list: _.map(err.detail, &#x27;error&#x27;),
				});
			}
		}
		// Fallback
		else {
			if (options.flashErrors === true || options.flashErrors === &#x27;update&#x27;) {
				var errors = [];
				if (typeof err.error === &#x27;string&#x27;) {
					errors.push(err.error);
				}
				if (typeof err.detail === &#x27;string&#x27;) {
					errors.push(err.detail);
				}
				req.flash(&#x27;error&#x27;, {
					type: &#x27;UpdateError&#x27;,
					title: errorMessage,
					list: errors.length ? errors : undefined,
				});
			}
		}
	}

	this.list.updateItem(this.item, data, options, function (err) {
		if (err) {
			if (options.logErrors) {
				console.log(&#x27;Error saving changes to &#x27; + list.singular + &#x27; &#x27; + item.id + &#x27;:&#x27;, err);
			}
			if (options.flashErrors) {
				flashErrors(err);
			}
		}
		callback(err);
	});

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.updates" id="apidoc.module.keystone.updates">module keystone.updates</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.updates.apply" id="apidoc.element.keystone.updates.apply">
        function <span class="apidocSignatureSpan">keystone.updates.</span>apply
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">apply = function (callback) {

	var Update = mongoose.model(&#x27;App_Update&#x27;);
	var updateCount = 0;
	var deferCount = 0;
	var skipCount = 0;

	var updatesPath = keystone.getPath(&#x27;updates&#x27;, &#x27;updates&#x27;);

	// logError is used to log errors before the process exits since it is more synchronous than console.error.  Using
	// console.error gets into race condition issues with process.exit, which has higher priority.
	var logError = function () {
		for (var i = 0, len = arguments.length; i &#x3c; len; ++i) {
			process.stderr.write(arguments[i] + &#x27;\n&#x27;);
		}
	};

	var applyUpdate = function (file, done) {
		Update.findOne({ key: file }, function (err, updateRecord) {
			if (err) {
				console.error(&#x27;Error searching database for update &#x27; + file + &#x27;:&#x27;);
				console.dir(err);
				done(err);
			} else if (!updateRecord) {
				var update = require(path.join(updatesPath, file));
				// skip updates that export a falsy value
				if (!update) {
					skipCount++;
					return done();
				}
				// auto-wrap create scripts for a friendlier shorthand syntax
				if (_.isObject(update.create)) {
					var items = update.create;
					var ops = update.options || {};
					var background_mode = update.__background__ ? &#x27; (background mode) &#x27; : &#x27;&#x27;;

					update = function (done) {
						keystone.createItems(items, ops, function (err, stats) {
							if (!err) {
								var statsMsg = stats ? stats.message : &#x27;&#x27;;

								console.log(&#x27;\n&#x27; + _dashes_,
									&#x27;\n&#x27; + keystone.get(&#x27;name&#x27;) + &#x27;: Successfully applied update &#x27; + file + background_mode + &#x27;.&#x27;,
									&#x27;\n&#x27; + statsMsg,
									&#x27;\n&#x27;);
								done(null);
							}
							else {
								logError(&#x27;\n&#x27; + _dashes_,
									&#x27;\n&#x27; + keystone.get(&#x27;name&#x27;) + &#x27;: Update &#x27; + file + background_mode + &#x27; failed with errors:&#x27;,
									&#x27;\n&#x27; + err,
									&#x27;\n&#x27;);

								// give the logging some time to finish
								process.nextTick(function () {
									done(err);
								});
							}
						});
					};
				}
				// ensure type
				if (typeof update !== &#x27;function&#x27;) {
					console.log(&#x27;\nError in update file ./updates/&#x27; + file + &#x27;.js\nUpdate files must export a function\n&#x27;);
					process.exit();
				}
				// if an update is deferred, don&#x27;t process it
				if (update.__defer__) {
					deferCount++;
					return done();
				}
				// if there are deferred updates, don&#x27;t process any subsequent ones
				if (deferCount) {
					skipCount++;
					return done();
				}
				console.log(_dashes_ + &#x27;\nApplying update &#x27; + file + &#x27;...&#x27;);
				if (update.__background__) {
					updateCount++;
					update(function (err) {
						if (!err) {
							if (update.__commit__ !== false) {
								new Update({ key: file }).save();
							}
						} else {
							done(err);
						}
					});
					done();
				} else {
					update(function (err) {
						if (!err) {
							updateCount++;
							if (update.__commit__ === false) {
								done();
							} else {
								new Update({ key: file }).save(done);
							}
						} else {
							done(err);
						}
					});
				}
			} else {
				done();
			}
		});
	};

	if (!fs.existsSync(updatesPath)) {
		console.log(&#x27;\nKeystoneJS Update Error:\n\n&#x27;
			+ &#x27;An updates folder must exist in your project root to use automatic updates.\n&#x27;
			+ &#x27;If you want to use a custom path for your updates, set the `updates` option.\n&#x27;
			+ &#x27;If you don\&#x27;t want to use updates, set the `auto update` option to `false`.\n&#x27;
			+ &#x27;See http://keystonejs.com/docs/configuration/#updates for more information.\n&#x27;);
		process.exit();
	}

	var updates = fs.readdirSync(updatesPath)
		.map(function (i) {
			// exclude non-javascript or coffee files in the updates folder
			return (path.extname(i) !== &#x27;.js&#x27; &#x26;&#x26; path.extname(i) !== &#x27;.coffee&#x27;) ? false : path.basename(i, &#x27;.js&#x27;);
		}).filter(function (i) {
			// exclude falsy values and filenames that without a valid semver
			return i &#x26;&#x26; semver.valid(i.split(&#x27;-&#x27;)[0]);
		}).sort(function (a, b) {
			// exclude anything after a hyphen from the version number
			return semver.compare(a.split(&#x27;-&#x27;)[0], b.split(&#x27;-&#x27;)[0]);
		});

	async.eachSeries(updates, applyUpdate, function (err) {
		if (updateCount || deferCou ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * Applies Application updates
 */

Keystone.prototype.applyUpdates = function (callback) {
	var self = this;
	self.callHook(&#x27;pre:updates&#x27;, function (err) {
		if (err) return callback(err);
		require(&#x27;./lib/updates&#x27;).<span class="apidocCodeKeywordSpan">apply</span>(function (err) {
			if (err) return callback(err);
			self.callHook(&#x27;post:updates&#x27;, callback);
		});
	});
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.keystone.utils" id="apidoc.module.keystone.utils">module keystone.utils</a></h1>


    <h2>
        <a href="#apidoc.element.keystone.utils.bindMethods" id="apidoc.element.keystone.utils.bindMethods">
        function <span class="apidocSignatureSpan">keystone.utils.</span>bindMethods
        <span class="apidocSignatureSpan">(obj, scope)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bindMethods(obj, scope) {
	var bound = {};
	for (var prop in obj) {
		if (typeof obj[prop] === &#x27;function&#x27;) {
			bound[prop] = obj[prop].bind(scope);
		} else if (isObject(obj[prop])) {
			bound[prop] = bindMethods(obj[prop], scope);
		}
	}
	return bound;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		this.schema.methods.getRelated = schemaPlugins.methods.getRelated;
		this.schema.methods.populateRelated = schemaPlugins.methods.populateRelated;
		if (!this.schema.options.toObject) this.schema.options.toObject = {};
		this.schema.options.toObject.transform = schemaPlugins.options.transform;
	}
	this.schema.virtual(&#x27;_&#x27;).get(function () {
		if (!this.__methods) {
			this.__methods = utils.<span class="apidocCodeKeywordSpan">bindMethods</span>(list.underscoreMethods, this);
		}
		return this.__methods;
	});
	this.schema.method(&#x27;getUpdateHandler&#x27;, function (req, res, ops) {
		return new UpdateHandler(list, this, req, res, ops);
	});
	/* Apply list inheritance */
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.calculateDistance" id="apidoc.element.keystone.utils.calculateDistance">
        function <span class="apidocSignatureSpan">keystone.utils.</span>calculateDistance
        <span class="apidocSignatureSpan">(point1, point2)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function calculateDistance(point1, point2) {
	var dLng = (point2[0] - point1[0]) * Math.PI / 180;
	var dLat = (point2[1] - point1[1]) * Math.PI / 180;
	var lat1 = (point1[1]) * Math.PI / 180;
	var lat2 = (point2[1]) * Math.PI / 180;
	var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.sin(dLng / 2) * Math.sin(dLng / 2) * Math.cos(lat1) * Math.cos(lat2);
	var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
	return c;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.camelcase" id="apidoc.element.keystone.utils.camelcase">
        function <span class="apidocSignatureSpan">keystone.utils.</span>camelcase
        <span class="apidocSignatureSpan">(str, lc)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function camelcase(str, lc) {
	return inflect.camelize(str, !(lc));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.cropHTMLString" id="apidoc.element.keystone.utils.cropHTMLString">
        function <span class="apidocSignatureSpan">keystone.utils.</span>cropHTMLString
        <span class="apidocSignatureSpan">(str, length, append, preserveWords)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function cropHTMLString(str, length, append, preserveWords) {
	return textToHTML(cropString(htmlToText(str), length, append, preserveWords));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.cropString" id="apidoc.element.keystone.utils.cropString">
        function <span class="apidocSignatureSpan">keystone.utils.</span>cropString
        <span class="apidocSignatureSpan">(str, length, append, preserveWords)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function cropString(str, length, append, preserveWords) {
	if (str &#x26;&#x26; str.toString) str = str.toString();
	if (!isString(str) || !str.length) return &#x27;&#x27;;
	if (typeof append === &#x27;boolean&#x27;) {
		preserveWords = append;
		append = null;
	}
	str = String(str);
	if (str.length &#x3c;= length) return str;
	var cropTo = length;
	if (preserveWords) {
		var r = str.substr(cropTo);
		var word = r.match(/^\w+/);
		if (word &#x26;&#x26; word.length) {
			cropTo += word[0].length;
		}
	}
	var rtn = str.substr(0, cropTo);
	return (rtn.length &#x3c; str.length &#x26;&#x26; append) ? rtn + append : rtn;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	return query;
};

/**
 * Crops the string to the specifed length.
 */
text.prototype.crop = function (item, length, append, preserveWords) {
	return utils.<span class="apidocCodeKeywordSpan">cropString</span>(item.get(this.path), length, append, preserveWords);
};

/* Export Field Type */
module.exports = text;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.decodeHTMLEntities" id="apidoc.element.keystone.utils.decodeHTMLEntities">
        function <span class="apidocSignatureSpan">keystone.utils.</span>decodeHTMLEntities
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function decodeHTMLEntities(str) {
	if (str &#x26;&#x26; str.toString) str = str.toString();
	if (!isString(str) || !str.length) return &#x27;&#x27;;
	return str.replace(/&#x26;([^;&#x26;\s]+);/g, function (match, ent) {
		return String.fromCharCode(ent[0] !== &#x27;#&#x27; ? htmlEntities[ent] : ent[1] === &#x27;x&#x27; ? parseInt(ent.substr(2), 16) : parseInt(ent.substr
(1), 10));
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.defer" id="apidoc.element.keystone.utils.defer">
        function <span class="apidocSignatureSpan">keystone.utils.</span>defer
        <span class="apidocSignatureSpan">(fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function defer(fn) {
	var args = Array.prototype.slice.call(arguments, 1);
	process.nextTick(function () { fn.apply(null, args); });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	if (value !== undefined
		&#x26;&#x26; value !== null
		&#x26;&#x26; typeof value !== &#x27;string&#x27;
		&#x26;&#x26; typeof value !== &#x27;number&#x27;
		&#x26;&#x26; typeof value !== &#x27;boolean&#x27;) {
		result = false;
	}
	utils.<span class="apidocCodeKeywordSpan">defer</span>(callback, result);
};

boolean.prototype.validateRequiredInput = function (item, data, callback) {
	var value = this.getValueFromData(data);
	var result = (value &#x26;&#x26; value !== &#x27;false&#x27;) || item.get(this.path) ? true : false;
	utils.defer(callback, result);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.downcase" id="apidoc.element.keystone.utils.downcase">
        function <span class="apidocSignatureSpan">keystone.utils.</span>downcase
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function downcase(str) {
	if (str &#x26;&#x26; str.toString) str = str.toString();
	if (!isString(str) || !str.length) return &#x27;&#x27;;
	return (str.substr(0, 1).toLowerCase() + str.substr(1));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	if (typeof def === &#x27;string&#x27;) {
		def = { ref: def };
	}
	if (!def.ref) {
		throw new Error(&#x27;List Relationships must be specified with an object containing ref (&#x27; + this.key + &#x27;)&#x27;);
	}
	if (!def.refPath) {
		def.refPath = utils.<span class="apidocCodeKeywordSpan">downcase</span>(this.key);
	}
	if (!def.path) {
		def.path = utils.keyToProperty(def.ref, true);
	}
	Object.defineProperty(def, &#x27;refList&#x27;, {
		get: function () {
			return keystone.list(def.ref);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.encodeHTMLEntities" id="apidoc.element.keystone.utils.encodeHTMLEntities">
        function <span class="apidocSignatureSpan">keystone.utils.</span>encodeHTMLEntities
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function encodeHTMLEntities(str) {
	if (str &#x26;&#x26; str.toString) str = str.toString();
	if (!isString(str) || !str.length) return &#x27;&#x27;;
	return str.replace(htmlEntitiesRegExp, function (match) {
		return &#x27;&#x26;&#x27; + htmlEntitiesMap[match] + &#x27;;&#x27;;
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @param {Boolean} escape - causes HTML entities to be encoded
 */
function getDocumentName (doc, escape) {
	// console.log(&#x27;getting document name for &#x27; + doc.id, &#x27;nameField: &#x27; + this.nameField, &#x27;namePath: &#x27
; + this.namePath);
	// console.log(&#x27;raw name value: &#x27;, doc.get(this.namePath));
	// if (this.nameField) console.log(&#x27;formatted name value: &#x27;, this.nameField.format(doc));
	var name = String(this.nameField ? this.nameField.format(doc) : doc.get(this.namePath));
	return (escape) ? utils.<span class="apidocCodeKeywordSpan">encodeHTMLEntities</span>(name) : name;
}

module.exports = getDocumentName;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.escapeRegExp" id="apidoc.element.keystone.utils.escapeRegExp">
        function <span class="apidocSignatureSpan">keystone.utils.</span>escapeRegExp
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function escapeRegExp(str) {
	if (str &#x26;&#x26; str.toString) str = str.toString();
	if (!isString(str) || !str.length) return &#x27;&#x27;;
	return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, &#x27;\\$&#x26;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			$text: {
				$search: searchString,
			},
		});

		if (this.autokey) {
			var strictAutokeyFilter = {};
			var autokeyRegExp = new RegExp(&#x27;^&#x27; + utils.<span class="apidocCodeKeywordSpan">escapeRegExp</span>(searchString));
			strictAutokeyFilter[this.autokey.path] = autokeyRegExp;
			searchFilters.push(strictAutokeyFilter);
		}
	} else {
		debug(&#x27;Using regular expression search for value: &#x22;&#x27; + searchString + &#x27;&#x22;&#x27;);
		var searchRegExp = new RegExp(utils.escapeRegExp(searchString), &#x27;i&#x27;);
		searchFilters = this.searchFields.map(function (i) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.escapeString" id="apidoc.element.keystone.utils.escapeString">
        function <span class="apidocSignatureSpan">keystone.utils.</span>escapeString
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function escapeString(str) {
	if (str &#x26;&#x26; str.toString) str = str.toString();
	if (!isString(str) || !str.length) return &#x27;&#x27;;
	return str.replace(/[\\&#x27;&#x22;]/g, &#x27;\\$&#x26;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.htmlStringify" id="apidoc.element.keystone.utils.htmlStringify">
        function <span class="apidocSignatureSpan">keystone.utils.</span>htmlStringify
        <span class="apidocSignatureSpan">(obj, fromRecur)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function htmlStringify(obj, fromRecur) {

	var tag = (fromRecur) ? &#x27;span&#x27; : &#x27;div&#x27;;
	var nextLevel = (fromRecur || 0) + 1;
	
	// strings
	if (typeof obj == &#x27;string&#x27;) {
		return &#x27;&#x3c;&#x27; + tag + &#x27; style=&#x22;color: #0e4889; cursor: default;&#x22;&#x3e;&#x22;&#x27; + obj + &#x27;&#x22;&#x3c;/&#x27; + tag + &#x27;&#x3e;&#x27;;
	}
	// booleans, null and undefined
	else if (typeof obj == &#x27;boolean&#x27; || obj === null || obj === undefined) {
		return &#x27;&#x3c;&#x27; + tag + &#x27;&#x3e;&#x3c;em style=&#x22;color: #06624b; cursor: default;&#x22;&#x3e;&#x27; + obj + &#x27;&#x3c;/em&#x3e;&#x3c;/&#x27; + tag + &#x27;&#x3e;&#x27;;
	}
	// numbers
	else if (typeof obj == &#x27;number&#x27;) {
		return &#x27;&#x3c;&#x27; + tag + &#x27; style=&#x22;color: #ca000a; cursor: default;&#x22;&#x3e;&#x27; + obj + &#x27;&#x3c;/&#x27; + tag + &#x27;&#x3e;&#x27;;
	}
	// dates
	else if (Object.prototype.toString.call(obj) == &#x27;[object Date]&#x27;) {
		return &#x27;&#x3c;&#x27; + tag + &#x27; style=&#x22;color: #009f7b; cursor: default;&#x22;&#x3e;&#x27; + obj + &#x27;&#x3c;/&#x27; + tag + &#x27;&#x3e;&#x27;;
	}
	// arrays
	else if (Array.isArray(obj)) {
		
		var rtn = &#x27;&#x3c;&#x27; + tag + &#x27; style=&#x22;color: #666; cursor: default;&#x22;&#x3e;Array: [&#x27;;
		
		if (!obj.length) {
			return rtn + &#x27;]&#x3c;/&#x27; + tag + &#x27;&#x3e;&#x27;;
		}
		
		rtn += &#x27;&#x3c;/&#x27; + tag + &#x27;&#x3e;&#x3c;div style=&#x22;padding-left: 20px;&#x22;&#x3e;&#x27;;
		
		for (var i = 0; i &#x3c; obj.length; i++) {
			rtn += &#x27;&#x3c;span&#x3e;&#x3c;/span&#x3e;&#x27; + htmlStringify(obj[i], nextLevel); // give the DOM structure has as many elements as an object, for collapse
 behaviour
			if (i &#x3c; obj.length - 1) {
				rtn += &#x27;, &#x3c;br&#x3e;&#x27;;
			}
		}
	
		return rtn + &#x27;&#x3c;/div&#x3e;&#x3c;&#x27; + tag + &#x27; style=&#x22;color: #666&#x22;&#x3e;]&#x3c;/&#x27; + tag + &#x27;&#x3e;&#x27;;
		
	}
	// objects
	else if (obj &#x26;&#x26; typeof obj == &#x27;object&#x27;) {
		
		var rtn = &#x27;&#x27;,
			len = Object.keys(obj).length;
	
		if (fromRecur &#x26;&#x26; !len) {
			return &#x27;&#x3c;&#x27; + tag + &#x27; style=&#x22;color: #999; cursor: default;&#x22;&#x3e;Object: {}&#x3c;/&#x27; + tag + &#x27;&#x3e;&#x27;;
		}
		
		if (fromRecur) {
			rtn += &#x27;&#x3c;&#x27; + tag + &#x27; style=&#x22;color: #0b89b6&#x22;&#x3e;Object: {&#x3c;/&#x27; + tag + &#x27;&#x3e;&#x3c;div class=&#x22;_stringify_recur _stringify_recur_level_&#x27; + fromRecur
 + &#x27;&#x22; style=&#x22;padding-left: 20px;&#x22;&#x3e;&#x27;;
		}
		
		for (var key in obj) {
			if (typeof obj[key] != &#x27;function&#x27;) {
				rtn += &#x27;&#x3c;div&#x3e;&#x3c;span style=&#x22;padding-right: 5px; cursor: default;&#x22;&#x3e;&#x27; +key + &#x27;:&#x3c;/span&#x3e;&#x27; + htmlStringify(obj[key], nextLevel) + &#x27;&#x3c;/
div&#x3e;&#x27;;
			}
		}
		
		if (fromRecur) {
			rtn += &#x27;&#x3c;/div&#x3e;&#x3c;&#x27; + tag + &#x27; style=&#x22;color: #0b89b6; cursor: default;&#x22;&#x3e;}&#x3c;/&#x27; + tag + &#x27;&#x3e;&#x27;;
		}
		
		return rtn;
		
	}

	return &#x27;&#x27;;

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.htmlToText" id="apidoc.element.keystone.utils.htmlToText">
        function <span class="apidocSignatureSpan">keystone.utils.</span>htmlToText
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function htmlToText(str) {
	if (str &#x26;&#x26; str.toString) str = str.toString();
	if (!isString(str) || !str.length) return &#x27;&#x27;;
	// remove all source-code line-breaks first
	str = str.replace(/\n/g, &#x27;&#x27;);
	// turn non-breaking spaces into normal spaces
	str = str.replace(/&#x26;nbsp;/g, &#x27; &#x27;);
	// &#x3c;br&#x3e; tags become single line-breaks
	str = str.replace(/&#x3c;br&#x3e;/gi, &#x27;\n&#x27;);
	// &#x3c;p&#x3e;, &#x3c;li&#x3e;, &#x3c;td&#x3e; and &#x3c;th&#x3e; tags become double line-breaks
	str = str.replace(/&#x3c;(?:p|li|td|th)[^&#x3e;]*&#x3e;/gi, &#x27;\n&#x27;);
	// strip all other tags (including closing tags)
	str = str.replace(/&#x3c;[^&#x3e;]*&#x3e;/g, &#x27;&#x27;);
	// compress white space
	str = str.replace(/(\s)\s+/g, &#x27;$1&#x27;);
	// remove leading or trailing spaces
	str = str.replace(/^\s+|\s+$/g, &#x27;&#x27;);
	return decodeHTMLEntities(str);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.isArray" id="apidoc.element.keystone.utils.isArray">
        function <span class="apidocSignatureSpan">keystone.utils.</span>isArray
        <span class="apidocSignatureSpan">(arg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function isArray(arg) {
	return Array.isArray(arg);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	var lessPaths = keystone.get(&#x27;less&#x27;);
	var lessOptions = keystone.get(&#x27;less options&#x27;) || {};

	if (typeof lessPaths === &#x27;string&#x27;) {
		lessPaths = [lessPaths];
	}

	if (Array.<span class="apidocCodeKeywordSpan">isArray</span>(lessPaths)) {
		lessPaths.forEach(function (path) {
			app.use(require(&#x27;less-middleware&#x27;)(keystone.expandPath(path), lessOptions));
		});
	}
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.isDataURL" id="apidoc.element.keystone.utils.isDataURL">
        function <span class="apidocSignatureSpan">keystone.utils.</span>isDataURL
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function isDataURL(str) {
	if (typeof str !== &#x27;string&#x27;) return false;
	var isDataURLRegex = /^\s*data:([a-z]+\/[a-z0-9\-\+]+(;[a-z\-]+\=[a-z0-9\-]+)?)?(;base64)?,[a-z0-9\!\$\&#x26;\&#x27;\,\(\)\*\+\,\;\=\-\.\
_\~\:\@\/\?\%\s]*\s*$/i;
	return !!str.match(isDataURLRegex);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.isDate" id="apidoc.element.keystone.utils.isDate">
        function <span class="apidocSignatureSpan">keystone.utils.</span>isDate
        <span class="apidocSignatureSpan">(arg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function isDate(arg) {
	return Object.prototype.toString.call(arg) === &#x27;[object Date]&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.isEmail" id="apidoc.element.keystone.utils.isEmail">
        function <span class="apidocSignatureSpan">keystone.utils.</span>isEmail
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function isEmail(str) {
	return /^[a-z0-9!#$%&#x26;&#x27;*+/=?^_`{|}~-]+(?:\.[&#x27;a-z0-9!#$%&#x26;*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0
-9-]*[a-z0-9])?$/i.test(str);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/**
* Asynchronously confirms that the provided email is valid
*/
email.prototype.validateInput = function (data, callback) {
	var input = this.getValueFromData(data);
	var result = true;
	if (input) {
		result = utils.<span class="apidocCodeKeywordSpan">isEmail</span>(input);
	}
	utils.defer(callback, result);
};

/**
* Asynchronously confirms that required input is present
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.isFunction" id="apidoc.element.keystone.utils.isFunction">
        function <span class="apidocSignatureSpan">keystone.utils.</span>isFunction
        <span class="apidocSignatureSpan">(arg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function isFunction(arg) {
	return typeof arg === &#x27;function&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * - `field.paths.action` in `req.body` (`clear` or `delete`)
 * - `field.paths.upload` in `req.files` (uploads the file to s3file)
 */
azurefile.prototype.getRequestHandler = function (item, req, paths, callback) {

	var field = this;

	if (utils.<span class="apidocCodeKeywordSpan">isFunction</span>(paths)) {
		callback = paths;
		paths = field.paths;
	} else if (!paths) {
		paths = field.paths;
	}

	callback = callback || function () {};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.isNumber" id="apidoc.element.keystone.utils.isNumber">
        function <span class="apidocSignatureSpan">keystone.utils.</span>isNumber
        <span class="apidocSignatureSpan">(arg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function isNumber(arg) {
	return typeof arg === &#x27;number&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		throw new Error(&#x27;Select fields require an options array.&#x27;);
	}
	this.ops = options.options.map(function (i) {
		var op = typeof i === &#x27;string&#x27; ? { value: i.trim(), label: utils.keyToLabel(i) } : i;
		if (!_.isObject(op)) {
			op = { label: &#x27;&#x27; + i, value: &#x27;&#x27; + i };
		}
		if (options.numeric &#x26;&#x26; !_.<span class="apidocCodeKeywordSpan">isNumber</span>(op.value)) {
			op.value = Number(op.value);
		}
		return op;
	});
	// undefined options.emptyOption defaults to true
	if (options.emptyOption === undefined) {
		options.emptyOption = true;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.isObject" id="apidoc.element.keystone.utils.isObject">
        function <span class="apidocSignatureSpan">keystone.utils.</span>isObject
        <span class="apidocSignatureSpan">(arg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function isObject(arg) {
	return Object.prototype.toString.call(arg) === &#x27;[object Object]&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @api public
 */

var Email = function (options) {
	if (typeof options === &#x27;string&#x27;) {
		options = { templateName: options };
	}
	if (!utils.<span class="apidocCodeKeywordSpan">isObject</span>(options)) {
		throw new Error(&#x27;The keystone.Email class requires a templateName or options argument to be provided&#x27;);
	}

	/**
	 * Keystone &#x3c; 0.4 Compatibility
	 *
	 * NOTE: Add warnings and enable them in 4.1 or 4.2 release. These patterns
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.isString" id="apidoc.element.keystone.utils.isString">
        function <span class="apidocSignatureSpan">keystone.utils.</span>isString
        <span class="apidocSignatureSpan">(arg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function isString(arg) {
	return typeof arg === &#x27;string&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	if (!_.has(header, HEADER_VALUE_KEY)) {
		return callback(new Error(&#x27;Unsupported Header option: missing required key &#x22;&#x27; + HEADER_VALUE_KEY + &#x27;&#x22;
in &#x27; + JSON.stringify(header)));
	}

	filteredKeys = _.filter(_.keys(header), function (key) { return _.indexOf(validKeys, key) &#x3e; -1; });

	_.forEach(filteredKeys, function (key) {
		if (!_.<span class="apidocCodeKeywordSpan">isString</span>(header[key])) {
			return callback(new Error(&#x27;Unsupported Header option: value for &#x27; + key + &#x27; header must be a String &#x27; + header
[key].toString()));
		}
	});

	return true;
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.isValidObjectId" id="apidoc.element.keystone.utils.isValidObjectId">
        function <span class="apidocSignatureSpan">keystone.utils.</span>isValidObjectId
        <span class="apidocSignatureSpan">(arg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function isValidObjectId(arg) {
	var len = arg.length;
	if (len === 12 || len === 24) {
		return /^[0-9a-fA-F]+$/.test(arg);
	} else {
		return false;
	}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		if (this.autokey) {
			var autokeyFilter = {};
			autokeyFilter[this.autokey.path] = searchRegExp;
			searchFilters.push(autokeyFilter);
		}
	}

	if (utils.<span class="apidocCodeKeywordSpan">isValidObjectId</span>(searchString)) {
		searchFilters.push({
			_id: searchString,
		});
	}

	if (searchFilters.length &#x3e; 1) {
		query.$or = searchFilters;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.keyToLabel" id="apidoc.element.keystone.utils.keyToLabel">
        function <span class="apidocSignatureSpan">keystone.utils.</span>keyToLabel
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function keyToLabel(str) {
	if (str &#x26;&#x26; str.toString) str = str.toString();
	if (!isString(str) || !str.length) return &#x27;&#x27;;
	str = str.replace(/([a-z])([A-Z])/g, &#x27;$1 $2&#x27;);
	str = str.replace(/([0-9])([a-zA-Z])/g, &#x27;$1 $2&#x27;);
	str = str.replace(/([a-zA-Z])([0-9])/g, &#x27;$1 $2&#x27;);
	var parts = str.split(/\s|\.|_|-|:|;|([A-z\u00C0-\u00ff]+)/);
	for (var i = 0; i &#x3c; parts.length; i++) {
		if (parts[i] &#x26;&#x26; !/^[A-Z0-9]+$/.test(parts[i])) {
			parts[i] = upcase(parts[i]);
		}
	}
	return compact(parts).join(&#x27; &#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var self = this;

		// init mappings
		_.forEach(this.options.map, function (val, key) { self.map(key, val); });

		// define property getters
		Object.defineProperty(this, &#x27;label&#x27;, { get: function () {
			return this.get(&#x27;label&#x27;) || this.set(&#x27;label&#x27;, utils.plural(utils.<span class="apidocCodeKeywordSpan">keyToLabel
</span>(key)));
		} });
		Object.defineProperty(this, &#x27;singular&#x27;, { get: function () {
			return this.get(&#x27;singular&#x27;) || this.set(&#x27;singular&#x27;, utils.singular(this.label));
		} });
		Object.defineProperty(this, &#x27;plural&#x27;, { get: function () {
			return this.get(&#x27;plural&#x27;) || this.set(&#x27;plural&#x27;, utils.plural(this.singular));
		} });
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.keyToPath" id="apidoc.element.keystone.utils.keyToPath">
        function <span class="apidocSignatureSpan">keystone.utils.</span>keyToPath
        <span class="apidocSignatureSpan">(str, plural)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function keyToPath(str, plural) {
	if (str &#x26;&#x26; str.toString) str = str.toString();
	if (!isString(str) || !str.length) return &#x27;&#x27;;
	var parts = slug(keyToLabel(str)).split(&#x27;-&#x27;);
	if (parts.length &#x26;&#x26; plural) {
		parts[parts.length - 1] = inflect.pluralize(parts[parts.length - 1]);
	}
	return parts.join(&#x27;-&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
			}
		}

		this.options = utils.options(defaultOptions, options);

		// init properties
		this.key = key;
		this.path = this.get(&#x27;path&#x27;) || utils.<span class="apidocCodeKeywordSpan">keyToPath</span>(key, true);
		this.schema = new keystone.mongoose.Schema({}, this.options.schema);
		this.schemaFields = [];
		this.uiElements = [];
		this.underscoreMethods = {};
		this.fields = {};
		this.fieldsArray = [];
		this.fieldTypes = {};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.keyToProperty" id="apidoc.element.keystone.utils.keyToProperty">
        function <span class="apidocSignatureSpan">keystone.utils.</span>keyToProperty
        <span class="apidocSignatureSpan">(str, plural)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function keyToProperty(str, plural) {
	if (str &#x26;&#x26; str.toString) str = str.toString();
	if (!isString(str) || !str.length) return &#x27;&#x27;;
	var parts = slug(keyToLabel(str)).split(&#x27;-&#x27;);
	if (parts.length &#x26;&#x26; plural) {
		parts[parts.length - 1] = inflect.pluralize(parts[parts.length - 1]);
	}
	for (var i = 1; i &#x3c; parts.length; i++) {
		parts[i] = upcase(parts[i]);
	}
	return parts.join(&#x27;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	if (!def.ref) {
		throw new Error(&#x27;List Relationships must be specified with an object containing ref (&#x27; + this.key + &#x27;)&#x27;);
	}
	if (!def.refPath) {
		def.refPath = utils.downcase(this.key);
	}
	if (!def.path) {
		def.path = utils.<span class="apidocCodeKeywordSpan">keyToProperty</span>(def.ref, true);
	}
	Object.defineProperty(def, &#x27;refList&#x27;, {
		get: function () {
			return keystone.list(def.ref);
		},
	});
	Object.defineProperty(def, &#x27;isValid&#x27;, {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.kmBetween" id="apidoc.element.keystone.utils.kmBetween">
        function <span class="apidocSignatureSpan">keystone.utils.</span>kmBetween
        <span class="apidocSignatureSpan">(point1, point2)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function kmBetween(point1, point2) {
	return calculateDistance(point1, point2) * RADIUS_KM;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.milesBetween" id="apidoc.element.keystone.utils.milesBetween">
        function <span class="apidocSignatureSpan">keystone.utils.</span>milesBetween
        <span class="apidocSignatureSpan">(point1, point2)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function milesBetween(point1, point2) {
	return calculateDistance(point1, point2) * RADIUS_MILES;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.noop" id="apidoc.element.keystone.utils.noop">
        function <span class="apidocSignatureSpan">keystone.utils.</span>noop
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">noop = function () {}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.number" id="apidoc.element.keystone.utils.number">
        function <span class="apidocSignatureSpan">keystone.utils.</span>number
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function number(str) {
	return parseFloat(String(str).replace(/[^\-0-9\.]/g, &#x27;&#x27;));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
					}
					break;

				case &#x27;number&#x27;:
				case &#x27;money&#x27;:
					if (filter.operator === &#x27;bt&#x27;) {
						value = [
							utils.<span class="apidocCodeKeywordSpan">number</span>(value[0]),
							utils.number(value[1]),
						];
						if (!isNaN(value[0]) &#x26;&#x26; !isNaN(value[1])) {
							filters[path] = {
								$gte: value[0],
								$lte: value[1],
							};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.options" id="apidoc.element.keystone.utils.options">
        function <span class="apidocSignatureSpan">keystone.utils.</span>options
        <span class="apidocSignatureSpan">(defaults, ops)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function options(defaults, ops) {
	defaults = defaults || {};
	ops = ops || {};
	Object.keys(ops).forEach(function (key) {
		defaults[key] = ops[key];
	});
	return defaults;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var initialFields;

		// Inherit default options from parent list if it exists
		if (options &#x26;&#x26; options.inherits) {
			if (options.inherits.options &#x26;&#x26; options.inherits.options.inherits) {
				throw new Error(&#x27;Inherited Lists may not contain any inheritance&#x27;);
			}
			defaultOptions = utils.<span class="apidocCodeKeywordSpan">options</span>(defaultOptions, options.inherits.options);
			if (options.inherits.options.track) {
				options.track = false;
			}
		}

		this.options = utils.options(defaultOptions, options);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.optionsMap" id="apidoc.element.keystone.utils.optionsMap">
        function <span class="apidocSignatureSpan">keystone.utils.</span>optionsMap
        <span class="apidocSignatureSpan">(arr, property, clone)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function optionsMap(arr, property, clone) {
	if (arguments.length === 2 &#x26;&#x26; typeof property === &#x27;boolean&#x27;) {
		clone = property;
		property = undefined;
	}
	var obj = {};
	for (var i = 0; i &#x3c; arr.length; i++) {
		var prop = (property) ? arr[i][property] : arr[i];
		if (clone) {
			prop = deepClone(prop);
		}
		obj[arr[i].value] = prop;
	}
	return obj;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	// undefined options.emptyOption defaults to true
	if (options.emptyOption === undefined) {
		options.emptyOption = true;
	}
	// ensure this.emptyOption is a boolean
	this.emptyOption = !!options.emptyOption;
	// cached maps for options, labels and values
	this.map = utils.<span class="apidocCodeKeywordSpan">optionsMap</span>(this.ops);
	this.labels = utils.optionsMap(this.ops, &#x27;label&#x27;);
	this.values = _.map(this.ops, &#x27;value&#x27;);
	select.super_.call(this, list, path, options);
}
select.properName = &#x27;Select&#x27;;
util.inherits(select, FieldType);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.plural" id="apidoc.element.keystone.utils.plural">
        function <span class="apidocSignatureSpan">keystone.utils.</span>plural
        <span class="apidocSignatureSpan">(count, sn, pl)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function plural(count, sn, pl) {
	if (arguments.length === 1) {
		return inflect.pluralize(count);
	}
	if (typeof sn !== &#x27;string&#x27;) sn = &#x27;&#x27;;
	if (!pl) {
		pl = inflect.pluralize(sn);
	}
	if (typeof count === &#x27;string&#x27;) {
		count = Number(count);
	} else if (typeof count !== &#x27;number&#x27;) {
		count = Object.keys(count).length;
	}
	return (count === 1 ? sn : pl).replace(&#x27;*&#x27;, count);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		var self = this;

		// init mappings
		_.forEach(this.options.map, function (val, key) { self.map(key, val); });

		// define property getters
		Object.defineProperty(this, &#x27;label&#x27;, { get: function () {
			return this.get(&#x27;label&#x27;) || this.set(&#x27;label&#x27;, utils.<span class="apidocCodeKeywordSpan">plural</span>(utils
.keyToLabel(key)));
		} });
		Object.defineProperty(this, &#x27;singular&#x27;, { get: function () {
			return this.get(&#x27;singular&#x27;) || this.set(&#x27;singular&#x27;, utils.singular(this.label));
		} });
		Object.defineProperty(this, &#x27;plural&#x27;, { get: function () {
			return this.get(&#x27;plural&#x27;) || this.set(&#x27;plural&#x27;, utils.plural(this.singular));
		} });
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.randomString" id="apidoc.element.keystone.utils.randomString">
        function <span class="apidocSignatureSpan">keystone.utils.</span>randomString
        <span class="apidocSignatureSpan">(len, chars)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function randomKey(len, chars) {
	var str = &#x27;&#x27;;
	if (typeof len === &#x27;object&#x27;) { // cheap array check
		var min = number(len[0]);
		var max = number(len[1]);
		len = Math.round(Math.random() * (max - min)) + min;
	} else {
		len = number(len);
	}
	chars = chars || randomKey.default;
	for (var i = 0; i &#x3c; len; i++) {
		str += chars.charAt(Math.floor(Math.random() * chars.length));
	}
	return str;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

exports.getSecret = function (req) {
	return req.session[exports.SECRET_KEY] || (req.session[exports.SECRET_KEY] = exports.createSecret());
};

exports.createToken = function (req) {
	return tokenize(utils.<span class="apidocCodeKeywordSpan">randomString</span>(exports.SECRET_LENGTH), exports.getSecret(req));
};

exports.getToken = function (req, res) {
	res.locals[exports.LOCAL_VALUE] = res.locals[exports.LOCAL_VALUE] || exports.createToken(req);
	res.cookie(exports.XSRF_COOKIE_KEY, res.locals[exports.LOCAL_VALUE]);
	return res.locals[exports.LOCAL_VALUE];
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.singular" id="apidoc.element.keystone.utils.singular">
        function <span class="apidocSignatureSpan">keystone.utils.</span>singular
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function singular(str) {
	return inflect.singularize(str);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		_.forEach(this.options.map, function (val, key) { self.map(key, val); });

		// define property getters
		Object.defineProperty(this, &#x27;label&#x27;, { get: function () {
			return this.get(&#x27;label&#x27;) || this.set(&#x27;label&#x27;, utils.plural(utils.keyToLabel(key)));
		} });
		Object.defineProperty(this, &#x27;singular&#x27;, { get: function () {
			return this.get(&#x27;singular&#x27;) || this.set(&#x27;singular&#x27;, utils.<span class="apidocCodeKeywordSpan">singular</span
>(this.label));
		} });
		Object.defineProperty(this, &#x27;plural&#x27;, { get: function () {
			return this.get(&#x27;plural&#x27;) || this.set(&#x27;plural&#x27;, utils.plural(this.singular));
		} });
		Object.defineProperty(this, &#x27;namePath&#x27;, { get: function () {
			return this.mappings.name || &#x27;_id&#x27;;
		} });
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.slug" id="apidoc.element.keystone.utils.slug">
        function <span class="apidocSignatureSpan">keystone.utils.</span>slug
        <span class="apidocSignatureSpan">(str, sep, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function slug(str, sep, options) {
	if (!limax) {
		return _slug(str, {
			separator: sep,
			custom: {
				&#x27;’&#x27;: &#x27;&#x27;,
			},
		}).toLowerCase();
	}
	options = options || {};
	sep = sep || &#x27;-&#x27;;
	return limax(str, { tone: false, lang: options.locale, separator: sep });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...


var utils = require(&#x27;keystone-utils&#x27;);

module.exports = function initDatabaseConfig () {
	if (!this.get(&#x27;mongo&#x27;)) {
		var dbName = this.get(&#x27;db name&#x27;)
			|| utils.<span class="apidocCodeKeywordSpan">slug</span>(this.get(&#x27;name&#x27;));
		var dbUrl = process.env.MONGO_URI
			|| process.env.MONGODB_URI
			|| process.env.MONGO_URL
			|| process.env.MONGODB_URL
			|| process.env.MONGOLAB_URI
			|| process.env.MONGOLAB_URL
			|| (process.env.OPENSHIFT_MONGODB_DB_URL
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.stringify" id="apidoc.element.keystone.utils.stringify">
        function <span class="apidocSignatureSpan">keystone.utils.</span>stringify
        <span class="apidocSignatureSpan">(obj)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function stringify(obj) {
	return JSON.stringify(obj).replace(/[\u000A\u000D\u2028\u2029]/g, function (c) {
		return &#x27;\\u&#x27; + (&#x27;0000&#x27; + c.charCodeAt(0).toString(16)).slice(-4);
	});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		if (keystone.get(&#x27;env&#x27;) === &#x27;development&#x27;) {
			if (err instanceof Error) {
				if (err.type) {
					msg += &#x27;&#x3c;h2&#x3e;&#x27; + err.type + &#x27;&#x3c;/h2&#x3e;&#x27;;
				}
				msg += utils.textToHTML(err.message);
			} else if (typeof err === &#x27;object&#x27;) {
				msg += &#x27;&#x3c;code&#x3e;&#x27; + JSON.<span class="apidocCodeKeywordSpan">stringify</span>(err) + &#x27;&#x3c;/code&#x3e
;&#x27;;
			} else if (err) {
				msg += err;
			}
		}
		return res.status(500).send(keystone.wrapHTMLError(&#x27;Sorry, an error occurred loading the page (500)&#x27;, msg));
	};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.stripDiacritics" id="apidoc.element.keystone.utils.stripDiacritics">
        function <span class="apidocSignatureSpan">keystone.utils.</span>stripDiacritics
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function stripDiacritics(str) {
	if (str &#x26;&#x26; str.toString) str = str.toString();
	if (!isString(str) || !str.length) return &#x27;&#x27;;
	var rtn = [];
	for (var i = 0; i &#x3c; str.length; i++) {
		var c = str.charAt(i);
		rtn.push(diacritics[c] || c);
	}
	return rtn.join(&#x27;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.textToHTML" id="apidoc.element.keystone.utils.textToHTML">
        function <span class="apidocSignatureSpan">keystone.utils.</span>textToHTML
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function textToHTML(str) {
	if (str &#x26;&#x26; str.toString) str = str.toString();
	if (!isString(str) || !str.length) return &#x27;&#x27;;
	return encodeHTMLEntities(str).replace(/\n/g, &#x27;&#x3c;br&#x3e;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
		}
		var msg = &#x27;&#x27;;
		if (keystone.get(&#x27;env&#x27;) === &#x27;development&#x27;) {
			if (err instanceof Error) {
				if (err.type) {
					msg += &#x27;&#x3c;h2&#x3e;&#x27; + err.type + &#x27;&#x3c;/h2&#x3e;&#x27;;
				}
				msg += utils.<span class="apidocCodeKeywordSpan">textToHTML</span>(err.message);
			} else if (typeof err === &#x27;object&#x27;) {
				msg += &#x27;&#x3c;code&#x3e;&#x27; + JSON.stringify(err) + &#x27;&#x3c;/code&#x3e;&#x27;;
			} else if (err) {
				msg += err;
			}
		}
		return res.status(500).send(keystone.wrapHTMLError(&#x27;Sorry, an error occurred loading the page (500)&#x27;, msg));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.titlecase" id="apidoc.element.keystone.utils.titlecase">
        function <span class="apidocSignatureSpan">keystone.utils.</span>titlecase
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function titlecase(str) {
	if (str &#x26;&#x26; str.toString) str = str.toString();
	if (!isString(str) || !str.length) return &#x27;&#x27;;
	str = str.replace(/([a-z])([A-Z])/g, &#x27;$1 $2&#x27;);
	var parts = str.split(/\s|_|\-/);
	for (var i = 0; i &#x3c; parts.length; i++) {
		if (parts[i] &#x26;&#x26; !/^[A-Z0-9]+$/.test(parts[i])) {
			parts[i] = upcase(parts[i]);
		}
	}
	return compact(parts).join(&#x27; &#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.transliterate" id="apidoc.element.keystone.utils.transliterate">
        function <span class="apidocSignatureSpan">keystone.utils.</span>transliterate
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function transliterate(str) {
	if (str &#x26;&#x26; str.toString) str = str.toString();
	if (!isString(str) || !str.length) return &#x27;&#x27;;
	var rtn = [];
	// applying зг-zgh rule
	str = str.replace(transliteration.regexp.Zgh, &#x27;Zgh&#x27;);
	str = str.replace(transliteration.regexp.zgh, &#x27;zgh&#x27;);
	// replace characters with equivalent maps
	for (var i = 0; i &#x3c; str.length; i++) {
		var character = str[i];
		var latinCharacter = transliteration.characterMap[character];
		rtn.push((latinCharacter || latinCharacter === &#x27;&#x27;) ? latinCharacter : character);
	}
	return rtn.join(&#x27;&#x27;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.keystone.utils.upcase" id="apidoc.element.keystone.utils.upcase">
        function <span class="apidocSignatureSpan">keystone.utils.</span>upcase
        <span class="apidocSignatureSpan">(str)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function upcase(str) {
	if (str &#x26;&#x26; str.toString) str = str.toString();
	if (!isString(str) || !str.length) return &#x27;&#x27;;
	return (str.substr(0, 1).toUpperCase() + str.substr(1));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
exports.titlecase = function (str) {
 if (str &#x26;&#x26; str.toString) str = str.toString();
 if (typeof str !== &#x27;string&#x27; || !str.length) return &#x27;&#x27;;
 str = str.replace(/([a-z])([A-Z])/g, &#x27;$1 $2&#x27;);
 var parts = str.split(/\s|_|\-/);
 for (var i = 0; i &#x3c; parts.length; i++) {
   if (parts[i] &#x26;&#x26; !/^[A-Z0-9]+$/.test(parts[i])) {
     parts[i] = exports.<span class="apidocCodeKeywordSpan">upcase</span>(parts[i]);
   }
 }
 return (0, _lodash.compact)(parts).join(&#x27; &#x27;);
};

/**
* Converts a string to camel case
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
